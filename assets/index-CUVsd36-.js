(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function NO(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hI={exports:{}},Kd={},fI={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tc=Symbol.for("react.element"),EO=Symbol.for("react.portal"),IO=Symbol.for("react.fragment"),TO=Symbol.for("react.strict_mode"),jO=Symbol.for("react.profiler"),kO=Symbol.for("react.provider"),CO=Symbol.for("react.context"),AO=Symbol.for("react.forward_ref"),DO=Symbol.for("react.suspense"),MO=Symbol.for("react.memo"),RO=Symbol.for("react.lazy"),a1=Symbol.iterator;function OO(e){return e===null||typeof e!="object"?null:(e=a1&&e[a1]||e["@@iterator"],typeof e=="function"?e:null)}var dI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pI=Object.assign,mI={};function mu(e,t,n){this.props=e,this.context=t,this.refs=mI,this.updater=n||dI}mu.prototype.isReactComponent={};mu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};mu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gI(){}gI.prototype=mu.prototype;function S0(e,t,n){this.props=e,this.context=t,this.refs=mI,this.updater=n||dI}var _0=S0.prototype=new gI;_0.constructor=S0;pI(_0,mu.prototype);_0.isPureReactComponent=!0;var u1=Array.isArray,vI=Object.prototype.hasOwnProperty,N0={current:null},yI={key:!0,ref:!0,__self:!0,__source:!0};function wI(e,t,n){var r,o={},s=null,u=null;if(t!=null)for(r in t.ref!==void 0&&(u=t.ref),t.key!==void 0&&(s=""+t.key),t)vI.call(t,r)&&!yI.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(c===1)o.children=n;else if(1<c){for(var f=Array(c),p=0;p<c;p++)f[p]=arguments[p+2];o.children=f}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)o[r]===void 0&&(o[r]=c[r]);return{$$typeof:Tc,type:e,key:s,ref:u,props:o,_owner:N0.current}}function LO(e,t){return{$$typeof:Tc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function E0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tc}function PO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var l1=/\/+/g;function fv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?PO(""+e.key):t.toString(36)}function Tf(e,t,n,r,o){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var u=!1;if(e===null)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case Tc:case EO:u=!0}}if(u)return u=e,o=o(u),e=r===""?"."+fv(u,0):r,u1(o)?(n="",e!=null&&(n=e.replace(l1,"$&/")+"/"),Tf(o,t,n,"",function(p){return p})):o!=null&&(E0(o)&&(o=LO(o,n+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(l1,"$&/")+"/")+e)),t.push(o)),1;if(u=0,r=r===""?".":r+":",u1(e))for(var c=0;c<e.length;c++){s=e[c];var f=r+fv(s,c);u+=Tf(s,t,n,f,o)}else if(f=OO(e),typeof f=="function")for(e=f.call(e),c=0;!(s=e.next()).done;)s=s.value,f=r+fv(s,c++),u+=Tf(s,t,n,f,o);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function Qh(e,t,n){if(e==null)return e;var r=[],o=0;return Tf(e,r,"","",function(s){return t.call(n,s,o++)}),r}function UO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Cn={current:null},jf={transition:null},FO={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:jf,ReactCurrentOwner:N0};function xI(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Qh,forEach:function(e,t,n){Qh(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Qh(e,function(){t++}),t},toArray:function(e){return Qh(e,function(t){return t})||[]},only:function(e){if(!E0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Re.Component=mu;Re.Fragment=IO;Re.Profiler=jO;Re.PureComponent=S0;Re.StrictMode=TO;Re.Suspense=DO;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FO;Re.act=xI;Re.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=pI({},e.props),o=e.key,s=e.ref,u=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,u=N0.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(f in t)vI.call(t,f)&&!yI.hasOwnProperty(f)&&(r[f]=t[f]===void 0&&c!==void 0?c[f]:t[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){c=Array(f);for(var p=0;p<f;p++)c[p]=arguments[p+2];r.children=c}return{$$typeof:Tc,type:e.type,key:o,ref:s,props:r,_owner:u}};Re.createContext=function(e){return e={$$typeof:CO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kO,_context:e},e.Consumer=e};Re.createElement=wI;Re.createFactory=function(e){var t=wI.bind(null,e);return t.type=e,t};Re.createRef=function(){return{current:null}};Re.forwardRef=function(e){return{$$typeof:AO,render:e}};Re.isValidElement=E0;Re.lazy=function(e){return{$$typeof:RO,_payload:{_status:-1,_result:e},_init:UO}};Re.memo=function(e,t){return{$$typeof:MO,type:e,compare:t===void 0?null:t}};Re.startTransition=function(e){var t=jf.transition;jf.transition={};try{e()}finally{jf.transition=t}};Re.unstable_act=xI;Re.useCallback=function(e,t){return Cn.current.useCallback(e,t)};Re.useContext=function(e){return Cn.current.useContext(e)};Re.useDebugValue=function(){};Re.useDeferredValue=function(e){return Cn.current.useDeferredValue(e)};Re.useEffect=function(e,t){return Cn.current.useEffect(e,t)};Re.useId=function(){return Cn.current.useId()};Re.useImperativeHandle=function(e,t,n){return Cn.current.useImperativeHandle(e,t,n)};Re.useInsertionEffect=function(e,t){return Cn.current.useInsertionEffect(e,t)};Re.useLayoutEffect=function(e,t){return Cn.current.useLayoutEffect(e,t)};Re.useMemo=function(e,t){return Cn.current.useMemo(e,t)};Re.useReducer=function(e,t,n){return Cn.current.useReducer(e,t,n)};Re.useRef=function(e){return Cn.current.useRef(e)};Re.useState=function(e){return Cn.current.useState(e)};Re.useSyncExternalStore=function(e,t,n){return Cn.current.useSyncExternalStore(e,t,n)};Re.useTransition=function(){return Cn.current.useTransition()};Re.version="18.3.1";fI.exports=Re;var M=fI.exports;const Bl=NO(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $O=M,VO=Symbol.for("react.element"),BO=Symbol.for("react.fragment"),zO=Object.prototype.hasOwnProperty,qO=$O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,KO={key:!0,ref:!0,__self:!0,__source:!0};function bI(e,t,n){var r,o={},s=null,u=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(u=t.ref);for(r in t)zO.call(t,r)&&!KO.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:VO,type:e,key:s,ref:u,props:o,_owner:qO.current}}Kd.Fragment=BO;Kd.jsx=bI;Kd.jsxs=bI;hI.exports=Kd;var h=hI.exports,Zv={},SI={exports:{}},lr={},_I={exports:{}},NI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,Z){var z=P.length;P.push(Z);e:for(;0<z;){var ae=z-1>>>1,Q=P[ae];if(0<o(Q,Z))P[ae]=Z,P[z]=Q,z=ae;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var Z=P[0],z=P.pop();if(z!==Z){P[0]=z;e:for(var ae=0,Q=P.length,we=Q>>>1;ae<we;){var De=2*(ae+1)-1,xe=P[De],Ve=De+1,re=P[Ve];if(0>o(xe,z))Ve<Q&&0>o(re,xe)?(P[ae]=re,P[Ve]=z,ae=Ve):(P[ae]=xe,P[De]=z,ae=De);else if(Ve<Q&&0>o(re,z))P[ae]=re,P[Ve]=z,ae=Ve;else break e}}return Z}function o(P,Z){var z=P.sortIndex-Z.sortIndex;return z!==0?z:P.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();e.unstable_now=function(){return u.now()-c}}var f=[],p=[],m=1,y=null,v=3,w=!1,E=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var Z=n(p);Z!==null;){if(Z.callback===null)r(p);else if(Z.startTime<=P)r(p),Z.sortIndex=Z.expirationTime,t(f,Z);else break;Z=n(p)}}function j(P){if(_=!1,x(P),!E)if(n(f)!==null)E=!0,J(k);else{var Z=n(p);Z!==null&&V(j,Z.startTime-P)}}function k(P,Z){E=!1,_&&(_=!1,b(L),L=-1),w=!0;var z=v;try{for(x(Z),y=n(f);y!==null&&(!(y.expirationTime>Z)||P&&!$());){var ae=y.callback;if(typeof ae=="function"){y.callback=null,v=y.priorityLevel;var Q=ae(y.expirationTime<=Z);Z=e.unstable_now(),typeof Q=="function"?y.callback=Q:y===n(f)&&r(f),x(Z)}else r(f);y=n(f)}if(y!==null)var we=!0;else{var De=n(p);De!==null&&V(j,De.startTime-Z),we=!1}return we}finally{y=null,v=z,w=!1}}var A=!1,T=null,L=-1,U=5,K=-1;function $(){return!(e.unstable_now()-K<U)}function O(){if(T!==null){var P=e.unstable_now();K=P;var Z=!0;try{Z=T(!0,P)}finally{Z?R():(A=!1,T=null)}}else A=!1}var R;if(typeof N=="function")R=function(){N(O)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,q=X.port2;X.port1.onmessage=O,R=function(){q.postMessage(null)}}else R=function(){C(O,0)};function J(P){T=P,A||(A=!0,R())}function V(P,Z){L=C(function(){P(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){E||w||(E=!0,J(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(P){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var z=v;v=Z;try{return P()}finally{v=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,Z){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var z=v;v=P;try{return Z()}finally{v=z}},e.unstable_scheduleCallback=function(P,Z,z){var ae=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?ae+z:ae):z=ae,P){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=z+Q,P={id:m++,callback:Z,priorityLevel:P,startTime:z,expirationTime:Q,sortIndex:-1},z>ae?(P.sortIndex=z,t(p,P),n(f)===null&&P===n(p)&&(_?(b(L),L=-1):_=!0,V(j,z-ae))):(P.sortIndex=Q,t(f,P),E||w||(E=!0,J(k))),P},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(P){var Z=v;return function(){var z=v;v=Z;try{return P.apply(this,arguments)}finally{v=z}}}})(NI);_I.exports=NI;var HO=_I.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GO=M,ar=HO;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var EI=new Set,zl={};function As(e,t){za(e,t),za(e+"Capture",t)}function za(e,t){for(zl[e]=t,e=0;e<t.length;e++)EI.add(t[e])}var ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ey=Object.prototype.hasOwnProperty,WO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c1={},h1={};function YO(e){return ey.call(h1,e)?!0:ey.call(c1,e)?!1:WO.test(e)?h1[e]=!0:(c1[e]=!0,!1)}function QO(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XO(e,t,n,r){if(t===null||typeof t>"u"||QO(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,n,r,o,s,u){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=u}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sn[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sn[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sn[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sn[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sn[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sn[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sn[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sn[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sn[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var I0=/[\-:]([a-z])/g;function T0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(I0,T0);sn[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(I0,T0);sn[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(I0,T0);sn[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sn[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});sn.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sn[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function j0(e,t,n,r){var o=sn.hasOwnProperty(t)?sn[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XO(t,n,o,r)&&(n=null),r||o===null?YO(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ri=GO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xh=Symbol.for("react.element"),Sa=Symbol.for("react.portal"),_a=Symbol.for("react.fragment"),k0=Symbol.for("react.strict_mode"),ty=Symbol.for("react.profiler"),II=Symbol.for("react.provider"),TI=Symbol.for("react.context"),C0=Symbol.for("react.forward_ref"),ny=Symbol.for("react.suspense"),ry=Symbol.for("react.suspense_list"),A0=Symbol.for("react.memo"),Qi=Symbol.for("react.lazy"),jI=Symbol.for("react.offscreen"),f1=Symbol.iterator;function cl(e){return e===null||typeof e!="object"?null:(e=f1&&e[f1]||e["@@iterator"],typeof e=="function"?e:null)}var yt=Object.assign,dv;function bl(e){if(dv===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);dv=t&&t[1]||""}return`
`+dv+e}var pv=!1;function mv(e,t){if(!e||pv)return"";pv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var r=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){r=p}e.call(t.prototype)}else{try{throw Error()}catch(p){r=p}e()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var o=p.stack.split(`
`),s=r.stack.split(`
`),u=o.length-1,c=s.length-1;1<=u&&0<=c&&o[u]!==s[c];)c--;for(;1<=u&&0<=c;u--,c--)if(o[u]!==s[c]){if(u!==1||c!==1)do if(u--,c--,0>c||o[u]!==s[c]){var f=`
`+o[u].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=u&&0<=c);break}}}finally{pv=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?bl(e):""}function JO(e){switch(e.tag){case 5:return bl(e.type);case 16:return bl("Lazy");case 13:return bl("Suspense");case 19:return bl("SuspenseList");case 0:case 2:case 15:return e=mv(e.type,!1),e;case 11:return e=mv(e.type.render,!1),e;case 1:return e=mv(e.type,!0),e;default:return""}}function iy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _a:return"Fragment";case Sa:return"Portal";case ty:return"Profiler";case k0:return"StrictMode";case ny:return"Suspense";case ry:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case TI:return(e.displayName||"Context")+".Consumer";case II:return(e._context.displayName||"Context")+".Provider";case C0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A0:return t=e.displayName||null,t!==null?t:iy(e.type)||"Memo";case Qi:t=e._payload,e=e._init;try{return iy(e(t))}catch{}}return null}function ZO(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return iy(t);case 8:return t===k0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kI(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function eL(e){var t=kI(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(u){r=""+u,s.call(this,u)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(u){r=""+u},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Jh(e){e._valueTracker||(e._valueTracker=eL(e))}function CI(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=kI(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Gf(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oy(e,t){var n=t.checked;return yt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function d1(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=xo(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function AI(e,t){t=t.checked,t!=null&&j0(e,"checked",t,!1)}function sy(e,t){AI(e,t);var n=xo(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ay(e,t.type,n):t.hasOwnProperty("defaultValue")&&ay(e,t.type,xo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function p1(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ay(e,t,n){(t!=="number"||Gf(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Sl=Array.isArray;function La(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+xo(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function uy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return yt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function m1(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(te(92));if(Sl(n)){if(1<n.length)throw Error(te(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xo(n)}}function DI(e,t){var n=xo(t.value),r=xo(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function g1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function MI(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ly(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?MI(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zh,RI=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zh=Zh||document.createElement("div"),Zh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ql(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Tl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tL=["Webkit","ms","Moz","O"];Object.keys(Tl).forEach(function(e){tL.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Tl[t]=Tl[e]})});function OI(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Tl.hasOwnProperty(e)&&Tl[e]?(""+t).trim():t+"px"}function LI(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=OI(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var nL=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cy(e,t){if(t){if(nL[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function hy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fy=null;function D0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dy=null,Pa=null,Ua=null;function v1(e){if(e=Cc(e)){if(typeof dy!="function")throw Error(te(280));var t=e.stateNode;t&&(t=Qd(t),dy(e.stateNode,e.type,t))}}function PI(e){Pa?Ua?Ua.push(e):Ua=[e]:Pa=e}function UI(){if(Pa){var e=Pa,t=Ua;if(Ua=Pa=null,v1(e),t)for(e=0;e<t.length;e++)v1(t[e])}}function FI(e,t){return e(t)}function $I(){}var gv=!1;function VI(e,t,n){if(gv)return e(t,n);gv=!0;try{return FI(e,t,n)}finally{gv=!1,(Pa!==null||Ua!==null)&&($I(),UI())}}function Kl(e,t){var n=e.stateNode;if(n===null)return null;var r=Qd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(te(231,t,typeof n));return n}var py=!1;if(ji)try{var hl={};Object.defineProperty(hl,"passive",{get:function(){py=!0}}),window.addEventListener("test",hl,hl),window.removeEventListener("test",hl,hl)}catch{py=!1}function rL(e,t,n,r,o,s,u,c,f){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(m){this.onError(m)}}var jl=!1,Wf=null,Yf=!1,my=null,iL={onError:function(e){jl=!0,Wf=e}};function oL(e,t,n,r,o,s,u,c,f){jl=!1,Wf=null,rL.apply(iL,arguments)}function sL(e,t,n,r,o,s,u,c,f){if(oL.apply(this,arguments),jl){if(jl){var p=Wf;jl=!1,Wf=null}else throw Error(te(198));Yf||(Yf=!0,my=p)}}function Ds(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function BI(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function y1(e){if(Ds(e)!==e)throw Error(te(188))}function aL(e){var t=e.alternate;if(!t){if(t=Ds(e),t===null)throw Error(te(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return y1(o),e;if(s===r)return y1(o),t;s=s.sibling}throw Error(te(188))}if(n.return!==r.return)n=o,r=s;else{for(var u=!1,c=o.child;c;){if(c===n){u=!0,n=o,r=s;break}if(c===r){u=!0,r=o,n=s;break}c=c.sibling}if(!u){for(c=s.child;c;){if(c===n){u=!0,n=s,r=o;break}if(c===r){u=!0,r=s,n=o;break}c=c.sibling}if(!u)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?e:t}function zI(e){return e=aL(e),e!==null?qI(e):null}function qI(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qI(e);if(t!==null)return t;e=e.sibling}return null}var KI=ar.unstable_scheduleCallback,w1=ar.unstable_cancelCallback,uL=ar.unstable_shouldYield,lL=ar.unstable_requestPaint,kt=ar.unstable_now,cL=ar.unstable_getCurrentPriorityLevel,M0=ar.unstable_ImmediatePriority,HI=ar.unstable_UserBlockingPriority,Qf=ar.unstable_NormalPriority,hL=ar.unstable_LowPriority,GI=ar.unstable_IdlePriority,Hd=null,si=null;function fL(e){if(si&&typeof si.onCommitFiberRoot=="function")try{si.onCommitFiberRoot(Hd,e,void 0,(e.current.flags&128)===128)}catch{}}var Fr=Math.clz32?Math.clz32:mL,dL=Math.log,pL=Math.LN2;function mL(e){return e>>>=0,e===0?32:31-(dL(e)/pL|0)|0}var ef=64,tf=4194304;function _l(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xf(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,s=e.pingedLanes,u=n&268435455;if(u!==0){var c=u&~o;c!==0?r=_l(c):(s&=u,s!==0&&(r=_l(s)))}else u=n&~o,u!==0?r=_l(u):s!==0&&(r=_l(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,s=t&-t,o>=s||o===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Fr(t),o=1<<n,r|=e[n],t&=~o;return r}function gL(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vL(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var u=31-Fr(s),c=1<<u,f=o[u];f===-1?(!(c&n)||c&r)&&(o[u]=gL(c,t)):f<=t&&(e.expiredLanes|=c),s&=~c}}function gy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function WI(){var e=ef;return ef<<=1,!(ef&4194240)&&(ef=64),e}function vv(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function jc(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fr(t),e[t]=n}function yL(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Fr(n),s=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~s}}function R0(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Fr(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var Xe=0;function YI(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var QI,O0,XI,JI,ZI,vy=!1,nf=[],uo=null,lo=null,co=null,Hl=new Map,Gl=new Map,eo=[],wL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function x1(e,t){switch(e){case"focusin":case"focusout":uo=null;break;case"dragenter":case"dragleave":lo=null;break;case"mouseover":case"mouseout":co=null;break;case"pointerover":case"pointerout":Hl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gl.delete(t.pointerId)}}function fl(e,t,n,r,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},t!==null&&(t=Cc(t),t!==null&&O0(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function xL(e,t,n,r,o){switch(t){case"focusin":return uo=fl(uo,e,t,n,r,o),!0;case"dragenter":return lo=fl(lo,e,t,n,r,o),!0;case"mouseover":return co=fl(co,e,t,n,r,o),!0;case"pointerover":var s=o.pointerId;return Hl.set(s,fl(Hl.get(s)||null,e,t,n,r,o)),!0;case"gotpointercapture":return s=o.pointerId,Gl.set(s,fl(Gl.get(s)||null,e,t,n,r,o)),!0}return!1}function eT(e){var t=is(e.target);if(t!==null){var n=Ds(t);if(n!==null){if(t=n.tag,t===13){if(t=BI(n),t!==null){e.blockedOn=t,ZI(e.priority,function(){XI(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=yy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);fy=r,n.target.dispatchEvent(r),fy=null}else return t=Cc(n),t!==null&&O0(t),e.blockedOn=n,!1;t.shift()}return!0}function b1(e,t,n){kf(e)&&n.delete(t)}function bL(){vy=!1,uo!==null&&kf(uo)&&(uo=null),lo!==null&&kf(lo)&&(lo=null),co!==null&&kf(co)&&(co=null),Hl.forEach(b1),Gl.forEach(b1)}function dl(e,t){e.blockedOn===t&&(e.blockedOn=null,vy||(vy=!0,ar.unstable_scheduleCallback(ar.unstable_NormalPriority,bL)))}function Wl(e){function t(o){return dl(o,e)}if(0<nf.length){dl(nf[0],e);for(var n=1;n<nf.length;n++){var r=nf[n];r.blockedOn===e&&(r.blockedOn=null)}}for(uo!==null&&dl(uo,e),lo!==null&&dl(lo,e),co!==null&&dl(co,e),Hl.forEach(t),Gl.forEach(t),n=0;n<eo.length;n++)r=eo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<eo.length&&(n=eo[0],n.blockedOn===null);)eT(n),n.blockedOn===null&&eo.shift()}var Fa=Ri.ReactCurrentBatchConfig,Jf=!0;function SL(e,t,n,r){var o=Xe,s=Fa.transition;Fa.transition=null;try{Xe=1,L0(e,t,n,r)}finally{Xe=o,Fa.transition=s}}function _L(e,t,n,r){var o=Xe,s=Fa.transition;Fa.transition=null;try{Xe=4,L0(e,t,n,r)}finally{Xe=o,Fa.transition=s}}function L0(e,t,n,r){if(Jf){var o=yy(e,t,n,r);if(o===null)Tv(e,t,r,Zf,n),x1(e,r);else if(xL(o,e,t,n,r))r.stopPropagation();else if(x1(e,r),t&4&&-1<wL.indexOf(e)){for(;o!==null;){var s=Cc(o);if(s!==null&&QI(s),s=yy(e,t,n,r),s===null&&Tv(e,t,r,Zf,n),s===o)break;o=s}o!==null&&r.stopPropagation()}else Tv(e,t,r,null,n)}}var Zf=null;function yy(e,t,n,r){if(Zf=null,e=D0(r),e=is(e),e!==null)if(t=Ds(e),t===null)e=null;else if(n=t.tag,n===13){if(e=BI(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zf=e,null}function tT(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cL()){case M0:return 1;case HI:return 4;case Qf:case hL:return 16;case GI:return 536870912;default:return 16}default:return 16}}var so=null,P0=null,Cf=null;function nT(){if(Cf)return Cf;var e,t=P0,n=t.length,r,o="value"in so?so.value:so.textContent,s=o.length;for(e=0;e<n&&t[e]===o[e];e++);var u=n-e;for(r=1;r<=u&&t[n-r]===o[s-r];r++);return Cf=o.slice(e,1<r?1-r:void 0)}function Af(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function rf(){return!0}function S1(){return!1}function cr(e){function t(n,r,o,s,u){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=u,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?rf:S1,this.isPropagationStopped=S1,this}return yt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rf)},persist:function(){},isPersistent:rf}),t}var gu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},U0=cr(gu),kc=yt({},gu,{view:0,detail:0}),NL=cr(kc),yv,wv,pl,Gd=yt({},kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:F0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pl&&(pl&&e.type==="mousemove"?(yv=e.screenX-pl.screenX,wv=e.screenY-pl.screenY):wv=yv=0,pl=e),yv)},movementY:function(e){return"movementY"in e?e.movementY:wv}}),_1=cr(Gd),EL=yt({},Gd,{dataTransfer:0}),IL=cr(EL),TL=yt({},kc,{relatedTarget:0}),xv=cr(TL),jL=yt({},gu,{animationName:0,elapsedTime:0,pseudoElement:0}),kL=cr(jL),CL=yt({},gu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),AL=cr(CL),DL=yt({},gu,{data:0}),N1=cr(DL),ML={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LL(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=OL[e])?!!t[e]:!1}function F0(){return LL}var PL=yt({},kc,{key:function(e){if(e.key){var t=ML[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Af(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?RL[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:F0,charCode:function(e){return e.type==="keypress"?Af(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Af(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),UL=cr(PL),FL=yt({},Gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E1=cr(FL),$L=yt({},kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:F0}),VL=cr($L),BL=yt({},gu,{propertyName:0,elapsedTime:0,pseudoElement:0}),zL=cr(BL),qL=yt({},Gd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),KL=cr(qL),HL=[9,13,27,32],$0=ji&&"CompositionEvent"in window,kl=null;ji&&"documentMode"in document&&(kl=document.documentMode);var GL=ji&&"TextEvent"in window&&!kl,rT=ji&&(!$0||kl&&8<kl&&11>=kl),I1=" ",T1=!1;function iT(e,t){switch(e){case"keyup":return HL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oT(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Na=!1;function WL(e,t){switch(e){case"compositionend":return oT(t);case"keypress":return t.which!==32?null:(T1=!0,I1);case"textInput":return e=t.data,e===I1&&T1?null:e;default:return null}}function YL(e,t){if(Na)return e==="compositionend"||!$0&&iT(e,t)?(e=nT(),Cf=P0=so=null,Na=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rT&&t.locale!=="ko"?null:t.data;default:return null}}var QL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!QL[e.type]:t==="textarea"}function sT(e,t,n,r){PI(r),t=ed(t,"onChange"),0<t.length&&(n=new U0("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Cl=null,Yl=null;function XL(e){vT(e,0)}function Wd(e){var t=Ta(e);if(CI(t))return e}function JL(e,t){if(e==="change")return t}var aT=!1;if(ji){var bv;if(ji){var Sv="oninput"in document;if(!Sv){var k1=document.createElement("div");k1.setAttribute("oninput","return;"),Sv=typeof k1.oninput=="function"}bv=Sv}else bv=!1;aT=bv&&(!document.documentMode||9<document.documentMode)}function C1(){Cl&&(Cl.detachEvent("onpropertychange",uT),Yl=Cl=null)}function uT(e){if(e.propertyName==="value"&&Wd(Yl)){var t=[];sT(t,Yl,e,D0(e)),VI(XL,t)}}function ZL(e,t,n){e==="focusin"?(C1(),Cl=t,Yl=n,Cl.attachEvent("onpropertychange",uT)):e==="focusout"&&C1()}function eP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wd(Yl)}function tP(e,t){if(e==="click")return Wd(t)}function nP(e,t){if(e==="input"||e==="change")return Wd(t)}function rP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qr=typeof Object.is=="function"?Object.is:rP;function Ql(e,t){if(qr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ey.call(t,o)||!qr(e[o],t[o]))return!1}return!0}function A1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function D1(e,t){var n=A1(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=A1(n)}}function lT(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lT(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cT(){for(var e=window,t=Gf();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Gf(e.document)}return t}function V0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iP(e){var t=cT(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&lT(n.ownerDocument.documentElement,n)){if(r!==null&&V0(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!e.extend&&s>r&&(o=r,r=s,s=o),o=D1(n,s);var u=D1(n,r);o&&u&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==u.node||e.focusOffset!==u.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(u.node,u.offset)):(t.setEnd(u.node,u.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var oP=ji&&"documentMode"in document&&11>=document.documentMode,Ea=null,wy=null,Al=null,xy=!1;function M1(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xy||Ea==null||Ea!==Gf(r)||(r=Ea,"selectionStart"in r&&V0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Al&&Ql(Al,r)||(Al=r,r=ed(wy,"onSelect"),0<r.length&&(t=new U0("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ea)))}function of(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ia={animationend:of("Animation","AnimationEnd"),animationiteration:of("Animation","AnimationIteration"),animationstart:of("Animation","AnimationStart"),transitionend:of("Transition","TransitionEnd")},_v={},hT={};ji&&(hT=document.createElement("div").style,"AnimationEvent"in window||(delete Ia.animationend.animation,delete Ia.animationiteration.animation,delete Ia.animationstart.animation),"TransitionEvent"in window||delete Ia.transitionend.transition);function Yd(e){if(_v[e])return _v[e];if(!Ia[e])return e;var t=Ia[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in hT)return _v[e]=t[n];return e}var fT=Yd("animationend"),dT=Yd("animationiteration"),pT=Yd("animationstart"),mT=Yd("transitionend"),gT=new Map,R1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(e,t){gT.set(e,t),As(t,[e])}for(var Nv=0;Nv<R1.length;Nv++){var Ev=R1[Nv],sP=Ev.toLowerCase(),aP=Ev[0].toUpperCase()+Ev.slice(1);No(sP,"on"+aP)}No(fT,"onAnimationEnd");No(dT,"onAnimationIteration");No(pT,"onAnimationStart");No("dblclick","onDoubleClick");No("focusin","onFocus");No("focusout","onBlur");No(mT,"onTransitionEnd");za("onMouseEnter",["mouseout","mouseover"]);za("onMouseLeave",["mouseout","mouseover"]);za("onPointerEnter",["pointerout","pointerover"]);za("onPointerLeave",["pointerout","pointerover"]);As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));As("onBeforeInput",["compositionend","keypress","textInput","paste"]);As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nl));function O1(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,sL(r,t,void 0,e),e.currentTarget=null}function vT(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var u=r.length-1;0<=u;u--){var c=r[u],f=c.instance,p=c.currentTarget;if(c=c.listener,f!==s&&o.isPropagationStopped())break e;O1(o,c,p),s=f}else for(u=0;u<r.length;u++){if(c=r[u],f=c.instance,p=c.currentTarget,c=c.listener,f!==s&&o.isPropagationStopped())break e;O1(o,c,p),s=f}}}if(Yf)throw e=my,Yf=!1,my=null,e}function rt(e,t){var n=t[Ey];n===void 0&&(n=t[Ey]=new Set);var r=e+"__bubble";n.has(r)||(yT(t,e,2,!1),n.add(r))}function Iv(e,t,n){var r=0;t&&(r|=4),yT(n,e,r,t)}var sf="_reactListening"+Math.random().toString(36).slice(2);function Xl(e){if(!e[sf]){e[sf]=!0,EI.forEach(function(n){n!=="selectionchange"&&(uP.has(n)||Iv(n,!1,e),Iv(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[sf]||(t[sf]=!0,Iv("selectionchange",!1,t))}}function yT(e,t,n,r){switch(tT(t)){case 1:var o=SL;break;case 4:o=_L;break;default:o=L0}n=o.bind(null,t,n,e),o=void 0,!py||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Tv(e,t,n,r,o){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var u=r.tag;if(u===3||u===4){var c=r.stateNode.containerInfo;if(c===o||c.nodeType===8&&c.parentNode===o)break;if(u===4)for(u=r.return;u!==null;){var f=u.tag;if((f===3||f===4)&&(f=u.stateNode.containerInfo,f===o||f.nodeType===8&&f.parentNode===o))return;u=u.return}for(;c!==null;){if(u=is(c),u===null)return;if(f=u.tag,f===5||f===6){r=s=u;continue e}c=c.parentNode}}r=r.return}VI(function(){var p=s,m=D0(n),y=[];e:{var v=gT.get(e);if(v!==void 0){var w=U0,E=e;switch(e){case"keypress":if(Af(n)===0)break e;case"keydown":case"keyup":w=UL;break;case"focusin":E="focus",w=xv;break;case"focusout":E="blur",w=xv;break;case"beforeblur":case"afterblur":w=xv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=_1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=IL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=VL;break;case fT:case dT:case pT:w=kL;break;case mT:w=zL;break;case"scroll":w=NL;break;case"wheel":w=KL;break;case"copy":case"cut":case"paste":w=AL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=E1}var _=(t&4)!==0,C=!_&&e==="scroll",b=_?v!==null?v+"Capture":null:v;_=[];for(var N=p,x;N!==null;){x=N;var j=x.stateNode;if(x.tag===5&&j!==null&&(x=j,b!==null&&(j=Kl(N,b),j!=null&&_.push(Jl(N,j,x)))),C)break;N=N.return}0<_.length&&(v=new w(v,E,null,n,m),y.push({event:v,listeners:_}))}}if(!(t&7)){e:{if(v=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",v&&n!==fy&&(E=n.relatedTarget||n.fromElement)&&(is(E)||E[ki]))break e;if((w||v)&&(v=m.window===m?m:(v=m.ownerDocument)?v.defaultView||v.parentWindow:window,w?(E=n.relatedTarget||n.toElement,w=p,E=E?is(E):null,E!==null&&(C=Ds(E),E!==C||E.tag!==5&&E.tag!==6)&&(E=null)):(w=null,E=p),w!==E)){if(_=_1,j="onMouseLeave",b="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(_=E1,j="onPointerLeave",b="onPointerEnter",N="pointer"),C=w==null?v:Ta(w),x=E==null?v:Ta(E),v=new _(j,N+"leave",w,n,m),v.target=C,v.relatedTarget=x,j=null,is(m)===p&&(_=new _(b,N+"enter",E,n,m),_.target=x,_.relatedTarget=C,j=_),C=j,w&&E)t:{for(_=w,b=E,N=0,x=_;x;x=pa(x))N++;for(x=0,j=b;j;j=pa(j))x++;for(;0<N-x;)_=pa(_),N--;for(;0<x-N;)b=pa(b),x--;for(;N--;){if(_===b||b!==null&&_===b.alternate)break t;_=pa(_),b=pa(b)}_=null}else _=null;w!==null&&L1(y,v,w,_,!1),E!==null&&C!==null&&L1(y,C,E,_,!0)}}e:{if(v=p?Ta(p):window,w=v.nodeName&&v.nodeName.toLowerCase(),w==="select"||w==="input"&&v.type==="file")var k=JL;else if(j1(v))if(aT)k=nP;else{k=eP;var A=ZL}else(w=v.nodeName)&&w.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(k=tP);if(k&&(k=k(e,p))){sT(y,k,n,m);break e}A&&A(e,v,p),e==="focusout"&&(A=v._wrapperState)&&A.controlled&&v.type==="number"&&ay(v,"number",v.value)}switch(A=p?Ta(p):window,e){case"focusin":(j1(A)||A.contentEditable==="true")&&(Ea=A,wy=p,Al=null);break;case"focusout":Al=wy=Ea=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,M1(y,n,m);break;case"selectionchange":if(oP)break;case"keydown":case"keyup":M1(y,n,m)}var T;if($0)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Na?iT(e,n)&&(L="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(rT&&n.locale!=="ko"&&(Na||L!=="onCompositionStart"?L==="onCompositionEnd"&&Na&&(T=nT()):(so=m,P0="value"in so?so.value:so.textContent,Na=!0)),A=ed(p,L),0<A.length&&(L=new N1(L,e,null,n,m),y.push({event:L,listeners:A}),T?L.data=T:(T=oT(n),T!==null&&(L.data=T)))),(T=GL?WL(e,n):YL(e,n))&&(p=ed(p,"onBeforeInput"),0<p.length&&(m=new N1("onBeforeInput","beforeinput",null,n,m),y.push({event:m,listeners:p}),m.data=T))}vT(y,t)})}function Jl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ed(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=Kl(e,n),s!=null&&r.unshift(Jl(e,s,o)),s=Kl(e,t),s!=null&&r.push(Jl(e,s,o))),e=e.return}return r}function pa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function L1(e,t,n,r,o){for(var s=t._reactName,u=[];n!==null&&n!==r;){var c=n,f=c.alternate,p=c.stateNode;if(f!==null&&f===r)break;c.tag===5&&p!==null&&(c=p,o?(f=Kl(n,s),f!=null&&u.unshift(Jl(n,f,c))):o||(f=Kl(n,s),f!=null&&u.push(Jl(n,f,c)))),n=n.return}u.length!==0&&e.push({event:t,listeners:u})}var lP=/\r\n?/g,cP=/\u0000|\uFFFD/g;function P1(e){return(typeof e=="string"?e:""+e).replace(lP,`
`).replace(cP,"")}function af(e,t,n){if(t=P1(t),P1(e)!==t&&n)throw Error(te(425))}function td(){}var by=null,Sy=null;function _y(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ny=typeof setTimeout=="function"?setTimeout:void 0,hP=typeof clearTimeout=="function"?clearTimeout:void 0,U1=typeof Promise=="function"?Promise:void 0,fP=typeof queueMicrotask=="function"?queueMicrotask:typeof U1<"u"?function(e){return U1.resolve(null).then(e).catch(dP)}:Ny;function dP(e){setTimeout(function(){throw e})}function jv(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),Wl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Wl(t)}function ho(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function F1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var vu=Math.random().toString(36).slice(2),ii="__reactFiber$"+vu,Zl="__reactProps$"+vu,ki="__reactContainer$"+vu,Ey="__reactEvents$"+vu,pP="__reactListeners$"+vu,mP="__reactHandles$"+vu;function is(e){var t=e[ii];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ki]||n[ii]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=F1(e);e!==null;){if(n=e[ii])return n;e=F1(e)}return t}e=n,n=e.parentNode}return null}function Cc(e){return e=e[ii]||e[ki],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ta(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Qd(e){return e[Zl]||null}var Iy=[],ja=-1;function Eo(e){return{current:e}}function ot(e){0>ja||(e.current=Iy[ja],Iy[ja]=null,ja--)}function tt(e,t){ja++,Iy[ja]=e.current,e.current=t}var bo={},yn=Eo(bo),$n=Eo(!1),ys=bo;function qa(e,t){var n=e.type.contextTypes;if(!n)return bo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in n)o[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Vn(e){return e=e.childContextTypes,e!=null}function nd(){ot($n),ot(yn)}function $1(e,t,n){if(yn.current!==bo)throw Error(te(168));tt(yn,t),tt($n,n)}function wT(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(te(108,ZO(e)||"Unknown",o));return yt({},n,r)}function rd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bo,ys=yn.current,tt(yn,e),tt($n,$n.current),!0}function V1(e,t,n){var r=e.stateNode;if(!r)throw Error(te(169));n?(e=wT(e,t,ys),r.__reactInternalMemoizedMergedChildContext=e,ot($n),ot(yn),tt(yn,e)):ot($n),tt($n,n)}var wi=null,Xd=!1,kv=!1;function xT(e){wi===null?wi=[e]:wi.push(e)}function gP(e){Xd=!0,xT(e)}function Io(){if(!kv&&wi!==null){kv=!0;var e=0,t=Xe;try{var n=wi;for(Xe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}wi=null,Xd=!1}catch(o){throw wi!==null&&(wi=wi.slice(e+1)),KI(M0,Io),o}finally{Xe=t,kv=!1}}return null}var ka=[],Ca=0,id=null,od=0,xr=[],br=0,ws=null,xi=1,bi="";function es(e,t){ka[Ca++]=od,ka[Ca++]=id,id=e,od=t}function bT(e,t,n){xr[br++]=xi,xr[br++]=bi,xr[br++]=ws,ws=e;var r=xi;e=bi;var o=32-Fr(r)-1;r&=~(1<<o),n+=1;var s=32-Fr(t)+o;if(30<s){var u=o-o%5;s=(r&(1<<u)-1).toString(32),r>>=u,o-=u,xi=1<<32-Fr(t)+o|n<<o|r,bi=s+e}else xi=1<<s|n<<o|r,bi=e}function B0(e){e.return!==null&&(es(e,1),bT(e,1,0))}function z0(e){for(;e===id;)id=ka[--Ca],ka[Ca]=null,od=ka[--Ca],ka[Ca]=null;for(;e===ws;)ws=xr[--br],xr[br]=null,bi=xr[--br],xr[br]=null,xi=xr[--br],xr[br]=null}var or=null,nr=null,ct=!1,Ur=null;function ST(e,t){var n=Sr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function B1(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,or=e,nr=ho(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,or=e,nr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ws!==null?{id:xi,overflow:bi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Sr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,or=e,nr=null,!0):!1;default:return!1}}function Ty(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jy(e){if(ct){var t=nr;if(t){var n=t;if(!B1(e,t)){if(Ty(e))throw Error(te(418));t=ho(n.nextSibling);var r=or;t&&B1(e,t)?ST(r,n):(e.flags=e.flags&-4097|2,ct=!1,or=e)}}else{if(Ty(e))throw Error(te(418));e.flags=e.flags&-4097|2,ct=!1,or=e}}}function z1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;or=e}function uf(e){if(e!==or)return!1;if(!ct)return z1(e),ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_y(e.type,e.memoizedProps)),t&&(t=nr)){if(Ty(e))throw _T(),Error(te(418));for(;t;)ST(e,t),t=ho(t.nextSibling)}if(z1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){nr=ho(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}nr=null}}else nr=or?ho(e.stateNode.nextSibling):null;return!0}function _T(){for(var e=nr;e;)e=ho(e.nextSibling)}function Ka(){nr=or=null,ct=!1}function q0(e){Ur===null?Ur=[e]:Ur.push(e)}var vP=Ri.ReactCurrentBatchConfig;function ml(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,e));var o=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(u){var c=o.refs;u===null?delete c[s]:c[s]=u},t._stringRef=s,t)}if(typeof e!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,e))}return e}function lf(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function q1(e){var t=e._init;return t(e._payload)}function NT(e){function t(b,N){if(e){var x=b.deletions;x===null?(b.deletions=[N],b.flags|=16):x.push(N)}}function n(b,N){if(!e)return null;for(;N!==null;)t(b,N),N=N.sibling;return null}function r(b,N){for(b=new Map;N!==null;)N.key!==null?b.set(N.key,N):b.set(N.index,N),N=N.sibling;return b}function o(b,N){return b=go(b,N),b.index=0,b.sibling=null,b}function s(b,N,x){return b.index=x,e?(x=b.alternate,x!==null?(x=x.index,x<N?(b.flags|=2,N):x):(b.flags|=2,N)):(b.flags|=1048576,N)}function u(b){return e&&b.alternate===null&&(b.flags|=2),b}function c(b,N,x,j){return N===null||N.tag!==6?(N=Lv(x,b.mode,j),N.return=b,N):(N=o(N,x),N.return=b,N)}function f(b,N,x,j){var k=x.type;return k===_a?m(b,N,x.props.children,j,x.key):N!==null&&(N.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qi&&q1(k)===N.type)?(j=o(N,x.props),j.ref=ml(b,N,x),j.return=b,j):(j=Uf(x.type,x.key,x.props,null,b.mode,j),j.ref=ml(b,N,x),j.return=b,j)}function p(b,N,x,j){return N===null||N.tag!==4||N.stateNode.containerInfo!==x.containerInfo||N.stateNode.implementation!==x.implementation?(N=Pv(x,b.mode,j),N.return=b,N):(N=o(N,x.children||[]),N.return=b,N)}function m(b,N,x,j,k){return N===null||N.tag!==7?(N=fs(x,b.mode,j,k),N.return=b,N):(N=o(N,x),N.return=b,N)}function y(b,N,x){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Lv(""+N,b.mode,x),N.return=b,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Xh:return x=Uf(N.type,N.key,N.props,null,b.mode,x),x.ref=ml(b,null,N),x.return=b,x;case Sa:return N=Pv(N,b.mode,x),N.return=b,N;case Qi:var j=N._init;return y(b,j(N._payload),x)}if(Sl(N)||cl(N))return N=fs(N,b.mode,x,null),N.return=b,N;lf(b,N)}return null}function v(b,N,x,j){var k=N!==null?N.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return k!==null?null:c(b,N,""+x,j);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Xh:return x.key===k?f(b,N,x,j):null;case Sa:return x.key===k?p(b,N,x,j):null;case Qi:return k=x._init,v(b,N,k(x._payload),j)}if(Sl(x)||cl(x))return k!==null?null:m(b,N,x,j,null);lf(b,x)}return null}function w(b,N,x,j,k){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(x)||null,c(N,b,""+j,k);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Xh:return b=b.get(j.key===null?x:j.key)||null,f(N,b,j,k);case Sa:return b=b.get(j.key===null?x:j.key)||null,p(N,b,j,k);case Qi:var A=j._init;return w(b,N,x,A(j._payload),k)}if(Sl(j)||cl(j))return b=b.get(x)||null,m(N,b,j,k,null);lf(N,j)}return null}function E(b,N,x,j){for(var k=null,A=null,T=N,L=N=0,U=null;T!==null&&L<x.length;L++){T.index>L?(U=T,T=null):U=T.sibling;var K=v(b,T,x[L],j);if(K===null){T===null&&(T=U);break}e&&T&&K.alternate===null&&t(b,T),N=s(K,N,L),A===null?k=K:A.sibling=K,A=K,T=U}if(L===x.length)return n(b,T),ct&&es(b,L),k;if(T===null){for(;L<x.length;L++)T=y(b,x[L],j),T!==null&&(N=s(T,N,L),A===null?k=T:A.sibling=T,A=T);return ct&&es(b,L),k}for(T=r(b,T);L<x.length;L++)U=w(T,b,L,x[L],j),U!==null&&(e&&U.alternate!==null&&T.delete(U.key===null?L:U.key),N=s(U,N,L),A===null?k=U:A.sibling=U,A=U);return e&&T.forEach(function($){return t(b,$)}),ct&&es(b,L),k}function _(b,N,x,j){var k=cl(x);if(typeof k!="function")throw Error(te(150));if(x=k.call(x),x==null)throw Error(te(151));for(var A=k=null,T=N,L=N=0,U=null,K=x.next();T!==null&&!K.done;L++,K=x.next()){T.index>L?(U=T,T=null):U=T.sibling;var $=v(b,T,K.value,j);if($===null){T===null&&(T=U);break}e&&T&&$.alternate===null&&t(b,T),N=s($,N,L),A===null?k=$:A.sibling=$,A=$,T=U}if(K.done)return n(b,T),ct&&es(b,L),k;if(T===null){for(;!K.done;L++,K=x.next())K=y(b,K.value,j),K!==null&&(N=s(K,N,L),A===null?k=K:A.sibling=K,A=K);return ct&&es(b,L),k}for(T=r(b,T);!K.done;L++,K=x.next())K=w(T,b,L,K.value,j),K!==null&&(e&&K.alternate!==null&&T.delete(K.key===null?L:K.key),N=s(K,N,L),A===null?k=K:A.sibling=K,A=K);return e&&T.forEach(function(O){return t(b,O)}),ct&&es(b,L),k}function C(b,N,x,j){if(typeof x=="object"&&x!==null&&x.type===_a&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Xh:e:{for(var k=x.key,A=N;A!==null;){if(A.key===k){if(k=x.type,k===_a){if(A.tag===7){n(b,A.sibling),N=o(A,x.props.children),N.return=b,b=N;break e}}else if(A.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qi&&q1(k)===A.type){n(b,A.sibling),N=o(A,x.props),N.ref=ml(b,A,x),N.return=b,b=N;break e}n(b,A);break}else t(b,A);A=A.sibling}x.type===_a?(N=fs(x.props.children,b.mode,j,x.key),N.return=b,b=N):(j=Uf(x.type,x.key,x.props,null,b.mode,j),j.ref=ml(b,N,x),j.return=b,b=j)}return u(b);case Sa:e:{for(A=x.key;N!==null;){if(N.key===A)if(N.tag===4&&N.stateNode.containerInfo===x.containerInfo&&N.stateNode.implementation===x.implementation){n(b,N.sibling),N=o(N,x.children||[]),N.return=b,b=N;break e}else{n(b,N);break}else t(b,N);N=N.sibling}N=Pv(x,b.mode,j),N.return=b,b=N}return u(b);case Qi:return A=x._init,C(b,N,A(x._payload),j)}if(Sl(x))return E(b,N,x,j);if(cl(x))return _(b,N,x,j);lf(b,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,N!==null&&N.tag===6?(n(b,N.sibling),N=o(N,x),N.return=b,b=N):(n(b,N),N=Lv(x,b.mode,j),N.return=b,b=N),u(b)):n(b,N)}return C}var Ha=NT(!0),ET=NT(!1),sd=Eo(null),ad=null,Aa=null,K0=null;function H0(){K0=Aa=ad=null}function G0(e){var t=sd.current;ot(sd),e._currentValue=t}function ky(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function $a(e,t){ad=e,K0=Aa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Un=!0),e.firstContext=null)}function Nr(e){var t=e._currentValue;if(K0!==e)if(e={context:e,memoizedValue:t,next:null},Aa===null){if(ad===null)throw Error(te(308));Aa=e,ad.dependencies={lanes:0,firstContext:e}}else Aa=Aa.next=e;return t}var os=null;function W0(e){os===null?os=[e]:os.push(e)}function IT(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,W0(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ci(e,r)}function Ci(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Xi=!1;function Y0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TT(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ni(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Ci(e,n)}return o=r.interleaved,o===null?(t.next=t,W0(r)):(t.next=o.next,o.next=t),r.interleaved=t,Ci(e,n)}function Df(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,R0(e,n)}}function K1(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?o=s=u:s=s.next=u,n=n.next}while(n!==null);s===null?o=s=t:s=s.next=t}else o=s=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ud(e,t,n,r){var o=e.updateQueue;Xi=!1;var s=o.firstBaseUpdate,u=o.lastBaseUpdate,c=o.shared.pending;if(c!==null){o.shared.pending=null;var f=c,p=f.next;f.next=null,u===null?s=p:u.next=p,u=f;var m=e.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==u&&(c===null?m.firstBaseUpdate=p:c.next=p,m.lastBaseUpdate=f))}if(s!==null){var y=o.baseState;u=0,m=p=f=null,c=s;do{var v=c.lane,w=c.eventTime;if((r&v)===v){m!==null&&(m=m.next={eventTime:w,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var E=e,_=c;switch(v=t,w=n,_.tag){case 1:if(E=_.payload,typeof E=="function"){y=E.call(w,y,v);break e}y=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=_.payload,v=typeof E=="function"?E.call(w,y,v):E,v==null)break e;y=yt({},y,v);break e;case 2:Xi=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,v=o.effects,v===null?o.effects=[c]:v.push(c))}else w={eventTime:w,lane:v,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(p=m=w,f=y):m=m.next=w,u|=v;if(c=c.next,c===null){if(c=o.shared.pending,c===null)break;v=c,c=v.next,v.next=null,o.lastBaseUpdate=v,o.shared.pending=null}}while(!0);if(m===null&&(f=y),o.baseState=f,o.firstBaseUpdate=p,o.lastBaseUpdate=m,t=o.shared.interleaved,t!==null){o=t;do u|=o.lane,o=o.next;while(o!==t)}else s===null&&(o.shared.lanes=0);bs|=u,e.lanes=u,e.memoizedState=y}}function H1(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(te(191,o));o.call(r)}}}var Ac={},ai=Eo(Ac),ec=Eo(Ac),tc=Eo(Ac);function ss(e){if(e===Ac)throw Error(te(174));return e}function Q0(e,t){switch(tt(tc,t),tt(ec,e),tt(ai,Ac),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ly(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ly(t,e)}ot(ai),tt(ai,t)}function Ga(){ot(ai),ot(ec),ot(tc)}function jT(e){ss(tc.current);var t=ss(ai.current),n=ly(t,e.type);t!==n&&(tt(ec,e),tt(ai,n))}function X0(e){ec.current===e&&(ot(ai),ot(ec))}var mt=Eo(0);function ld(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cv=[];function J0(){for(var e=0;e<Cv.length;e++)Cv[e]._workInProgressVersionPrimary=null;Cv.length=0}var Mf=Ri.ReactCurrentDispatcher,Av=Ri.ReactCurrentBatchConfig,xs=0,vt=null,$t=null,Wt=null,cd=!1,Dl=!1,nc=0,yP=0;function un(){throw Error(te(321))}function Z0(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qr(e[n],t[n]))return!1;return!0}function ew(e,t,n,r,o,s){if(xs=s,vt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mf.current=e===null||e.memoizedState===null?SP:_P,e=n(r,o),Dl){s=0;do{if(Dl=!1,nc=0,25<=s)throw Error(te(301));s+=1,Wt=$t=null,t.updateQueue=null,Mf.current=NP,e=n(r,o)}while(Dl)}if(Mf.current=hd,t=$t!==null&&$t.next!==null,xs=0,Wt=$t=vt=null,cd=!1,t)throw Error(te(300));return e}function tw(){var e=nc!==0;return nc=0,e}function ni(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?vt.memoizedState=Wt=e:Wt=Wt.next=e,Wt}function Er(){if($t===null){var e=vt.alternate;e=e!==null?e.memoizedState:null}else e=$t.next;var t=Wt===null?vt.memoizedState:Wt.next;if(t!==null)Wt=t,$t=e;else{if(e===null)throw Error(te(310));$t=e,e={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Wt===null?vt.memoizedState=Wt=e:Wt=Wt.next=e}return Wt}function rc(e,t){return typeof t=="function"?t(e):t}function Dv(e){var t=Er(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=$t,o=r.baseQueue,s=n.pending;if(s!==null){if(o!==null){var u=o.next;o.next=s.next,s.next=u}r.baseQueue=o=s,n.pending=null}if(o!==null){s=o.next,r=r.baseState;var c=u=null,f=null,p=s;do{var m=p.lane;if((xs&m)===m)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:e(r,p.action);else{var y={lane:m,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(c=f=y,u=r):f=f.next=y,vt.lanes|=m,bs|=m}p=p.next}while(p!==null&&p!==s);f===null?u=r:f.next=c,qr(r,t.memoizedState)||(Un=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=f,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do s=o.lane,vt.lanes|=s,bs|=s,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Mv(e){var t=Er(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,s=t.memoizedState;if(o!==null){n.pending=null;var u=o=o.next;do s=e(s,u.action),u=u.next;while(u!==o);qr(s,t.memoizedState)||(Un=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function kT(){}function CT(e,t){var n=vt,r=Er(),o=t(),s=!qr(r.memoizedState,o);if(s&&(r.memoizedState=o,Un=!0),r=r.queue,nw(MT.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Wt!==null&&Wt.memoizedState.tag&1){if(n.flags|=2048,ic(9,DT.bind(null,n,r,o,t),void 0,null),Yt===null)throw Error(te(349));xs&30||AT(n,t,o)}return o}function AT(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function DT(e,t,n,r){t.value=n,t.getSnapshot=r,RT(t)&&OT(e)}function MT(e,t,n){return n(function(){RT(t)&&OT(e)})}function RT(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!qr(e,n)}catch{return!0}}function OT(e){var t=Ci(e,1);t!==null&&$r(t,e,1,-1)}function G1(e){var t=ni();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rc,lastRenderedState:e},t.queue=e,e=e.dispatch=bP.bind(null,vt,e),[t.memoizedState,e]}function ic(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function LT(){return Er().memoizedState}function Rf(e,t,n,r){var o=ni();vt.flags|=e,o.memoizedState=ic(1|t,n,void 0,r===void 0?null:r)}function Jd(e,t,n,r){var o=Er();r=r===void 0?null:r;var s=void 0;if($t!==null){var u=$t.memoizedState;if(s=u.destroy,r!==null&&Z0(r,u.deps)){o.memoizedState=ic(t,n,s,r);return}}vt.flags|=e,o.memoizedState=ic(1|t,n,s,r)}function W1(e,t){return Rf(8390656,8,e,t)}function nw(e,t){return Jd(2048,8,e,t)}function PT(e,t){return Jd(4,2,e,t)}function UT(e,t){return Jd(4,4,e,t)}function FT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $T(e,t,n){return n=n!=null?n.concat([e]):null,Jd(4,4,FT.bind(null,t,e),n)}function rw(){}function VT(e,t){var n=Er();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Z0(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function BT(e,t){var n=Er();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Z0(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function zT(e,t,n){return xs&21?(qr(n,t)||(n=WI(),vt.lanes|=n,bs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Un=!0),e.memoizedState=n)}function wP(e,t){var n=Xe;Xe=n!==0&&4>n?n:4,e(!0);var r=Av.transition;Av.transition={};try{e(!1),t()}finally{Xe=n,Av.transition=r}}function qT(){return Er().memoizedState}function xP(e,t,n){var r=mo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},KT(e))HT(t,n);else if(n=IT(e,t,n,r),n!==null){var o=kn();$r(n,e,r,o),GT(n,t,r)}}function bP(e,t,n){var r=mo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(KT(e))HT(t,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var u=t.lastRenderedState,c=s(u,n);if(o.hasEagerState=!0,o.eagerState=c,qr(c,u)){var f=t.interleaved;f===null?(o.next=o,W0(t)):(o.next=f.next,f.next=o),t.interleaved=o;return}}catch{}finally{}n=IT(e,t,o,r),n!==null&&(o=kn(),$r(n,e,r,o),GT(n,t,r))}}function KT(e){var t=e.alternate;return e===vt||t!==null&&t===vt}function HT(e,t){Dl=cd=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function GT(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,R0(e,n)}}var hd={readContext:Nr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},SP={readContext:Nr,useCallback:function(e,t){return ni().memoizedState=[e,t===void 0?null:t],e},useContext:Nr,useEffect:W1,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Rf(4194308,4,FT.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Rf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rf(4,2,e,t)},useMemo:function(e,t){var n=ni();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ni();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=xP.bind(null,vt,e),[r.memoizedState,e]},useRef:function(e){var t=ni();return e={current:e},t.memoizedState=e},useState:G1,useDebugValue:rw,useDeferredValue:function(e){return ni().memoizedState=e},useTransition:function(){var e=G1(!1),t=e[0];return e=wP.bind(null,e[1]),ni().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vt,o=ni();if(ct){if(n===void 0)throw Error(te(407));n=n()}else{if(n=t(),Yt===null)throw Error(te(349));xs&30||AT(r,t,n)}o.memoizedState=n;var s={value:n,getSnapshot:t};return o.queue=s,W1(MT.bind(null,r,s,e),[e]),r.flags|=2048,ic(9,DT.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ni(),t=Yt.identifierPrefix;if(ct){var n=bi,r=xi;n=(r&~(1<<32-Fr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=nc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=yP++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_P={readContext:Nr,useCallback:VT,useContext:Nr,useEffect:nw,useImperativeHandle:$T,useInsertionEffect:PT,useLayoutEffect:UT,useMemo:BT,useReducer:Dv,useRef:LT,useState:function(){return Dv(rc)},useDebugValue:rw,useDeferredValue:function(e){var t=Er();return zT(t,$t.memoizedState,e)},useTransition:function(){var e=Dv(rc)[0],t=Er().memoizedState;return[e,t]},useMutableSource:kT,useSyncExternalStore:CT,useId:qT,unstable_isNewReconciler:!1},NP={readContext:Nr,useCallback:VT,useContext:Nr,useEffect:nw,useImperativeHandle:$T,useInsertionEffect:PT,useLayoutEffect:UT,useMemo:BT,useReducer:Mv,useRef:LT,useState:function(){return Mv(rc)},useDebugValue:rw,useDeferredValue:function(e){var t=Er();return $t===null?t.memoizedState=e:zT(t,$t.memoizedState,e)},useTransition:function(){var e=Mv(rc)[0],t=Er().memoizedState;return[e,t]},useMutableSource:kT,useSyncExternalStore:CT,useId:qT,unstable_isNewReconciler:!1};function Lr(e,t){if(e&&e.defaultProps){t=yt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Cy(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:yt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Zd={isMounted:function(e){return(e=e._reactInternals)?Ds(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=kn(),o=mo(e),s=Ni(r,o);s.payload=t,n!=null&&(s.callback=n),t=fo(e,s,o),t!==null&&($r(t,e,o,r),Df(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=kn(),o=mo(e),s=Ni(r,o);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=fo(e,s,o),t!==null&&($r(t,e,o,r),Df(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=kn(),r=mo(e),o=Ni(n,r);o.tag=2,t!=null&&(o.callback=t),t=fo(e,o,r),t!==null&&($r(t,e,r,n),Df(t,e,r))}};function Y1(e,t,n,r,o,s,u){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,u):t.prototype&&t.prototype.isPureReactComponent?!Ql(n,r)||!Ql(o,s):!0}function WT(e,t,n){var r=!1,o=bo,s=t.contextType;return typeof s=="object"&&s!==null?s=Nr(s):(o=Vn(t)?ys:yn.current,r=t.contextTypes,s=(r=r!=null)?qa(e,o):bo),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=s),t}function Q1(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Zd.enqueueReplaceState(t,t.state,null)}function Ay(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Y0(e);var s=t.contextType;typeof s=="object"&&s!==null?o.context=Nr(s):(s=Vn(t)?ys:yn.current,o.context=qa(e,s)),o.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Cy(e,t,s,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Zd.enqueueReplaceState(o,o.state,null),ud(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Wa(e,t){try{var n="",r=t;do n+=JO(r),r=r.return;while(r);var o=n}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:o,digest:null}}function Rv(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Dy(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var EP=typeof WeakMap=="function"?WeakMap:Map;function YT(e,t,n){n=Ni(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){dd||(dd=!0,By=r),Dy(e,t)},n}function QT(e,t,n){n=Ni(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Dy(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Dy(e,t),typeof r!="function"&&(po===null?po=new Set([this]):po.add(this));var u=t.stack;this.componentDidCatch(t.value,{componentStack:u!==null?u:""})}),n}function X1(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new EP;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=FP.bind(null,e,t,n),t.then(e,e))}function J1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Z1(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ni(-1,1),t.tag=2,fo(n,t,1))),n.lanes|=1),e)}var IP=Ri.ReactCurrentOwner,Un=!1;function _n(e,t,n,r){t.child=e===null?ET(t,null,n,r):Ha(t,e.child,n,r)}function eN(e,t,n,r,o){n=n.render;var s=t.ref;return $a(t,o),r=ew(e,t,n,r,s,o),n=tw(),e!==null&&!Un?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ai(e,t,o)):(ct&&n&&B0(t),t.flags|=1,_n(e,t,r,o),t.child)}function tN(e,t,n,r,o){if(e===null){var s=n.type;return typeof s=="function"&&!hw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,XT(e,t,s,r,o)):(e=Uf(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&o)){var u=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ql,n(u,r)&&e.ref===t.ref)return Ai(e,t,o)}return t.flags|=1,e=go(s,r),e.ref=t.ref,e.return=t,t.child=e}function XT(e,t,n,r,o){if(e!==null){var s=e.memoizedProps;if(Ql(s,r)&&e.ref===t.ref)if(Un=!1,t.pendingProps=r=s,(e.lanes&o)!==0)e.flags&131072&&(Un=!0);else return t.lanes=e.lanes,Ai(e,t,o)}return My(e,t,n,r,o)}function JT(e,t,n){var r=t.pendingProps,o=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(Ma,Xn),Xn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,tt(Ma,Xn),Xn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,tt(Ma,Xn),Xn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,tt(Ma,Xn),Xn|=r;return _n(e,t,o,n),t.child}function ZT(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function My(e,t,n,r,o){var s=Vn(n)?ys:yn.current;return s=qa(t,s),$a(t,o),n=ew(e,t,n,r,s,o),r=tw(),e!==null&&!Un?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ai(e,t,o)):(ct&&r&&B0(t),t.flags|=1,_n(e,t,n,o),t.child)}function nN(e,t,n,r,o){if(Vn(n)){var s=!0;rd(t)}else s=!1;if($a(t,o),t.stateNode===null)Of(e,t),WT(t,n,r),Ay(t,n,r,o),r=!0;else if(e===null){var u=t.stateNode,c=t.memoizedProps;u.props=c;var f=u.context,p=n.contextType;typeof p=="object"&&p!==null?p=Nr(p):(p=Vn(n)?ys:yn.current,p=qa(t,p));var m=n.getDerivedStateFromProps,y=typeof m=="function"||typeof u.getSnapshotBeforeUpdate=="function";y||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(c!==r||f!==p)&&Q1(t,u,r,p),Xi=!1;var v=t.memoizedState;u.state=v,ud(t,r,u,o),f=t.memoizedState,c!==r||v!==f||$n.current||Xi?(typeof m=="function"&&(Cy(t,n,m,r),f=t.memoizedState),(c=Xi||Y1(t,n,c,r,v,f,p))?(y||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=f),u.props=r,u.state=f,u.context=p,r=c):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{u=t.stateNode,TT(e,t),c=t.memoizedProps,p=t.type===t.elementType?c:Lr(t.type,c),u.props=p,y=t.pendingProps,v=u.context,f=n.contextType,typeof f=="object"&&f!==null?f=Nr(f):(f=Vn(n)?ys:yn.current,f=qa(t,f));var w=n.getDerivedStateFromProps;(m=typeof w=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(c!==y||v!==f)&&Q1(t,u,r,f),Xi=!1,v=t.memoizedState,u.state=v,ud(t,r,u,o);var E=t.memoizedState;c!==y||v!==E||$n.current||Xi?(typeof w=="function"&&(Cy(t,n,w,r),E=t.memoizedState),(p=Xi||Y1(t,n,p,r,v,E,f)||!1)?(m||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(r,E,f),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(r,E,f)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=E),u.props=r,u.state=E,u.context=f,r=p):(typeof u.componentDidUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),r=!1)}return Ry(e,t,n,r,s,o)}function Ry(e,t,n,r,o,s){ZT(e,t);var u=(t.flags&128)!==0;if(!r&&!u)return o&&V1(t,n,!1),Ai(e,t,s);r=t.stateNode,IP.current=t;var c=u&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&u?(t.child=Ha(t,e.child,null,s),t.child=Ha(t,null,c,s)):_n(e,t,c,s),t.memoizedState=r.state,o&&V1(t,n,!0),t.child}function ej(e){var t=e.stateNode;t.pendingContext?$1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$1(e,t.context,!1),Q0(e,t.containerInfo)}function rN(e,t,n,r,o){return Ka(),q0(o),t.flags|=256,_n(e,t,n,r),t.child}var Oy={dehydrated:null,treeContext:null,retryLane:0};function Ly(e){return{baseLanes:e,cachePool:null,transitions:null}}function tj(e,t,n){var r=t.pendingProps,o=mt.current,s=!1,u=(t.flags&128)!==0,c;if((c=u)||(c=e!==null&&e.memoizedState===null?!1:(o&2)!==0),c?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),tt(mt,o&1),e===null)return jy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(u=r.children,e=r.fallback,s?(r=t.mode,s=t.child,u={mode:"hidden",children:u},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=u):s=np(u,r,0,null),e=fs(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ly(n),t.memoizedState=Oy,e):iw(t,u));if(o=e.memoizedState,o!==null&&(c=o.dehydrated,c!==null))return TP(e,t,u,r,c,o,n);if(s){s=r.fallback,u=t.mode,o=e.child,c=o.sibling;var f={mode:"hidden",children:r.children};return!(u&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=f,t.deletions=null):(r=go(o,f),r.subtreeFlags=o.subtreeFlags&14680064),c!==null?s=go(c,s):(s=fs(s,u,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,u=e.child.memoizedState,u=u===null?Ly(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Oy,r}return s=e.child,e=s.sibling,r=go(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function iw(e,t){return t=np({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cf(e,t,n,r){return r!==null&&q0(r),Ha(t,e.child,null,n),e=iw(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function TP(e,t,n,r,o,s,u){if(n)return t.flags&256?(t.flags&=-257,r=Rv(Error(te(422))),cf(e,t,u,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,o=t.mode,r=np({mode:"visible",children:r.children},o,0,null),s=fs(s,o,u,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Ha(t,e.child,null,u),t.child.memoizedState=Ly(u),t.memoizedState=Oy,s);if(!(t.mode&1))return cf(e,t,u,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var c=r.dgst;return r=c,s=Error(te(419)),r=Rv(s,r,void 0),cf(e,t,u,r)}if(c=(u&e.childLanes)!==0,Un||c){if(r=Yt,r!==null){switch(u&-u){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|u)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,Ci(e,o),$r(r,e,o,-1))}return cw(),r=Rv(Error(te(421))),cf(e,t,u,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=$P.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,nr=ho(o.nextSibling),or=t,ct=!0,Ur=null,e!==null&&(xr[br++]=xi,xr[br++]=bi,xr[br++]=ws,xi=e.id,bi=e.overflow,ws=t),t=iw(t,r.children),t.flags|=4096,t)}function iN(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ky(e.return,t,n)}function Ov(e,t,n,r,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o)}function nj(e,t,n){var r=t.pendingProps,o=r.revealOrder,s=r.tail;if(_n(e,t,r.children,n),r=mt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&iN(e,n,t);else if(e.tag===19)iN(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(tt(mt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&ld(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ov(t,!1,o,n,s);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&ld(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ov(t,!0,n,null,s);break;case"together":Ov(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Of(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ai(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),bs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,n=go(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=go(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function jP(e,t,n){switch(t.tag){case 3:ej(t),Ka();break;case 5:jT(t);break;case 1:Vn(t.type)&&rd(t);break;case 4:Q0(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;tt(sd,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(tt(mt,mt.current&1),t.flags|=128,null):n&t.child.childLanes?tj(e,t,n):(tt(mt,mt.current&1),e=Ai(e,t,n),e!==null?e.sibling:null);tt(mt,mt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return nj(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),tt(mt,mt.current),r)break;return null;case 22:case 23:return t.lanes=0,JT(e,t,n)}return Ai(e,t,n)}var rj,Py,ij,oj;rj=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Py=function(){};ij=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,ss(ai.current);var s=null;switch(n){case"input":o=oy(e,o),r=oy(e,r),s=[];break;case"select":o=yt({},o,{value:void 0}),r=yt({},r,{value:void 0}),s=[];break;case"textarea":o=uy(e,o),r=uy(e,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=td)}cy(n,r);var u;n=null;for(p in o)if(!r.hasOwnProperty(p)&&o.hasOwnProperty(p)&&o[p]!=null)if(p==="style"){var c=o[p];for(u in c)c.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(zl.hasOwnProperty(p)?s||(s=[]):(s=s||[]).push(p,null));for(p in r){var f=r[p];if(c=o!=null?o[p]:void 0,r.hasOwnProperty(p)&&f!==c&&(f!=null||c!=null))if(p==="style")if(c){for(u in c)!c.hasOwnProperty(u)||f&&f.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in f)f.hasOwnProperty(u)&&c[u]!==f[u]&&(n||(n={}),n[u]=f[u])}else n||(s||(s=[]),s.push(p,n)),n=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,c=c?c.__html:void 0,f!=null&&c!==f&&(s=s||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(s=s||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(zl.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&rt("scroll",e),s||c===f||(s=[])):(s=s||[]).push(p,f))}n&&(s=s||[]).push("style",n);var p=s;(t.updateQueue=p)&&(t.flags|=4)}};oj=function(e,t,n,r){n!==r&&(t.flags|=4)};function gl(e,t){if(!ct)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ln(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function kP(e,t,n){var r=t.pendingProps;switch(z0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(t),null;case 1:return Vn(t.type)&&nd(),ln(t),null;case 3:return r=t.stateNode,Ga(),ot($n),ot(yn),J0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(uf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ur!==null&&(Ky(Ur),Ur=null))),Py(e,t),ln(t),null;case 5:X0(t);var o=ss(tc.current);if(n=t.type,e!==null&&t.stateNode!=null)ij(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(te(166));return ln(t),null}if(e=ss(ai.current),uf(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ii]=t,r[Zl]=s,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(o=0;o<Nl.length;o++)rt(Nl[o],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":d1(r,s),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},rt("invalid",r);break;case"textarea":m1(r,s),rt("invalid",r)}cy(n,s),o=null;for(var u in s)if(s.hasOwnProperty(u)){var c=s[u];u==="children"?typeof c=="string"?r.textContent!==c&&(s.suppressHydrationWarning!==!0&&af(r.textContent,c,e),o=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&af(r.textContent,c,e),o=["children",""+c]):zl.hasOwnProperty(u)&&c!=null&&u==="onScroll"&&rt("scroll",r)}switch(n){case"input":Jh(r),p1(r,s,!0);break;case"textarea":Jh(r),g1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=td)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{u=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=MI(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=u.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),n==="select"&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[ii]=t,e[Zl]=r,rj(e,t,!1,!1),t.stateNode=e;e:{switch(u=hy(n,r),n){case"dialog":rt("cancel",e),rt("close",e),o=r;break;case"iframe":case"object":case"embed":rt("load",e),o=r;break;case"video":case"audio":for(o=0;o<Nl.length;o++)rt(Nl[o],e);o=r;break;case"source":rt("error",e),o=r;break;case"img":case"image":case"link":rt("error",e),rt("load",e),o=r;break;case"details":rt("toggle",e),o=r;break;case"input":d1(e,r),o=oy(e,r),rt("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=yt({},r,{value:void 0}),rt("invalid",e);break;case"textarea":m1(e,r),o=uy(e,r),rt("invalid",e);break;default:o=r}cy(n,o),c=o;for(s in c)if(c.hasOwnProperty(s)){var f=c[s];s==="style"?LI(e,f):s==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&RI(e,f)):s==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&ql(e,f):typeof f=="number"&&ql(e,""+f):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(zl.hasOwnProperty(s)?f!=null&&s==="onScroll"&&rt("scroll",e):f!=null&&j0(e,s,f,u))}switch(n){case"input":Jh(e),p1(e,r,!1);break;case"textarea":Jh(e),g1(e);break;case"option":r.value!=null&&e.setAttribute("value",""+xo(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?La(e,!!r.multiple,s,!1):r.defaultValue!=null&&La(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=td)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ln(t),null;case 6:if(e&&t.stateNode!=null)oj(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(te(166));if(n=ss(tc.current),ss(ai.current),uf(t)){if(r=t.stateNode,n=t.memoizedProps,r[ii]=t,(s=r.nodeValue!==n)&&(e=or,e!==null))switch(e.tag){case 3:af(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&af(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ii]=t,t.stateNode=r}return ln(t),null;case 13:if(ot(mt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ct&&nr!==null&&t.mode&1&&!(t.flags&128))_T(),Ka(),t.flags|=98560,s=!1;else if(s=uf(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(te(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[ii]=t}else Ka(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ln(t),s=!1}else Ur!==null&&(Ky(Ur),Ur=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||mt.current&1?Vt===0&&(Vt=3):cw())),t.updateQueue!==null&&(t.flags|=4),ln(t),null);case 4:return Ga(),Py(e,t),e===null&&Xl(t.stateNode.containerInfo),ln(t),null;case 10:return G0(t.type._context),ln(t),null;case 17:return Vn(t.type)&&nd(),ln(t),null;case 19:if(ot(mt),s=t.memoizedState,s===null)return ln(t),null;if(r=(t.flags&128)!==0,u=s.rendering,u===null)if(r)gl(s,!1);else{if(Vt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(u=ld(e),u!==null){for(t.flags|=128,gl(s,!1),r=u.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,u=s.alternate,u===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,e=u.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return tt(mt,mt.current&1|2),t.child}e=e.sibling}s.tail!==null&&kt()>Ya&&(t.flags|=128,r=!0,gl(s,!1),t.lanes=4194304)}else{if(!r)if(e=ld(u),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),gl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!u.alternate&&!ct)return ln(t),null}else 2*kt()-s.renderingStartTime>Ya&&n!==1073741824&&(t.flags|=128,r=!0,gl(s,!1),t.lanes=4194304);s.isBackwards?(u.sibling=t.child,t.child=u):(n=s.last,n!==null?n.sibling=u:t.child=u,s.last=u)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=kt(),t.sibling=null,n=mt.current,tt(mt,r?n&1|2:n&1),t):(ln(t),null);case 22:case 23:return lw(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Xn&1073741824&&(ln(t),t.subtreeFlags&6&&(t.flags|=8192)):ln(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function CP(e,t){switch(z0(t),t.tag){case 1:return Vn(t.type)&&nd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ga(),ot($n),ot(yn),J0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return X0(t),null;case 13:if(ot(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ot(mt),null;case 4:return Ga(),null;case 10:return G0(t.type._context),null;case 22:case 23:return lw(),null;case 24:return null;default:return null}}var hf=!1,hn=!1,AP=typeof WeakSet=="function"?WeakSet:Set,le=null;function Da(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(e,t,r)}else n.current=null}function Uy(e,t,n){try{n()}catch(r){bt(e,t,r)}}var oN=!1;function DP(e,t){if(by=Jf,e=cT(),V0(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var u=0,c=-1,f=-1,p=0,m=0,y=e,v=null;t:for(;;){for(var w;y!==n||o!==0&&y.nodeType!==3||(c=u+o),y!==s||r!==0&&y.nodeType!==3||(f=u+r),y.nodeType===3&&(u+=y.nodeValue.length),(w=y.firstChild)!==null;)v=y,y=w;for(;;){if(y===e)break t;if(v===n&&++p===o&&(c=u),v===s&&++m===r&&(f=u),(w=y.nextSibling)!==null)break;y=v,v=y.parentNode}y=w}n=c===-1||f===-1?null:{start:c,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sy={focusedElem:e,selectionRange:n},Jf=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var _=E.memoizedProps,C=E.memoizedState,b=t.stateNode,N=b.getSnapshotBeforeUpdate(t.elementType===t.type?_:Lr(t.type,_),C);b.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(j){bt(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return E=oN,oN=!1,E}function Ml(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var s=o.destroy;o.destroy=void 0,s!==void 0&&Uy(t,n,s)}o=o.next}while(o!==r)}}function ep(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Fy(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function sj(e){var t=e.alternate;t!==null&&(e.alternate=null,sj(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ii],delete t[Zl],delete t[Ey],delete t[pP],delete t[mP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function aj(e){return e.tag===5||e.tag===3||e.tag===4}function sN(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||aj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $y(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=td));else if(r!==4&&(e=e.child,e!==null))for($y(e,t,n),e=e.sibling;e!==null;)$y(e,t,n),e=e.sibling}function Vy(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Vy(e,t,n),e=e.sibling;e!==null;)Vy(e,t,n),e=e.sibling}var Zt=null,Pr=!1;function Hi(e,t,n){for(n=n.child;n!==null;)uj(e,t,n),n=n.sibling}function uj(e,t,n){if(si&&typeof si.onCommitFiberUnmount=="function")try{si.onCommitFiberUnmount(Hd,n)}catch{}switch(n.tag){case 5:hn||Da(n,t);case 6:var r=Zt,o=Pr;Zt=null,Hi(e,t,n),Zt=r,Pr=o,Zt!==null&&(Pr?(e=Zt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Zt.removeChild(n.stateNode));break;case 18:Zt!==null&&(Pr?(e=Zt,n=n.stateNode,e.nodeType===8?jv(e.parentNode,n):e.nodeType===1&&jv(e,n),Wl(e)):jv(Zt,n.stateNode));break;case 4:r=Zt,o=Pr,Zt=n.stateNode.containerInfo,Pr=!0,Hi(e,t,n),Zt=r,Pr=o;break;case 0:case 11:case 14:case 15:if(!hn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,u=s.destroy;s=s.tag,u!==void 0&&(s&2||s&4)&&Uy(n,t,u),o=o.next}while(o!==r)}Hi(e,t,n);break;case 1:if(!hn&&(Da(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){bt(n,t,c)}Hi(e,t,n);break;case 21:Hi(e,t,n);break;case 22:n.mode&1?(hn=(r=hn)||n.memoizedState!==null,Hi(e,t,n),hn=r):Hi(e,t,n);break;default:Hi(e,t,n)}}function aN(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new AP),t.forEach(function(r){var o=VP.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Rr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var s=e,u=t,c=u;e:for(;c!==null;){switch(c.tag){case 5:Zt=c.stateNode,Pr=!1;break e;case 3:Zt=c.stateNode.containerInfo,Pr=!0;break e;case 4:Zt=c.stateNode.containerInfo,Pr=!0;break e}c=c.return}if(Zt===null)throw Error(te(160));uj(s,u,o),Zt=null,Pr=!1;var f=o.alternate;f!==null&&(f.return=null),o.return=null}catch(p){bt(o,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)lj(t,e),t=t.sibling}function lj(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rr(t,e),ei(e),r&4){try{Ml(3,e,e.return),ep(3,e)}catch(_){bt(e,e.return,_)}try{Ml(5,e,e.return)}catch(_){bt(e,e.return,_)}}break;case 1:Rr(t,e),ei(e),r&512&&n!==null&&Da(n,n.return);break;case 5:if(Rr(t,e),ei(e),r&512&&n!==null&&Da(n,n.return),e.flags&32){var o=e.stateNode;try{ql(o,"")}catch(_){bt(e,e.return,_)}}if(r&4&&(o=e.stateNode,o!=null)){var s=e.memoizedProps,u=n!==null?n.memoizedProps:s,c=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&AI(o,s),hy(c,u);var p=hy(c,s);for(u=0;u<f.length;u+=2){var m=f[u],y=f[u+1];m==="style"?LI(o,y):m==="dangerouslySetInnerHTML"?RI(o,y):m==="children"?ql(o,y):j0(o,m,y,p)}switch(c){case"input":sy(o,s);break;case"textarea":DI(o,s);break;case"select":var v=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?La(o,!!s.multiple,w,!1):v!==!!s.multiple&&(s.defaultValue!=null?La(o,!!s.multiple,s.defaultValue,!0):La(o,!!s.multiple,s.multiple?[]:"",!1))}o[Zl]=s}catch(_){bt(e,e.return,_)}}break;case 6:if(Rr(t,e),ei(e),r&4){if(e.stateNode===null)throw Error(te(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(_){bt(e,e.return,_)}}break;case 3:if(Rr(t,e),ei(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wl(t.containerInfo)}catch(_){bt(e,e.return,_)}break;case 4:Rr(t,e),ei(e);break;case 13:Rr(t,e),ei(e),o=e.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(aw=kt())),r&4&&aN(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(hn=(p=hn)||m,Rr(t,e),hn=p):Rr(t,e),ei(e),r&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!m&&e.mode&1)for(le=e,m=e.child;m!==null;){for(y=le=m;le!==null;){switch(v=le,w=v.child,v.tag){case 0:case 11:case 14:case 15:Ml(4,v,v.return);break;case 1:Da(v,v.return);var E=v.stateNode;if(typeof E.componentWillUnmount=="function"){r=v,n=v.return;try{t=r,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(_){bt(r,n,_)}}break;case 5:Da(v,v.return);break;case 22:if(v.memoizedState!==null){lN(y);continue}}w!==null?(w.return=v,le=w):lN(y)}m=m.sibling}e:for(m=null,y=e;;){if(y.tag===5){if(m===null){m=y;try{o=y.stateNode,p?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=y.stateNode,f=y.memoizedProps.style,u=f!=null&&f.hasOwnProperty("display")?f.display:null,c.style.display=OI("display",u))}catch(_){bt(e,e.return,_)}}}else if(y.tag===6){if(m===null)try{y.stateNode.nodeValue=p?"":y.memoizedProps}catch(_){bt(e,e.return,_)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===e)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===e)break e;for(;y.sibling===null;){if(y.return===null||y.return===e)break e;m===y&&(m=null),y=y.return}m===y&&(m=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:Rr(t,e),ei(e),r&4&&aN(e);break;case 21:break;default:Rr(t,e),ei(e)}}function ei(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(aj(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(ql(o,""),r.flags&=-33);var s=sN(e);Vy(e,s,o);break;case 3:case 4:var u=r.stateNode.containerInfo,c=sN(e);$y(e,c,u);break;default:throw Error(te(161))}}catch(f){bt(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MP(e,t,n){le=e,cj(e)}function cj(e,t,n){for(var r=(e.mode&1)!==0;le!==null;){var o=le,s=o.child;if(o.tag===22&&r){var u=o.memoizedState!==null||hf;if(!u){var c=o.alternate,f=c!==null&&c.memoizedState!==null||hn;c=hf;var p=hn;if(hf=u,(hn=f)&&!p)for(le=o;le!==null;)u=le,f=u.child,u.tag===22&&u.memoizedState!==null?cN(o):f!==null?(f.return=u,le=f):cN(o);for(;s!==null;)le=s,cj(s),s=s.sibling;le=o,hf=c,hn=p}uN(e)}else o.subtreeFlags&8772&&s!==null?(s.return=o,le=s):uN(e)}}function uN(e){for(;le!==null;){var t=le;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:hn||ep(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!hn)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Lr(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&H1(t,s,r);break;case 3:var u=t.updateQueue;if(u!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}H1(t,u,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var m=p.memoizedState;if(m!==null){var y=m.dehydrated;y!==null&&Wl(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}hn||t.flags&512&&Fy(t)}catch(v){bt(t,t.return,v)}}if(t===e){le=null;break}if(n=t.sibling,n!==null){n.return=t.return,le=n;break}le=t.return}}function lN(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var n=t.sibling;if(n!==null){n.return=t.return,le=n;break}le=t.return}}function cN(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ep(4,t)}catch(f){bt(t,n,f)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(f){bt(t,o,f)}}var s=t.return;try{Fy(t)}catch(f){bt(t,s,f)}break;case 5:var u=t.return;try{Fy(t)}catch(f){bt(t,u,f)}}}catch(f){bt(t,t.return,f)}if(t===e){le=null;break}var c=t.sibling;if(c!==null){c.return=t.return,le=c;break}le=t.return}}var RP=Math.ceil,fd=Ri.ReactCurrentDispatcher,ow=Ri.ReactCurrentOwner,_r=Ri.ReactCurrentBatchConfig,Be=0,Yt=null,Ot=null,nn=0,Xn=0,Ma=Eo(0),Vt=0,oc=null,bs=0,tp=0,sw=0,Rl=null,Pn=null,aw=0,Ya=1/0,yi=null,dd=!1,By=null,po=null,ff=!1,ao=null,pd=0,Ol=0,zy=null,Lf=-1,Pf=0;function kn(){return Be&6?kt():Lf!==-1?Lf:Lf=kt()}function mo(e){return e.mode&1?Be&2&&nn!==0?nn&-nn:vP.transition!==null?(Pf===0&&(Pf=WI()),Pf):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:tT(e.type)),e):1}function $r(e,t,n,r){if(50<Ol)throw Ol=0,zy=null,Error(te(185));jc(e,n,r),(!(Be&2)||e!==Yt)&&(e===Yt&&(!(Be&2)&&(tp|=n),Vt===4&&to(e,nn)),Bn(e,r),n===1&&Be===0&&!(t.mode&1)&&(Ya=kt()+500,Xd&&Io()))}function Bn(e,t){var n=e.callbackNode;vL(e,t);var r=Xf(e,e===Yt?nn:0);if(r===0)n!==null&&w1(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&w1(n),t===1)e.tag===0?gP(hN.bind(null,e)):xT(hN.bind(null,e)),fP(function(){!(Be&6)&&Io()}),n=null;else{switch(YI(r)){case 1:n=M0;break;case 4:n=HI;break;case 16:n=Qf;break;case 536870912:n=GI;break;default:n=Qf}n=yj(n,hj.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function hj(e,t){if(Lf=-1,Pf=0,Be&6)throw Error(te(327));var n=e.callbackNode;if(Va()&&e.callbackNode!==n)return null;var r=Xf(e,e===Yt?nn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=md(e,r);else{t=r;var o=Be;Be|=2;var s=dj();(Yt!==e||nn!==t)&&(yi=null,Ya=kt()+500,hs(e,t));do try{PP();break}catch(c){fj(e,c)}while(!0);H0(),fd.current=s,Be=o,Ot!==null?t=0:(Yt=null,nn=0,t=Vt)}if(t!==0){if(t===2&&(o=gy(e),o!==0&&(r=o,t=qy(e,o))),t===1)throw n=oc,hs(e,0),to(e,r),Bn(e,kt()),n;if(t===6)to(e,r);else{if(o=e.current.alternate,!(r&30)&&!OP(o)&&(t=md(e,r),t===2&&(s=gy(e),s!==0&&(r=s,t=qy(e,s))),t===1))throw n=oc,hs(e,0),to(e,r),Bn(e,kt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(te(345));case 2:ts(e,Pn,yi);break;case 3:if(to(e,r),(r&130023424)===r&&(t=aw+500-kt(),10<t)){if(Xf(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){kn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ny(ts.bind(null,e,Pn,yi),t);break}ts(e,Pn,yi);break;case 4:if(to(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var u=31-Fr(r);s=1<<u,u=t[u],u>o&&(o=u),r&=~s}if(r=o,r=kt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*RP(r/1960))-r,10<r){e.timeoutHandle=Ny(ts.bind(null,e,Pn,yi),r);break}ts(e,Pn,yi);break;case 5:ts(e,Pn,yi);break;default:throw Error(te(329))}}}return Bn(e,kt()),e.callbackNode===n?hj.bind(null,e):null}function qy(e,t){var n=Rl;return e.current.memoizedState.isDehydrated&&(hs(e,t).flags|=256),e=md(e,t),e!==2&&(t=Pn,Pn=n,t!==null&&Ky(t)),e}function Ky(e){Pn===null?Pn=e:Pn.push.apply(Pn,e)}function OP(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],s=o.getSnapshot;o=o.value;try{if(!qr(s(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function to(e,t){for(t&=~sw,t&=~tp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Fr(t),r=1<<n;e[n]=-1,t&=~r}}function hN(e){if(Be&6)throw Error(te(327));Va();var t=Xf(e,0);if(!(t&1))return Bn(e,kt()),null;var n=md(e,t);if(e.tag!==0&&n===2){var r=gy(e);r!==0&&(t=r,n=qy(e,r))}if(n===1)throw n=oc,hs(e,0),to(e,t),Bn(e,kt()),n;if(n===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ts(e,Pn,yi),Bn(e,kt()),null}function uw(e,t){var n=Be;Be|=1;try{return e(t)}finally{Be=n,Be===0&&(Ya=kt()+500,Xd&&Io())}}function Ss(e){ao!==null&&ao.tag===0&&!(Be&6)&&Va();var t=Be;Be|=1;var n=_r.transition,r=Xe;try{if(_r.transition=null,Xe=1,e)return e()}finally{Xe=r,_r.transition=n,Be=t,!(Be&6)&&Io()}}function lw(){Xn=Ma.current,ot(Ma)}function hs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hP(n)),Ot!==null)for(n=Ot.return;n!==null;){var r=n;switch(z0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&nd();break;case 3:Ga(),ot($n),ot(yn),J0();break;case 5:X0(r);break;case 4:Ga();break;case 13:ot(mt);break;case 19:ot(mt);break;case 10:G0(r.type._context);break;case 22:case 23:lw()}n=n.return}if(Yt=e,Ot=e=go(e.current,null),nn=Xn=t,Vt=0,oc=null,sw=tp=bs=0,Pn=Rl=null,os!==null){for(t=0;t<os.length;t++)if(n=os[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,s=n.pending;if(s!==null){var u=s.next;s.next=o,r.next=u}n.pending=r}os=null}return e}function fj(e,t){do{var n=Ot;try{if(H0(),Mf.current=hd,cd){for(var r=vt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}cd=!1}if(xs=0,Wt=$t=vt=null,Dl=!1,nc=0,ow.current=null,n===null||n.return===null){Vt=1,oc=t,Ot=null;break}e:{var s=e,u=n.return,c=n,f=t;if(t=nn,c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,m=c,y=m.tag;if(!(m.mode&1)&&(y===0||y===11||y===15)){var v=m.alternate;v?(m.updateQueue=v.updateQueue,m.memoizedState=v.memoizedState,m.lanes=v.lanes):(m.updateQueue=null,m.memoizedState=null)}var w=J1(u);if(w!==null){w.flags&=-257,Z1(w,u,c,s,t),w.mode&1&&X1(s,p,t),t=w,f=p;var E=t.updateQueue;if(E===null){var _=new Set;_.add(f),t.updateQueue=_}else E.add(f);break e}else{if(!(t&1)){X1(s,p,t),cw();break e}f=Error(te(426))}}else if(ct&&c.mode&1){var C=J1(u);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Z1(C,u,c,s,t),q0(Wa(f,c));break e}}s=f=Wa(f,c),Vt!==4&&(Vt=2),Rl===null?Rl=[s]:Rl.push(s),s=u;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=YT(s,f,t);K1(s,b);break e;case 1:c=f;var N=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof N.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(po===null||!po.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var j=QT(s,c,t);K1(s,j);break e}}s=s.return}while(s!==null)}mj(n)}catch(k){t=k,Ot===n&&n!==null&&(Ot=n=n.return);continue}break}while(!0)}function dj(){var e=fd.current;return fd.current=hd,e===null?hd:e}function cw(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Yt===null||!(bs&268435455)&&!(tp&268435455)||to(Yt,nn)}function md(e,t){var n=Be;Be|=2;var r=dj();(Yt!==e||nn!==t)&&(yi=null,hs(e,t));do try{LP();break}catch(o){fj(e,o)}while(!0);if(H0(),Be=n,fd.current=r,Ot!==null)throw Error(te(261));return Yt=null,nn=0,Vt}function LP(){for(;Ot!==null;)pj(Ot)}function PP(){for(;Ot!==null&&!uL();)pj(Ot)}function pj(e){var t=vj(e.alternate,e,Xn);e.memoizedProps=e.pendingProps,t===null?mj(e):Ot=t,ow.current=null}function mj(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=CP(n,t),n!==null){n.flags&=32767,Ot=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vt=6,Ot=null;return}}else if(n=kP(n,t,Xn),n!==null){Ot=n;return}if(t=t.sibling,t!==null){Ot=t;return}Ot=t=e}while(t!==null);Vt===0&&(Vt=5)}function ts(e,t,n){var r=Xe,o=_r.transition;try{_r.transition=null,Xe=1,UP(e,t,n,r)}finally{_r.transition=o,Xe=r}return null}function UP(e,t,n,r){do Va();while(ao!==null);if(Be&6)throw Error(te(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(yL(e,s),e===Yt&&(Ot=Yt=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ff||(ff=!0,yj(Qf,function(){return Va(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=_r.transition,_r.transition=null;var u=Xe;Xe=1;var c=Be;Be|=4,ow.current=null,DP(e,n),lj(n,e),iP(Sy),Jf=!!by,Sy=by=null,e.current=n,MP(n),lL(),Be=c,Xe=u,_r.transition=s}else e.current=n;if(ff&&(ff=!1,ao=e,pd=o),s=e.pendingLanes,s===0&&(po=null),fL(n.stateNode),Bn(e,kt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(dd)throw dd=!1,e=By,By=null,e;return pd&1&&e.tag!==0&&Va(),s=e.pendingLanes,s&1?e===zy?Ol++:(Ol=0,zy=e):Ol=0,Io(),null}function Va(){if(ao!==null){var e=YI(pd),t=_r.transition,n=Xe;try{if(_r.transition=null,Xe=16>e?16:e,ao===null)var r=!1;else{if(e=ao,ao=null,pd=0,Be&6)throw Error(te(331));var o=Be;for(Be|=4,le=e.current;le!==null;){var s=le,u=s.child;if(le.flags&16){var c=s.deletions;if(c!==null){for(var f=0;f<c.length;f++){var p=c[f];for(le=p;le!==null;){var m=le;switch(m.tag){case 0:case 11:case 15:Ml(8,m,s)}var y=m.child;if(y!==null)y.return=m,le=y;else for(;le!==null;){m=le;var v=m.sibling,w=m.return;if(sj(m),m===p){le=null;break}if(v!==null){v.return=w,le=v;break}le=w}}}var E=s.alternate;if(E!==null){var _=E.child;if(_!==null){E.child=null;do{var C=_.sibling;_.sibling=null,_=C}while(_!==null)}}le=s}}if(s.subtreeFlags&2064&&u!==null)u.return=s,le=u;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ml(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,le=b;break e}le=s.return}}var N=e.current;for(le=N;le!==null;){u=le;var x=u.child;if(u.subtreeFlags&2064&&x!==null)x.return=u,le=x;else e:for(u=N;le!==null;){if(c=le,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ep(9,c)}}catch(k){bt(c,c.return,k)}if(c===u){le=null;break e}var j=c.sibling;if(j!==null){j.return=c.return,le=j;break e}le=c.return}}if(Be=o,Io(),si&&typeof si.onPostCommitFiberRoot=="function")try{si.onPostCommitFiberRoot(Hd,e)}catch{}r=!0}return r}finally{Xe=n,_r.transition=t}}return!1}function fN(e,t,n){t=Wa(n,t),t=YT(e,t,1),e=fo(e,t,1),t=kn(),e!==null&&(jc(e,1,t),Bn(e,t))}function bt(e,t,n){if(e.tag===3)fN(e,e,n);else for(;t!==null;){if(t.tag===3){fN(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(po===null||!po.has(r))){e=Wa(n,e),e=QT(t,e,1),t=fo(t,e,1),e=kn(),t!==null&&(jc(t,1,e),Bn(t,e));break}}t=t.return}}function FP(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=kn(),e.pingedLanes|=e.suspendedLanes&n,Yt===e&&(nn&n)===n&&(Vt===4||Vt===3&&(nn&130023424)===nn&&500>kt()-aw?hs(e,0):sw|=n),Bn(e,t)}function gj(e,t){t===0&&(e.mode&1?(t=tf,tf<<=1,!(tf&130023424)&&(tf=4194304)):t=1);var n=kn();e=Ci(e,t),e!==null&&(jc(e,t,n),Bn(e,n))}function $P(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),gj(e,n)}function VP(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(t),gj(e,n)}var vj;vj=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||$n.current)Un=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Un=!1,jP(e,t,n);Un=!!(e.flags&131072)}else Un=!1,ct&&t.flags&1048576&&bT(t,od,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Of(e,t),e=t.pendingProps;var o=qa(t,yn.current);$a(t,n),o=ew(null,t,r,e,o,n);var s=tw();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vn(r)?(s=!0,rd(t)):s=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Y0(t),o.updater=Zd,t.stateNode=o,o._reactInternals=t,Ay(t,r,e,n),t=Ry(null,t,r,!0,s,n)):(t.tag=0,ct&&s&&B0(t),_n(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Of(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=zP(r),e=Lr(r,e),o){case 0:t=My(null,t,r,e,n);break e;case 1:t=nN(null,t,r,e,n);break e;case 11:t=eN(null,t,r,e,n);break e;case 14:t=tN(null,t,r,Lr(r.type,e),n);break e}throw Error(te(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Lr(r,o),My(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Lr(r,o),nN(e,t,r,o,n);case 3:e:{if(ej(t),e===null)throw Error(te(387));r=t.pendingProps,s=t.memoizedState,o=s.element,TT(e,t),ud(t,r,null,n);var u=t.memoizedState;if(r=u.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){o=Wa(Error(te(423)),t),t=rN(e,t,r,n,o);break e}else if(r!==o){o=Wa(Error(te(424)),t),t=rN(e,t,r,n,o);break e}else for(nr=ho(t.stateNode.containerInfo.firstChild),or=t,ct=!0,Ur=null,n=ET(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ka(),r===o){t=Ai(e,t,n);break e}_n(e,t,r,n)}t=t.child}return t;case 5:return jT(t),e===null&&jy(t),r=t.type,o=t.pendingProps,s=e!==null?e.memoizedProps:null,u=o.children,_y(r,o)?u=null:s!==null&&_y(r,s)&&(t.flags|=32),ZT(e,t),_n(e,t,u,n),t.child;case 6:return e===null&&jy(t),null;case 13:return tj(e,t,n);case 4:return Q0(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ha(t,null,r,n):_n(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Lr(r,o),eN(e,t,r,o,n);case 7:return _n(e,t,t.pendingProps,n),t.child;case 8:return _n(e,t,t.pendingProps.children,n),t.child;case 12:return _n(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,s=t.memoizedProps,u=o.value,tt(sd,r._currentValue),r._currentValue=u,s!==null)if(qr(s.value,u)){if(s.children===o.children&&!$n.current){t=Ai(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var c=s.dependencies;if(c!==null){u=s.child;for(var f=c.firstContext;f!==null;){if(f.context===r){if(s.tag===1){f=Ni(-1,n&-n),f.tag=2;var p=s.updateQueue;if(p!==null){p=p.shared;var m=p.pending;m===null?f.next=f:(f.next=m.next,m.next=f),p.pending=f}}s.lanes|=n,f=s.alternate,f!==null&&(f.lanes|=n),ky(s.return,n,t),c.lanes|=n;break}f=f.next}}else if(s.tag===10)u=s.type===t.type?null:s.child;else if(s.tag===18){if(u=s.return,u===null)throw Error(te(341));u.lanes|=n,c=u.alternate,c!==null&&(c.lanes|=n),ky(u,n,t),u=s.sibling}else u=s.child;if(u!==null)u.return=s;else for(u=s;u!==null;){if(u===t){u=null;break}if(s=u.sibling,s!==null){s.return=u.return,u=s;break}u=u.return}s=u}_n(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,$a(t,n),o=Nr(o),r=r(o),t.flags|=1,_n(e,t,r,n),t.child;case 14:return r=t.type,o=Lr(r,t.pendingProps),o=Lr(r.type,o),tN(e,t,r,o,n);case 15:return XT(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Lr(r,o),Of(e,t),t.tag=1,Vn(r)?(e=!0,rd(t)):e=!1,$a(t,n),WT(t,r,o),Ay(t,r,o,n),Ry(null,t,r,!0,e,n);case 19:return nj(e,t,n);case 22:return JT(e,t,n)}throw Error(te(156,t.tag))};function yj(e,t){return KI(e,t)}function BP(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(e,t,n,r){return new BP(e,t,n,r)}function hw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zP(e){if(typeof e=="function")return hw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===C0)return 11;if(e===A0)return 14}return 2}function go(e,t){var n=e.alternate;return n===null?(n=Sr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Uf(e,t,n,r,o,s){var u=2;if(r=e,typeof e=="function")hw(e)&&(u=1);else if(typeof e=="string")u=5;else e:switch(e){case _a:return fs(n.children,o,s,t);case k0:u=8,o|=8;break;case ty:return e=Sr(12,n,t,o|2),e.elementType=ty,e.lanes=s,e;case ny:return e=Sr(13,n,t,o),e.elementType=ny,e.lanes=s,e;case ry:return e=Sr(19,n,t,o),e.elementType=ry,e.lanes=s,e;case jI:return np(n,o,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case II:u=10;break e;case TI:u=9;break e;case C0:u=11;break e;case A0:u=14;break e;case Qi:u=16,r=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=Sr(u,n,t,o),t.elementType=e,t.type=r,t.lanes=s,t}function fs(e,t,n,r){return e=Sr(7,e,r,t),e.lanes=n,e}function np(e,t,n,r){return e=Sr(22,e,r,t),e.elementType=jI,e.lanes=n,e.stateNode={isHidden:!1},e}function Lv(e,t,n){return e=Sr(6,e,null,t),e.lanes=n,e}function Pv(e,t,n){return t=Sr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qP(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vv(0),this.expirationTimes=vv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vv(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function fw(e,t,n,r,o,s,u,c,f){return e=new qP(e,t,n,c,f),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Sr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Y0(s),e}function KP(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sa,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function wj(e){if(!e)return bo;e=e._reactInternals;e:{if(Ds(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var n=e.type;if(Vn(n))return wT(e,n,t)}return t}function xj(e,t,n,r,o,s,u,c,f){return e=fw(n,r,!0,e,o,s,u,c,f),e.context=wj(null),n=e.current,r=kn(),o=mo(n),s=Ni(r,o),s.callback=t??null,fo(n,s,o),e.current.lanes=o,jc(e,o,r),Bn(e,r),e}function rp(e,t,n,r){var o=t.current,s=kn(),u=mo(o);return n=wj(n),t.context===null?t.context=n:t.pendingContext=n,t=Ni(s,u),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=fo(o,t,u),e!==null&&($r(e,o,u,s),Df(e,o,u)),u}function gd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function dN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function dw(e,t){dN(e,t),(e=e.alternate)&&dN(e,t)}function HP(){return null}var bj=typeof reportError=="function"?reportError:function(e){console.error(e)};function pw(e){this._internalRoot=e}ip.prototype.render=pw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));rp(e,t,null,null)};ip.prototype.unmount=pw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ss(function(){rp(null,e,null,null)}),t[ki]=null}};function ip(e){this._internalRoot=e}ip.prototype.unstable_scheduleHydration=function(e){if(e){var t=JI();e={blockedOn:null,target:e,priority:t};for(var n=0;n<eo.length&&t!==0&&t<eo[n].priority;n++);eo.splice(n,0,e),n===0&&eT(e)}};function mw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function op(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pN(){}function GP(e,t,n,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var p=gd(u);s.call(p)}}var u=xj(t,r,e,0,null,!1,!1,"",pN);return e._reactRootContainer=u,e[ki]=u.current,Xl(e.nodeType===8?e.parentNode:e),Ss(),u}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var c=r;r=function(){var p=gd(f);c.call(p)}}var f=fw(e,0,!1,null,null,!1,!1,"",pN);return e._reactRootContainer=f,e[ki]=f.current,Xl(e.nodeType===8?e.parentNode:e),Ss(function(){rp(t,f,n,r)}),f}function sp(e,t,n,r,o){var s=n._reactRootContainer;if(s){var u=s;if(typeof o=="function"){var c=o;o=function(){var f=gd(u);c.call(f)}}rp(t,u,e,o)}else u=GP(n,t,e,o,r);return gd(u)}QI=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=_l(t.pendingLanes);n!==0&&(R0(t,n|1),Bn(t,kt()),!(Be&6)&&(Ya=kt()+500,Io()))}break;case 13:Ss(function(){var r=Ci(e,1);if(r!==null){var o=kn();$r(r,e,1,o)}}),dw(e,1)}};O0=function(e){if(e.tag===13){var t=Ci(e,134217728);if(t!==null){var n=kn();$r(t,e,134217728,n)}dw(e,134217728)}};XI=function(e){if(e.tag===13){var t=mo(e),n=Ci(e,t);if(n!==null){var r=kn();$r(n,e,t,r)}dw(e,t)}};JI=function(){return Xe};ZI=function(e,t){var n=Xe;try{return Xe=e,t()}finally{Xe=n}};dy=function(e,t,n){switch(t){case"input":if(sy(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Qd(r);if(!o)throw Error(te(90));CI(r),sy(r,o)}}}break;case"textarea":DI(e,n);break;case"select":t=n.value,t!=null&&La(e,!!n.multiple,t,!1)}};FI=uw;$I=Ss;var WP={usingClientEntryPoint:!1,Events:[Cc,Ta,Qd,PI,UI,uw]},vl={findFiberByHostInstance:is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YP={bundleType:vl.bundleType,version:vl.version,rendererPackageName:vl.rendererPackageName,rendererConfig:vl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=zI(e),e===null?null:e.stateNode},findFiberByHostInstance:vl.findFiberByHostInstance||HP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!df.isDisabled&&df.supportsFiber)try{Hd=df.inject(YP),si=df}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WP;lr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mw(t))throw Error(te(200));return KP(e,t,null,n)};lr.createRoot=function(e,t){if(!mw(e))throw Error(te(299));var n=!1,r="",o=bj;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=fw(e,1,!1,null,null,n,!1,r,o),e[ki]=t.current,Xl(e.nodeType===8?e.parentNode:e),new pw(t)};lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=zI(t),e=e===null?null:e.stateNode,e};lr.flushSync=function(e){return Ss(e)};lr.hydrate=function(e,t,n){if(!op(t))throw Error(te(200));return sp(null,e,t,!0,n)};lr.hydrateRoot=function(e,t,n){if(!mw(e))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,o=!1,s="",u=bj;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),t=xj(t,null,e,1,n??null,o,!1,s,u),e[ki]=t.current,Xl(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new ip(t)};lr.render=function(e,t,n){if(!op(t))throw Error(te(200));return sp(null,e,t,!1,n)};lr.unmountComponentAtNode=function(e){if(!op(e))throw Error(te(40));return e._reactRootContainer?(Ss(function(){sp(null,null,e,!1,function(){e._reactRootContainer=null,e[ki]=null})}),!0):!1};lr.unstable_batchedUpdates=uw;lr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!op(n))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return sp(e,t,n,!1,r)};lr.version="18.3.1-next-f1338f8080-20240426";function Sj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sj)}catch(e){console.error(e)}}Sj(),SI.exports=lr;var QP=SI.exports,mN=QP;Zv.createRoot=mN.createRoot,Zv.hydrateRoot=mN.hydrateRoot;var Hy=function(e,t){return Hy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},Hy(e,t)};function be(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Hy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var sc=function(){return sc=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},sc.apply(this,arguments)};function W(e,t,n,r){function o(s){return s instanceof n?s:new n(function(u){u(s)})}return new(n||(n=Promise))(function(s,u){function c(m){try{p(r.next(m))}catch(y){u(y)}}function f(m){try{p(r.throw(m))}catch(y){u(y)}}function p(m){m.done?s(m.value):o(m.value).then(c,f)}p((r=r.apply(e,t||[])).next())})}function H(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=c(0),u.throw=c(1),u.return=c(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(p){return function(m){return f([p,m])}}function f(p){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,p[0]&&(n=0)),n;)try{if(r=1,o&&(s=p[0]&2?o.return:p[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,p[1])).done)return s;switch(o=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,o=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){n.label=p[1];break}if(p[0]===6&&n.label<s[1]){n.label=s[1],s=p;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(p);break}s[2]&&n.ops.pop(),n.trys.pop();continue}p=t.call(e,n)}catch(m){p=[6,m],o=0}finally{r=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Uv(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pf(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,s=[],u;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){u={error:c}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(u)throw u.error}}return s}function _t(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,s;r<o;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _j=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t},XP=function(e){for(var t=[],n=0,r=0;n<e.length;){var o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){var s=e[n++];t[r++]=String.fromCharCode((o&31)<<6|s&63)}else if(o>239&&o<365){var s=e[n++],u=e[n++],c=e[n++],f=((o&7)<<18|(s&63)<<12|(u&63)<<6|c&63)-65536;t[r++]=String.fromCharCode(55296+(f>>10)),t[r++]=String.fromCharCode(56320+(f&1023))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((o&15)<<12|(s&63)<<6|u&63)}}return t.join("")},JP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],o=0;o<e.length;o+=3){var s=e[o],u=o+1<e.length,c=u?e[o+1]:0,f=o+2<e.length,p=f?e[o+2]:0,m=s>>2,y=(s&3)<<4|c>>4,v=(c&15)<<2|p>>6,w=p&63;f||(w=64,u||(v=64)),r.push(n[m],n[y],n[v],n[w])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(_j(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):XP(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],o=0;o<e.length;){var s=n[e.charAt(o++)],u=o<e.length,c=u?n[e.charAt(o)]:0;++o;var f=o<e.length,p=f?n[e.charAt(o)]:64;++o;var m=o<e.length,y=m?n[e.charAt(o)]:64;if(++o,s==null||c==null||p==null||y==null)throw Error();var v=s<<2|c>>4;if(r.push(v),p!==64){var w=c<<4&240|p>>2;if(r.push(w),y!==64){var E=p<<6&192|y;r.push(E)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},ZP=function(e){var t=_j(e);return JP.encodeByteArray(t,!0)},gN=function(e){return ZP(e).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eU(e){return ac(void 0,e)}function ac(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)!t.hasOwnProperty(r)||!tU(r)||(e[r]=ac(e[r],t[r]));return e}function tU(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nU=function(){function e(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(n,r){t.resolve=n,t.reject=r})}return e.prototype.wrapCallback=function(t){var n=this;return function(r,o){r?n.reject(r):n.resolve(o),typeof t=="function"&&(n.promise.catch(function(){}),t.length===1?t(r):t(r,o))}},e}();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rU(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},r=t||"demo-project",o=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var u=sc({iss:"https://securetoken.google.com/"+r,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),c="";return[gN(JSON.stringify(n)),gN(JSON.stringify(u)),c].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_s())}function Nj(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oU(){return typeof self=="object"&&self.self===self}function sU(){var e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function aU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uU(){return _s().indexOf("Electron/")>=0}function lU(){var e=_s();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function cU(){return _s().indexOf("MSAppHost/")>=0}function hU(){return!Nj()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fU="FirebaseError",dU=function(e){be(t,e);function t(n,r,o){var s=e.call(this,r)||this;return s.code=n,s.customData=o,s.name=fU,Object.setPrototypeOf(s,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,gw.prototype.create),s}return t}(Error),gw=function(){function e(t,n,r){this.service=t,this.serviceName=n,this.errors=r}return e.prototype.create=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=n[0]||{},s=this.service+"/"+t,u=this.errors[t],c=u?pU(u,o):"Error",f=this.serviceName+": "+c+" ("+s+").",p=new dU(s,f,o);return p},e}();function pU(e,t){return e.replace(mU,function(n,r){var o=t[r];return o!=null?String(o):"<"+r+"?>"})}var mU=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function gU(e,t){var n=new vU(e,t);return n.subscribe.bind(n)}var vU=function(){function e(t,n){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(o){r.error(o)})}return e.prototype.next=function(t){this.forEachObserver(function(n){n.next(t)})},e.prototype.error=function(t){this.forEachObserver(function(n){n.error(t)}),this.close(t)},e.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},e.prototype.subscribe=function(t,n,r){var o=this,s;if(t===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");yU(t,["next","error","complete"])?s=t:s={next:t,error:n,complete:r},s.next===void 0&&(s.next=Fv),s.error===void 0&&(s.error=Fv),s.complete===void 0&&(s.complete=Fv);var u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?s.error(o.finalError):s.complete()}catch{}}),this.observers.push(s),u},e.prototype.unsubscribeOne=function(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},e.prototype.forEachObserver=function(t){if(!this.finalized)for(var n=0;n<this.observers.length;n++)this.sendOne(n,t)},e.prototype.sendOne=function(t,n){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[t]!==void 0)try{n(r.observers[t])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})},e.prototype.close=function(t){var n=this;this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(function(){n.observers=void 0,n.onNoObservers=void 0}))},e}();function yU(e,t){if(typeof e!="object"||e===null)return!1;for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o in e&&typeof e[o]=="function")return!0}return!1}function Fv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(e){return e&&e._delegate?e._delegate:e}var ap=function(){function e(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},e.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},e.prototype.setServiceProps=function(t){return this.serviceProps=t,this},e.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},e}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wU=function(){function e(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(t){var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var r=new nU;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{var o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise},e.prototype.getImmediate=function(t){var n,r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(o)return null;throw s}else{if(o)return null;throw Error("Service "+this.name+" is not available")}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(t){var n,r;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,!!this.shouldAutoInitialize()){if(bU(t))try{this.getOrInitializeService({instanceIdentifier:ns})}catch{}try{for(var o=Uv(this.instancesDeferred.entries()),s=o.next();!s.done;s=o.next()){var u=pf(s.value,2),c=u[0],f=u[1],p=this.normalizeInstanceIdentifier(c);try{var m=this.getOrInitializeService({instanceIdentifier:p});f.resolve(m)}catch{}}}catch(y){n={error:y}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},e.prototype.clearInstance=function(t){t===void 0&&(t=ns),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},e.prototype.delete=function(){return W(this,void 0,void 0,function(){var t;return H(this,function(n){switch(n.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(_t(_t([],pf(t.filter(function(r){return"INTERNAL"in r}).map(function(r){return r.INTERNAL.delete()}))),pf(t.filter(function(r){return"_delete"in r}).map(function(r){return r._delete()}))))];case 1:return n.sent(),[2]}})})},e.prototype.isComponentSet=function(){return this.component!=null},e.prototype.isInitialized=function(t){return t===void 0&&(t=ns),this.instances.has(t)},e.prototype.getOptions=function(t){return t===void 0&&(t=ns),this.instancesOptions.get(t)||{}},e.prototype.initialize=function(t){var n,r;t===void 0&&(t={});var o=t.options,s=o===void 0?{}:o,u=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(u))throw Error(this.name+"("+u+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var c=this.getOrInitializeService({instanceIdentifier:u,options:s});try{for(var f=Uv(this.instancesDeferred.entries()),p=f.next();!p.done;p=f.next()){var m=pf(p.value,2),y=m[0],v=m[1],w=this.normalizeInstanceIdentifier(y);u===w&&v.resolve(c)}}catch(E){n={error:E}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return c},e.prototype.onInit=function(t,n){var r,o=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(o,s);var u=this.instances.get(o);return u&&t(u,o),function(){s.delete(t)}},e.prototype.invokeOnInitCallbacks=function(t,n){var r,o,s=this.onInitCallbacks.get(n);if(s)try{for(var u=Uv(s),c=u.next();!c.done;c=u.next()){var f=c.value;try{f(t,n)}catch{}}}catch(p){r={error:p}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}},e.prototype.getOrInitializeService=function(t){var n=t.instanceIdentifier,r=t.options,o=r===void 0?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:xU(n),options:o}),this.instances.set(n,s),this.instancesOptions.set(n,o),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch{}return s||null},e.prototype.normalizeInstanceIdentifier=function(t){return t===void 0&&(t=ns),this.component?this.component.multipleInstances?t:ns:t},e.prototype.shouldAutoInitialize=function(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"},e}();function xU(e){return e===ns?void 0:e}function bU(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SU=function(){function e(t){this.name=t,this.providers=new Map}return e.prototype.addComponent=function(t){var n=this.getProvider(t.name);if(n.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);n.setComponent(t)},e.prototype.addOrOverwriteComponent=function(t){var n=this.getProvider(t.name);n.isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},e.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var n=new wU(t,this);return this.providers.set(t,n),n},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Or(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,o++)r[o]=s[u];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jo,vw=[],Ke;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ke||(Ke={}));var Ej={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},_U=Ke.INFO,NU=(Jo={},Jo[Ke.DEBUG]="log",Jo[Ke.VERBOSE]="log",Jo[Ke.INFO]="info",Jo[Ke.WARN]="warn",Jo[Ke.ERROR]="error",Jo),EU=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var o=new Date().toISOString(),s=NU[t];if(s)console[s].apply(console,Or(["["+o+"]  "+e.name+":"],n));else throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}},Ij=function(){function e(t){this.name=t,this._logLevel=_U,this._logHandler=EU,this._userLogHandler=null,vw.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Ke))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(t){this._logLevel=typeof t=="string"?Ej[t]:t},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Or([this,Ke.DEBUG],t)),this._logHandler.apply(this,Or([this,Ke.DEBUG],t))},e.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Or([this,Ke.VERBOSE],t)),this._logHandler.apply(this,Or([this,Ke.VERBOSE],t))},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Or([this,Ke.INFO],t)),this._logHandler.apply(this,Or([this,Ke.INFO],t))},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Or([this,Ke.WARN],t)),this._logHandler.apply(this,Or([this,Ke.WARN],t))},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Or([this,Ke.ERROR],t)),this._logHandler.apply(this,Or([this,Ke.ERROR],t))},e}();function IU(e){vw.forEach(function(t){t.setLogLevel(e)})}function TU(e,t){for(var n=function(u){var c=null;t&&t.level&&(c=Ej[t.level]),e===null?u.userLogHandler=null:u.userLogHandler=function(f,p){for(var m=[],y=2;y<arguments.length;y++)m[y-2]=arguments[y];var v=m.map(function(w){if(w==null)return null;if(typeof w=="string")return w;if(typeof w=="number"||typeof w=="boolean")return w.toString();if(w instanceof Error)return w.message;try{return JSON.stringify(w)}catch{return null}}).filter(function(w){return w}).join(" ");p>=(c??f.logLevel)&&e({level:Ke[p].toLowerCase(),message:v,args:m,type:f.name})}},r=0,o=vw;r<o.length;r++){var s=o[r];n(s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gi,jU=(Gi={},Gi["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Gi["bad-app-name"]="Illegal App name: '{$appName}",Gi["duplicate-app"]="Firebase App named '{$appName}' already exists",Gi["app-deleted"]="Firebase App named '{$appName}' already deleted",Gi["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Gi["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Gi),wa=new gw("app","Firebase",jU),Tj="@firebase/app",kU="0.6.30",CU="@firebase/analytics",AU="@firebase/app-check",DU="@firebase/auth",MU="@firebase/database",RU="@firebase/functions",OU="@firebase/installations",LU="@firebase/messaging",PU="@firebase/performance",UU="@firebase/remote-config",FU="@firebase/storage",$U="@firebase/firestore",VU="firebase-wrapper";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cn,vd="[DEFAULT]",BU=(cn={},cn[Tj]="fire-core",cn[CU]="fire-analytics",cn[AU]="fire-app-check",cn[DU]="fire-auth",cn[MU]="fire-rtdb",cn[RU]="fire-fn",cn[OU]="fire-iid",cn[LU]="fire-fcm",cn[PU]="fire-perf",cn[UU]="fire-rc",cn[FU]="fire-gcs",cn[$U]="fire-fst",cn["fire-js"]="fire-js",cn[VU]="fire-js-all",cn);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qa=new Ij("@firebase/app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ff=function(){function e(t,n,r){var o=this;this.firebase_=r,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=eU(t),this.container=new SU(n.name),this._addComponent(new ap("app",function(){return o},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(s){return o._addComponent(s)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var t=this;return new Promise(function(n){t.checkDestroyed_(),n()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(n){return n.delete()}))}).then(function(){t.isDeleted_=!0})},e.prototype._getService=function(t,n){var r;n===void 0&&(n=vd),this.checkDestroyed_();var o=this.container.getProvider(t);return!o.isInitialized()&&((r=o.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&o.initialize(),o.getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(t,n){n===void 0&&(n=vd),this.container.getProvider(t).clearInstance(n)},e.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(n){Qa.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw wa.create("app-deleted",{appName:this.name_})},e}();Ff.prototype.name&&Ff.prototype.options||Ff.prototype.delete||console.log("dc");var zU="8.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qU(e){var t={},n=new Map,r={__esModule:!0,initializeApp:u,app:s,registerVersion:p,setLogLevel:IU,onLog:m,apps:null,SDK_VERSION:zU,INTERNAL:{registerComponent:f,removeApp:o,components:n,useAsService:y}};r.default=r,Object.defineProperty(r,"apps",{get:c});function o(v){delete t[v]}function s(v){if(v=v||vd,!vN(t,v))throw wa.create("no-app",{appName:v});return t[v]}s.App=e;function u(v,w){if(w===void 0&&(w={}),typeof w!="object"||w===null){var E=w;w={name:E}}var _=w;_.name===void 0&&(_.name=vd);var C=_.name;if(typeof C!="string"||!C)throw wa.create("bad-app-name",{appName:String(C)});if(vN(t,C))throw wa.create("duplicate-app",{appName:C});var b=new e(v,_,r);return t[C]=b,b}function c(){return Object.keys(t).map(function(v){return t[v]})}function f(v){var w=v.name;if(n.has(w))return Qa.debug("There were multiple attempts to register component "+w+"."),v.type==="PUBLIC"?r[w]:null;if(n.set(w,v),v.type==="PUBLIC"){var E=function(N){if(N===void 0&&(N=s()),typeof N[w]!="function")throw wa.create("invalid-app-argument",{appName:w});return N[w]()};v.serviceProps!==void 0&&ac(E,v.serviceProps),r[w]=E,e.prototype[w]=function(){for(var N=[],x=0;x<arguments.length;x++)N[x]=arguments[x];var j=this._getService.bind(this,w);return j.apply(this,v.multipleInstances?N:[])}}for(var _=0,C=Object.keys(t);_<C.length;_++){var b=C[_];t[b]._addComponent(v)}return v.type==="PUBLIC"?r[w]:null}function p(v,w,E){var _,C=(_=BU[v])!==null&&_!==void 0?_:v;E&&(C+="-"+E);var b=C.match(/\s|\//),N=w.match(/\s|\//);if(b||N){var x=['Unable to register library "'+C+'" with version "'+w+'":'];b&&x.push('library name "'+C+'" contains illegal characters (whitespace or "/")'),b&&N&&x.push("and"),N&&x.push('version name "'+w+'" contains illegal characters (whitespace or "/")'),Qa.warn(x.join(" "));return}f(new ap(C+"-version",function(){return{library:C,version:w}},"VERSION"))}function m(v,w){if(v!==null&&typeof v!="function")throw wa.create("invalid-log-argument");TU(v,w)}function y(v,w){if(w==="serverAuth")return null;var E=w;return E}return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj(){var e=qU(Ff);e.INTERNAL=sc(sc({},e.INTERNAL),{createFirebaseNamespace:jj,extendNamespace:t,createSubscribe:gU,ErrorFactory:gw,deepExtend:ac});function t(n){ac(e,n)}return e}var yw=jj();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var KU=function(){function e(t){this.container=t}return e.prototype.getPlatformInfoString=function(){var t=this.container.getProviders();return t.map(function(n){if(HU(n)){var r=n.getImmediate();return r.library+"/"+r.version}else return null}).filter(function(n){return n}).join(" ")},e}();function HU(e){var t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(e,t){e.INTERNAL.registerComponent(new ap("platform-logger",function(n){return new KU(n)},"PRIVATE")),e.registerVersion(Tj,kU,t),e.registerVersion("fire-js","")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(oU()&&self.firebase!==void 0){Qa.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);var yN=self.firebase.SDK_VERSION;yN&&yN.indexOf("LITE")>=0&&Qa.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var WU=yw.initializeApp;yw.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Nj()&&Qa.warn(`
      Warning: This is a browser-targeted Firebase bundle but it appears it is being
      run in a Node environment.  If running in a Node environment, make sure you
      are using the bundle specified by the "main" field in package.json.
      
      If you are using Webpack, you can specify "main" as the first item in
      "resolve.mainFields":
      https://webpack.js.org/configuration/resolve/#resolvemainfields
      
      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"
      as the first item in "mainFields", e.g. ['main', 'module'].
      https://github.com/rollup/@rollup/plugin-node-resolve
      `),WU.apply(void 0,e)};var de=yw;GU(de);var YU="firebase",kj="8.10.1";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */de.registerVersion(YU,kj,"app");de.SDK_VERSION=kj;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,a,l){i!=Array.prototype&&i!=Object.prototype&&(i[a]=l.value)};function n(i){i=[typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global,i];for(var a=0;a<i.length;++a){var l=i[a];if(l&&l.Math==Math)return l}return globalThis}var r=n(this);function o(i,a){if(a){var l=r;i=i.split(".");for(var d=0;d<i.length-1;d++){var g=i[d];g in l||(l[g]={}),l=l[g]}i=i[i.length-1],d=l[i],a=a(d),a!=d&&a!=null&&t(l,i,{configurable:!0,writable:!0,value:a})}}function s(i){var a=0;return function(){return a<i.length?{done:!1,value:i[a++]}:{done:!0}}}function u(i){var a=typeof Symbol<"u"&&Symbol.iterator&&i[Symbol.iterator];return a?a.call(i):{next:s(i)}}o("Promise",function(i){function a(I){this.b=0,this.c=void 0,this.a=[];var D=this.f();try{I(D.resolve,D.reject)}catch(B){D.reject(B)}}function l(){this.a=null}function d(I){return I instanceof a?I:new a(function(D){D(I)})}if(i)return i;l.prototype.b=function(I){if(this.a==null){this.a=[];var D=this;this.c(function(){D.g()})}this.a.push(I)};var g=r.setTimeout;l.prototype.c=function(I){g(I,0)},l.prototype.g=function(){for(;this.a&&this.a.length;){var I=this.a;this.a=[];for(var D=0;D<I.length;++D){var B=I[D];I[D]=null;try{B()}catch(G){this.f(G)}}}this.a=null},l.prototype.f=function(I){this.c(function(){throw I})},a.prototype.f=function(){function I(G){return function(Ee){B||(B=!0,G.call(D,Ee))}}var D=this,B=!1;return{resolve:I(this.m),reject:I(this.g)}},a.prototype.m=function(I){if(I===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(I instanceof a)this.s(I);else{e:switch(typeof I){case"object":var D=I!=null;break e;case"function":D=!0;break e;default:D=!1}D?this.v(I):this.h(I)}},a.prototype.v=function(I){var D=void 0;try{D=I.then}catch(B){this.g(B);return}typeof D=="function"?this.u(D,I):this.h(I)},a.prototype.g=function(I){this.i(2,I)},a.prototype.h=function(I){this.i(1,I)},a.prototype.i=function(I,D){if(this.b!=0)throw Error("Cannot settle("+I+", "+D+"): Promise already settled in state"+this.b);this.b=I,this.c=D,this.l()},a.prototype.l=function(){if(this.a!=null){for(var I=0;I<this.a.length;++I)S.b(this.a[I]);this.a=null}};var S=new l;return a.prototype.s=function(I){var D=this.f();I.Ra(D.resolve,D.reject)},a.prototype.u=function(I,D){var B=this.f();try{I.call(D,B.resolve,B.reject)}catch(G){B.reject(G)}},a.prototype.then=function(I,D){function B(qe,Ht){return typeof qe=="function"?function(vi){try{G(qe(vi))}catch(hv){Ee(hv)}}:Ht}var G,Ee,Qe=new a(function(qe,Ht){G=qe,Ee=Ht});return this.Ra(B(I,G),B(D,Ee)),Qe},a.prototype.catch=function(I){return this.then(void 0,I)},a.prototype.Ra=function(I,D){function B(){switch(G.b){case 1:I(G.c);break;case 2:D(G.c);break;default:throw Error("Unexpected state: "+G.b)}}var G=this;this.a==null?S.b(B):this.a.push(B)},a.resolve=d,a.reject=function(I){return new a(function(D,B){B(I)})},a.race=function(I){return new a(function(D,B){for(var G=u(I),Ee=G.next();!Ee.done;Ee=G.next())d(Ee.value).Ra(D,B)})},a.all=function(I){var D=u(I),B=D.next();return B.done?d([]):new a(function(G,Ee){function Qe(vi){return function(hv){qe[vi]=hv,Ht--,Ht==0&&G(qe)}}var qe=[],Ht=0;do qe.push(void 0),Ht++,d(B.value).Ra(Qe(qe.length-1),Ee),B=D.next();while(!B.done)})},a});var c=c||{},f=this||self,p=/^[\w+/_-]+[=]{0,2}$/,m=null;function y(i){return(i=i.querySelector&&i.querySelector("script[nonce]"))&&(i=i.nonce||i.getAttribute("nonce"))&&p.test(i)?i:""}function v(){}function w(i){var a=typeof i;return a!="object"?a:i?Array.isArray(i)?"array":a:"null"}function E(i){var a=w(i);return a=="array"||a=="object"&&typeof i.length=="number"}function _(i){return w(i)=="function"}function C(i){var a=typeof i;return a=="object"&&i!=null||a=="function"}function b(i,a,l){return i.call.apply(i.bind,arguments)}function N(i,a,l){if(!i)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(g,d),i.apply(a,g)}}return function(){return i.apply(a,arguments)}}function x(i,a,l){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x=b:x=N,x.apply(null,arguments)}function j(i,a){var l=Array.prototype.slice.call(arguments,1);return function(){var d=l.slice();return d.push.apply(d,arguments),i.apply(this,d)}}function k(i,a){function l(){}l.prototype=a.prototype,i.bb=a.prototype,i.prototype=new l,i.prototype.constructor=i}function A(i){return i}function T(i,a,l){this.code=U+i,this.message=a||K[i]||"",this.a=l||null}k(T,Error),T.prototype.w=function(){var i={code:this.code,message:this.message};return this.a&&(i.serverResponse=this.a),i},T.prototype.toJSON=function(){return this.w()};function L(i){var a=i&&i.code;return a?new T(a.substring(U.length),i.message,i.serverResponse):null}var U="auth/",K={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},$={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function O(i){for(var a in $)if($[a].id===i)return i=$[a],{firebaseEndpoint:i.Ua,secureTokenEndpoint:i.$a,identityPlatformEndpoint:i.Xa};return null}var R;R=O("__EID__")?"__EID__":void 0;function X(i){if(!i)return!1;try{return!!i.$goog_Thenable}catch{return!1}}function q(i){if(Error.captureStackTrace)Error.captureStackTrace(this,q);else{var a=Error().stack;a&&(this.stack=a)}i&&(this.message=String(i))}k(q,Error),q.prototype.name="CustomError";function J(i,a){i=i.split("%s");for(var l="",d=i.length-1,g=0;g<d;g++)l+=i[g]+(g<a.length?a[g]:"%s");q.call(this,l+i[d])}k(J,q),J.prototype.name="AssertionError";function V(i,a){throw new J("Failure"+(i?": "+i:""),Array.prototype.slice.call(arguments,1))}function P(i,a){this.c=i,this.f=a,this.b=0,this.a=null}P.prototype.get=function(){if(0<this.b){this.b--;var i=this.a;this.a=i.next,i.next=null}else i=this.c();return i};function Z(i,a){i.f(a),100>i.b&&(i.b++,a.next=i.a,i.a=a)}function z(){this.b=this.a=null}var ae=new P(function(){return new we},function(i){i.reset()});z.prototype.add=function(i,a){var l=ae.get();l.set(i,a),this.b?this.b.next=l:this.a=l,this.b=l};function Q(){var i=Hx,a=null;return i.a&&(a=i.a,i.a=i.a.next,i.a||(i.b=null),a.next=null),a}function we(){this.next=this.b=this.a=null}we.prototype.set=function(i,a){this.a=i,this.b=a,this.next=null},we.prototype.reset=function(){this.next=this.b=this.a=null};var De=Array.prototype.indexOf?function(i,a){return Array.prototype.indexOf.call(i,a,void 0)}:function(i,a){if(typeof i=="string")return typeof a!="string"||a.length!=1?-1:i.indexOf(a,0);for(var l=0;l<i.length;l++)if(l in i&&i[l]===a)return l;return-1},xe=Array.prototype.forEach?function(i,a,l){Array.prototype.forEach.call(i,a,l)}:function(i,a,l){for(var d=i.length,g=typeof i=="string"?i.split(""):i,S=0;S<d;S++)S in g&&a.call(l,g[S],S,i)};function Ve(i,a){for(var l=typeof i=="string"?i.split(""):i,d=i.length-1;0<=d;--d)d in l&&a.call(void 0,l[d],d,i)}var re=Array.prototype.filter?function(i,a){return Array.prototype.filter.call(i,a,void 0)}:function(i,a){for(var l=i.length,d=[],g=0,S=typeof i=="string"?i.split(""):i,I=0;I<l;I++)if(I in S){var D=S[I];a.call(void 0,D,I,i)&&(d[g++]=D)}return d},je=Array.prototype.map?function(i,a){return Array.prototype.map.call(i,a,void 0)}:function(i,a){for(var l=i.length,d=Array(l),g=typeof i=="string"?i.split(""):i,S=0;S<l;S++)S in g&&(d[S]=a.call(void 0,g[S],S,i));return d},et=Array.prototype.some?function(i,a){return Array.prototype.some.call(i,a,void 0)}:function(i,a){for(var l=i.length,d=typeof i=="string"?i.split(""):i,g=0;g<l;g++)if(g in d&&a.call(void 0,d[g],g,i))return!0;return!1};function ft(i){e:{for(var a=rM,l=i.length,d=typeof i=="string"?i.split(""):i,g=0;g<l;g++)if(g in d&&a.call(void 0,d[g],g,i)){a=g;break e}a=-1}return 0>a?null:typeof i=="string"?i.charAt(a):i[a]}function Ce(i,a){return 0<=De(i,a)}function st(i,a){a=De(i,a);var l;return(l=0<=a)&&Array.prototype.splice.call(i,a,1),l}function Ze(i,a){var l=0;Ve(i,function(d,g){a.call(void 0,d,g,i)&&Array.prototype.splice.call(i,g,1).length==1&&l++})}function at(i){return Array.prototype.concat.apply([],arguments)}function dt(i){var a=i.length;if(0<a){for(var l=Array(a),d=0;d<a;d++)l[d]=i[d];return l}return[]}var Dn=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]},Hr=/&/g,Ir=/</g,zs=/>/g,ve=/"/g,Ue=/'/g,oe=/\x00/g,ye=/[\x00&<>"']/;function Te(i,a){return i.indexOf(a)!=-1}function qt(i,a){return i<a?-1:i>a?1:0}var Kt;e:{var Do=f.navigator;if(Do){var Gn=Do.userAgent;if(Gn){Kt=Gn;break e}}Kt=""}function ze(i){return Te(Kt,i)}function hr(i,a){for(var l in i)a.call(void 0,i[l],l,i)}function Mn(i){for(var a in i)return!1;return!0}function fr(i){var a={},l;for(l in i)a[l]=i[l];return a}var qs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xt(i,a){for(var l,d,g=1;g<arguments.length;g++){d=arguments[g];for(l in d)i[l]=d[l];for(var S=0;S<qs.length;S++)l=qs[S],Object.prototype.hasOwnProperty.call(d,l)&&(i[l]=d[l])}}function Tu(i,a){e:{try{var l=i&&i.ownerDocument,d=l&&(l.defaultView||l.parentWindow);if(d=d||f,d.Element&&d.Location){var g=d;break e}}catch{}g=null}if(g&&typeof g[a]<"u"&&(!i||!(i instanceof g[a])&&(i instanceof g.Location||i instanceof g.Element))){if(C(i))try{var S=i.constructor.displayName||i.constructor.name||Object.prototype.toString.call(i)}catch{S="<object could not be stringified>"}else S=i===void 0?"undefined":i===null?"null":typeof i;V("Argument is not a %s (or a non-Element, non-Location mock); got: %s",a,S)}}function se(i,a){this.a=i===We&&a||"",this.b=Ne}se.prototype.ta=!0,se.prototype.sa=function(){return this.a},se.prototype.toString=function(){return"Const{"+this.a+"}"};function ie(i){return i instanceof se&&i.constructor===se&&i.b===Ne?i.a:(V("expected object of type Const, got '"+i+"'"),"type_error:Const")}var Ne={},We={},Ct;function wt(){if(Ct===void 0){var i=null,a=f.trustedTypes;if(a&&a.createPolicy){try{i=a.createPolicy("goog#html",{createHTML:A,createScript:A,createScriptURL:A})}catch(l){f.console&&f.console.error(l.message)}Ct=i}else Ct=i}return Ct}function Fe(i,a){this.a=a===Li?i:""}Fe.prototype.ta=!0,Fe.prototype.sa=function(){return this.a.toString()},Fe.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};function Nt(i){return i instanceof Fe&&i.constructor===Fe?i.a:(V("expected object of type TrustedResourceUrl, got '"+i+"' of type "+w(i)),"type_error:TrustedResourceUrl")}function Et(i,a){var l=ie(i);if(!dr.test(l))throw Error("Invalid TrustedResourceUrl format: "+l);return i=l.replace(Tr,function(d,g){if(!Object.prototype.hasOwnProperty.call(a,g))throw Error('Found marker, "'+g+'", in format string, "'+l+'", but no valid label mapping found in args: '+JSON.stringify(a));return d=a[g],d instanceof se?ie(d):encodeURIComponent(String(d))}),fi(i)}var Tr=/%{(\w+)}/g,dr=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Li={};function fi(i){var a=wt();return i=a?a.createScriptURL(i):i,new Fe(i,Li)}function At(i,a){this.a=a===ju?i:""}At.prototype.ta=!0,At.prototype.sa=function(){return this.a.toString()},At.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};function Pi(i){return i instanceof At&&i.constructor===At?i.a:(V("expected object of type SafeUrl, got '"+i+"' of type "+w(i)),"type_error:SafeUrl")}var Ks=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,pr=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Xc=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Dx(i){if(i instanceof At)return i;if(i=typeof i=="object"&&i.ta?i.sa():String(i),Xc.test(i))i=new At(i,ju);else{i=String(i),i=i.replace(/(%0A|%0D)/g,"");var a=i.match(pr);i=a&&Ks.test(a[1])?new At(i,ju):null}return i}function Mx(i){return i instanceof At?i:(i=typeof i=="object"&&i.ta?i.sa():String(i),Xc.test(i)||(i="about:invalid#zClosurez"),new At(i,ju))}var ju={},Rx=new At("about:invalid#zClosurez",ju);function Hs(i,a,l){this.a=l===Ox?i:""}Hs.prototype.ta=!0,Hs.prototype.sa=function(){return this.a.toString()},Hs.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};function PA(i){return i instanceof Hs&&i.constructor===Hs?i.a:(V("expected object of type SafeHtml, got '"+i+"' of type "+w(i)),"type_error:SafeHtml")}var Ox={};function UA(i,a){Tu(i,"HTMLScriptElement"),i.src=Nt(a),(a=i.ownerDocument&&i.ownerDocument.defaultView)&&a!=f?a=y(a.document):(m===null&&(m=y(f.document)),a=m),a&&i.setAttribute("nonce",a)}function Lx(i,a,l,d){return i=i instanceof At?i:Mx(i),a=a||f,l=l instanceof se?ie(l):l||"",a.open(Pi(i),l,d,void 0)}function Px(i,a){for(var l=i.split("%s"),d="",g=Array.prototype.slice.call(arguments,1);g.length&&1<l.length;)d+=l.shift()+g.shift();return d+l.join("%s")}function $p(i){return ye.test(i)&&(i.indexOf("&")!=-1&&(i=i.replace(Hr,"&amp;")),i.indexOf("<")!=-1&&(i=i.replace(Ir,"&lt;")),i.indexOf(">")!=-1&&(i=i.replace(zs,"&gt;")),i.indexOf('"')!=-1&&(i=i.replace(ve,"&quot;")),i.indexOf("'")!=-1&&(i=i.replace(Ue,"&#39;")),i.indexOf("\0")!=-1&&(i=i.replace(oe,"&#0;"))),i}function Vp(i){return Vp[" "](i),i}Vp[" "]=v;function FA(i,a){var l=zA;return Object.prototype.hasOwnProperty.call(l,i)?l[i]:l[i]=a(i)}var $A=ze("Opera"),jr=ze("Trident")||ze("MSIE"),Ux=ze("Edge"),VA=Ux||jr,Fx=ze("Gecko")&&!(Te(Kt.toLowerCase(),"webkit")&&!ze("Edge"))&&!(ze("Trident")||ze("MSIE"))&&!ze("Edge"),BA=Te(Kt.toLowerCase(),"webkit")&&!ze("Edge");function $x(){var i=f.document;return i?i.documentMode:void 0}var Jc;e:{var Bp="",zp=function(){var i=Kt;if(Fx)return/rv:([^\);]+)(\)|;)/.exec(i);if(Ux)return/Edge\/([\d\.]+)/.exec(i);if(jr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i);if(BA)return/WebKit\/(\S+)/.exec(i);if($A)return/(?:Version)[ \/]?(\S+)/.exec(i)}();if(zp&&(Bp=zp?zp[1]:""),jr){var qp=$x();if(qp!=null&&qp>parseFloat(Bp)){Jc=String(qp);break e}}Jc=Bp}var zA={};function Vx(i){return FA(i,function(){for(var a=0,l=Dn(String(Jc)).split("."),d=Dn(String(i)).split("."),g=Math.max(l.length,d.length),S=0;a==0&&S<g;S++){var I=l[S]||"",D=d[S]||"";do{if(I=/(\d*)(\D*)(.*)/.exec(I)||["","","",""],D=/(\d*)(\D*)(.*)/.exec(D)||["","","",""],I[0].length==0&&D[0].length==0)break;a=qt(I[1].length==0?0:parseInt(I[1],10),D[1].length==0?0:parseInt(D[1],10))||qt(I[2].length==0,D[2].length==0)||qt(I[2],D[2]),I=I[3],D=D[3]}while(a==0)}return 0<=a})}var Kp;if(f.document&&jr){var Bx=$x();Kp=Bx||parseInt(Jc,10)||void 0}else Kp=void 0;var Ui=Kp;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch{}var qA=!jr||9<=Number(Ui);function ku(i){var a=document;return typeof i=="string"?a.getElementById(i):i}function zx(i,a){hr(a,function(l,d){l&&typeof l=="object"&&l.ta&&(l=l.sa()),d=="style"?i.style.cssText=l:d=="class"?i.className=l:d=="for"?i.htmlFor=l:qx.hasOwnProperty(d)?i.setAttribute(qx[d],l):d.lastIndexOf("aria-",0)==0||d.lastIndexOf("data-",0)==0?i.setAttribute(d,l):i[d]=l})}var qx={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function KA(i,a,l){var d=arguments,g=document,S=String(d[0]),I=d[1];if(!qA&&I&&(I.name||I.type)){if(S=["<",S],I.name&&S.push(' name="',$p(I.name),'"'),I.type){S.push(' type="',$p(I.type),'"');var D={};Xt(D,I),delete D.type,I=D}S.push(">"),S=S.join("")}return S=Zc(g,S),I&&(typeof I=="string"?S.className=I:Array.isArray(I)?S.className=I.join(" "):zx(S,I)),2<d.length&&HA(g,S,d),S}function HA(i,a,l){function d(D){D&&a.appendChild(typeof D=="string"?i.createTextNode(D):D)}for(var g=2;g<l.length;g++){var S=l[g];if(!E(S)||C(S)&&0<S.nodeType)d(S);else{e:{if(S&&typeof S.length=="number"){if(C(S)){var I=typeof S.item=="function"||typeof S.item=="string";break e}if(_(S)){I=typeof S.item=="function";break e}}I=!1}xe(I?dt(S):S,d)}}}function Zc(i,a){return a=String(a),i.contentType==="application/xhtml+xml"&&(a=a.toLowerCase()),i.createElement(a)}function Kx(i){f.setTimeout(function(){throw i},0)}var Hp;function GA(){var i=f.MessageChannel;if(typeof i>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!ze("Presto")&&(i=function(){var g=Zc(document,"IFRAME");g.style.display="none",document.documentElement.appendChild(g);var S=g.contentWindow;g=S.document,g.open(),g.close();var I="callImmediate"+Math.random(),D=S.location.protocol=="file:"?"*":S.location.protocol+"//"+S.location.host;g=x(function(B){(D=="*"||B.origin==D)&&B.data==I&&this.port1.onmessage()},this),S.addEventListener("message",g,!1),this.port1={},this.port2={postMessage:function(){S.postMessage(I,D)}}}),typeof i<"u"&&!ze("Trident")&&!ze("MSIE")){var a=new i,l={},d=l;return a.port1.onmessage=function(){if(l.next!==void 0){l=l.next;var g=l.Hb;l.Hb=null,g()}},function(g){d.next={Hb:g},d=d.next,a.port2.postMessage(0)}}return function(g){f.setTimeout(g,0)}}function eh(i,a){th||WA(),Gp||(th(),Gp=!0),Hx.add(i,a)}var th;function WA(){if(f.Promise&&f.Promise.resolve){var i=f.Promise.resolve(void 0);th=function(){i.then(Gx)}}else th=function(){var a=Gx;!_(f.setImmediate)||f.Window&&f.Window.prototype&&!ze("Edge")&&f.Window.prototype.setImmediate==f.setImmediate?(Hp||(Hp=GA()),Hp(a)):f.setImmediate(a)}}var Gp=!1,Hx=new z;function Gx(){for(var i;i=Q();){try{i.a.call(i.b)}catch(a){Kx(a)}Z(ae,i)}Gp=!1}function Me(i,a){if(this.a=Mo,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,i!=v)try{var l=this;i.call(a,function(d){Ro(l,Cu,d)},function(d){if(!(d instanceof Gs))try{throw d instanceof Error?d:Error("Promise rejected.")}catch{}Ro(l,di,d)})}catch(d){Ro(this,di,d)}}var Mo=0,Cu=2,di=3;function Wx(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Wx.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Yx=new P(function(){return new Wx},function(i){i.reset()});function Wp(i,a,l){var d=Yx.get();return d.g=i,d.b=a,d.f=l,d}function ge(i){if(i instanceof Me)return i;var a=new Me(v);return Ro(a,Cu,i),a}function ut(i){return new Me(function(a,l){l(i)})}function Qx(i,a,l){eb(i,a,l,null)||eh(j(a,i))}function YA(i){return new Me(function(a,l){var d=i.length,g=[];if(d)for(var S=function(G,Ee){d--,g[G]=Ee,d==0&&a(g)},I=function(G){l(G)},D=0,B;D<i.length;D++)B=i[D],Qx(B,j(S,D),I);else a(g)})}function Xx(i){return new Me(function(a){var l=i.length,d=[];if(l)for(var g=function(D,B,G){l--,d[D]=B?{Qb:!0,value:G}:{Qb:!1,reason:G},l==0&&a(d)},S=0,I;S<i.length;S++)I=i[S],Qx(I,j(g,S,!0),j(g,S,!1));else a(d)})}Me.prototype.then=function(i,a,l){return Zx(this,_(i)?i:null,_(a)?a:null,l)},Me.prototype.$goog_Thenable=!0,e=Me.prototype,e.oa=function(i,a){return i=Wp(i,i,a),i.c=!0,Yp(this,i),this},e.o=function(i,a){return Zx(this,null,i,a)},e.cancel=function(i){if(this.a==Mo){var a=new Gs(i);eh(function(){Jx(this,a)},this)}};function Jx(i,a){if(i.a==Mo)if(i.c){var l=i.c;if(l.b){for(var d=0,g=null,S=null,I=l.b;I&&(I.c||(d++,I.a==i&&(g=I),!(g&&1<d)));I=I.next)g||(S=I);g&&(l.a==Mo&&d==1?Jx(l,a):(S?(d=S,d.next==l.f&&(l.f=d),d.next=d.next.next):nb(l),rb(l,g,di,a)))}i.c=null}else Ro(i,di,a)}function Yp(i,a){i.b||i.a!=Cu&&i.a!=di||tb(i),i.f?i.f.next=a:i.b=a,i.f=a}function Zx(i,a,l,d){var g=Wp(null,null,null);return g.a=new Me(function(S,I){g.g=a?function(D){try{var B=a.call(d,D);S(B)}catch(G){I(G)}}:S,g.b=l?function(D){try{var B=l.call(d,D);B===void 0&&D instanceof Gs?I(D):S(B)}catch(G){I(G)}}:I}),g.a.c=i,Yp(i,g),g.a}e.$c=function(i){this.a=Mo,Ro(this,Cu,i)},e.ad=function(i){this.a=Mo,Ro(this,di,i)};function Ro(i,a,l){i.a==Mo&&(i===l&&(a=di,l=new TypeError("Promise cannot resolve to itself")),i.a=1,eb(l,i.$c,i.ad,i)||(i.i=l,i.a=a,i.c=null,tb(i),a!=di||l instanceof Gs||XA(i,l)))}function eb(i,a,l,d){if(i instanceof Me)return Yp(i,Wp(a||v,l||null,d)),!0;if(X(i))return i.then(a,l,d),!0;if(C(i))try{var g=i.then;if(_(g))return QA(i,g,a,l,d),!0}catch(S){return l.call(d,S),!0}return!1}function QA(i,a,l,d,g){function S(B){D||(D=!0,d.call(g,B))}function I(B){D||(D=!0,l.call(g,B))}var D=!1;try{a.call(i,I,S)}catch(B){S(B)}}function tb(i){i.h||(i.h=!0,eh(i.gc,i))}function nb(i){var a=null;return i.b&&(a=i.b,i.b=a.next,a.next=null),i.b||(i.f=null),a}e.gc=function(){for(var i;i=nb(this);)rb(this,i,this.a,this.i);this.h=!1};function rb(i,a,l,d){if(l==di&&a.b&&!a.c)for(;i&&i.g;i=i.c)i.g=!1;if(a.a)a.a.c=null,ib(a,l,d);else try{a.c?a.g.call(a.f):ib(a,l,d)}catch(g){ob.call(null,g)}Z(Yx,a)}function ib(i,a,l){a==Cu?i.g.call(i.f,l):i.b&&i.b.call(i.f,l)}function XA(i,a){i.g=!0,eh(function(){i.g&&ob.call(null,a)})}var ob=Kx;function Gs(i){q.call(this,i)}k(Gs,q),Gs.prototype.name="cancel";function nh(){this.ya=this.ya,this.pa=this.pa}var JA=0;nh.prototype.ya=!1;function sb(i){!i.ya&&(i.ya=!0,i.Da(),JA!=0)}nh.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var ZA=Object.freeze||function(i){return i},ab=!jr||9<=Number(Ui),eD=jr&&!Vx("9"),tD=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var i=!1,a=Object.defineProperty({},"passive",{get:function(){i=!0}});try{f.addEventListener("test",v,a),f.removeEventListener("test",v,a)}catch{}return i}();function Rn(i,a){this.type=i,this.b=this.target=a,this.defaultPrevented=!1}Rn.prototype.preventDefault=function(){this.defaultPrevented=!0};function Oo(i,a){if(Rn.call(this,i?i.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,i){var l=this.type=i.type,d=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.b=a,a=i.relatedTarget){if(Fx){e:{try{Vp(a.nodeName);var g=!0;break e}catch{}g=!1}g||(a=null)}}else l=="mouseover"?a=i.fromElement:l=="mouseout"&&(a=i.toElement);this.relatedTarget=a,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:nD[i.pointerType]||"",this.a=i,i.defaultPrevented&&this.preventDefault()}}k(Oo,Rn);var nD=ZA({2:"touch",3:"pen",4:"mouse"});Oo.prototype.preventDefault=function(){Oo.bb.preventDefault.call(this);var i=this.a;if(i.preventDefault)i.preventDefault();else if(i.returnValue=!1,eD)try{(i.ctrlKey||112<=i.keyCode&&123>=i.keyCode)&&(i.keyCode=-1)}catch{}},Oo.prototype.g=function(){return this.a};var Au="closure_listenable_"+(1e6*Math.random()|0),rD=0;function iD(i,a,l,d,g){this.listener=i,this.proxy=null,this.src=a,this.type=l,this.capture=!!d,this.Wa=g,this.key=++rD,this.wa=this.Qa=!1}function rh(i){i.wa=!0,i.listener=null,i.proxy=null,i.src=null,i.Wa=null}function ih(i){this.src=i,this.a={},this.b=0}ih.prototype.add=function(i,a,l,d,g){var S=i.toString();i=this.a[S],i||(i=this.a[S]=[],this.b++);var I=Xp(i,a,d,g);return-1<I?(a=i[I],l||(a.Qa=!1)):(a=new iD(a,this.src,S,!!d,g),a.Qa=l,i.push(a)),a};function Qp(i,a){var l=a.type;l in i.a&&st(i.a[l],a)&&(rh(a),i.a[l].length==0&&(delete i.a[l],i.b--))}function Xp(i,a,l,d){for(var g=0;g<i.length;++g){var S=i[g];if(!S.wa&&S.listener==a&&S.capture==!!l&&S.Wa==d)return g}return-1}var Jp="closure_lm_"+(1e6*Math.random()|0),Zp={};function mr(i,a,l,d,g){if(d&&d.once)em(i,a,l,d,g);else if(Array.isArray(a))for(var S=0;S<a.length;S++)mr(i,a[S],l,d,g);else l=nm(l),i&&i[Au]?db(i,a,l,C(d)?!!d.capture:!!d,g):ub(i,a,l,!1,d,g)}function ub(i,a,l,d,g,S){if(!a)throw Error("Invalid event type");var I=C(g)?!!g.capture:!!g,D=oh(i);if(D||(i[Jp]=D=new ih(i)),l=D.add(a,l,d,I,S),!l.proxy)if(d=oD(),l.proxy=d,d.src=i,d.listener=l,i.addEventListener)tD||(g=I),g===void 0&&(g=!1),i.addEventListener(a.toString(),d,g);else if(i.attachEvent)i.attachEvent(cb(a.toString()),d);else if(i.addListener&&i.removeListener)i.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.")}function oD(){var i=sD,a=ab?function(l){return i.call(a.src,a.listener,l)}:function(l){if(l=i.call(a.src,a.listener,l),!l)return l};return a}function em(i,a,l,d,g){if(Array.isArray(a))for(var S=0;S<a.length;S++)em(i,a[S],l,d,g);else l=nm(l),i&&i[Au]?rm(i,a,l,C(d)?!!d.capture:!!d,g):ub(i,a,l,!0,d,g)}function Wn(i,a,l,d,g){if(Array.isArray(a))for(var S=0;S<a.length;S++)Wn(i,a[S],l,d,g);else d=C(d)?!!d.capture:!!d,l=nm(l),i&&i[Au]?(i=i.v,a=String(a).toString(),a in i.a&&(S=i.a[a],l=Xp(S,l,d,g),-1<l&&(rh(S[l]),Array.prototype.splice.call(S,l,1),S.length==0&&(delete i.a[a],i.b--)))):i&&(i=oh(i))&&(a=i.a[a.toString()],i=-1,a&&(i=Xp(a,l,d,g)),(l=-1<i?a[i]:null)&&lb(l))}function lb(i){if(typeof i!="number"&&i&&!i.wa){var a=i.src;if(a&&a[Au])Qp(a.v,i);else{var l=i.type,d=i.proxy;a.removeEventListener?a.removeEventListener(l,d,i.capture):a.detachEvent?a.detachEvent(cb(l),d):a.addListener&&a.removeListener&&a.removeListener(d),(l=oh(a))?(Qp(l,i),l.b==0&&(l.src=null,a[Jp]=null)):rh(i)}}}function cb(i){return i in Zp?Zp[i]:Zp[i]="on"+i}function hb(i,a,l,d){var g=!0;if((i=oh(i))&&(a=i.a[a.toString()]))for(a=a.concat(),i=0;i<a.length;i++){var S=a[i];S&&S.capture==l&&!S.wa&&(S=fb(S,d),g=g&&S!==!1)}return g}function fb(i,a){var l=i.listener,d=i.Wa||i.src;return i.Qa&&lb(i),l.call(d,a)}function sD(i,a){if(i.wa)return!0;if(!ab){if(!a)e:{a=["window","event"];for(var l=f,d=0;d<a.length;d++)if(l=l[a[d]],l==null){a=null;break e}a=l}if(d=a,a=new Oo(d,this),l=!0,!(0>d.keyCode||d.returnValue!=null)){e:{var g=!1;if(d.keyCode==0)try{d.keyCode=-1;break e}catch{g=!0}(g||d.returnValue==null)&&(d.returnValue=!0)}for(d=[],g=a.b;g;g=g.parentNode)d.push(g);for(i=i.type,g=d.length-1;0<=g;g--){a.b=d[g];var S=hb(d[g],i,!0,a);l=l&&S}for(g=0;g<d.length;g++)a.b=d[g],S=hb(d[g],i,!1,a),l=l&&S}return l}return fb(i,new Oo(a,this))}function oh(i){return i=i[Jp],i instanceof ih?i:null}var tm="__closure_events_fn_"+(1e9*Math.random()>>>0);function nm(i){return _(i)?i:(i[tm]||(i[tm]=function(a){return i.handleEvent(a)}),i[tm])}function bn(){nh.call(this),this.v=new ih(this),this.bc=this,this.hb=null}k(bn,nh),bn.prototype[Au]=!0,bn.prototype.addEventListener=function(i,a,l,d){mr(this,i,a,l,d)},bn.prototype.removeEventListener=function(i,a,l,d){Wn(this,i,a,l,d)},bn.prototype.dispatchEvent=function(i){var a,l=this.hb;if(l)for(a=[];l;l=l.hb)a.push(l);l=this.bc;var d=i.type||i;if(typeof i=="string")i=new Rn(i,l);else if(i instanceof Rn)i.target=i.target||l;else{var g=i;i=new Rn(d,l),Xt(i,g)}if(g=!0,a)for(var S=a.length-1;0<=S;S--){var I=i.b=a[S];g=sh(I,d,!0,i)&&g}if(I=i.b=l,g=sh(I,d,!0,i)&&g,g=sh(I,d,!1,i)&&g,a)for(S=0;S<a.length;S++)I=i.b=a[S],g=sh(I,d,!1,i)&&g;return g},bn.prototype.Da=function(){if(bn.bb.Da.call(this),this.v){var i=this.v,a;for(a in i.a){for(var l=i.a[a],d=0;d<l.length;d++)rh(l[d]);delete i.a[a],i.b--}}this.hb=null};function db(i,a,l,d,g){i.v.add(String(a),l,!1,d,g)}function rm(i,a,l,d,g){i.v.add(String(a),l,!0,d,g)}function sh(i,a,l,d){if(a=i.v.a[String(a)],!a)return!0;a=a.concat();for(var g=!0,S=0;S<a.length;++S){var I=a[S];if(I&&!I.wa&&I.capture==l){var D=I.listener,B=I.Wa||I.src;I.Qa&&Qp(i.v,I),g=D.call(B,d)!==!1&&g}}return g&&!d.defaultPrevented}function im(i,a,l){if(_(i))l&&(i=x(i,l));else if(i&&typeof i.handleEvent=="function")i=x(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:f.setTimeout(i,a||0)}function Ws(i){var a=null;return new Me(function(l,d){a=im(function(){l(void 0)},i),a==-1&&d(Error("Failed to schedule timer."))}).o(function(l){throw f.clearTimeout(a),l})}function pb(i){if(i.X&&typeof i.X=="function")return i.X();if(typeof i=="string")return i.split("");if(E(i)){for(var a=[],l=i.length,d=0;d<l;d++)a.push(i[d]);return a}a=[],l=0;for(d in i)a[l++]=i[d];return a}function mb(i){if(i.Y&&typeof i.Y=="function")return i.Y();if(!i.X||typeof i.X!="function"){if(E(i)||typeof i=="string"){var a=[];i=i.length;for(var l=0;l<i;l++)a.push(l);return a}a=[],l=0;for(var d in i)a[l++]=d;return a}}function aD(i,a){if(i.forEach&&typeof i.forEach=="function")i.forEach(a,void 0);else if(E(i)||typeof i=="string")xe(i,a,void 0);else for(var l=mb(i),d=pb(i),g=d.length,S=0;S<g;S++)a.call(void 0,d[S],l&&l[S],i)}function Ys(i,a){this.b={},this.a=[],this.c=0;var l=arguments.length;if(1<l){if(l%2)throw Error("Uneven number of arguments");for(var d=0;d<l;d+=2)this.set(arguments[d],arguments[d+1])}else if(i)if(i instanceof Ys)for(l=i.Y(),d=0;d<l.length;d++)this.set(l[d],i.get(l[d]));else for(d in i)this.set(d,i[d])}e=Ys.prototype,e.X=function(){om(this);for(var i=[],a=0;a<this.a.length;a++)i.push(this.b[this.a[a]]);return i},e.Y=function(){return om(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0};function om(i){if(i.c!=i.a.length){for(var a=0,l=0;a<i.a.length;){var d=i.a[a];Lo(i.b,d)&&(i.a[l++]=d),a++}i.a.length=l}if(i.c!=i.a.length){var g={};for(l=a=0;a<i.a.length;)d=i.a[a],Lo(g,d)||(i.a[l++]=d,g[d]=1),a++;i.a.length=l}}e.get=function(i,a){return Lo(this.b,i)?this.b[i]:a},e.set=function(i,a){Lo(this.b,i)||(this.c++,this.a.push(i)),this.b[i]=a},e.forEach=function(i,a){for(var l=this.Y(),d=0;d<l.length;d++){var g=l[d],S=this.get(g);i.call(a,S,g,this)}};function Lo(i,a){return Object.prototype.hasOwnProperty.call(i,a)}var gb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function uD(i,a){if(i){i=i.split("&");for(var l=0;l<i.length;l++){var d=i[l].indexOf("="),g=null;if(0<=d){var S=i[l].substring(0,d);g=i[l].substring(d+1)}else S=i[l];a(S,g?decodeURIComponent(g.replace(/\+/g," ")):"")}}}function Fi(i,a){this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1;var l;i instanceof Fi?(this.i=a!==void 0?a:i.i,Du(this,i.c),this.l=i.l,this.a=i.a,Mu(this,i.g),this.f=i.f,sm(this,xb(i.b)),this.h=i.h):i&&(l=String(i).match(gb))?(this.i=!!a,Du(this,l[1]||"",!0),this.l=Ru(l[2]||""),this.a=Ru(l[3]||"",!0),Mu(this,l[4]),this.f=Ru(l[5]||"",!0),sm(this,l[6]||"",!0),this.h=Ru(l[7]||"")):(this.i=!!a,this.b=new Po(null,this.i))}Fi.prototype.toString=function(){var i=[],a=this.c;a&&i.push(Ou(a,vb,!0),":");var l=this.a;return(l||a=="file")&&(i.push("//"),(a=this.l)&&i.push(Ou(a,vb,!0),"@"),i.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.g,l!=null&&i.push(":",String(l))),(l=this.f)&&(this.a&&l.charAt(0)!="/"&&i.push("/"),i.push(Ou(l,l.charAt(0)=="/"?hD:cD,!0))),(l=this.b.toString())&&i.push("?",l),(l=this.h)&&i.push("#",Ou(l,dD)),i.join("")},Fi.prototype.resolve=function(i){var a=new Fi(this),l=!!i.c;l?Du(a,i.c):l=!!i.l,l?a.l=i.l:l=!!i.a,l?a.a=i.a:l=i.g!=null;var d=i.f;if(l)Mu(a,i.g);else if(l=!!i.f){if(d.charAt(0)!="/")if(this.a&&!this.f)d="/"+d;else{var g=a.f.lastIndexOf("/");g!=-1&&(d=a.f.substr(0,g+1)+d)}if(g=d,g==".."||g==".")d="";else if(Te(g,"./")||Te(g,"/.")){d=g.lastIndexOf("/",0)==0,g=g.split("/");for(var S=[],I=0;I<g.length;){var D=g[I++];D=="."?d&&I==g.length&&S.push(""):D==".."?((1<S.length||S.length==1&&S[0]!="")&&S.pop(),d&&I==g.length&&S.push("")):(S.push(D),d=!0)}d=S.join("/")}else d=g}return l?a.f=d:l=i.b.toString()!=="",l?sm(a,xb(i.b)):l=!!i.h,l&&(a.h=i.h),a};function Du(i,a,l){i.c=l?Ru(a,!0):a,i.c&&(i.c=i.c.replace(/:$/,""))}function Mu(i,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);i.g=a}else i.g=null}function sm(i,a,l){a instanceof Po?(i.b=a,pD(i.b,i.i)):(l||(a=Ou(a,fD)),i.b=new Po(a,i.i))}function It(i,a,l){i.b.set(a,l)}function gr(i,a){return i.b.get(a)}function On(i){return i instanceof Fi?new Fi(i):new Fi(i,void 0)}function ah(i,a,l,d){var g=new Fi(null,void 0);return i&&Du(g,i),a&&(g.a=a),l&&Mu(g,l),d&&(g.f=d),g}function Ru(i,a){return i?a?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Ou(i,a,l){return typeof i=="string"?(i=encodeURI(i).replace(a,lD),l&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function lD(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var vb=/[#\/\?@]/g,cD=/[#\?:]/g,hD=/[#\?]/g,fD=/[#\?@]/g,dD=/#/g;function Po(i,a){this.b=this.a=null,this.c=i||null,this.f=!!a}function $i(i){i.a||(i.a=new Ys,i.b=0,i.c&&uD(i.c,function(a,l){i.add(decodeURIComponent(a.replace(/\+/g," ")),l)}))}function yb(i){var a=mb(i);if(typeof a>"u")throw Error("Keys are undefined");var l=new Po(null,void 0);i=pb(i);for(var d=0;d<a.length;d++){var g=a[d],S=i[d];Array.isArray(S)?wb(l,g,S):l.add(g,S)}return l}e=Po.prototype,e.add=function(i,a){$i(this),this.c=null,i=Qs(this,i);var l=this.a.get(i);return l||this.a.set(i,l=[]),l.push(a),this.b+=1,this};function Gr(i,a){$i(i),a=Qs(i,a),Lo(i.a.b,a)&&(i.c=null,i.b-=i.a.get(a).length,i=i.a,Lo(i.b,a)&&(delete i.b[a],i.c--,i.a.length>2*i.c&&om(i)))}e.clear=function(){this.a=this.c=null,this.b=0};function am(i,a){return $i(i),a=Qs(i,a),Lo(i.a.b,a)}e.forEach=function(i,a){$i(this),this.a.forEach(function(l,d){xe(l,function(g){i.call(a,g,d,this)},this)},this)},e.Y=function(){$i(this);for(var i=this.a.X(),a=this.a.Y(),l=[],d=0;d<a.length;d++)for(var g=i[d],S=0;S<g.length;S++)l.push(a[d]);return l},e.X=function(i){$i(this);var a=[];if(typeof i=="string")am(this,i)&&(a=at(a,this.a.get(Qs(this,i))));else{i=this.a.X();for(var l=0;l<i.length;l++)a=at(a,i[l])}return a},e.set=function(i,a){return $i(this),this.c=null,i=Qs(this,i),am(this,i)&&(this.b-=this.a.get(i).length),this.a.set(i,[a]),this.b+=1,this},e.get=function(i,a){return i?(i=this.X(i),0<i.length?String(i[0]):a):a};function wb(i,a,l){Gr(i,a),0<l.length&&(i.c=null,i.a.set(Qs(i,a),dt(l)),i.b+=l.length)}e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var i=[],a=this.a.Y(),l=0;l<a.length;l++){var d=a[l],g=encodeURIComponent(String(d));d=this.X(d);for(var S=0;S<d.length;S++){var I=g;d[S]!==""&&(I+="="+encodeURIComponent(String(d[S]))),i.push(I)}}return this.c=i.join("&")};function xb(i){var a=new Po;return a.c=i.c,i.a&&(a.a=new Ys(i.a),a.b=i.b),a}function Qs(i,a){return a=String(a),i.f&&(a=a.toLowerCase()),a}function pD(i,a){a&&!i.f&&($i(i),i.c=null,i.a.forEach(function(l,d){var g=d.toLowerCase();d!=g&&(Gr(this,d),wb(this,g,l))},i)),i.f=a}function bb(i){var a=[];return um(new mD,i,a),a.join("")}function mD(){}function um(i,a,l){if(a==null)l.push("null");else{if(typeof a=="object"){if(Array.isArray(a)){var d=a;a=d.length,l.push("[");for(var g="",S=0;S<a;S++)l.push(g),um(i,d[S],l),g=",";l.push("]");return}if(a instanceof String||a instanceof Number||a instanceof Boolean)a=a.valueOf();else{l.push("{"),g="";for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&(S=a[d],typeof S!="function"&&(l.push(g),_b(d,l),l.push(":"),um(i,S,l),g=","));l.push("}");return}}switch(typeof a){case"string":_b(a,l);break;case"number":l.push(isFinite(a)&&!isNaN(a)?String(a):"null");break;case"boolean":l.push(String(a));break;case"function":l.push("null");break;default:throw Error("Unknown type: "+typeof a)}}}var Sb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\u000b"},gD=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function _b(i,a){a.push('"',i.replace(gD,function(l){var d=Sb[l];return d||(d="\\u"+(l.charCodeAt(0)|65536).toString(16).substr(1),Sb[l]=d),d}),'"')}function lm(){var i=Jt();return jr&&!!Ui&&Ui==11||/Edge\/\d+/.test(i)}function Lu(){return f.window&&f.window.location.href||self&&self.location&&self.location.href||""}function Nb(i,a){a=a||f.window;var l="about:blank";i&&(l=Pi(Dx(i)||Rx)),a.location.href=l}function Eb(i,a){var l=[],d;for(d in i)d in a?typeof i[d]!=typeof a[d]?l.push(d):typeof i[d]=="object"&&i[d]!=null&&a[d]!=null?0<Eb(i[d],a[d]).length&&l.push(d):i[d]!==a[d]&&l.push(d):l.push(d);for(d in a)d in i||l.push(d);return l}function vD(){var i=Jt();return i=Xs(i)!=kb?null:(i=i.match(/\sChrome\/(\d+)/i))&&i.length==2?parseInt(i[1],10):null,i&&30>i?!1:!jr||!Ui||9<Ui}function Ib(i){return i=(i||Jt()).toLowerCase(),!!(i.match(/android/)||i.match(/webos/)||i.match(/iphone|ipad|ipod/)||i.match(/blackberry/)||i.match(/windows phone/)||i.match(/iemobile/))}function Uo(i){i=i||f.window;try{i.close()}catch{}}function Tb(i,a,l){var d=Math.floor(1e9*Math.random()).toString();a=a||500,l=l||600;var g=(window.screen.availHeight-l)/2,S=(window.screen.availWidth-a)/2;a={width:a,height:l,top:0<g?g:0,left:0<S?S:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},l=Jt().toLowerCase(),d&&(a.target=d,Te(l,"crios/")&&(a.target="_blank")),Xs(Jt())==fm&&(i=i||"http://localhost",a.scrollbars=!0),l=i||"",(i=a)||(i={}),d=window,a=l instanceof At?l:Dx(typeof l.href<"u"?l.href:String(l))||Rx,l=i.target||l.target,g=[];for(I in i)switch(I){case"width":case"height":case"top":case"left":g.push(I+"="+i[I]);break;case"target":case"noopener":case"noreferrer":break;default:g.push(I+"="+(i[I]?1:0))}var I=g.join(",");if((ze("iPhone")&&!ze("iPod")&&!ze("iPad")||ze("iPad")||ze("iPod"))&&d.navigator&&d.navigator.standalone&&l&&l!="_self"?(I=Zc(document,"A"),Tu(I,"HTMLAnchorElement"),a=a instanceof At?a:Mx(a),I.href=Pi(a),I.setAttribute("target",l),i.noreferrer&&I.setAttribute("rel","noreferrer"),i=document.createEvent("MouseEvent"),i.initMouseEvent("click",!0,!0,d,1),I.dispatchEvent(i),I={}):i.noreferrer?(I=Lx("",d,l,I),i=Pi(a),I&&(VA&&Te(i,";")&&(i="'"+i.replace(/'/g,"%27")+"'"),I.opener=null,i='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+$p(i)+'">',i=(d=wt())?d.createHTML(i):i,i=new Hs(i,null,Ox),d=I.document)&&(d.write(PA(i)),d.close())):(I=Lx(a,d,l,I))&&i.noopener&&(I.opener=null),I)try{I.focus()}catch{}return I}function yD(i){return new Me(function(a){function l(){Ws(2e3).then(function(){if(!i||i.closed)a();else return l()})}return l()})}var wD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xD=/^[^@]+@[^@]+$/;function uh(){var i=null;return new Me(function(a){f.document.readyState=="complete"?a():(i=function(){a()},em(window,"load",i))}).o(function(a){throw Wn(window,"load",i),a})}function bD(){return cm(void 0)?uh().then(function(){return new Me(function(i,a){var l=f.document,d=setTimeout(function(){a(Error("Cordova framework is not ready."))},1e3);l.addEventListener("deviceready",function(){clearTimeout(d),i()},!1)})}):ut(Error("Cordova must run in an Android or iOS file scheme."))}function cm(i){return i=i||Jt(),!(Zs()!=="file:"&&Zs()!=="ionic:"||!i.toLowerCase().match(/iphone|ipad|ipod|android/))}function hm(){var i=f.window;try{return!(!i||i==i.top)}catch{return!1}}function kr(){return typeof f.WorkerGlobalScope<"u"&&typeof f.importScripts=="function"}function Wr(){return de.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":de.INTERNAL.hasOwnProperty("node")?"Node":kr()?"Worker":"Browser"}function jb(){var i=Wr();return i==="ReactNative"||i==="Node"}function SD(){for(var i=50,a=[];0<i;)a.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),i--;return a.join("")}var fm="Firefox",kb="Chrome";function Xs(i){var a=i.toLowerCase();if(Te(a,"opera/")||Te(a,"opr/")||Te(a,"opios/"))return"Opera";if(Te(a,"iemobile"))return"IEMobile";if(Te(a,"msie")||Te(a,"trident/"))return"IE";if(Te(a,"edge/"))return"Edge";if(Te(a,"firefox/"))return fm;if(Te(a,"silk/"))return"Silk";if(Te(a,"blackberry"))return"Blackberry";if(Te(a,"webos"))return"Webos";if(!Te(a,"safari/")||Te(a,"chrome/")||Te(a,"crios/")||Te(a,"android"))if(!Te(a,"chrome/")&&!Te(a,"crios/")||Te(a,"edge/")){if(Te(a,"android"))return"Android";if((i=i.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&i.length==2)return i[1]}else return kb;else return"Safari";return"Other"}var Cb={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Js(i,a){a=a||[];var l=[],d={},g;for(g in Cb)d[Cb[g]]=!0;for(g=0;g<a.length;g++)typeof d[a[g]]<"u"&&(delete d[a[g]],l.push(a[g]));return l.sort(),a=l,a.length||(a=["FirebaseCore-web"]),l=Wr(),l==="Browser"?(d=Jt(),l=Xs(d)):l==="Worker"&&(d=Jt(),l=Xs(d)+"-"+l),l+"/JsCore/"+i+"/"+a.join(",")}function Jt(){return f.navigator&&f.navigator.userAgent||""}function lt(i,a){i=i.split("."),a=a||f;for(var l=0;l<i.length&&typeof a=="object"&&a!=null;l++)a=a[i[l]];return l!=i.length&&(a=void 0),a}function dm(){try{var i=f.localStorage,a=$o();if(i)return i.setItem(a,"1"),i.removeItem(a),lm()?!!f.indexedDB:!0}catch{return kr()&&!!f.indexedDB}return!1}function Fo(){return(lh()||Zs()==="chrome-extension:"||cm())&&!jb()&&dm()&&!kr()}function lh(){return Zs()==="http:"||Zs()==="https:"}function Zs(){return f.location&&f.location.protocol||null}function Pu(i){return i=i||Jt(),!(Ib(i)||Xs(i)==fm)}function Uu(i){return typeof i>"u"?null:bb(i)}function Ab(i){var a={},l;for(l in i)i.hasOwnProperty(l)&&i[l]!==null&&i[l]!==void 0&&(a[l]=i[l]);return a}function ea(i){if(i!==null)return JSON.parse(i)}function $o(i){return i||Math.floor(1e9*Math.random()).toString()}function Db(i){return i=i||Jt(),!(Xs(i)=="Safari"||i.toLowerCase().match(/iphone|ipad|ipod/))}function Mb(){var i=f.___jsl;if(i&&i.H){for(var a in i.H)if(i.H[a].r=i.H[a].r||[],i.H[a].L=i.H[a].L||[],i.H[a].r=i.H[a].L.concat(),i.CP)for(var l=0;l<i.CP.length;l++)i.CP[l]=null}}function Vi(i,a){if(i>a)throw Error("Short delay should be less than long delay!");this.a=i,this.c=a,i=Jt(),a=Wr(),this.b=Ib(i)||a==="ReactNative"}Vi.prototype.get=function(){var i=f.navigator;return!(i&&typeof i.onLine=="boolean"&&(lh()||Zs()==="chrome-extension:"||typeof i.connection<"u"))||i.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};function pm(){var i=f.document;return i&&typeof i.visibilityState<"u"?i.visibilityState=="visible":!0}function _D(){var i=f.document,a=null;return pm()||!i?ge():new Me(function(l){a=function(){pm()&&(i.removeEventListener("visibilitychange",a,!1),l())},i.addEventListener("visibilitychange",a,!1)}).o(function(l){throw i.removeEventListener("visibilitychange",a,!1),l})}function Fu(i){try{var a=new Date(parseInt(i,10));if(!isNaN(a.getTime())&&!/[^0-9]/.test(i))return a.toUTCString()}catch{}return null}function Rb(){return!(!lt("fireauth.oauthhelper",f)&&!lt("fireauth.iframe",f))}function ND(){var i=f.navigator;return i&&i.serviceWorker&&i.serviceWorker.controller||null}function ED(){var i=f.navigator;return i&&i.serviceWorker?ge().then(function(){return i.serviceWorker.ready}).then(function(a){return a.active||null}).o(function(){return null}):ge(null)}var Ob={};function mm(i){Ob[i]||(Ob[i]=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn(i))}var gm;try{var vm={};Object.defineProperty(vm,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(vm,"abcd",{configurable:!0,enumerable:!0,value:2}),gm=vm.abcd==2}catch{gm=!1}function fe(i,a,l){gm?Object.defineProperty(i,a,{configurable:!0,enumerable:!0,value:l}):i[a]=l}function Sn(i,a){if(a)for(var l in a)a.hasOwnProperty(l)&&fe(i,l,a[l])}function Yr(i){var a={};return Sn(a,i),a}function ID(i){var a={},l;for(l in i)i.hasOwnProperty(l)&&(a[l]=i[l]);return a}function TD(i,a){if(!a||!a.length)return!0;if(!i)return!1;for(var l=0;l<a.length;l++){var d=i[a[l]];if(d==null||d==="")return!1}return!0}function ym(i){var a=i;if(typeof i=="object"&&i!=null){a="length"in i?[]:{};for(var l in i)fe(a,l,ym(i[l]))}return a}function wm(i){var a=i&&(i[_m]?"phone":null);if(a&&i&&i[Sm]){fe(this,"uid",i[Sm]),fe(this,"displayName",i[Lb]||null);var l=null;i[bm]&&(l=new Date(i[bm]).toUTCString()),fe(this,"enrollmentTime",l),fe(this,"factorId",a)}else throw new T("internal-error","Internal assert: invalid MultiFactorInfo object")}wm.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};function xm(i){try{var a=new $u(i)}catch{a=null}return a}var Lb="displayName",bm="enrolledAt",Sm="mfaEnrollmentId",_m="phoneInfo";function $u(i){wm.call(this,i),fe(this,"phoneNumber",i[_m])}k($u,wm),$u.prototype.w=function(){var i=$u.bb.w.call(this);return i.phoneNumber=this.phoneNumber,i};function jD(i){var a={},l=i[kD],d=i[AD],g=i[DD];if(i=xm(i[CD]),!g||g!=ch&&g!=Vu&&!l||g==Vu&&!d||g==Nm&&!i)throw Error("Invalid checkActionCode response!");g==Vu?(a[Ub]=l||null,a[Fb]=l||null,a[Pb]=d):(a[Ub]=d||null,a[Fb]=d||null,a[Pb]=l||null),a[MD]=i||null,fe(this,OD,g),fe(this,RD,ym(a))}var Nm="REVERT_SECOND_FACTOR_ADDITION",ch="EMAIL_SIGNIN",Vu="VERIFY_AND_CHANGE_EMAIL",kD="email",CD="mfaInfo",AD="newEmail",DD="requestType",Pb="email",Ub="fromEmail",MD="multiFactorInfo",Fb="previousEmail",RD="data",OD="operation";function Em(i){i=On(i);var a=gr(i,$b)||null,l=gr(i,Vb)||null,d=gr(i,Bb)||null;if(d=d&&FD[d]||null,!a||!l||!d)throw new T("argument-error",$b+", "+Vb+"and "+Bb+" are required in a valid action code URL.");Sn(this,{apiKey:a,operation:d,code:l,continueUrl:gr(i,LD)||null,languageCode:gr(i,PD)||null,tenantId:gr(i,UD)||null})}var $b="apiKey",Vb="oobCode",LD="continueUrl",PD="languageCode",Bb="mode",UD="tenantId",FD={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:Nm,signIn:ch,verifyAndChangeEmail:Vu,verifyEmail:"VERIFY_EMAIL"};function zb(i){try{return new Em(i)}catch{return null}}function hh(i){var a=i[$D];if(typeof a>"u")throw new T("missing-continue-uri");if(typeof a!="string"||typeof a=="string"&&!a.length)throw new T("invalid-continue-uri");this.h=a,this.b=this.a=null,this.g=!1;var l=i[qb];if(l&&typeof l=="object"){a=l[Yb];var d=l[Gb];if(l=l[Wb],typeof a=="string"&&a.length){if(this.a=a,typeof d<"u"&&typeof d!="boolean")throw new T("argument-error",Gb+" property must be a boolean when specified.");if(this.g=!!d,typeof l<"u"&&(typeof l!="string"||typeof l=="string"&&!l.length))throw new T("argument-error",Wb+" property must be a non empty string when specified.");this.b=l||null}else{if(typeof a<"u")throw new T("argument-error",Yb+" property must be a non empty string when specified.");if(typeof d<"u"||typeof l<"u")throw new T("missing-android-pkg-name")}}else if(typeof l<"u")throw new T("argument-error",qb+" property must be a non null object when specified.");if(this.f=null,(a=i[Hb])&&typeof a=="object"){if(a=a[Qb],typeof a=="string"&&a.length)this.f=a;else if(typeof a<"u")throw new T("argument-error",Qb+" property must be a non empty string when specified.")}else if(typeof a<"u")throw new T("argument-error",Hb+" property must be a non null object when specified.");if(a=i[Im],typeof a<"u"&&typeof a!="boolean")throw new T("argument-error",Im+" property must be a boolean when specified.");if(this.c=!!a,i=i[Kb],typeof i<"u"&&(typeof i!="string"||typeof i=="string"&&!i.length))throw new T("argument-error",Kb+" property must be a non empty string when specified.");this.i=i||null}var qb="android",Kb="dynamicLinkDomain",Im="handleCodeInApp",Hb="iOS",$D="url",Gb="installApp",Wb="minimumVersion",Yb="packageName",Qb="bundleId";function fh(i){var a={};a.continueUrl=i.h,a.canHandleCodeInApp=i.c,(a.androidPackageName=i.a)&&(a.androidMinimumVersion=i.b,a.androidInstallApp=i.g),a.iOSBundleId=i.f,a.dynamicLinkDomain=i.i;for(var l in a)a[l]===null&&delete a[l];return a}function VD(i){return je(i,function(a){return a=a.toString(16),1<a.length?a:"0"+a}).join("")}var Bu=null;function BD(i){var a=[];return zD(i,function(l){a.push(l)}),a}function zD(i,a){function l(B){for(;d<i.length;){var G=i.charAt(d++),Ee=Bu[G];if(Ee!=null)return Ee;if(!/^[\s\xa0]*$/.test(G))throw Error("Unknown base64 encoding at char: "+G)}return B}qD();for(var d=0;;){var g=l(-1),S=l(0),I=l(64),D=l(64);if(D===64&&g===-1)break;a(g<<2|S>>4),I!=64&&(a(S<<4&240|I>>2),D!=64&&a(I<<6&192|D))}}function qD(){if(!Bu){Bu={};for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),a=["+/=","+/","-_=","-_.","-_"],l=0;5>l;l++)for(var d=i.concat(a[l].split("")),g=0;g<d.length;g++){var S=d[g];Bu[S]===void 0&&(Bu[S]=g)}}}function dh(i){var a=Xb(i);if(!(a&&a.sub&&a.iss&&a.aud&&a.exp))throw Error("Invalid JWT");this.h=i,this.a=a.exp,this.i=a.sub,i=Date.now()/1e3,this.g=a.iat||(i>this.a?this.a:i),this.b=a.provider_id||a.firebase&&a.firebase.sign_in_provider||null,this.f=a.firebase&&a.firebase.tenant||null,this.c=!!a.is_anonymous||this.b=="anonymous"}dh.prototype.T=function(){return this.f},dh.prototype.l=function(){return this.c},dh.prototype.toString=function(){return this.h};function ph(i){try{return new dh(i)}catch{return null}}function Xb(i){if(!i||(i=i.split("."),i.length!=3))return null;i=i[1];for(var a=(4-i.length%4)%4,l=0;l<a;l++)i+=".";try{var d=BD(i);for(i=[],l=a=0;a<d.length;){var g=d[a++];if(128>g)i[l++]=String.fromCharCode(g);else if(191<g&&224>g){var S=d[a++];i[l++]=String.fromCharCode((g&31)<<6|S&63)}else if(239<g&&365>g){S=d[a++];var I=d[a++],D=d[a++],B=((g&7)<<18|(S&63)<<12|(I&63)<<6|D&63)-65536;i[l++]=String.fromCharCode(55296+(B>>10)),i[l++]=String.fromCharCode(56320+(B&1023))}else S=d[a++],I=d[a++],i[l++]=String.fromCharCode((g&15)<<12|(S&63)<<6|I&63)}return JSON.parse(i.join(""))}catch{}return null}var Jb="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),mh=["client_id","response_type","scope","redirect_uri","state"],Tm={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:mh},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:mh},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:mh},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Jb},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function jm(i){for(var a in Tm)if(Tm[a].fa==i)return Tm[a];return null}function Zb(i){var a={};a["facebook.com"]=tS,a["google.com"]=rS,a["github.com"]=nS,a["twitter.com"]=iS;var l=i&&i[eS];try{if(l)return a[l]?new a[l](i):new Qr(i);if(typeof i[km]<"u")return new Cm(i)}catch{}return null}var km="idToken",eS="providerId";function Cm(i){var a=i[eS];if(!a&&i[km]){var l=ph(i[km]);l&&l.b&&(a=l.b)}if(!a)throw Error("Invalid additional user info!");(a=="anonymous"||a=="custom")&&(a=null),l=!1,typeof i.isNewUser<"u"?l=!!i.isNewUser:i.kind==="identitytoolkit#SignupNewUserResponse"&&(l=!0),fe(this,"providerId",a),fe(this,"isNewUser",l)}function Qr(i){Cm.call(this,i),i=ea(i.rawUserInfo||"{}"),fe(this,"profile",ym(i||{}))}k(Qr,Cm);function tS(i){if(Qr.call(this,i),this.providerId!="facebook.com")throw Error("Invalid provider ID!")}k(tS,Qr);function nS(i){if(Qr.call(this,i),this.providerId!="github.com")throw Error("Invalid provider ID!");fe(this,"username",this.profile&&this.profile.login||null)}k(nS,Qr);function rS(i){if(Qr.call(this,i),this.providerId!="google.com")throw Error("Invalid provider ID!")}k(rS,Qr);function iS(i){if(Qr.call(this,i),this.providerId!="twitter.com")throw Error("Invalid provider ID!");fe(this,"username",i.screenName||null)}k(iS,Qr);function oS(i){var a=On(i),l=gr(a,"link"),d=gr(On(l),"link");return a=gr(a,"deep_link_id"),gr(On(a),"link")||a||d||l||i}function gh(i,a){if(!i&&!a)throw new T("internal-error","Internal assert: no raw session string available");if(i&&a)throw new T("internal-error","Internal assert: unable to determine the session type");this.a=i||null,this.b=a||null,this.type=this.a?zu:vh}var zu="enroll",vh="signin";gh.prototype.Ha=function(){return this.a?ge(this.a):ge(this.b)},gh.prototype.w=function(){return this.type==zu?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}};function ta(){}ta.prototype.ka=function(){},ta.prototype.b=function(){},ta.prototype.c=function(){},ta.prototype.w=function(){};function na(i,a){return i.then(function(l){if(l[Dr]){var d=ph(l[Dr]);if(!d||a!=d.i)throw new T("user-mismatch");return l}throw new T("user-mismatch")}).o(function(l){throw l&&l.code&&l.code==U+"user-not-found"?new T("user-mismatch"):l})}function Vo(i,a){if(a)this.a=a;else throw new T("internal-error","failed to construct a credential");fe(this,"providerId",i),fe(this,"signInMethod",i)}Vo.prototype.ka=function(i){return eg(i,Am(this))},Vo.prototype.b=function(i,a){var l=Am(this);return l.idToken=a,tg(i,l)},Vo.prototype.c=function(i,a){return na(ng(i,Am(this)),a)};function Am(i){return{pendingToken:i.a,requestUri:"http://localhost"}}Vo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}};function KD(i){if(i&&i.providerId&&i.signInMethod&&i.providerId.indexOf("saml.")==0&&i.pendingToken)try{return new Vo(i.providerId,i.pendingToken)}catch{}return null}function pi(i,a,l){if(this.a=null,a.idToken||a.accessToken)a.idToken&&fe(this,"idToken",a.idToken),a.accessToken&&fe(this,"accessToken",a.accessToken),a.nonce&&!a.pendingToken&&fe(this,"nonce",a.nonce),a.pendingToken&&(this.a=a.pendingToken);else if(a.oauthToken&&a.oauthTokenSecret)fe(this,"accessToken",a.oauthToken),fe(this,"secret",a.oauthTokenSecret);else throw new T("internal-error","failed to construct a credential");fe(this,"providerId",i),fe(this,"signInMethod",l)}pi.prototype.ka=function(i){return eg(i,Dm(this))},pi.prototype.b=function(i,a){var l=Dm(this);return l.idToken=a,tg(i,l)},pi.prototype.c=function(i,a){var l=Dm(this);return na(ng(i,l),a)};function Dm(i){var a={};return i.idToken&&(a.id_token=i.idToken),i.accessToken&&(a.access_token=i.accessToken),i.secret&&(a.oauth_token_secret=i.secret),a.providerId=i.providerId,i.nonce&&!i.a&&(a.nonce=i.nonce),a={postBody:yb(a).toString(),requestUri:"http://localhost"},i.a&&(delete a.postBody,a.pendingToken=i.a),a}pi.prototype.w=function(){var i={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(i.oauthIdToken=this.idToken),this.accessToken&&(i.oauthAccessToken=this.accessToken),this.secret&&(i.oauthTokenSecret=this.secret),this.nonce&&(i.nonce=this.nonce),this.a&&(i.pendingToken=this.a),i};function HD(i){if(i&&i.providerId&&i.signInMethod){var a={idToken:i.oauthIdToken,accessToken:i.oauthTokenSecret?null:i.oauthAccessToken,oauthTokenSecret:i.oauthTokenSecret,oauthToken:i.oauthTokenSecret&&i.oauthAccessToken,nonce:i.nonce,pendingToken:i.pendingToken};try{return new pi(i.providerId,a,i.signInMethod)}catch{}}return null}function Bo(i,a){this.Qc=a||[],Sn(this,{providerId:i,isOAuthProvider:!0}),this.Jb={},this.qb=(jm(i)||{}).Ja||null,this.pb=null}Bo.prototype.Ka=function(i){return this.Jb=fr(i),this};function sS(i){if(typeof i!="string"||i.indexOf("saml.")!=0)throw new T("argument-error",'SAML provider IDs must be prefixed with "saml."');Bo.call(this,i,[])}k(sS,Bo);function Yn(i){Bo.call(this,i,mh),this.a=[]}k(Yn,Bo),Yn.prototype.Ca=function(i){return Ce(this.a,i)||this.a.push(i),this},Yn.prototype.Rb=function(){return dt(this.a)},Yn.prototype.credential=function(i,a){var l;if(C(i)?l={idToken:i.idToken||null,accessToken:i.accessToken||null,nonce:i.rawNonce||null}:l={idToken:i||null,accessToken:a||null},!l.idToken&&!l.accessToken)throw new T("argument-error","credential failed: must provide the ID token and/or the access token.");return new pi(this.providerId,l,this.providerId)};function zo(){Yn.call(this,"facebook.com")}k(zo,Yn),fe(zo,"PROVIDER_ID","facebook.com"),fe(zo,"FACEBOOK_SIGN_IN_METHOD","facebook.com");function aS(i){if(!i)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var a=i;return C(i)&&(a=i.accessToken),new zo().credential({accessToken:a})}function qo(){Yn.call(this,"github.com")}k(qo,Yn),fe(qo,"PROVIDER_ID","github.com"),fe(qo,"GITHUB_SIGN_IN_METHOD","github.com");function uS(i){if(!i)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var a=i;return C(i)&&(a=i.accessToken),new qo().credential({accessToken:a})}function Ko(){Yn.call(this,"google.com"),this.Ca("profile")}k(Ko,Yn),fe(Ko,"PROVIDER_ID","google.com"),fe(Ko,"GOOGLE_SIGN_IN_METHOD","google.com");function lS(i,a){var l=i;return C(i)&&(l=i.idToken,a=i.accessToken),new Ko().credential({idToken:l,accessToken:a})}function ra(){Bo.call(this,"twitter.com",Jb)}k(ra,Bo),fe(ra,"PROVIDER_ID","twitter.com"),fe(ra,"TWITTER_SIGN_IN_METHOD","twitter.com");function cS(i,a){var l=i;if(C(l)||(l={oauthToken:i,oauthTokenSecret:a}),!l.oauthToken||!l.oauthTokenSecret)throw new T("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new pi("twitter.com",l,"twitter.com")}function Bi(i,a,l){this.a=i,this.f=a,fe(this,"providerId","password"),fe(this,"signInMethod",l===vr.EMAIL_LINK_SIGN_IN_METHOD?vr.EMAIL_LINK_SIGN_IN_METHOD:vr.EMAIL_PASSWORD_SIGN_IN_METHOD)}Bi.prototype.ka=function(i){return this.signInMethod==vr.EMAIL_LINK_SIGN_IN_METHOD?Le(i,CM,{email:this.a,oobCode:this.f}):Le(i,US,{email:this.a,password:this.f})},Bi.prototype.b=function(i,a){return this.signInMethod==vr.EMAIL_LINK_SIGN_IN_METHOD?Le(i,AM,{idToken:a,email:this.a,oobCode:this.f}):Le(i,PS,{idToken:a,email:this.a,password:this.f})},Bi.prototype.c=function(i,a){return na(this.ka(i),a)},Bi.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}};function GD(i){return i&&i.email&&i.password?new Bi(i.email,i.password,i.signInMethod):null}function vr(){Sn(this,{providerId:"password",isOAuthProvider:!1})}function hS(i,a){if(a=Mm(a),!a)throw new T("argument-error","Invalid email link!");return new Bi(i,a.code,vr.EMAIL_LINK_SIGN_IN_METHOD)}function Mm(i){return i=oS(i),(i=zb(i))&&i.operation===ch?i:null}Sn(vr,{PROVIDER_ID:"password"}),Sn(vr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Sn(vr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"});function zi(i){if(!(i.fb&&i.eb||i.La&&i.ea))throw new T("internal-error");this.a=i,fe(this,"providerId","phone"),this.fa="phone",fe(this,"signInMethod","phone")}zi.prototype.ka=function(i){return i.gb(qu(this))},zi.prototype.b=function(i,a){var l=qu(this);return l.idToken=a,Le(i,XM,l)},zi.prototype.c=function(i,a){var l=qu(this);return l.operation="REAUTH",i=Le(i,JM,l),na(i,a)},zi.prototype.w=function(){var i={providerId:"phone"};return this.a.fb&&(i.verificationId=this.a.fb),this.a.eb&&(i.verificationCode=this.a.eb),this.a.La&&(i.temporaryProof=this.a.La),this.a.ea&&(i.phoneNumber=this.a.ea),i};function WD(i){if(i&&i.providerId==="phone"&&(i.verificationId&&i.verificationCode||i.temporaryProof&&i.phoneNumber)){var a={};return xe(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(l){i[l]&&(a[l]=i[l])}),new zi(a)}return null}function qu(i){return i.a.La&&i.a.ea?{temporaryProof:i.a.La,phoneNumber:i.a.ea}:{sessionInfo:i.a.fb,code:i.a.eb}}function mi(i){try{this.a=i||de.auth()}catch{throw new T("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Sn(this,{providerId:"phone",isOAuthProvider:!1})}mi.prototype.gb=function(i,a){var l=this.a.a;return ge(a.verify()).then(function(d){if(typeof d!="string")throw new T("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(a.type){case"recaptcha":var g=C(i)?i.session:null,S=C(i)?i.phoneNumber:i,I;return g&&g.type==zu?I=g.Ha().then(function(D){return bM(l,{idToken:D,phoneEnrollmentInfo:{phoneNumber:S,recaptchaToken:d}})}):g&&g.type==vh?I=g.Ha().then(function(D){return SM(l,{mfaPendingCredential:D,mfaEnrollmentId:i.multiFactorHint&&i.multiFactorHint.uid||i.multiFactorUid,phoneSignInInfo:{recaptchaToken:d}})}):I=xM(l,{phoneNumber:S,recaptchaToken:d}),I.then(function(D){return typeof a.reset=="function"&&a.reset(),D},function(D){throw typeof a.reset=="function"&&a.reset(),D});default:throw new T("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};function fS(i,a){if(!i)throw new T("missing-verification-id");if(!a)throw new T("missing-verification-code");return new zi({fb:i,eb:a})}Sn(mi,{PROVIDER_ID:"phone"}),Sn(mi,{PHONE_SIGN_IN_METHOD:"phone"});function Rm(i){if(i.temporaryProof&&i.phoneNumber)return new zi({La:i.temporaryProof,ea:i.phoneNumber});var a=i&&i.providerId;if(!a||a==="password")return null;var l=i&&i.oauthAccessToken,d=i&&i.oauthTokenSecret,g=i&&i.nonce,S=i&&i.oauthIdToken,I=i&&i.pendingToken;try{switch(a){case"google.com":return lS(S,l);case"facebook.com":return aS(l);case"github.com":return uS(l);case"twitter.com":return cS(l,d);default:return l||d||S||I?I?a.indexOf("saml.")==0?new Vo(a,I):new pi(a,{pendingToken:I,idToken:i.oauthIdToken,accessToken:i.oauthAccessToken},a):new Yn(a).credential({idToken:S,accessToken:l,rawNonce:g}):null}}catch{return null}}function Om(i){if(!i.isOAuthProvider)throw new T("invalid-oauth-provider")}function Cr(i,a,l,d,g,S,I){if(this.c=i,this.b=a||null,this.g=l||null,this.f=d||null,this.i=S||null,this.h=I||null,this.a=g||null,this.g||this.a){if(this.g&&this.a)throw new T("invalid-auth-event");if(this.g&&!this.f)throw new T("invalid-auth-event")}else throw new T("invalid-auth-event")}Cr.prototype.getUid=function(){var i=[];return i.push(this.c),this.b&&i.push(this.b),this.f&&i.push(this.f),this.h&&i.push(this.h),i.join("-")},Cr.prototype.T=function(){return this.h},Cr.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};function dS(i){return i=i||{},i.type?new Cr(i.type,i.eventId,i.urlResponse,i.sessionId,i.error&&L(i.error),i.postBody,i.tenantId):null}function YD(){this.b=null,this.a=[]}var Lm=null;function QD(i){var a=Lm;a.a.push(i),a.b||(a.b=function(l){for(var d=0;d<a.a.length;d++)a.a[d](l)},i=lt("universalLinks.subscribe",f),typeof i=="function"&&i(null,a.b))}function Pm(i){var a="unauthorized-domain",l=void 0,d=On(i);i=d.a,d=d.c,d=="chrome-extension"?l=Px("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",i):d=="http"||d=="https"?l=Px("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",i):a="operation-not-supported-in-this-environment",T.call(this,a,l)}k(Pm,T);function Ku(i,a,l){T.call(this,i,l),i=a||{},i.Kb&&fe(this,"email",i.Kb),i.ea&&fe(this,"phoneNumber",i.ea),i.credential&&fe(this,"credential",i.credential),i.$b&&fe(this,"tenantId",i.$b)}k(Ku,T),Ku.prototype.w=function(){var i={code:this.code,message:this.message};this.email&&(i.email=this.email),this.phoneNumber&&(i.phoneNumber=this.phoneNumber),this.tenantId&&(i.tenantId=this.tenantId);var a=this.credential&&this.credential.w();return a&&Xt(i,a),i},Ku.prototype.toJSON=function(){return this.w()};function yh(i){if(i.code){var a=i.code||"";a.indexOf(U)==0&&(a=a.substring(U.length));var l={credential:Rm(i),$b:i.tenantId};if(i.email)l.Kb=i.email;else if(i.phoneNumber)l.ea=i.phoneNumber;else if(!l.credential)return new T(a,i.message||void 0);return new Ku(a,l,i.message)}return null}function Hu(){}Hu.prototype.c=null;function pS(i){return i.c||(i.c=i.b())}var Um;function wh(){}k(wh,Hu),wh.prototype.a=function(){var i=mS(this);return i?new ActiveXObject(i):new XMLHttpRequest},wh.prototype.b=function(){var i={};return mS(this)&&(i[0]=!0,i[1]=!0),i};function mS(i){if(!i.f&&typeof XMLHttpRequest>"u"&&typeof ActiveXObject<"u"){for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],l=0;l<a.length;l++){var d=a[l];try{return new ActiveXObject(d),i.f=d}catch{}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return i.f}Um=new wh;function xh(){}k(xh,Hu),xh.prototype.a=function(){var i=new XMLHttpRequest;if("withCredentials"in i)return i;if(typeof XDomainRequest<"u")return new gS;throw Error("Unsupported browser")},xh.prototype.b=function(){return{}};function gS(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=x(this.qc,this),this.a.onerror=x(this.Tb,this),this.a.onprogress=x(this.rc,this),this.a.ontimeout=x(this.vc,this)}e=gS.prototype,e.open=function(i,a,l){if(l!=null&&!l)throw Error("Only async requests are supported.");this.a.open(i,a)},e.send=function(i){if(i)if(typeof i=="string")this.a.send(i);else throw Error("Only string data is supported");else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(i){return i.toLowerCase()=="content-type"?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Fm(this,4)},e.Tb=function(){this.status=500,this.response=this.responseText="",Fm(this,4)},e.vc=function(){this.Tb()},e.rc=function(){this.status=200,Fm(this,1)};function Fm(i,a){i.readyState=a,i.onreadystatechange&&i.onreadystatechange()}e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};function $m(i,a,l){this.reset(i,a,l,void 0,void 0)}$m.prototype.a=null,$m.prototype.reset=function(i,a,l,d,g){delete this.a};function Vm(i){this.f=i,this.b=this.c=this.a=null}function Gu(i,a){this.name=i,this.value=a}Gu.prototype.toString=function(){return this.name};var vS=new Gu("SEVERE",1e3),Bm=new Gu("WARNING",900),XD=new Gu("CONFIG",700),JD=new Gu("FINE",500);function yS(i){return i.c?i.c:i.a?yS(i.a):(V("Root logger has no level set."),null)}Vm.prototype.log=function(i,a,l){if(i.value>=yS(this).value)for(_(a)&&(a=a()),i=new $m(i,String(a),this.f),l&&(i.a=l),l=this;l;)l=l.a};var zm={},bh=null;function qm(i){bh||(bh=new Vm(""),zm[""]=bh,bh.c=XD);var a;if(!(a=zm[i])){a=new Vm(i);var l=i.lastIndexOf("."),d=i.substr(l+1);l=qm(i.substr(0,l)),l.b||(l.b={}),l.b[d]=a,a.a=l,zm[i]=a}return a}function yr(i,a){i&&i.log(JD,a,void 0)}function Sh(i){this.f=i}k(Sh,Hu),Sh.prototype.a=function(){return new _h(this.f)},Sh.prototype.b=function(i){return function(){return i}}({});function _h(i){bn.call(this),this.u=i,this.h=void 0,this.readyState=Km,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=qm("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}k(_h,bn);var Km=0;e=_h.prototype,e.open=function(i,a){if(this.readyState!=Km)throw this.abort(),Error("Error reopening a connection");this.s=i,this.f=a,this.readyState=1,Yu(this)},e.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.a=!0;var a={headers:this.l,method:this.s,credentials:this.h,cache:void 0};i&&(a.body=i),this.u.fetch(new Request(this.f,a)).then(this.uc.bind(this),this.Va.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&this.readyState!=4&&(this.a=!1,Wu(this)),this.readyState=Km},e.uc=function(i){this.a&&(this.g=i,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=i.headers,this.readyState=2,Yu(this)),this.a&&(this.readyState=3,Yu(this),this.a&&(this.responseType==="arraybuffer"?i.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):typeof f.ReadableStream<"u"&&"body"in i?(this.response=this.responseText="",this.c=i.body.getReader(),this.m=new TextDecoder,wS(this)):i.text().then(this.tc.bind(this),this.Va.bind(this)))))};function wS(i){i.c.read().then(i.pc.bind(i)).catch(i.Va.bind(i))}e.pc=function(i){if(this.a){var a=this.m.decode(i.value?i.value:new Uint8Array(0),{stream:!i.done});a&&(this.response=this.responseText+=a),i.done?Wu(this):Yu(this),this.readyState==3&&wS(this)}},e.tc=function(i){this.a&&(this.response=this.responseText=i,Wu(this))},e.sc=function(i){this.a&&(this.response=i,Wu(this))},e.Va=function(i){var a=this.i;a&&a.log(Bm,"Failed to fetch url "+this.f,i instanceof Error?i:Error(i)),this.a&&Wu(this)};function Wu(i){i.readyState=4,i.g=null,i.c=null,i.m=null,Yu(i)}e.setRequestHeader=function(i,a){this.l.append(i,a)},e.getResponseHeader=function(i){return this.b?this.b.get(i.toLowerCase())||"":((i=this.i)&&i.log(Bm,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var i=this.i;return i&&i.log(Bm,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}i=[];for(var a=this.b.entries(),l=a.next();!l.done;)l=l.value,i.push(l[0]+": "+l[1]),l=a.next();return i.join(`\r
`)};function Yu(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(_h.prototype,"withCredentials",{get:function(){return this.h==="include"},set:function(i){this.h=i?"include":"same-origin"}});function Qu(i){bn.call(this),this.headers=new Ys,this.D=i||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=xS,this.u=this.S=!1}k(Qu,bn);var xS="";Qu.prototype.b=qm("goog.net.XhrIo");var ZD=/^https?$/i,eM=["POST","PUT"];function tM(i,a,l,d,g){if(i.a)throw Error("[goog.net.XhrIo] Object is active with another request="+i.l+"; newUri="+a);l=l?l.toUpperCase():"GET",i.l=a,i.h="",i.P=l,i.J=!1,i.c=!0,i.a=i.D?i.D.a():Um.a(),i.C=i.D?pS(i.D):pS(Um),i.a.onreadystatechange=x(i.Wb,i);try{yr(i.b,gi(i,"Opening Xhr")),i.N=!0,i.a.open(l,String(a),!0),i.N=!1}catch(I){yr(i.b,gi(i,"Error opening Xhr: "+I.message)),bS(i,I);return}a=d||"";var S=new Ys(i.headers);g&&aD(g,function(I,D){S.set(D,I)}),g=ft(S.Y()),d=f.FormData&&a instanceof f.FormData,!Ce(eM,l)||g||d||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),S.forEach(function(I,D){this.a.setRequestHeader(D,I)},i),i.m&&(i.a.responseType=i.m),"withCredentials"in i.a&&i.a.withCredentials!==i.S&&(i.a.withCredentials=i.S);try{NS(i),0<i.g&&(i.u=nM(i.a),yr(i.b,gi(i,"Will abort after "+i.g+"ms if incomplete, xhr2 "+i.u)),i.u?(i.a.timeout=i.g,i.a.ontimeout=x(i.Ma,i)):i.s=im(i.Ma,i.g,i)),yr(i.b,gi(i,"Sending request")),i.i=!0,i.a.send(a),i.i=!1}catch(I){yr(i.b,gi(i,"Send error: "+I.message)),bS(i,I)}}function nM(i){return jr&&Vx(9)&&typeof i.timeout=="number"&&i.ontimeout!==void 0}function rM(i){return i.toLowerCase()=="content-type"}e=Qu.prototype,e.Ma=function(){typeof c<"u"&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",yr(this.b,gi(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))};function bS(i,a){i.c=!1,i.a&&(i.f=!0,i.a.abort(),i.f=!1),i.h=a,SS(i),Nh(i)}function SS(i){i.J||(i.J=!0,i.dispatchEvent("complete"),i.dispatchEvent("error"))}e.abort=function(){this.a&&this.c&&(yr(this.b,gi(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Nh(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Nh(this,!0)),Qu.bb.Da.call(this)},e.Wb=function(){this.ya||(this.N||this.i||this.f?_S(this):this.Jc())},e.Jc=function(){_S(this)};function _S(i){if(i.c&&typeof c<"u"){if(i.C[1]&&Xu(i)==4&&Eh(i)==2)yr(i.b,gi(i,"Local request error detected and ignored"));else if(i.i&&Xu(i)==4)im(i.Wb,0,i);else if(i.dispatchEvent("readystatechange"),Xu(i)==4){yr(i.b,gi(i,"Request complete")),i.c=!1;try{var a=Eh(i);e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var g;if(g=a===0){var S=String(i.l).match(gb)[1]||null;if(!S&&f.self&&f.self.location){var I=f.self.location.protocol;S=I.substr(0,I.length-1)}g=!ZD.test(S?S.toLowerCase():"")}d=g}if(d)i.dispatchEvent("complete"),i.dispatchEvent("success");else{try{var D=2<Xu(i)?i.a.statusText:""}catch(B){yr(i.b,"Can not get status: "+B.message),D=""}i.h=D+" ["+Eh(i)+"]",SS(i)}}finally{Nh(i)}}}}function Nh(i,a){if(i.a){NS(i);var l=i.a,d=i.C[0]?v:null;i.a=null,i.C=null,a||i.dispatchEvent("ready");try{l.onreadystatechange=d}catch(g){(i=i.b)&&i.log(vS,"Problem encountered resetting onreadystatechange: "+g.message,void 0)}}}function NS(i){i.a&&i.u&&(i.a.ontimeout=null),i.s&&(f.clearTimeout(i.s),i.s=null)}function Xu(i){return i.a?i.a.readyState:0}function Eh(i){try{return 2<Xu(i)?i.a.status:-1}catch{return-1}}function iM(i){try{return i.a?i.a.responseText:""}catch(a){return yr(i.b,"Can not get responseText: "+a.message),""}}e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case xS:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var i=this.b;return i&&i.log(vS,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(a){return yr(this.b,"Can not get response: "+a.message),null}};function gi(i,a){return a+" ["+i.P+" "+i.l+" "+Eh(i)+"]"}function Ho(i){var a=aM;this.g=[],this.u=a,this.s=i||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}Ho.prototype.cancel=function(i){if(this.a)this.c instanceof Ho&&this.c.cancel();else{if(this.b){var a=this.b;delete this.b,i?a.cancel(i):(a.l--,0>=a.l&&a.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(i=new Zu,Ih(this),Ju(this,!1,i))}},Ho.prototype.m=function(i,a){this.i=!1,Ju(this,i,a)};function Ju(i,a,l){i.a=!0,i.c=l,i.f=!a,IS(i)}function Ih(i){if(i.a){if(!i.v)throw new Th;i.v=!1}}function oM(i,a){Hm(i,null,a,void 0)}function Hm(i,a,l,d){i.g.push([a,l,d]),i.a&&IS(i)}Ho.prototype.then=function(i,a,l){var d,g,S=new Me(function(I,D){d=I,g=D});return Hm(this,d,function(I){I instanceof Zu?S.cancel():g(I)}),S.then(i,a,l)},Ho.prototype.$goog_Thenable=!0;function ES(i){return et(i.g,function(a){return _(a[1])})}function IS(i){if(i.h&&i.a&&ES(i)){var a=i.h,l=jh[a];l&&(f.clearTimeout(l.a),delete jh[a]),i.h=0}i.b&&(i.b.l--,delete i.b),a=i.c;for(var d=l=!1;i.g.length&&!i.i;){var g=i.g.shift(),S=g[0],I=g[1];if(g=g[2],S=i.f?I:S)try{var D=S.call(g||i.s,a);D!==void 0&&(i.f=i.f&&(D==a||D instanceof Error),i.c=a=D),(X(a)||typeof f.Promise=="function"&&a instanceof f.Promise)&&(d=!0,i.i=!0)}catch(B){a=B,i.f=!0,ES(i)||(l=!0)}}i.c=a,d&&(D=x(i.m,i,!0),d=x(i.m,i,!1),a instanceof Ho?(Hm(a,D,d),a.C=!0):a.then(D,d)),l&&(a=new TS(a),jh[a.a]=a,i.h=a.a)}function Th(){q.call(this)}k(Th,q),Th.prototype.message="Deferred has already fired",Th.prototype.name="AlreadyCalledError";function Zu(){q.call(this)}k(Zu,q),Zu.prototype.message="Deferred was canceled",Zu.prototype.name="CanceledError";function TS(i){this.a=f.setTimeout(x(this.c,this),0),this.b=i}TS.prototype.c=function(){throw delete jh[this.a],this.b};var jh={};function Gm(i){var a={},l=a.document||document,d=Nt(i).toString(),g=Zc(document,"SCRIPT"),S={Xb:g,Ma:void 0},I=new Ho(S),D=null,B=a.timeout!=null?a.timeout:5e3;return 0<B&&(D=window.setTimeout(function(){kh(g,!0);var G=new Wm(lM,"Timeout reached for loading script "+d);Ih(I),Ju(I,!1,G)},B),S.Ma=D),g.onload=g.onreadystatechange=function(){g.readyState&&g.readyState!="loaded"&&g.readyState!="complete"||(kh(g,a.xd||!1,D),Ih(I),Ju(I,!0,null))},g.onerror=function(){kh(g,!0,D);var G=new Wm(uM,"Error while loading script "+d);Ih(I),Ju(I,!1,G)},S=a.attributes||{},Xt(S,{type:"text/javascript",charset:"UTF-8"}),zx(g,S),UA(g,i),sM(l).appendChild(g),I}function sM(i){var a;return(a=(i||document).getElementsByTagName("HEAD"))&&a.length!=0?a[0]:i.documentElement}function aM(){if(this&&this.Xb){var i=this.Xb;i&&i.tagName=="SCRIPT"&&kh(i,!0,this.Ma)}}function kh(i,a,l){l!=null&&f.clearTimeout(l),i.onload=v,i.onerror=v,i.onreadystatechange=v,a&&window.setTimeout(function(){i&&i.parentNode&&i.parentNode.removeChild(i)},0)}var uM=0,lM=1;function Wm(i,a){var l="Jsloader error (code #"+i+")";a&&(l+=": "+a),q.call(this,l),this.code=i}k(Wm,q);function Ch(i){this.f=i}k(Ch,Hu),Ch.prototype.a=function(){return new this.f},Ch.prototype.b=function(){return{}};function Ar(i,a,l){if(this.c=i,i=a||{},this.l=i.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=i.secureTokenTimeout||cM,this.g=fr(i.secureTokenHeaders||hM),this.h=i.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=i.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=i.firebaseTimeout||fM,this.a=fr(i.firebaseHeaders||dM),l&&(this.a["X-Client-Version"]=l,this.g["X-Client-Version"]=l),l=Wr()=="Node",l=f.XMLHttpRequest||l&&de.INTERNAL.node&&de.INTERNAL.node.XMLHttpRequest,!l&&!kr())throw new T("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,kr()?this.f=new Sh(self):jb()?this.f=new Ch(l):this.f=new xh,this.b=null}var Ym,Dr="idToken",cM=new Vi(3e4,6e4),hM={"Content-Type":"application/x-www-form-urlencoded"},fM=new Vi(3e4,6e4),dM={"Content-Type":"application/json"};function jS(i,a){a?i.a["X-Firebase-Locale"]=a:delete i.a["X-Firebase-Locale"]}function Ah(i,a){a&&(i.l=Qm("https://securetoken.googleapis.com/v1/token",a),i.h=Qm("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",a),i.i=Qm("https://identitytoolkit.googleapis.com/v2/",a))}function Qm(i,a){return i=On(i),a=On(a.url),i.f=i.a+i.f,Du(i,a.c),i.a=a.a,Mu(i,a.g),i.toString()}function kS(i,a){a?(i.a["X-Client-Version"]=a,i.g["X-Client-Version"]=a):(delete i.a["X-Client-Version"],delete i.g["X-Client-Version"])}Ar.prototype.T=function(){return this.b};function CS(i,a,l,d,g,S,I){vD()||kr()?i=x(i.u,i):(Ym||(Ym=new Me(function(D,B){mM(D,B)})),i=x(i.s,i)),i(a,l,d,g,S,I)}Ar.prototype.u=function(i,a,l,d,g,S){if(kr()&&(typeof f.fetch>"u"||typeof f.Headers>"u"||typeof f.Request>"u"))throw new T("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var I=new Qu(this.f);if(S){I.g=Math.max(0,S);var D=setTimeout(function(){I.dispatchEvent("timeout")},S)}db(I,"complete",function(){D&&clearTimeout(D);var B=null;try{B=JSON.parse(iM(this))||null}catch{B=null}a&&a(B)}),rm(I,"ready",function(){D&&clearTimeout(D),sb(this)}),rm(I,"timeout",function(){D&&clearTimeout(D),sb(this),a&&a(null)}),tM(I,i,l,d,g)};var pM=new se(We,"https://apis.google.com/js/client.js?onload=%{onload}"),AS="__fcb"+Math.floor(1e6*Math.random()).toString();function mM(i,a){if(((window.gapi||{}).client||{}).request)i();else{f[AS]=function(){((window.gapi||{}).client||{}).request?i():a(Error("CORS_UNSUPPORTED"))};var l=Et(pM,{onload:AS});oM(Gm(l),function(){a(Error("CORS_UNSUPPORTED"))})}}Ar.prototype.s=function(i,a,l,d,g){var S=this;Ym.then(function(){window.gapi.client.setApiKey(S.c);var I=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:i,method:l,body:d,headers:g,authType:"none",callback:function(D){window.gapi.auth.setToken(I),a&&a(D)}})}).o(function(I){a&&a({error:{message:I&&I.message||"CORS_UNSUPPORTED"}})})};function gM(i,a){return new Me(function(l,d){a.grant_type=="refresh_token"&&a.refresh_token||a.grant_type=="authorization_code"&&a.code?CS(i,i.l+"?key="+encodeURIComponent(i.c),function(g){g?g.error?d(ig(g)):g.access_token&&g.refresh_token?l(g):d(new T("internal-error")):d(new T("network-request-failed"))},"POST",yb(a).toString(),i.g,i.m.get()):d(new T("internal-error"))})}function DS(i,a,l,d,g,S,I){var D=On(a+l);It(D,"key",i.c),I&&It(D,"cb",Date.now().toString());var B=d=="GET";if(B)for(var G in g)g.hasOwnProperty(G)&&It(D,G,g[G]);return new Me(function(Ee,Qe){CS(i,D.toString(),function(qe){qe?qe.error?Qe(ig(qe,S||{})):Ee(qe):Qe(new T("network-request-failed"))},d,B?void 0:bb(Ab(g)),i.a,i.v.get())})}function Go(i){if(i=i.email,typeof i!="string"||!xD.test(i))throw new T("invalid-email")}function MS(i){"email"in i&&Go(i)}function vM(i,a){return Le(i,TM,{identifier:a,continueUri:lh()?Lu():"http://localhost"}).then(function(l){return l.signinMethods||[]})}function yM(i){return Le(i,FM,{}).then(function(a){return a.authorizedDomains||[]})}function Ln(i){if(!i[Dr])throw i.mfaPendingCredential?new T("multi-factor-auth-required",null,fr(i)):new T("internal-error")}function Xm(i){if(i.phoneNumber||i.temporaryProof){if(!i.phoneNumber||!i.temporaryProof)throw new T("internal-error")}else{if(!i.sessionInfo)throw new T("missing-verification-id");if(!i.code)throw new T("missing-verification-code")}}Ar.prototype.Ab=function(){return Le(this,zM,{})},Ar.prototype.Cb=function(i,a){return Le(this,LS,{idToken:i,email:a})},Ar.prototype.Db=function(i,a){return Le(this,PS,{idToken:i,password:a})};var wM={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};e=Ar.prototype,e.Eb=function(i,a){var l={idToken:i},d=[];return hr(wM,function(g,S){var I=a[S];I===null?d.push(g):S in a&&(l[S]=I)}),d.length&&(l.deleteAttribute=d),Le(this,LS,l)},e.wb=function(i,a){return i={requestType:"PASSWORD_RESET",email:i},Xt(i,a),Le(this,UM,i)},e.xb=function(i,a){return i={requestType:"EMAIL_SIGNIN",email:i},Xt(i,a),Le(this,OM,i)},e.vb=function(i,a){return i={requestType:"VERIFY_EMAIL",idToken:i},Xt(i,a),Le(this,LM,i)},e.Fb=function(i,a,l){return i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:a},Xt(i,l),Le(this,PM,i)};function xM(i,a){return Le(i,BM,a)}e.gb=function(i){return Le(this,QM,i)};function bM(i,a){return Le(i,qM,a).then(function(l){return l.phoneSessionInfo.sessionInfo})}function RS(i){if(!i.phoneVerificationInfo)throw new T("internal-error");if(!i.phoneVerificationInfo.sessionInfo)throw new T("missing-verification-id");if(!i.phoneVerificationInfo.code)throw new T("missing-verification-code")}function SM(i,a){return Le(i,KM,a).then(function(l){return l.phoneResponseInfo.sessionInfo})}function _M(i,a,l){return Le(i,kM,{idToken:a,deleteProvider:l})}function Jm(i){if(!i.requestUri||!i.sessionId&&!i.postBody&&!i.pendingToken)throw new T("internal-error")}function Zm(i,a){return a.oauthIdToken&&a.providerId&&a.providerId.indexOf("oidc.")==0&&!a.pendingToken&&(i.sessionId?a.nonce=i.sessionId:i.postBody&&(i=new Po(i.postBody),am(i,"nonce")&&(a.nonce=i.get("nonce")))),a}function OS(i){var a=null;if(i.needConfirmation?(i.code="account-exists-with-different-credential",a=yh(i)):i.errorMessage=="FEDERATED_USER_ID_ALREADY_LINKED"?(i.code="credential-already-in-use",a=yh(i)):i.errorMessage=="EMAIL_EXISTS"?(i.code="email-already-in-use",a=yh(i)):i.errorMessage&&(a=FS(i.errorMessage)),a)throw a;Ln(i)}function eg(i,a){return a.returnIdpCredential=!0,Le(i,HM,a)}function tg(i,a){return a.returnIdpCredential=!0,Le(i,WM,a)}function ng(i,a){return a.returnIdpCredential=!0,a.autoCreate=!1,Le(i,GM,a)}function rg(i){if(!i.oobCode)throw new T("invalid-action-code")}e.ob=function(i,a){return Le(this,VM,{oobCode:i,newPassword:a})},e.Sa=function(i){return Le(this,EM,{oobCode:i})},e.kb=function(i){return Le(this,NM,{oobCode:i})};var NM={endpoint:"setAccountInfo",A:rg,Z:"email",B:!0},EM={endpoint:"resetPassword",A:rg,G:function(i){var a=i.requestType;if(!a||!i.email&&a!="EMAIL_SIGNIN"&&a!="VERIFY_AND_CHANGE_EMAIL")throw new T("internal-error")},B:!0},IM={endpoint:"signupNewUser",A:function(i){if(Go(i),!i.password)throw new T("weak-password")},G:Ln,V:!0,B:!0},TM={endpoint:"createAuthUri",B:!0},jM={endpoint:"deleteAccount",O:["idToken"]},kM={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(i){if(!Array.isArray(i.deleteProvider))throw new T("internal-error")}},CM={endpoint:"emailLinkSignin",O:["email","oobCode"],A:Go,G:Ln,V:!0,B:!0},AM={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:Go,G:Ln,V:!0},DM={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:RS,G:Ln,B:!0,Na:!0},MM={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:RS,G:Ln,B:!0,Na:!0},RM={endpoint:"getAccountInfo"},OM={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(i){if(i.requestType!="EMAIL_SIGNIN")throw new T("internal-error");Go(i)},Z:"email",B:!0},LM={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(i){if(i.requestType!="VERIFY_EMAIL")throw new T("internal-error")},Z:"email",B:!0},PM={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(i){if(i.requestType!="VERIFY_AND_CHANGE_EMAIL")throw new T("internal-error")},Z:"email",B:!0},UM={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(i){if(i.requestType!="PASSWORD_RESET")throw new T("internal-error");Go(i)},Z:"email",B:!0},FM={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},$M={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(i){if(!i.recaptchaSiteKey)throw new T("internal-error")}},VM={endpoint:"resetPassword",A:rg,Z:"email",B:!0},BM={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},LS={endpoint:"setAccountInfo",O:["idToken"],A:MS,V:!0},PS={endpoint:"setAccountInfo",O:["idToken"],A:function(i){if(MS(i),!i.password)throw new T("weak-password")},G:Ln,V:!0},zM={endpoint:"signupNewUser",G:Ln,V:!0,B:!0},qM={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(i){if(!i.phoneEnrollmentInfo)throw new T("internal-error");if(!i.phoneEnrollmentInfo.phoneNumber)throw new T("missing-phone-number");if(!i.phoneEnrollmentInfo.recaptchaToken)throw new T("missing-app-credential")},G:function(i){if(!i.phoneSessionInfo||!i.phoneSessionInfo.sessionInfo)throw new T("internal-error")},B:!0,Na:!0},KM={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(i){if(!i.phoneSignInInfo||!i.phoneSignInInfo.recaptchaToken)throw new T("missing-app-credential")},G:function(i){if(!i.phoneResponseInfo||!i.phoneResponseInfo.sessionInfo)throw new T("internal-error")},B:!0,Na:!0},HM={endpoint:"verifyAssertion",A:Jm,Za:Zm,G:OS,V:!0,B:!0},GM={endpoint:"verifyAssertion",A:Jm,Za:Zm,G:function(i){if(i.errorMessage&&i.errorMessage=="USER_NOT_FOUND")throw new T("user-not-found");if(i.errorMessage)throw FS(i.errorMessage);Ln(i)},V:!0,B:!0},WM={endpoint:"verifyAssertion",A:function(i){if(Jm(i),!i.idToken)throw new T("internal-error")},Za:Zm,G:OS,V:!0},YM={endpoint:"verifyCustomToken",A:function(i){if(!i.token)throw new T("invalid-custom-token")},G:Ln,V:!0,B:!0},US={endpoint:"verifyPassword",A:function(i){if(Go(i),!i.password)throw new T("wrong-password")},G:Ln,V:!0,B:!0},QM={endpoint:"verifyPhoneNumber",A:Xm,G:Ln,B:!0},XM={endpoint:"verifyPhoneNumber",A:function(i){if(!i.idToken)throw new T("internal-error");Xm(i)},G:function(i){if(i.temporaryProof)throw i.code="credential-already-in-use",yh(i);Ln(i)}},JM={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:Xm,G:Ln,B:!0},ZM={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(i){if(!!i[Dr]^!!i.refreshToken)throw new T("internal-error")},B:!0,Na:!0};function Le(i,a,l){if(!TD(l,a.O))return ut(new T("internal-error"));var d=!!a.Na,g=a.Vb||"POST",S;return ge(l).then(a.A).then(function(){return a.V&&(l.returnSecureToken=!0),a.B&&i.b&&typeof l.tenantId>"u"&&(l.tenantId=i.b),d?DS(i,i.i,a.endpoint,g,l,a.Ib,a.mb||!1):DS(i,i.h,a.endpoint,g,l,a.Ib,a.mb||!1)}).then(function(I){return S=I,a.Za?a.Za(l,S):S}).then(a.G).then(function(){if(!a.Z)return S;if(!(a.Z in S))throw new T("internal-error");return S[a.Z]})}function FS(i){return ig({error:{errors:[{message:i}],code:400,message:i}})}function ig(i,a){var l=(i.error&&i.error.errors&&i.error.errors[0]||{}).reason||"",d={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(l=d[l]?new T(d[l]):null)return l;l=i.error&&i.error.message||"",d={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},Xt(d,a||{}),a=(a=l.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<a.length?a[1]:void 0;for(var g in d)if(l.indexOf(g)===0)return new T(d[g],a);return!a&&i&&(a=Uu(i)),new T("internal-error",a)}function eR(i){this.b=i,this.a=null,this.sb=tR(this)}function tR(i){return aR().then(function(){return new Me(function(a,l){lt("gapi.iframes.getContext")().open({where:document.body,url:i.b,messageHandlersFilter:lt("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(d){function g(){clearTimeout(S),a()}i.a=d,i.a.restyle({setHideOnLeave:!1});var S=setTimeout(function(){l(Error("Network Error"))},sR.get());d.ping(g).then(g,function(){l(Error("Network Error"))})})})})}function nR(i,a){return i.sb.then(function(){return new Me(function(l){i.a.send(a.type,a,l,lt("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function rR(i,a){i.sb.then(function(){i.a.register("authEvent",a,lt("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}var iR=new se(We,"https://apis.google.com/js/api.js?onload=%{onload}"),oR=new Vi(3e4,6e4),sR=new Vi(5e3,15e3),Dh=null;function aR(){return Dh||(Dh=new Me(function(i,a){function l(){Mb(),lt("gapi.load")("gapi.iframes",{callback:i,ontimeout:function(){Mb(),a(Error("Network Error"))},timeout:oR.get()})}if(lt("gapi.iframes.Iframe"))i();else if(lt("gapi.load"))l();else{var d="__iframefcb"+Math.floor(1e6*Math.random()).toString();f[d]=function(){lt("gapi.load")?l():a(Error("Network Error"))},d=Et(iR,{onload:d}),ge(Gm(d)).o(function(){a(Error("Network Error"))})}}).o(function(i){throw Dh=null,i}))}function $S(i,a,l,d){this.l=i,this.h=a,this.i=l,this.g=d,this.f=null,this.g?(i=On(this.g.url),i=ah(i.c,i.a,i.g,"/emulator/auth/iframe")):i=ah("https",this.l,null,"/__/auth/iframe"),this.a=i,It(this.a,"apiKey",this.h),It(this.a,"appName",this.i),this.b=null,this.c=[]}$S.prototype.toString=function(){return this.f?It(this.a,"v",this.f):Gr(this.a.b,"v"),this.b?It(this.a,"eid",this.b):Gr(this.a.b,"eid"),this.c.length?It(this.a,"fw",this.c.join(",")):Gr(this.a.b,"fw"),this.a.toString()};function og(i,a,l,d,g,S){this.u=i,this.s=a,this.c=l,this.m=d,this.v=S,this.i=this.g=this.l=null,this.a=g,this.h=this.f=null}og.prototype.zb=function(i){return this.h=i,this},og.prototype.toString=function(){if(this.v){var i=On(this.v.url);i=ah(i.c,i.a,i.g,"/emulator/auth/handler")}else i=ah("https",this.u,null,"/__/auth/handler");if(It(i,"apiKey",this.s),It(i,"appName",this.c),It(i,"authType",this.m),this.a.isOAuthProvider){var a=this.a;try{var l=de.app(this.c).auth().la()}catch{l=null}a.pb=l,It(i,"providerId",this.a.providerId),l=this.a,a=Ab(l.Jb);for(var d in a)a[d]=a[d].toString();d=l.Qc,a=fr(a);for(var g=0;g<d.length;g++){var S=d[g];S in a&&delete a[S]}l.qb&&l.pb&&!a[l.qb]&&(a[l.qb]=l.pb),Mn(a)||It(i,"customParameters",Uu(a))}if(typeof this.a.Rb=="function"&&(l=this.a.Rb(),l.length&&It(i,"scopes",l.join(","))),this.l?It(i,"redirectUrl",this.l):Gr(i.b,"redirectUrl"),this.g?It(i,"eventId",this.g):Gr(i.b,"eventId"),this.i?It(i,"v",this.i):Gr(i.b,"v"),this.b)for(var I in this.b)this.b.hasOwnProperty(I)&&!gr(i,I)&&It(i,I,this.b[I]);return this.h?It(i,"tid",this.h):Gr(i.b,"tid"),this.f?It(i,"eid",this.f):Gr(i.b,"eid"),I=sg(this.c),I.length&&It(i,"fw",I.join(",")),i.toString()};function sg(i){try{return de.app(i).auth().Ga()}catch{return[]}}function VS(i,a,l,d,g,S){this.s=i,this.g=a,this.b=l,this.f=S,this.c=d||null,this.i=g||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function BS(i){var a=Lu();return yM(i).then(function(l){e:{var d=On(a),g=d.c;d=d.a;for(var S=0;S<l.length;S++){var I=l[S],D=d,B=g;if(I.indexOf("chrome-extension://")==0?D=On(I).a==D&&B=="chrome-extension":B!="http"&&B!="https"?D=!1:wD.test(I)?D=D==I:(I=I.split(".").join("\\."),D=new RegExp("^(.+\\."+I+"|"+I+")$","i").test(D)),D){l=!0;break e}}l=!1}if(!l)throw new Pm(Lu())})}function zS(i){return i.m||(i.m=uh().then(function(){if(!i.u){var a=i.c,l=i.i,d=sg(i.b),g=new $S(i.s,i.g,i.b,i.f);g.f=a,g.b=l,g.c=dt(d||[]),i.u=g.toString()}i.v=new eR(i.u),uR(i)})),i.m}e=VS.prototype,e.Pb=function(i,a,l){var d=new T("popup-closed-by-user"),g=new T("web-storage-unsupported"),S=this,I=!1;return this.ma().then(function(){lR(S).then(function(D){D||(i&&Uo(i),a(g),I=!0)})}).o(function(){}).then(function(){if(!I)return yD(i)}).then(function(){if(!I)return Ws(l).then(function(){a(d)})})},e.Yb=function(){var i=Jt();return!Pu(i)&&!Db(i)},e.Ub=function(){return!1},e.Nb=function(i,a,l,d,g,S,I,D){if(!i)return ut(new T("popup-blocked"));if(I&&!Pu())return this.ma().o(function(G){Uo(i),g(G)}),d(),ge();this.a||(this.a=BS(qS(this)));var B=this;return this.a.then(function(){var G=B.ma().o(function(Ee){throw Uo(i),g(Ee),Ee});return d(),G}).then(function(){if(Om(l),!I){var G=el(B.s,B.g,B.b,a,l,null,S,B.c,void 0,B.i,D,B.f);Nb(G,i)}}).o(function(G){throw G.code=="auth/network-request-failed"&&(B.a=null),G})};function qS(i){return i.l||(i.C=i.c?Js(i.c,sg(i.b)):null,i.l=new Ar(i.g,O(i.i),i.C),i.f&&Ah(i.l,i.f)),i.l}e.Ob=function(i,a,l,d){this.a||(this.a=BS(qS(this)));var g=this;return this.a.then(function(){Om(a);var S=el(g.s,g.g,g.b,i,a,Lu(),l,g.c,void 0,g.i,d,g.f);Nb(S)}).o(function(S){throw S.code=="auth/network-request-failed"&&(g.a=null),S})},e.ma=function(){var i=this;return zS(this).then(function(){return i.v.sb}).o(function(){throw i.a=null,new T("network-request-failed")})},e.ac=function(){return!0};function el(i,a,l,d,g,S,I,D,B,G,Ee,Qe){return i=new og(i,a,l,d,g,Qe),i.l=S,i.g=I,i.i=D,i.b=fr(B||null),i.f=G,i.zb(Ee).toString()}function uR(i){if(!i.v)throw Error("IfcHandler must be initialized!");rR(i.v,function(a){var l={};if(a&&a.authEvent){var d=!1;for(a=dS(a.authEvent),l=0;l<i.h.length;l++)d=i.h[l](a)||d;return l={},l.status=d?"ACK":"ERROR",ge(l)}return l.status="ERROR",ge(l)})}function lR(i){var a={type:"webStorageSupport"};return zS(i).then(function(){return nR(i.v,a)}).then(function(l){if(l&&l.length&&typeof l[0].webStorageSupport<"u")return l[0].webStorageSupport;throw Error()})}e.Ea=function(i){this.h.push(i)},e.Ta=function(i){Ze(this.h,function(a){return a==i})};function KS(i){if(this.a=i||de.INTERNAL.reactNative&&de.INTERNAL.reactNative.AsyncStorage,!this.a)throw new T("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}e=KS.prototype,e.get=function(i){return ge(this.a.getItem(i)).then(function(a){return a&&ea(a)})},e.set=function(i,a){return ge(this.a.setItem(i,Uu(a)))},e.U=function(i){return ge(this.a.removeItem(i))},e.ca=function(){},e.ia=function(){};function HS(i){this.b=i,this.a={},this.f=x(this.c,this)}var GS=[];function cR(){var i=kr()?self:null;if(xe(GS,function(l){l.b==i&&(a=l)}),!a){var a=new HS(i);GS.push(a)}return a}HS.prototype.c=function(i){var a=i.data.eventType,l=i.data.eventId,d=this.a[a];if(d&&0<d.length){i.ports[0].postMessage({status:"ack",eventId:l,eventType:a,response:null});var g=[];xe(d,function(S){g.push(ge().then(function(){return S(i.origin,i.data.data)}))}),Xx(g).then(function(S){var I=[];xe(S,function(D){I.push({fulfilled:D.Qb,value:D.value,reason:D.reason?D.reason.message:void 0})}),xe(I,function(D){for(var B in D)typeof D[B]>"u"&&delete D[B]}),i.ports[0].postMessage({status:"done",eventId:l,eventType:a,response:I})})}};function WS(i,a,l){Mn(i.a)&&i.b.addEventListener("message",i.f),typeof i.a[a]>"u"&&(i.a[a]=[]),i.a[a].push(l)}function YS(i){this.a=i}YS.prototype.postMessage=function(i,a){this.a.postMessage(i,a)};function QS(i){this.c=i,this.b=!1,this.a=[]}function XS(i,a,l,d){var g,S=l||{},I,D,B,G=null;if(i.b)return ut(Error("connection_unavailable"));var Ee=d?800:50,Qe=typeof MessageChannel<"u"?new MessageChannel:null;return new Me(function(qe,Ht){Qe?(g=Math.floor(Math.random()*Math.pow(10,20)).toString(),Qe.port1.start(),D=setTimeout(function(){Ht(Error("unsupported_event"))},Ee),I=function(vi){vi.data.eventId===g&&(vi.data.status==="ack"?(clearTimeout(D),B=setTimeout(function(){Ht(Error("timeout"))},3e3)):vi.data.status==="done"?(clearTimeout(B),typeof vi.data.response<"u"?qe(vi.data.response):Ht(Error("unknown_error"))):(clearTimeout(D),clearTimeout(B),Ht(Error("invalid_response"))))},G={messageChannel:Qe,onMessage:I},i.a.push(G),Qe.port1.addEventListener("message",I),i.c.postMessage({eventType:a,eventId:g,data:S},[Qe.port2])):Ht(Error("connection_unavailable"))}).then(function(qe){return ag(i,G),qe}).o(function(qe){throw ag(i,G),qe})}function ag(i,a){if(a){var l=a.messageChannel,d=a.onMessage;l&&(l.port1.removeEventListener("message",d),l.port1.close()),Ze(i.a,function(g){return g==a})}}QS.prototype.close=function(){for(;0<this.a.length;)ag(this,this.a[0]);this.b=!0};function JS(){if(!cg())throw new T("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=f.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var i=this;kr()&&self?(this.v=cR(),WS(this.v,"keyChanged",function(a,l){return t_(i).then(function(d){return 0<d.length&&xe(i.a,function(g){g(d)}),{keyProcessed:Ce(d,l.key)}})}),WS(this.v,"ping",function(){return ge(["keyChanged"])})):ED().then(function(a){(i.h=a)&&(i.g=new QS(new YS(a)),XS(i.g,"ping",null,!0).then(function(l){l[0].fulfilled&&Ce(l[0].value,"keyChanged")&&(i.s=!0)}).o(function(){}))})}var ug;function hR(i){return new Me(function(a,l){var d=i.m.deleteDatabase("firebaseLocalStorageDb");d.onsuccess=function(){a()},d.onerror=function(g){l(Error(g.target.error))}})}function ZS(i){return new Me(function(a,l){var d=i.m.open("firebaseLocalStorageDb",1);d.onerror=function(g){try{g.preventDefault()}catch{}l(Error(g.target.error))},d.onupgradeneeded=function(g){g=g.target.result;try{g.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(S){l(S)}},d.onsuccess=function(g){g=g.target.result,g.objectStoreNames.contains("firebaseLocalStorage")?a(g):hR(i).then(function(){return ZS(i)}).then(function(S){a(S)}).o(function(S){l(S)})}})}function lg(i){return i.i||(i.i=ZS(i)),i.i}function Mh(i,a){function l(g,S){lg(i).then(a).then(g).o(function(I){if(3<++d)S(I);else return lg(i).then(function(D){return D.close(),i.i=void 0,l(g,S)}).o(function(D){S(D)})})}var d=0;return new Me(l)}function cg(){try{return!!f.indexedDB}catch{return!1}}function tl(i){return i.objectStore("firebaseLocalStorage")}function nl(i,a){return i.transaction(["firebaseLocalStorage"],a?"readwrite":"readonly")}function ia(i){return new Me(function(a,l){i.onsuccess=function(d){d&&d.target?a(d.target.result):a()},i.onerror=function(d){l(d.target.error)}})}e=JS.prototype,e.set=function(i,a){var l=this,d=!1;return Mh(this,function(g){return g=tl(nl(g,!0)),ia(g.get(i))}).then(function(g){return Mh(l,function(S){if(S=tl(nl(S,!0)),g)return g.value=a,ia(S.put(g));l.b++,d=!0;var I={};return I.fbase_key=i,I.value=a,ia(S.add(I))})}).then(function(){return l.c[i]=a,e_(l,i)}).oa(function(){d&&l.b--})};function e_(i,a){return i.g&&i.h&&ND()===i.h?XS(i.g,"keyChanged",{key:a},i.s).then(function(){}).o(function(){}):ge()}e.get=function(i){return Mh(this,function(a){return ia(tl(nl(a,!1)).get(i))}).then(function(a){return a&&a.value})},e.U=function(i){var a=this,l=!1;return Mh(this,function(d){return l=!0,a.b++,ia(tl(nl(d,!0)).delete(i))}).then(function(){return delete a.c[i],e_(a,i)}).oa(function(){l&&a.b--})};function t_(i){return lg(i).then(function(a){var l=tl(nl(a,!1));return l.getAll?ia(l.getAll()):new Me(function(d,g){var S=[],I=l.openCursor();I.onsuccess=function(D){(D=D.target.result)?(S.push(D.value),D.continue()):d(S)},I.onerror=function(D){g(D.target.error)}})}).then(function(a){var l={},d=[];if(i.b==0){for(d=0;d<a.length;d++)l[a[d].fbase_key]=a[d].value;d=Eb(i.c,l),i.c=l}return d})}e.ca=function(i){this.a.length==0&&fR(this),this.a.push(i)},e.ia=function(i){Ze(this.a,function(a){return a==i}),this.a.length==0&&n_(this)};function fR(i){function a(){i.f=setTimeout(function(){i.l=t_(i).then(function(l){0<l.length&&xe(i.a,function(d){d(l)})}).then(function(){a()}).o(function(l){l.message!="STOP_EVENT"&&a()})},800)}n_(i),a()}function n_(i){i.l&&i.l.cancel("STOP_EVENT"),i.f&&(clearTimeout(i.f),i.f=null)}function r_(i){var a=this,l=null;this.a=[],this.type="indexedDB",this.c=i,this.b=ge().then(function(){if(cg()){var d=$o(),g="__sak"+d;return ug||(ug=new JS),l=ug,l.set(g,d).then(function(){return l.get(g)}).then(function(S){if(S!==d)throw Error("indexedDB not supported!");return l.U(g)}).then(function(){return l}).o(function(){return a.c})}return a.c}).then(function(d){return a.type=d.type,d.ca(function(g){xe(a.a,function(S){S(g)})}),d})}e=r_.prototype,e.get=function(i){return this.b.then(function(a){return a.get(i)})},e.set=function(i,a){return this.b.then(function(l){return l.set(i,a)})},e.U=function(i){return this.b.then(function(a){return a.U(i)})},e.ca=function(i){this.a.push(i)},e.ia=function(i){Ze(this.a,function(a){return a==i})};function rl(){this.a={},this.type="inMemory"}e=rl.prototype,e.get=function(i){return ge(this.a[i])},e.set=function(i,a){return this.a[i]=a,ge()},e.U=function(i){return delete this.a[i],ge()},e.ca=function(){},e.ia=function(){};function Rh(){if(!dR())throw Wr()=="Node"?new T("internal-error","The LocalStorage compatibility library was not found."):new T("web-storage-unsupported");this.a=i_()||de.INTERNAL.node.localStorage,this.type="localStorage"}function i_(){try{var i=f.localStorage,a=$o();return i&&(i.setItem(a,"1"),i.removeItem(a)),i}catch{return null}}function dR(){var i=Wr()=="Node";if(i=i_()||i&&de.INTERNAL.node&&de.INTERNAL.node.localStorage,!i)return!1;try{return i.setItem("__sak","1"),i.removeItem("__sak"),!0}catch{return!1}}e=Rh.prototype,e.get=function(i){var a=this;return ge().then(function(){var l=a.a.getItem(i);return ea(l)})},e.set=function(i,a){var l=this;return ge().then(function(){var d=Uu(a);d===null?l.U(i):l.a.setItem(i,d)})},e.U=function(i){var a=this;return ge().then(function(){a.a.removeItem(i)})},e.ca=function(i){f.window&&mr(f.window,"storage",i)},e.ia=function(i){f.window&&Wn(f.window,"storage",i)};function hg(){this.type="nullStorage"}e=hg.prototype,e.get=function(){return ge(null)},e.set=function(){return ge()},e.U=function(){return ge()},e.ca=function(){},e.ia=function(){};function fg(){if(!pR())throw Wr()=="Node"?new T("internal-error","The SessionStorage compatibility library was not found."):new T("web-storage-unsupported");this.a=o_()||de.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function o_(){try{var i=f.sessionStorage,a=$o();return i&&(i.setItem(a,"1"),i.removeItem(a)),i}catch{return null}}function pR(){var i=Wr()=="Node";if(i=o_()||i&&de.INTERNAL.node&&de.INTERNAL.node.sessionStorage,!i)return!1;try{return i.setItem("__sak","1"),i.removeItem("__sak"),!0}catch{return!1}}e=fg.prototype,e.get=function(i){var a=this;return ge().then(function(){var l=a.a.getItem(i);return ea(l)})},e.set=function(i,a){var l=this;return ge().then(function(){var d=Uu(a);d===null?l.U(i):l.a.setItem(i,d)})},e.U=function(i){var a=this;return ge().then(function(){a.a.removeItem(i)})},e.ca=function(){},e.ia=function(){};function mR(){var i={};i.Browser=gR,i.Node=vR,i.ReactNative=yR,i.Worker=wR,this.a=i[Wr()]}var dg,gR={F:Rh,cb:fg},vR={F:Rh,cb:fg},yR={F:KS,cb:hg},wR={F:Rh,cb:hg},oa={rd:"local",NONE:"none",td:"session"};function xR(i){var a=new T("invalid-persistence-type"),l=new T("unsupported-persistence-type");e:{for(d in oa)if(oa[d]==i){var d=!0;break e}d=!1}if(!d||typeof i!="string")throw a;switch(Wr()){case"ReactNative":if(i==="session")throw l;break;case"Node":if(i!=="none")throw l;break;case"Worker":if(i==="session"||!cg()&&i!=="none")throw l;break;default:if(!dm()&&i!=="none")throw l}}function s_(){var i=!!(!Db(Jt())&&hm()),a=Pu(),l=dm();this.m=i,this.h=a,this.l=l,this.a={},dg||(dg=new mR),i=dg;try{this.g=!lm()&&Rb()||!f.indexedDB?new i.a.F:new r_(kr()?new rl:new i.a.F)}catch{this.g=new rl,this.h=!0}try{this.i=new i.a.cb}catch{this.i=new rl}this.v=new rl,this.f=x(this.Zb,this),this.b={}}var pg;function il(){return pg||(pg=new s_),pg}function Wo(i,a){switch(a){case"session":return i.i;case"none":return i.v;default:return i.g}}function sa(i,a){return"firebase:"+i.name+(a?":"+a:"")}function bR(i,a,l){var d=sa(a,l),g=Wo(i,a.F);return i.get(a,l).then(function(S){var I=null;try{I=ea(f.localStorage.getItem(d))}catch{}if(I&&!S)return f.localStorage.removeItem(d),i.set(a,I,l);I&&S&&g.type!="localStorage"&&f.localStorage.removeItem(d)})}e=s_.prototype,e.get=function(i,a){return Wo(this,i.F).get(sa(i,a))};function aa(i,a,l){return l=sa(a,l),a.F=="local"&&(i.b[l]=null),Wo(i,a.F).U(l)}e.set=function(i,a,l){var d=sa(i,l),g=this,S=Wo(this,i.F);return S.set(d,a).then(function(){return S.get(d)}).then(function(I){i.F=="local"&&(g.b[d]=I)})},e.addListener=function(i,a,l){i=sa(i,a),this.l&&(this.b[i]=f.localStorage.getItem(i)),Mn(this.a)&&(Wo(this,"local").ca(this.f),this.h||(lm()||!Rb())&&f.indexedDB||!this.l||SR(this)),this.a[i]||(this.a[i]=[]),this.a[i].push(l)},e.removeListener=function(i,a,l){i=sa(i,a),this.a[i]&&(Ze(this.a[i],function(d){return d==l}),this.a[i].length==0&&delete this.a[i]),Mn(this.a)&&(Wo(this,"local").ia(this.f),mg(this))};function SR(i){mg(i),i.c=setInterval(function(){for(var a in i.a){var l=f.localStorage.getItem(a),d=i.b[a];l!=d&&(i.b[a]=l,l=new Oo({type:"storage",key:a,target:window,oldValue:d,newValue:l,a:!0}),i.Zb(l))}},1e3)}function mg(i){i.c&&(clearInterval(i.c),i.c=null)}e.Zb=function(i){if(i&&i.g){var a=i.a.key;if(a==null)for(var l in this.a){var d=this.b[l];typeof d>"u"&&(d=null);var g=f.localStorage.getItem(l);g!==d&&(this.b[l]=g,this.nb(l))}else if(a.indexOf("firebase:")==0&&this.a[a]){if(typeof i.a.a<"u"?Wo(this,"local").ia(this.f):mg(this),this.m){if(l=f.localStorage.getItem(a),d=i.a.newValue,d!==l)d!==null?f.localStorage.setItem(a,d):f.localStorage.removeItem(a);else if(this.b[a]===d&&typeof i.a.a>"u")return}var S=this;l=function(){(typeof i.a.a<"u"||S.b[a]!==f.localStorage.getItem(a))&&(S.b[a]=f.localStorage.getItem(a),S.nb(a))},jr&&Ui&&Ui==10&&f.localStorage.getItem(a)!==i.a.newValue&&i.a.newValue!==i.a.oldValue?setTimeout(l,10):l()}}else xe(i,x(this.nb,this))},e.nb=function(i){this.a[i]&&xe(this.a[i],function(a){a()})};function _R(i){this.a=i,this.b=il()}var gg={name:"authEvent",F:"local"};function NR(i){return i.b.get(gg,i.a).then(function(a){return dS(a)})}function ER(){this.a=il()}function IR(){this.b=-1}function Oh(i,a){this.b=a_,this.f=f.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=i,this.h=a,this.l=f.Int32Array?new Int32Array(64):Array(64),Lh===void 0&&(f.Int32Array?Lh=new Int32Array(c_):Lh=c_),this.reset()}var Lh;k(Oh,IR);for(var a_=64,TR=a_-1,u_=[],vg=0;vg<TR;vg++)u_[vg]=0;var l_=at(128,u_);Oh.prototype.reset=function(){this.g=this.c=0,this.a=f.Int32Array?new Int32Array(this.h):dt(this.h)};function yg(i){for(var a=i.f,l=i.l,d=0,g=0;g<a.length;)l[d++]=a[g]<<24|a[g+1]<<16|a[g+2]<<8|a[g+3],g=4*d;for(a=16;64>a;a++){g=l[a-15]|0,d=l[a-2]|0;var S=(l[a-16]|0)+((g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3)|0,I=(l[a-7]|0)+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;l[a]=S+I|0}d=i.a[0]|0,g=i.a[1]|0;var D=i.a[2]|0,B=i.a[3]|0,G=i.a[4]|0,Ee=i.a[5]|0,Qe=i.a[6]|0;for(S=i.a[7]|0,a=0;64>a;a++){var qe=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&g^d&D^g&D)|0;I=G&Ee^~G&Qe,S=S+((G>>>6|G<<26)^(G>>>11|G<<21)^(G>>>25|G<<7))|0,I=I+(Lh[a]|0)|0,I=S+(I+(l[a]|0)|0)|0,S=Qe,Qe=Ee,Ee=G,G=B+I|0,B=D,D=g,g=d,d=I+qe|0}i.a[0]=i.a[0]+d|0,i.a[1]=i.a[1]+g|0,i.a[2]=i.a[2]+D|0,i.a[3]=i.a[3]+B|0,i.a[4]=i.a[4]+G|0,i.a[5]=i.a[5]+Ee|0,i.a[6]=i.a[6]+Qe|0,i.a[7]=i.a[7]+S|0}function wg(i,a,l){l===void 0&&(l=a.length);var d=0,g=i.c;if(typeof a=="string")for(;d<l;)i.f[g++]=a.charCodeAt(d++),g==i.b&&(yg(i),g=0);else if(E(a))for(;d<l;){var S=a[d++];if(!(typeof S=="number"&&0<=S&&255>=S&&S==(S|0)))throw Error("message must be a byte array");i.f[g++]=S,g==i.b&&(yg(i),g=0)}else throw Error("message must be string or array");i.c=g,i.g+=l}var c_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function h_(){Oh.call(this,8,jR)}k(h_,Oh);var jR=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function f_(i,a,l,d,g,S){this.v=i,this.i=a,this.l=l,this.m=d||null,this.u=g||null,this.s=S,this.h=a+":"+l,this.C=new ER,this.g=new _R(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ph(i){return new T("invalid-cordova-configuration",i)}e=f_.prototype,e.ma=function(){return this.Ia?this.Ia:this.Ia=bD().then(function(){if(typeof lt("universalLinks.subscribe",f)!="function")throw Ph("cordova-universal-links-plugin-fix is not installed");if(typeof lt("BuildInfo.packageName",f)>"u")throw Ph("cordova-plugin-buildinfo is not installed");if(typeof lt("cordova.plugins.browsertab.openUrl",f)!="function")throw Ph("cordova-plugin-browsertab is not installed");if(typeof lt("cordova.InAppBrowser.open",f)!="function")throw Ph("cordova-plugin-inappbrowser is not installed")},function(){throw new T("cordova-not-ready")})};function kR(){for(var i=20,a=[];0<i;)a.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),i--;return a.join("")}function CR(i){var a=new h_;wg(a,i),i=[];var l=8*a.g;56>a.c?wg(a,l_,56-a.c):wg(a,l_,a.b-(a.c-56));for(var d=63;56<=d;d--)a.f[d]=l&255,l/=256;for(yg(a),d=l=0;d<a.i;d++)for(var g=24;0<=g;g-=8)i[l++]=a.a[d]>>g&255;return VD(i)}e.Pb=function(i,a){return a(new T("operation-not-supported-in-this-environment")),ge()},e.Nb=function(){return ut(new T("operation-not-supported-in-this-environment"))},e.ac=function(){return!1},e.Yb=function(){return!0},e.Ub=function(){return!0},e.Ob=function(i,a,l,d){if(this.c)return ut(new T("redirect-operation-pending"));var g=this,S=f.document,I=null,D=null,B=null,G=null;return this.c=ge().then(function(){return Om(a),p_(g)}).then(function(){return AR(g,i,a,l,d)}).then(function(){return new Me(function(Ee,Qe){D=function(){var qe=lt("cordova.plugins.browsertab.close",f);return Ee(),typeof qe=="function"&&qe(),g.a&&typeof g.a.close=="function"&&(g.a.close(),g.a=null),!1},g.Ea(D),B=function(){I||(I=Ws(2e3).then(function(){Qe(new T("redirect-cancelled-by-user"))}))},G=function(){pm()&&B()},S.addEventListener("resume",B,!1),Jt().toLowerCase().match(/android/)||S.addEventListener("visibilitychange",G,!1)}).o(function(Ee){return xg(g).then(function(){throw Ee})})}).oa(function(){B&&S.removeEventListener("resume",B,!1),G&&S.removeEventListener("visibilitychange",G,!1),I&&I.cancel(),D&&g.Ta(D),g.c=null})};function AR(i,a,l,d,g){var S=kR(),I=new Cr(a,d,null,S,new T("no-auth-event"),null,g),D=lt("BuildInfo.packageName",f);if(typeof D!="string")throw new T("invalid-cordova-configuration");var B=lt("BuildInfo.displayName",f),G={};if(Jt().toLowerCase().match(/iphone|ipad|ipod/))G.ibi=D;else if(Jt().toLowerCase().match(/android/))G.apn=D;else return ut(new T("operation-not-supported-in-this-environment"));B&&(G.appDisplayName=B),S=CR(S),G.sessionId=S;var Ee=el(i.v,i.i,i.l,a,l,null,d,i.m,G,i.u,g,i.s);return i.ma().then(function(){var Qe=i.h;return i.C.a.set(gg,I.w(),Qe)}).then(function(){var Qe=lt("cordova.plugins.browsertab.isAvailable",f);if(typeof Qe!="function")throw new T("invalid-cordova-configuration");var qe=null;Qe(function(Ht){if(Ht){if(qe=lt("cordova.plugins.browsertab.openUrl",f),typeof qe!="function")throw new T("invalid-cordova-configuration");qe(Ee)}else{if(qe=lt("cordova.InAppBrowser.open",f),typeof qe!="function")throw new T("invalid-cordova-configuration");Ht=Jt(),i.a=qe(Ee,Ht.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||Ht.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}function d_(i,a){for(var l=0;l<i.b.length;l++)try{i.b[l](a)}catch{}}function p_(i){return i.f||(i.f=i.ma().then(function(){return new Me(function(a){function l(d){return a(d),i.Ta(l),!1}i.Ea(l),DR(i)})})),i.f}function xg(i){var a=null;return NR(i.g).then(function(l){return a=l,l=i.g,aa(l.b,gg,l.a)}).then(function(){return a})}function DR(i){function a(I){d=!0,g&&g.cancel(),xg(i).then(function(D){var B=l;if(D&&I&&I.url){var G=null;B=oS(I.url),B.indexOf("/__/auth/callback")!=-1&&(G=On(B),G=ea(gr(G,"firebaseError")||null),G=(G=typeof G=="object"?L(G):null)?new Cr(D.c,D.b,null,null,G,null,D.T()):new Cr(D.c,D.b,B,D.f,null,null,D.T())),B=G||l}d_(i,B)})}var l=new Cr("unknown",null,null,null,new T("no-auth-event")),d=!1,g=Ws(500).then(function(){return xg(i).then(function(){d||d_(i,l)})}),S=f.handleOpenURL;f.handleOpenURL=function(I){if(I.toLowerCase().indexOf(lt("BuildInfo.packageName",f).toLowerCase()+"://")==0&&a({url:I}),typeof S=="function")try{S(I)}catch(D){console.error(D)}},Lm||(Lm=new YD),QD(a)}e.Ea=function(i){this.b.push(i),p_(this).o(function(a){a.code==="auth/invalid-cordova-configuration"&&(a=new Cr("unknown",null,null,null,new T("no-auth-event")),i(a))})},e.Ta=function(i){Ze(this.b,function(a){return a==i})};function MR(i){this.a=i,this.b=il()}var bg={name:"pendingRedirect",F:"session"};function RR(i){return i.b.set(bg,"pending",i.a)}function Sg(i){return aa(i.b,bg,i.a)}function OR(i){return i.b.get(bg,i.a).then(function(a){return a=="pending"})}function Uh(i,a,l,d){this.i={},this.u=0,this.D=i,this.v=a,this.m=l,this.J=d,this.h=[],this.f=!1,this.l=x(this.s,this),this.b=new $h,this.C=new N_,this.g=new MR(b_(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=m_(this.D,this.v,this.m,R,this.J)}function m_(i,a,l,d,g){var S=de.SDK_VERSION||null;return cm()?new f_(i,a,l,S,d,g):new VS(i,a,l,S,d,g)}Uh.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=m_(this.D,this.v,this.m,null,this.J),this.i={}};function g_(i){i.f||(i.f=!0,i.a.Ea(i.l));var a=i.a;return i.a.ma().o(function(l){throw i.a==a&&i.reset(),l})}function v_(i){i.a.Yb()&&g_(i).o(function(a){var l=new Cr("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Ng(a)&&i.s(l)}),i.a.Ub()||S_(i.b)}function Fh(i,a){Ce(i.h,a)||i.h.push(a),i.f||OR(i.g).then(function(l){l?Sg(i.g).then(function(){g_(i).o(function(d){var g=new Cr("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Ng(d)&&i.s(g)})}):v_(i)}).o(function(){v_(i)})}function _g(i,a){Ze(i.h,function(l){return l==a})}Uh.prototype.s=function(i){if(!i)throw new T("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),i&&i.getUid()&&this.i.hasOwnProperty(i.getUid()))return!1;for(var a=!1,l=0;l<this.h.length;l++){var d=this.h[l];if(d.Gb(i.c,i.b)){(a=this.c[i.c])&&(a.h(i,d),i&&(i.f||i.b)&&(this.i[i.getUid()]=!0,this.u=Date.now())),a=!0;break}}return S_(this.b),a};var LR=new Vi(2e3,1e4),PR=new Vi(3e4,6e4);Uh.prototype.ra=function(){return this.b.ra()};function y_(i,a,l,d,g,S,I){return i.a.Nb(a,l,d,function(){i.f||(i.f=!0,i.a.Ea(i.l))},function(){i.reset()},g,S,I)}function Ng(i){return!!(i&&i.code=="auth/cordova-not-ready")}function w_(i,a,l,d,g){var S;return RR(i.g).then(function(){return i.a.Ob(a,l,d,g).o(function(I){if(Ng(I))throw new T("operation-not-supported-in-this-environment");return S=I,Sg(i.g).then(function(){throw S})}).then(function(){return i.a.ac()?new Me(function(){}):Sg(i.g).then(function(){return i.ra()}).then(function(){}).o(function(){})})})}function x_(i,a,l,d,g){return i.a.Pb(d,function(S){a.na(l,null,S,g)},LR.get())}var Eg={};function b_(i,a,l){return i=i+":"+a,l&&(i=i+":"+l.url),i}function Ig(i,a,l,d){var g=b_(a,l,d);return Eg[g]||(Eg[g]=new Uh(i,a,l,d)),Eg[g]}function $h(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}$h.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},$h.prototype.h=function(i,a){if(i){this.reset(),this.g=!0;var l=i.c,d=i.b,g=i.a&&i.a.code=="auth/web-storage-unsupported",S=i.a&&i.a.code=="auth/operation-not-supported-in-this-environment";this.i=!(!g&&!S),l!="unknown"||g||S?i.a?(Yo(this,!0,null,i.a),ge()):a.Fa(l,d)?UR(this,i,a):ut(new T("invalid-auth-event")):(Yo(this,!1,null,null),ge())}else ut(new T("invalid-auth-event"))};function S_(i){i.g||(i.g=!0,Yo(i,!1,null,null))}function Vh(i){i.g&&!i.i&&Yo(i,!1,null,null)}function UR(i,a,l){l=l.Fa(a.c,a.b);var d=a.g,g=a.f,S=a.i,I=a.T(),D=!!a.c.match(/Redirect$/);l(d,g,I,S).then(function(B){Yo(i,D,B,null)}).o(function(B){Yo(i,D,null,B)})}function FR(i,a){if(i.b=function(){return ut(a)},i.c.length)for(var l=0;l<i.c.length;l++)i.c[l](a)}function __(i,a){if(i.b=function(){return ge(a)},i.f.length)for(var l=0;l<i.f.length;l++)i.f[l](a)}function Yo(i,a,l,d){a?d?FR(i,d):__(i,l):__(i,{user:null}),i.f=[],i.c=[]}$h.prototype.ra=function(){var i=this;return new Me(function(a,l){i.b?i.b().then(a,l):(i.f.push(a),i.c.push(l),$R(i))})};function $R(i){var a=new T("timeout");i.a&&i.a.cancel(),i.a=Ws(PR.get()).then(function(){i.b||(i.g=!0,Yo(i,!0,null,a))})}function N_(){}N_.prototype.h=function(i,a){if(i){var l=i.c,d=i.b;i.a?(a.na(i.c,null,i.a,i.b),ge()):a.Fa(l,d)?VR(i,a):ut(new T("invalid-auth-event"))}else ut(new T("invalid-auth-event"))};function VR(i,a){var l=i.b,d=i.c;a.Fa(d,l)(i.g,i.f,i.T(),i.i).then(function(g){a.na(d,g,null,l)}).o(function(g){a.na(d,null,g,l)})}function E_(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(i){this.jb=i},enumerable:!1})}function Tg(i,a){this.a=a,fe(this,"verificationId",i)}Tg.prototype.confirm=function(i){return i=fS(this.verificationId,i),this.a(i)};function jg(i,a,l,d){return new mi(i).gb(a,l).then(function(g){return new Tg(g,d)})}function BR(i){var a=Xb(i);if(!(a&&a.exp&&a.auth_time&&a.iat))throw new T("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Sn(this,{token:i,expirationTime:Fu(1e3*a.exp),authTime:Fu(1e3*a.auth_time),issuedAtTime:Fu(1e3*a.iat),signInProvider:a.firebase&&a.firebase.sign_in_provider?a.firebase.sign_in_provider:null,signInSecondFactor:a.firebase&&a.firebase.sign_in_second_factor?a.firebase.sign_in_second_factor:null,claims:a})}function kg(i,a,l){var d=a&&a[T_];if(!d)throw new T("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=i,this.f=fr(a),this.g=l,this.c=new gh(null,d),this.b=[];var g=this;xe(a[I_]||[],function(S){(S=xm(S))&&g.b.push(S)}),fe(this,"auth",this.a),fe(this,"session",this.c),fe(this,"hints",this.b)}var I_="mfaInfo",T_="mfaPendingCredential";kg.prototype.Rc=function(i){var a=this;return i.tb(this.a.a,this.c).then(function(l){var d=fr(a.f);return delete d[I_],delete d[T_],Xt(d,l),a.g(d)})};function Cg(i,a,l,d){T.call(this,"multi-factor-auth-required",d,a),this.b=new kg(i,a,l),fe(this,"resolver",this.b)}k(Cg,T);function j_(i,a,l){if(i&&C(i.serverResponse)&&i.code==="auth/multi-factor-auth-required")try{return new Cg(a,i.serverResponse,l,i.message)}catch{}return null}function k_(){}k_.prototype.tb=function(i,a,l){return a.type==zu?zR(this,i,a,l):qR(this,i,a)};function zR(i,a,l,d){return l.Ha().then(function(g){return g={idToken:g},typeof d<"u"&&(g.displayName=d),Xt(g,{phoneVerificationInfo:qu(i.a)}),Le(a,DM,g)})}function qR(i,a,l){return l.Ha().then(function(d){return d={mfaPendingCredential:d},Xt(d,{phoneVerificationInfo:qu(i.a)}),Le(a,MM,d)})}function Ag(i){fe(this,"factorId",i.fa),this.a=i}k(Ag,k_);function C_(i){if(Ag.call(this,i),this.a.fa!=mi.PROVIDER_ID)throw new T("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}k(C_,Ag);function ua(i,a){Rn.call(this,i);for(var l in a)this[l]=a[l]}k(ua,Rn);function Dg(i,a){this.a=i,this.b=[],this.c=x(this.yc,this),mr(this.a,"userReloaded",this.c);var l=[];a&&a.multiFactor&&a.multiFactor.enrolledFactors&&xe(a.multiFactor.enrolledFactors,function(d){var g=null,S={};if(d){d.uid&&(S[Sm]=d.uid),d.displayName&&(S[Lb]=d.displayName),d.enrollmentTime&&(S[bm]=new Date(d.enrollmentTime).toISOString()),d.phoneNumber&&(S[_m]=d.phoneNumber);try{g=new $u(S)}catch{}d=g}else d=null;d&&l.push(d)}),Bh(this,l)}function KR(i){var a=[];return xe(i.mfaInfo||[],function(l){(l=xm(l))&&a.push(l)}),a}e=Dg.prototype,e.yc=function(i){Bh(this,KR(i.hd))};function Bh(i,a){i.b=a,fe(i,"enrolledFactors",a)}e.Sb=function(){return this.a.I().then(function(i){return new gh(i,null)})},e.fc=function(i,a){var l=this,d=this.a.a;return this.Sb().then(function(g){return i.tb(d,g,a)}).then(function(g){return Xr(l.a,g),l.a.reload()})},e.bd=function(i){var a=this,l=typeof i=="string"?i:i.uid,d=this.a.a;return this.a.I().then(function(g){return Le(d,ZM,{idToken:g,mfaEnrollmentId:l})}).then(function(g){var S=re(a.b,function(I){return I.uid!=l});return Bh(a,S),Xr(a.a,g),a.a.reload().o(function(I){if(I.code!="auth/user-token-expired")throw I})})},e.w=function(){return{multiFactor:{enrolledFactors:je(this.b,function(i){return i.w()})}}};function Mg(i,a,l){if(this.h=i,this.i=a,this.g=l,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}Mg.prototype.start=function(){this.a=this.c,Rg(this,!0)};function HR(i,a){return a?(i.a=i.c,i.g()):(a=i.a,i.a*=2,i.a>i.f&&(i.a=i.f),a)}function Rg(i,a){i.stop(),i.b=Ws(HR(i,a)).then(function(){return _D()}).then(function(){return i.h()}).then(function(){Rg(i,!0)}).o(function(l){i.i(l)&&Rg(i,!1)})}Mg.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)};function Og(i){this.f=i,this.b=this.a=null,this.c=Date.now()}Og.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}};function A_(i,a){typeof a>"u"&&(i.b?(a=i.b,a=a.a-a.g):a=0),i.c=Date.now()+1e3*a}function D_(i,a){i.b=ph(a[Dr]||""),i.a=a.refreshToken,a=a.expiresIn,A_(i,typeof a<"u"?Number(a):void 0)}function GR(i,a){i.b=a.b,i.a=a.a,i.c=a.c}function WR(i,a){return gM(i.f,a).then(function(l){return i.b=ph(l.access_token),i.a=l.refresh_token,A_(i,l.expires_in),{accessToken:i.b.toString(),refreshToken:i.a}}).o(function(l){throw l.code=="auth/user-token-expired"&&(i.a=null),l})}Og.prototype.getToken=function(i){return i=!!i,this.b&&!this.a?ut(new T("user-token-expired")):i||!this.b||Date.now()>this.c-3e4?this.a?WR(this,{grant_type:"refresh_token",refresh_token:this.a}):ge(null):ge({accessToken:this.b.toString(),refreshToken:this.a})};function zh(i,a){this.a=i||null,this.b=a||null,Sn(this,{lastSignInTime:Fu(a||null),creationTime:Fu(i||null)})}function YR(i){return new zh(i.a,i.b)}zh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}};function QR(i,a,l,d,g,S){Sn(this,{uid:i,displayName:d||null,photoURL:g||null,email:l||null,phoneNumber:S||null,providerId:a})}function Qn(i,a,l){this.N=[],this.l=i.apiKey,this.m=i.appName,this.s=i.authDomain||null;var d=de.SDK_VERSION?Js(de.SDK_VERSION):null;this.a=new Ar(this.l,O(R),d),(this.u=i.emulatorConfig||null)&&Ah(this.a,this.u),this.h=new Og(this.a),Bg(this,a[Dr]),D_(this.h,a),fe(this,"refreshToken",this.h.a),R_(this,l||{}),bn.call(this),this.P=!1,this.s&&Fo()&&(this.b=Ig(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=XR(this),this.ba=x(this.ib,this);var g=this;this.za=null,this.Pa=function(S){g.xa(S.h)},this.qa=null,this.Ba=function(S){Lg(g,S.c)},this.$=null,this.aa=[],this.Oa=function(S){ol(g,S.f)},this.ja=null,this.S=new Dg(this,l),fe(this,"multiFactor",this.S)}k(Qn,bn),Qn.prototype.xa=function(i){this.za=i,jS(this.a,i)};function Lg(i,a){i.u=a,Ah(i.a,a),i.b&&(a=i.b,i.b=Ig(i.s,i.l,i.m,i.u),i.P&&(_g(a,i),Fh(i.b,i)))}Qn.prototype.la=function(){return this.za};function Pg(i,a){i.qa&&Wn(i.qa,"languageCodeChanged",i.Pa),(i.qa=a)&&mr(a,"languageCodeChanged",i.Pa)}function Ug(i,a){i.$&&Wn(i.$,"emulatorConfigChanged",i.Ba),(i.$=a)&&mr(a,"emulatorConfigChanged",i.Ba)}function ol(i,a){i.aa=a,kS(i.a,de.SDK_VERSION?Js(de.SDK_VERSION,i.aa):null)}Qn.prototype.Ga=function(){return dt(this.aa)};function Fg(i,a){i.ja&&Wn(i.ja,"frameworkChanged",i.Oa),(i.ja=a)&&mr(a,"frameworkChanged",i.Oa)}Qn.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())};function $g(i){try{return de.app(i.m).auth()}catch{throw new T("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+i.m+"'!")}}function XR(i){return new Mg(function(){return i.I(!0)},function(a){return!!(a&&a.code=="auth/network-request-failed")},function(){var a=i.h.c-Date.now()-3e5;return 0<a?a:0})}function M_(i){i.J||i.D.b||(i.D.start(),Wn(i,"tokenChanged",i.ba),mr(i,"tokenChanged",i.ba))}function Vg(i){Wn(i,"tokenChanged",i.ba),i.D.stop()}function Bg(i,a){i.Aa=a,fe(i,"_lat",a)}function JR(i,a){Ze(i.W,function(l){return l==a})}function Qo(i){for(var a=[],l=0;l<i.W.length;l++)a.push(i.W[l](i));return Xx(a).then(function(){return i})}function sl(i){i.b&&!i.P&&(i.P=!0,Fh(i.b,i))}function R_(i,a){Sn(i,{uid:a.uid,displayName:a.displayName||null,photoURL:a.photoURL||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,isAnonymous:a.isAnonymous||!1,tenantId:a.tenantId||null,metadata:new zh(a.createdAt,a.lastLoginAt),providerData:[]}),i.a.b=i.tenantId}fe(Qn.prototype,"providerId","firebase");function O_(){}function zg(i){return ge().then(function(){if(i.J)throw new T("app-deleted")})}function qg(i){return je(i.providerData,function(a){return a.providerId})}function Kg(i,a){a&&(L_(i,a.providerId),i.providerData.push(a))}function L_(i,a){Ze(i.providerData,function(l){return l.providerId==a})}function qi(i,a,l){(a!="uid"||l)&&i.hasOwnProperty(a)&&fe(i,a,l)}function qh(i,a){i!=a&&(Sn(i,{uid:a.uid,displayName:a.displayName,photoURL:a.photoURL,email:a.email,emailVerified:a.emailVerified,phoneNumber:a.phoneNumber,isAnonymous:a.isAnonymous,tenantId:a.tenantId,providerData:[]}),a.metadata?fe(i,"metadata",YR(a.metadata)):fe(i,"metadata",new zh),xe(a.providerData,function(l){Kg(i,l)}),GR(i.h,a.h),fe(i,"refreshToken",i.h.a),Bh(i.S,a.S.b))}e=Qn.prototype,e.reload=function(){var i=this;return Ft(this,zg(this).then(function(){return Hg(i).then(function(){return Qo(i)}).then(O_)}))};function Hg(i){return i.I().then(function(a){var l=i.isAnonymous;return ZR(i,a).then(function(){return l||qi(i,"isAnonymous",!1),a})})}e.oc=function(i){return this.I(i).then(function(a){return new BR(a)})},e.I=function(i){var a=this;return Ft(this,zg(this).then(function(){return a.h.getToken(i)}).then(function(l){if(!l)throw new T("internal-error");return l.accessToken!=a.Aa&&(Bg(a,l.accessToken),a.dispatchEvent(new ua("tokenChanged"))),qi(a,"refreshToken",l.refreshToken),l.accessToken}))};function Xr(i,a){a[Dr]&&i.Aa!=a[Dr]&&(D_(i.h,a),i.dispatchEvent(new ua("tokenChanged")),Bg(i,a[Dr]),qi(i,"refreshToken",i.h.a))}function ZR(i,a){return Le(i.a,RM,{idToken:a}).then(x(i.Kc,i))}e.Kc=function(i){if(i=i.users,!i||!i.length)throw new T("internal-error");i=i[0],R_(this,{uid:i.localId,displayName:i.displayName,photoURL:i.photoUrl,email:i.email,emailVerified:!!i.emailVerified,phoneNumber:i.phoneNumber,lastLoginAt:i.lastLoginAt,createdAt:i.createdAt,tenantId:i.tenantId});for(var a=eO(i),l=0;l<a.length;l++)Kg(this,a[l]);qi(this,"isAnonymous",!(this.email&&i.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new ua("userReloaded",{hd:i}))};function eO(i){return(i=i.providerUserInfo)&&i.length?je(i,function(a){return new QR(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl,a.phoneNumber)}):[]}e.Lc=function(i){return mm("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(i)},e.ub=function(i){var a=this,l=null;return Ft(this,i.c(this.a,this.uid).then(function(d){return Xr(a,d),l=al(a,d,"reauthenticate"),a.i=null,a.reload()}).then(function(){return l}),!0)};function Kh(i,a){return Hg(i).then(function(){if(Ce(qg(i),a))return Qo(i).then(function(){throw new T("provider-already-linked")})})}e.Cc=function(i){return mm("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(i)},e.rb=function(i){var a=this,l=null;return Ft(this,Kh(this,i.providerId).then(function(){return a.I()}).then(function(d){return i.b(a.a,d)}).then(function(d){return l=al(a,d,"link"),P_(a,d)}).then(function(){return l}))},e.Dc=function(i,a){var l=this;return Ft(this,Kh(this,"phone").then(function(){return jg($g(l),i,a,x(l.rb,l))}))},e.Mc=function(i,a){var l=this;return Ft(this,ge().then(function(){return jg($g(l),i,a,x(l.ub,l))}),!0)};function al(i,a,l){var d=Rm(a);return a=Zb(a),Yr({user:i,credential:d,additionalUserInfo:a,operationType:l})}function P_(i,a){return Xr(i,a),i.reload().then(function(){return i})}e.Cb=function(i){var a=this;return Ft(this,this.I().then(function(l){return a.a.Cb(l,i)}).then(function(l){return Xr(a,l),a.reload()}))},e.ed=function(i){var a=this;return Ft(this,this.I().then(function(l){return i.b(a.a,l)}).then(function(l){return Xr(a,l),a.reload()}))},e.Db=function(i){var a=this;return Ft(this,this.I().then(function(l){return a.a.Db(l,i)}).then(function(l){return Xr(a,l),a.reload()}))},e.Eb=function(i){if(i.displayName===void 0&&i.photoURL===void 0)return zg(this);var a=this;return Ft(this,this.I().then(function(l){return a.a.Eb(l,{displayName:i.displayName,photoUrl:i.photoURL})}).then(function(l){return Xr(a,l),qi(a,"displayName",l.displayName||null),qi(a,"photoURL",l.photoUrl||null),xe(a.providerData,function(d){d.providerId==="password"&&(fe(d,"displayName",a.displayName),fe(d,"photoURL",a.photoURL))}),Qo(a)}).then(O_))},e.cd=function(i){var a=this;return Ft(this,Hg(this).then(function(l){return Ce(qg(a),i)?_M(a.a,l,[i]).then(function(d){var g={};return xe(d.providerUserInfo||[],function(S){g[S.providerId]=!0}),xe(qg(a),function(S){g[S]||L_(a,S)}),g[mi.PROVIDER_ID]||fe(a,"phoneNumber",null),Qo(a)}):Qo(a).then(function(){throw new T("no-such-provider")})}))},e.delete=function(){var i=this;return Ft(this,this.I().then(function(a){return Le(i.a,jM,{idToken:a})}).then(function(){i.dispatchEvent(new ua("userDeleted"))})).then(function(){for(var a=0;a<i.N.length;a++)i.N[a].cancel("app-deleted");Pg(i,null),Ug(i,null),Fg(i,null),i.N=[],i.J=!0,Vg(i),fe(i,"refreshToken",null),i.b&&_g(i.b,i)})},e.Gb=function(i,a){return!!(i=="linkViaPopup"&&(this.g||null)==a&&this.f||i=="reauthViaPopup"&&(this.g||null)==a&&this.f||i=="linkViaRedirect"&&(this.ga||null)==a||i=="reauthViaRedirect"&&(this.ga||null)==a)},e.na=function(i,a,l,d){i!="linkViaPopup"&&i!="reauthViaPopup"||d!=(this.g||null)||(l&&this.C?this.C(l):a&&!l&&this.f&&this.f(a),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(i,a){return i=="linkViaPopup"&&a==(this.g||null)?x(this.Lb,this):i=="reauthViaPopup"&&a==(this.g||null)?x(this.Mb,this):i=="linkViaRedirect"&&(this.ga||null)==a?x(this.Lb,this):i=="reauthViaRedirect"&&(this.ga||null)==a?x(this.Mb,this):null},e.Ec=function(i){var a=this;return U_(this,"linkViaPopup",i,function(){return Kh(a,i.providerId).then(function(){return Qo(a)})},!1)},e.Nc=function(i){return U_(this,"reauthViaPopup",i,function(){return ge()},!0)};function U_(i,a,l,d,g){if(!Fo())return ut(new T("operation-not-supported-in-this-environment"));if(i.i&&!g)return ut(i.i);var S=jm(l.providerId),I=$o(i.uid+":::"),D=null;(!Pu()||hm())&&i.s&&l.isOAuthProvider&&(D=el(i.s,i.l,i.m,a,l,null,I,de.SDK_VERSION||null,null,null,i.tenantId,i.u));var B=Tb(D,S&&S.va,S&&S.ua);return d=d().then(function(){if($_(i),!g)return i.I().then(function(){})}).then(function(){return y_(i.b,B,a,l,I,!!D,i.tenantId)}).then(function(){return new Me(function(G,Ee){i.na(a,null,new T("cancelled-popup-request"),i.g||null),i.f=G,i.C=Ee,i.g=I,i.c=x_(i.b,i,a,B,I)})}).then(function(G){return B&&Uo(B),G?Yr(G):null}).o(function(G){throw B&&Uo(B),G}),Ft(i,d,g)}e.Fc=function(i){var a=this;return F_(this,"linkViaRedirect",i,function(){return Kh(a,i.providerId)},!1)},e.Oc=function(i){return F_(this,"reauthViaRedirect",i,function(){return ge()},!0)};function F_(i,a,l,d,g){if(!Fo())return ut(new T("operation-not-supported-in-this-environment"));if(i.i&&!g)return ut(i.i);var S=null,I=$o(i.uid+":::");return d=d().then(function(){if($_(i),!g)return i.I().then(function(){})}).then(function(){return i.ga=I,Qo(i)}).then(function(D){return i.ha&&(D=i.ha,D=D.b.set(Gg,i.w(),D.a)),D}).then(function(){return w_(i.b,a,l,I,i.tenantId)}).o(function(D){if(S=D,i.ha)return B_(i.ha);throw S}).then(function(){if(S)throw S}),Ft(i,d,g)}function $_(i){if(!i.b||!i.P)throw i.b&&!i.P?new T("internal-error"):new T("auth-domain-config-required")}e.Lb=function(i,a,l,d){var g=this;this.c&&(this.c.cancel(),this.c=null);var S=null;return l=this.I().then(function(I){return tg(g.a,{requestUri:i,postBody:d,sessionId:a,idToken:I})}).then(function(I){return S=al(g,I,"link"),P_(g,I)}).then(function(){return S}),Ft(this,l)},e.Mb=function(i,a,l,d){var g=this;this.c&&(this.c.cancel(),this.c=null);var S=null,I=ge().then(function(){return na(ng(g.a,{requestUri:i,sessionId:a,postBody:d,tenantId:l}),g.uid)}).then(function(D){return S=al(g,D,"reauthenticate"),Xr(g,D),g.i=null,g.reload()}).then(function(){return S});return Ft(this,I,!0)},e.vb=function(i){var a=this,l=null;return Ft(this,this.I().then(function(d){return l=d,typeof i>"u"||Mn(i)?{}:fh(new hh(i))}).then(function(d){return a.a.vb(l,d)}).then(function(d){if(a.email!=d)return a.reload()}).then(function(){}))},e.Fb=function(i,a){var l=this,d=null;return Ft(this,this.I().then(function(g){return d=g,typeof a>"u"||Mn(a)?{}:fh(new hh(a))}).then(function(g){return l.a.Fb(d,i,g)}).then(function(g){if(l.email!=g)return l.reload()}).then(function(){}))};function Ft(i,a,l){var d=tO(i,a,l);return i.N.push(d),d.oa(function(){st(i.N,d)}),d.o(function(g){var S=null;throw g&&g.code==="auth/multi-factor-auth-required"&&(S=j_(g.w(),$g(i),x(i.jc,i))),S||g})}e.jc=function(i){var a=null,l=this;return i=na(ge(i),l.uid).then(function(d){return a=al(l,d,"reauthenticate"),Xr(l,d),l.i=null,l.reload()}).then(function(){return a}),Ft(this,i,!0)};function tO(i,a,l){return i.i&&!l?(a.cancel(),ut(i.i)):a.o(function(d){throw!d||d.code!="auth/user-disabled"&&d.code!="auth/user-token-expired"||(i.i||i.dispatchEvent(new ua("userInvalidated")),i.i=d),d})}e.toJSON=function(){return this.w()},e.w=function(){var i={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&Xt(i,this.metadata.w()),xe(this.providerData,function(a){i.providerData.push(ID(a))}),Xt(i,this.S.w()),i};function V_(i){if(!i.apiKey)return null;var a={apiKey:i.apiKey,authDomain:i.authDomain,appName:i.appName,emulatorConfig:i.emulatorConfig},l={};if(i.stsTokenManager&&i.stsTokenManager.accessToken){l[Dr]=i.stsTokenManager.accessToken,l.refreshToken=i.stsTokenManager.refreshToken||null;var d=i.stsTokenManager.expirationTime;d&&(l.expiresIn=(d-Date.now())/1e3)}else return null;var g=new Qn(a,l,i);return i.providerData&&xe(i.providerData,function(S){S&&Kg(g,Yr(S))}),i.redirectEventId&&(g.ga=i.redirectEventId),g}function nO(i,a,l,d){var g=new Qn(i,a);return l&&(g.ha=l),d&&ol(g,d),g.reload().then(function(){return g})}function rO(i,a,l,d){var g=i.h,S={};return S[Dr]=g.b&&g.b.toString(),S.refreshToken=g.a,a=new Qn(a||{apiKey:i.l,authDomain:i.s,appName:i.m},S),l&&(a.ha=l),d&&ol(a,d),qh(a,i),a}function iO(i){this.a=i,this.b=il()}var Gg={name:"redirectUser",F:"session"};function B_(i){return aa(i.b,Gg,i.a)}function oO(i,a){return i.b.get(Gg,i.a).then(function(l){return l&&a&&(l.authDomain=a),V_(l||{})})}function Wg(i){this.a=i,this.b=il(),this.c=null,this.f=sO(this),this.b.addListener(Jr("local"),this.a,x(this.g,this))}Wg.prototype.g=function(){var i=this,a=Jr("local");la(this,function(){return ge().then(function(){return i.c&&i.c.F!="local"?i.b.get(a,i.a):null}).then(function(l){if(l)return Yg(i,"local").then(function(){i.c=a})})})};function Yg(i,a){var l=[],d;for(d in oa)oa[d]!==a&&l.push(aa(i.b,Jr(oa[d]),i.a));return l.push(aa(i.b,Qg,i.a)),YA(l)}function sO(i){var a=Jr("local"),l=Jr("session"),d=Jr("none");return bR(i.b,a,i.a).then(function(){return i.b.get(l,i.a)}).then(function(g){return g?l:i.b.get(d,i.a).then(function(S){return S?d:i.b.get(a,i.a).then(function(I){return I?a:i.b.get(Qg,i.a).then(function(D){return D?Jr(D):a})})})}).then(function(g){return i.c=g,Yg(i,g.F)}).o(function(){i.c||(i.c=a)})}var Qg={name:"persistence",F:"session"};function Jr(i){return{name:"authUser",F:i}}Wg.prototype.yb=function(i){var a=null,l=this;return xR(i),la(this,function(){return i!=l.c.F?l.b.get(l.c,l.a).then(function(d){return a=d,Yg(l,i)}).then(function(){if(l.c=Jr(i),a)return l.b.set(l.c,a,l.a)}):ge()})};function aO(i){return la(i,function(){return i.b.set(Qg,i.c.F,i.a)})}function z_(i,a){return la(i,function(){return i.b.set(i.c,a.w(),i.a)})}function q_(i){return la(i,function(){return aa(i.b,i.c,i.a)})}function K_(i,a,l){return la(i,function(){return i.b.get(i.c,i.a).then(function(d){return d&&a&&(d.authDomain=a),d&&l&&(d.emulatorConfig=l),V_(d||{})})})}function la(i,a){return i.f=i.f.then(a,a),i.f}function Mr(i){if(this.l=!1,fe(this,"settings",new E_),fe(this,"app",i),Je(this).options&&Je(this).options.apiKey)i=de.SDK_VERSION?Js(de.SDK_VERSION):null,this.a=new Ar(Je(this).options&&Je(this).options.apiKey,O(R),i);else throw new T("invalid-api-key");this.P=[],this.s=[],this.N=[],this.Pa=de.INTERNAL.createSubscribe(x(this.zc,this)),this.W=void 0,this.ib=de.INTERNAL.createSubscribe(x(this.Ac,this)),ca(this,null),this.i=new Wg(Je(this).options.apiKey+":"+Je(this).name),this.D=new iO(Je(this).options.apiKey+":"+Je(this).name),this.$=xt(this,dO(this)),this.h=xt(this,pO(this)),this.ba=!1,this.ja=x(this.Zc,this),this.Ba=x(this.da,this),this.qa=x(this.mc,this),this.za=x(this.wc,this),this.Aa=x(this.xc,this),this.b=null,cO(this),this.INTERNAL={},this.INTERNAL.delete=x(this.delete,this),this.INTERNAL.logFramework=x(this.Gc,this),this.u=0,bn.call(this),lO(this),this.J=[],this.R=null}k(Mr,bn);function H_(i){Rn.call(this,"languageCodeChanged"),this.h=i}k(H_,Rn);function G_(i){Rn.call(this,"emulatorConfigChanged"),this.c=i}k(G_,Rn);function W_(i){Rn.call(this,"frameworkChanged"),this.f=i}k(W_,Rn),e=Mr.prototype,e.yb=function(i){return i=this.i.yb(i),xt(this,i)},e.xa=function(i){this.aa===i||this.l||(this.aa=i,jS(this.a,this.aa),this.dispatchEvent(new H_(this.la())))},e.la=function(){return this.aa},e.fd=function(){var i=f.navigator;this.xa(i&&(i.languages&&i.languages[0]||i.language||i.userLanguage)||null)},e.gd=function(i,a){if(!this.R){if(!/^https?:\/\//.test(i))throw new T("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");a=a?!!a.disableWarnings:!1,uO(a),this.R={url:i,ec:a},this.settings.jb=!0,Ah(this.a,this.R),this.dispatchEvent(new G_(this.R))}};function uO(i){typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),f.document&&!i&&uh().then(function(){var a=f.document.createElement("div");a.innerText="Running in emulator mode. Do not use with production credentials.",a.style.position="fixed",a.style.width="100%",a.style.backgroundColor="#ffffff",a.style.border=".1em solid #000000",a.style.color="#b50000",a.style.bottom="0px",a.style.left="0px",a.style.margin="0px",a.style.zIndex=1e4,a.style.textAlign="center",a.classList.add("firebase-emulator-warning"),f.document.body.appendChild(a)})}e.Gc=function(i){this.J.push(i),kS(this.a,de.SDK_VERSION?Js(de.SDK_VERSION,this.J):null),this.dispatchEvent(new W_(this.J))},e.Ga=function(){return dt(this.J)},e.zb=function(i){this.S===i||this.l||(this.S=i,this.a.b=this.S)},e.T=function(){return this.S};function lO(i){Object.defineProperty(i,"lc",{get:function(){return this.la()},set:function(a){this.xa(a)},enumerable:!1}),i.aa=null,Object.defineProperty(i,"ti",{get:function(){return this.T()},set:function(a){this.zb(a)},enumerable:!1}),i.S=null,Object.defineProperty(i,"emulatorConfig",{get:function(){if(this.R){var a=On(this.R.url);a=Yr({protocol:a.c,host:a.a,port:a.g,options:Yr({disableWarnings:this.R.ec})})}else a=null;return a},enumerable:!1})}e.toJSON=function(){return{apiKey:Je(this).options.apiKey,authDomain:Je(this).options.authDomain,appName:Je(this).name,currentUser:ke(this)&&ke(this).w()}};function Xg(i){return i.Oa||ut(new T("auth-domain-config-required"))}function cO(i){var a=Je(i).options.authDomain,l=Je(i).options.apiKey;a&&Fo()&&(i.Oa=i.$.then(function(){if(!i.l){if(i.b=Ig(a,l,Je(i).name,i.R),Fh(i.b,i),ke(i)&&sl(ke(i)),i.m){sl(i.m);var d=i.m;d.xa(i.la()),Pg(d,i),d=i.m,ol(d,i.J),Fg(d,i),d=i.m,Lg(d,i.R),Ug(d,i),i.m=null}return i.b}}))}e.Gb=function(i,a){switch(i){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==a&&!!this.f;default:return!1}},e.na=function(i,a,l,d){i=="signInViaPopup"&&this.g==d&&(l&&this.C?this.C(l):a&&!l&&this.f&&this.f(a),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(i,a){return i=="signInViaRedirect"||i=="signInViaPopup"&&this.g==a&&this.f?x(this.ic,this):null},e.ic=function(i,a,l,d){var g=this,S={requestUri:i,postBody:d,sessionId:a,tenantId:l};return this.c&&(this.c.cancel(),this.c=null),g.$.then(function(){return Xo(g,eg(g.a,S))})},e.Xc=function(i){if(!Fo())return ut(new T("operation-not-supported-in-this-environment"));var a=this,l=jm(i.providerId),d=$o(),g=null;(!Pu()||hm())&&Je(this).options.authDomain&&i.isOAuthProvider&&(g=el(Je(this).options.authDomain,Je(this).options.apiKey,Je(this).name,"signInViaPopup",i,null,d,de.SDK_VERSION||null,null,null,this.T(),this.R));var S=Tb(g,l&&l.va,l&&l.ua);return l=Xg(this).then(function(I){return y_(I,S,"signInViaPopup",i,d,!!g,a.T())}).then(function(){return new Me(function(I,D){a.na("signInViaPopup",null,new T("cancelled-popup-request"),a.g),a.f=I,a.C=D,a.g=d,a.c=x_(a.b,a,"signInViaPopup",S,d)})}).then(function(I){return S&&Uo(S),I?Yr(I):null}).o(function(I){throw S&&Uo(S),I}),xt(this,l)},e.Yc=function(i){if(!Fo())return ut(new T("operation-not-supported-in-this-environment"));var a=this,l=Xg(this).then(function(){return aO(a.i)}).then(function(){return w_(a.b,"signInViaRedirect",i,void 0,a.T())});return xt(this,l)};function Y_(i){if(!Fo())return ut(new T("operation-not-supported-in-this-environment"));var a=Xg(i).then(function(){return i.b.ra()}).then(function(l){return l?Yr(l):null});return xt(i,a)}e.ra=function(){var i=this;return Y_(this).then(function(a){return i.b&&Vh(i.b.b),a}).o(function(a){throw i.b&&Vh(i.b.b),a})},e.dd=function(i){if(!i)return ut(new T("null-user"));if(this.S!=i.tenantId)return ut(new T("tenant-id-mismatch"));var a=this,l={};l.apiKey=Je(this).options.apiKey,l.authDomain=Je(this).options.authDomain,l.appName=Je(this).name;var d=rO(i,l,a.D,a.Ga());return xt(this,this.h.then(function(){if(Je(a).options.apiKey!=i.l)return d.reload()}).then(function(){return ke(a)&&i.uid==ke(a).uid?(qh(ke(a),i),a.da(i)):(ca(a,d),sl(d),a.da(d))}).then(function(){ul(a)}))};function hO(i,a){var l={};return l.apiKey=Je(i).options.apiKey,l.authDomain=Je(i).options.authDomain,l.appName=Je(i).name,i.R&&(l.emulatorConfig=i.R),i.$.then(function(){return nO(l,a,i.D,i.Ga())}).then(function(d){return ke(i)&&d.uid==ke(i).uid?(qh(ke(i),d),i.da(d)):(ca(i,d),sl(d),i.da(d))}).then(function(){ul(i)})}function ca(i,a){ke(i)&&(JR(ke(i),i.Ba),Wn(ke(i),"tokenChanged",i.qa),Wn(ke(i),"userDeleted",i.za),Wn(ke(i),"userInvalidated",i.Aa),Vg(ke(i))),a&&(a.W.push(i.Ba),mr(a,"tokenChanged",i.qa),mr(a,"userDeleted",i.za),mr(a,"userInvalidated",i.Aa),0<i.u&&M_(a)),fe(i,"currentUser",a),a&&(a.xa(i.la()),Pg(a,i),ol(a,i.J),Fg(a,i),Lg(a,i.R),Ug(a,i))}e.Bb=function(){var i=this,a=this.h.then(function(){return i.b&&Vh(i.b.b),ke(i)?(ca(i,null),q_(i.i).then(function(){ul(i)})):ge()});return xt(this,a)};function fO(i){var a=oO(i.D,Je(i).options.authDomain).then(function(l){return(i.m=l)&&(l.ha=i.D),B_(i.D)});return xt(i,a)}function dO(i){var a=Je(i).options.authDomain,l=fO(i).then(function(){return K_(i.i,a,i.R)}).then(function(d){return d?(d.ha=i.D,i.m&&(i.m.ga||null)==(d.ga||null)?d:d.reload().then(function(){return z_(i.i,d).then(function(){return d})}).o(function(g){return g.code=="auth/network-request-failed"?d:q_(i.i)})):null}).then(function(d){ca(i,d||null)});return xt(i,l)}function pO(i){return i.$.then(function(){return Y_(i)}).o(function(){}).then(function(){if(!i.l)return i.ja()}).o(function(){}).then(function(){if(!i.l){i.ba=!0;var a=i.i;a.b.addListener(Jr("local"),a.a,i.ja)}})}e.Zc=function(){var i=this;return K_(this.i,Je(this).options.authDomain).then(function(a){if(!i.l){var l;if(l=ke(i)&&a){l=ke(i).uid;var d=a.uid;l=l==null||l===""||d===void 0||d===null||d===""?!1:l==d}if(l)return qh(ke(i),a),ke(i).I();(ke(i)||a)&&(ca(i,a),a&&(sl(a),a.ha=i.D),i.b&&Fh(i.b,i),ul(i))}})},e.da=function(i){return z_(this.i,i)},e.mc=function(){ul(this),this.da(ke(this))},e.wc=function(){this.Bb()},e.xc=function(){this.Bb()};function Xo(i,a){var l=null,d=null;return xt(i,a.then(function(g){return l=Rm(g),d=Zb(g),hO(i,g)},function(g){var S=null;throw g&&g.code==="auth/multi-factor-auth-required"&&(S=j_(g.w(),i,x(i.kc,i))),S||g}).then(function(){return Yr({user:ke(i),credential:l,additionalUserInfo:d,operationType:"signIn"})}))}e.kc=function(i){var a=this;return this.h.then(function(){return Xo(a,ge(i))})},e.zc=function(i){var a=this;this.addAuthTokenListener(function(){i.next(ke(a))})},e.Ac=function(i){var a=this;mO(this,function(){i.next(ke(a))})},e.Ic=function(i,a,l){var d=this;return this.ba&&Promise.resolve().then(function(){typeof i=="function"?i(ke(d)):typeof i.next=="function"&&i.next(ke(d))}),this.Pa(i,a,l)},e.Hc=function(i,a,l){var d=this;return this.ba&&Promise.resolve().then(function(){d.W=d.getUid(),typeof i=="function"?i(ke(d)):typeof i.next=="function"&&i.next(ke(d))}),this.ib(i,a,l)},e.nc=function(i){var a=this,l=this.h.then(function(){return ke(a)?ke(a).I(i).then(function(d){return{accessToken:d}}):null});return xt(this,l)},e.Tc=function(i){var a=this;return this.h.then(function(){return Xo(a,Le(a.a,YM,{token:i}))}).then(function(l){var d=l.user;return qi(d,"isAnonymous",!1),a.da(d),l})},e.Uc=function(i,a){var l=this;return this.h.then(function(){return Xo(l,Le(l.a,US,{email:i,password:a}))})},e.dc=function(i,a){var l=this;return this.h.then(function(){return Xo(l,Le(l.a,IM,{email:i,password:a}))})},e.ab=function(i){var a=this;return this.h.then(function(){return Xo(a,i.ka(a.a))})},e.Sc=function(i){return mm("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(i)},e.Ab=function(){var i=this;return this.h.then(function(){var a=ke(i);if(a&&a.isAnonymous){var l=Yr({providerId:null,isNewUser:!1});return Yr({user:a,credential:null,additionalUserInfo:l,operationType:"signIn"})}return Xo(i,i.a.Ab()).then(function(d){var g=d.user;return qi(g,"isAnonymous",!0),i.da(g),d})})};function Je(i){return i.app}function ke(i){return i.currentUser}e.getUid=function(){return ke(this)&&ke(this).uid||null};function Hh(i){return ke(i)&&ke(i)._lat||null}function ul(i){if(i.ba){for(var a=0;a<i.s.length;a++)i.s[a]&&i.s[a](Hh(i));if(i.W!==i.getUid()&&i.N.length)for(i.W=i.getUid(),a=0;a<i.N.length;a++)i.N[a]&&i.N[a](Hh(i))}}e.cc=function(i){this.addAuthTokenListener(i),this.u++,0<this.u&&ke(this)&&M_(ke(this))},e.Pc=function(i){var a=this;xe(this.s,function(l){l==i&&a.u--}),0>this.u&&(this.u=0),this.u==0&&ke(this)&&Vg(ke(this)),this.removeAuthTokenListener(i)},e.addAuthTokenListener=function(i){var a=this;this.s.push(i),xt(this,this.h.then(function(){a.l||Ce(a.s,i)&&i(Hh(a))}))},e.removeAuthTokenListener=function(i){Ze(this.s,function(a){return a==i})};function mO(i,a){i.N.push(a),xt(i,i.h.then(function(){!i.l&&Ce(i.N,a)&&i.W!==i.getUid()&&(i.W=i.getUid(),a(Hh(i)))}))}e.delete=function(){this.l=!0;for(var i=0;i<this.P.length;i++)this.P[i].cancel("app-deleted");return this.P=[],this.i&&(i=this.i,i.b.removeListener(Jr("local"),i.a,this.ja)),this.b&&(_g(this.b,this),Vh(this.b.b)),Promise.resolve()};function xt(i,a){return i.P.push(a),a.oa(function(){st(i.P,a)}),a}e.hc=function(i){return xt(this,vM(this.a,i))},e.Bc=function(i){return!!Mm(i)},e.xb=function(i,a){var l=this;return xt(this,ge().then(function(){var d=new hh(a);if(!d.c)throw new T("argument-error",Im+" must be true when sending sign in link to email");return fh(d)}).then(function(d){return l.a.xb(i,d)}).then(function(){}))},e.jd=function(i){return this.Sa(i).then(function(a){return a.data.email})},e.ob=function(i,a){return xt(this,this.a.ob(i,a).then(function(){}))},e.Sa=function(i){return xt(this,this.a.Sa(i).then(function(a){return new jD(a)}))},e.kb=function(i){return xt(this,this.a.kb(i).then(function(){}))},e.wb=function(i,a){var l=this;return xt(this,ge().then(function(){return typeof a>"u"||Mn(a)?{}:fh(new hh(a))}).then(function(d){return l.a.wb(i,d)}).then(function(){}))},e.Wc=function(i,a){return xt(this,jg(this,i,a,x(this.ab,this)))},e.Vc=function(i,a){var l=this;return xt(this,ge().then(function(){var d=a||Lu(),g=hS(i,d);if(d=Mm(d),!d)throw new T("argument-error","Invalid email link!");if(d.tenantId!==l.T())throw new T("tenant-id-mismatch");return l.ab(g)}))};function ll(){}ll.prototype.render=function(){},ll.prototype.reset=function(){},ll.prototype.getResponse=function(){},ll.prototype.execute=function(){};function ha(){this.a={},this.b=1e12}var Jg=null;ha.prototype.render=function(i,a){return this.a[this.b.toString()]=new Gh(i,a),this.b++},ha.prototype.reset=function(i){var a=Zg(this,i);i=Q_(i),a&&i&&(a.delete(),delete this.a[i])},ha.prototype.getResponse=function(i){return(i=Zg(this,i))?i.getResponse():null},ha.prototype.execute=function(i){(i=Zg(this,i))&&i.execute()};function Zg(i,a){return(a=Q_(a))&&i.a[a]||null}function Q_(i){return(i=typeof i>"u"?1e12:i)?i.toString():null}function Gh(i,a){this.g=!1,this.c=a,this.a=this.b=null,this.h=this.c.size!=="invisible",this.f=ku(i);var l=this;this.i=function(){l.execute()},this.h?this.execute():mr(this.f,"click",this.i)}Gh.prototype.getResponse=function(){return ev(this),this.b},Gh.prototype.execute=function(){ev(this);var i=this;this.a||(this.a=setTimeout(function(){i.b=SD();var a=i.c.callback,l=i.c["expired-callback"];if(a)try{a(i.b)}catch{}i.a=setTimeout(function(){if(i.a=null,i.b=null,l)try{l()}catch{}i.h&&i.execute()},6e4)},500))},Gh.prototype.delete=function(){ev(this),this.g=!0,clearTimeout(this.a),this.a=null,Wn(this.f,"click",this.i)};function ev(i){if(i.g)throw Error("reCAPTCHA mock was already deleted!")}function tv(){}fe(tv,"FACTOR_ID","phone");function nv(){}nv.prototype.g=function(){return Jg||(Jg=new ha),ge(Jg)},nv.prototype.c=function(){};var rv=null;function iv(){this.b=f.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var gO=new se(We,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),vO=new Vi(3e4,6e4);iv.prototype.g=function(i){var a=this;return new Me(function(l,d){var g=setTimeout(function(){d(new T("network-request-failed"))},vO.get());if(!f.grecaptcha||i!==a.f&&!a.b){f[a.a]=function(){if(f.grecaptcha){a.f=i;var I=f.grecaptcha.render;f.grecaptcha.render=function(D,B){return D=I(D,B),a.b++,D},clearTimeout(g),l(f.grecaptcha)}else clearTimeout(g),d(new T("internal-error"));delete f[a.a]};var S=Et(gO,{onload:a.a,hl:i||""});ge(Gm(S)).o(function(){clearTimeout(g),d(new T("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(g),l(f.grecaptcha)})},iv.prototype.c=function(){this.b--};var ov=null;function sv(i,a,l,d,g,S,I){if(fe(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=a,this.g=null,I?(rv||(rv=new nv),I=rv):(ov||(ov=new iv),I=ov),this.m=I,this.a=l||{theme:"light",type:"image"},this.h=[],this.a[Z_])throw new T("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i=this.a[yO]==="invisible",!f.document)throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ku(a)||!this.i&&ku(a).hasChildNodes())throw new T("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ar(i,S||null,g||null),this.u=d||function(){return null};var D=this;this.l=[];var B=this.a[X_];this.a[X_]=function(Ee){if(e1(D,Ee),typeof B=="function")B(Ee);else if(typeof B=="string"){var Qe=lt(B,f);typeof Qe=="function"&&Qe(Ee)}};var G=this.a[J_];this.a[J_]=function(){if(e1(D,null),typeof G=="function")G();else if(typeof G=="string"){var Ee=lt(G,f);typeof Ee=="function"&&Ee()}}}var X_="callback",J_="expired-callback",Z_="sitekey",yO="size";function e1(i,a){for(var l=0;l<i.l.length;l++)try{i.l[l](a)}catch{}}function wO(i,a){Ze(i.l,function(l){return l==a})}function av(i,a){return i.h.push(a),a.oa(function(){st(i.h,a)}),a}e=sv.prototype,e.Ia=function(){var i=this;return this.f?this.f:this.f=av(this,ge().then(function(){if(lh()&&!kr())return uh();throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return i.m.g(i.u())}).then(function(a){return i.g=a,Le(i.s,$M,{})}).then(function(a){i.a[Z_]=a.recaptchaSiteKey}).o(function(a){throw i.f=null,a}))},e.render=function(){Wh(this);var i=this;return av(this,this.Ia().then(function(){if(i.c===null){var a=i.v;if(!i.i){var l=ku(a);a=KA("DIV"),l.appendChild(a)}i.c=i.g.render(a,i.a)}return i.c}))},e.verify=function(){Wh(this);var i=this;return av(this,this.render().then(function(a){return new Me(function(l){var d=i.g.getResponse(a);if(d)l(d);else{var g=function(S){S&&(wO(i,g),l(S))};i.l.push(g),i.i&&i.g.execute(i.c)}})}))},e.reset=function(){Wh(this),this.c!==null&&this.g.reset(this.c)};function Wh(i){if(i.J)throw new T("internal-error","RecaptchaVerifier instance has been destroyed.")}e.clear=function(){Wh(this),this.J=!0,this.m.c();for(var i=0;i<this.h.length;i++)this.h[i].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){i=ku(this.v);for(var a;a=i.firstChild;)i.removeChild(a)}};function uv(i,a,l){var d=!1;try{this.b=l||de.app()}catch{throw new T("argument-error","No firebase.app.App instance is currently initialized.")}if(this.b.options&&this.b.options.apiKey)l=this.b.options.apiKey;else throw new T("invalid-api-key");var g=this,S=null;try{S=this.b.auth().Ga()}catch{}try{d=this.b.auth().settings.appVerificationDisabledForTesting}catch{}S=de.SDK_VERSION?Js(de.SDK_VERSION,S):null,sv.call(this,l,i,a,function(){try{var I=g.b.auth().la()}catch{I=null}return I},S,O(R),d)}k(uv,sv);function t1(i,a,l,d){e:{l=Array.prototype.slice.call(l);for(var g=0,S=!1,I=0;I<a.length;I++)if(a[I].optional)S=!0;else{if(S)throw new T("internal-error","Argument validator encountered a required argument after an optional argument.");g++}if(S=a.length,l.length<g||S<l.length)d="Expected "+(g==S?g==1?"1 argument":g+" arguments":g+"-"+S+" arguments")+" but got "+l.length+".";else{for(g=0;g<l.length;g++)if(S=a[g].optional&&l[g]===void 0,!a[g].M(l[g])&&!S){if(a=a[g],0>g||g>=n1.length)throw new T("internal-error","Argument validator received an unsupported number of arguments.");l=n1[g],d=(d?"":l+" argument ")+(a.name?'"'+a.name+'" ':"")+"must be "+a.K+".";break e}d=null}}if(d)throw new T("argument-error",i+" failed: "+d)}var n1="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function he(i,a){return{name:i||"",K:"a valid string",optional:!!a,M:function(l){return typeof l=="string"}}}function lv(i,a){return{name:i||"",K:"a boolean",optional:!!a,M:function(l){return typeof l=="boolean"}}}function Dt(i,a){return{name:i||"",K:"a valid object",optional:!!a,M:C}}function fa(i,a){return{name:i||"",K:"a function",optional:!!a,M:function(l){return typeof l=="function"}}}function Zr(i,a){return{name:i||"",K:"null",optional:!!a,M:function(l){return l===null}}}function xO(){return{name:"",K:"an HTML element",optional:!1,M:function(i){return!!(i&&i instanceof Element)}}}function bO(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(i){return!!(i&&i instanceof Mr)}}}function SO(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(i){return!!(i&&i instanceof de.app.App)}}}function Ki(i){return{name:i?i+"Credential":"credential",K:i?"a valid "+i+" credential":"a valid credential",optional:!1,M:function(a){if(!a)return!1;var l=!i||a.providerId===i;return!(!a.ka||!l)}}}function r1(){return{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(i){return i?!!i.tb:!1}}}function da(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(i){return!!(i&&i.providerId&&i.hasOwnProperty&&i.hasOwnProperty("isOAuthProvider"))}}}function cv(i,a){return C(i)&&typeof i.type=="string"&&i.type===a&&typeof i.Ha=="function"}function i1(i){return C(i)&&typeof i.uid=="string"}function Yh(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(i){return!(!i||typeof i.type!="string"||typeof i.verify!="function")}}}function Tt(i,a,l,d){return{name:l||"",K:i.K+" or "+a.K,optional:!!d,M:function(g){return i.M(g)||a.M(g)}}}function pt(i,a){for(var l in a){var d=a[l].name;i[d]=s1(d,i[l],a[l].j)}}function o1(i,a){for(var l in a){var d=a[l].name;d!==l&&Object.defineProperty(i,d,{get:j(function(g){return this[g]},l),set:j(function(g,S,I,D){t1(g,[I],[D],!0),this[S]=D},d,l,a[l].lb),enumerable:!0})}}function jt(i,a,l,d){i[a]=s1(a,l,d)}function s1(i,a,l){function d(){var I=Array.prototype.slice.call(arguments);return t1(g,l,I),a.apply(this,I)}if(!l)return a;var g=_O(i),S;for(S in a)d[S]=a[S];for(S in a.prototype)d.prototype[S]=a.prototype[S];return d}function _O(i){return i=i.split("."),i[i.length-1]}pt(Mr.prototype,{kb:{name:"applyActionCode",j:[he("code")]},Sa:{name:"checkActionCode",j:[he("code")]},ob:{name:"confirmPasswordReset",j:[he("code"),he("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[he("email"),he("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[he("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[he("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Tt(Dt(),fa(),"nextOrObserver"),fa("opt_error",!0),fa("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Tt(Dt(),fa(),"nextOrObserver"),fa("opt_error",!0),fa("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[he("email"),Tt(Dt("opt_actionCodeSettings",!0),Zr(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[he("email"),Dt("actionCodeSettings")]},yb:{name:"setPersistence",j:[he("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Ki()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Ki()]},Tc:{name:"signInWithCustomToken",j:[he("token")]},Uc:{name:"signInWithEmailAndPassword",j:[he("email"),he("password")]},Vc:{name:"signInWithEmailLink",j:[he("email"),he("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[he("phoneNumber"),Yh()]},Xc:{name:"signInWithPopup",j:[da()]},Yc:{name:"signInWithRedirect",j:[da()]},dd:{name:"updateCurrentUser",j:[Tt(function(i){return{name:"user",K:"an instance of Firebase User",optional:!1,M:function(a){return!!(a&&a instanceof Qn)}}}(),Zr(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[he(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[he("url"),Dt("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[he("code")]}}),o1(Mr.prototype,{lc:{name:"languageCode",lb:Tt(he(),Zr(),"languageCode")},ti:{name:"tenantId",lb:Tt(he(),Zr(),"tenantId")}}),Mr.Persistence=oa,Mr.Persistence.LOCAL="local",Mr.Persistence.SESSION="session",Mr.Persistence.NONE="none",pt(Qn.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[lv("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[lv("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Ki()]},rb:{name:"linkWithCredential",j:[Ki()]},Dc:{name:"linkWithPhoneNumber",j:[he("phoneNumber"),Yh()]},Ec:{name:"linkWithPopup",j:[da()]},Fc:{name:"linkWithRedirect",j:[da()]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Ki()]},ub:{name:"reauthenticateWithCredential",j:[Ki()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[he("phoneNumber"),Yh()]},Nc:{name:"reauthenticateWithPopup",j:[da()]},Oc:{name:"reauthenticateWithRedirect",j:[da()]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[Tt(Dt("opt_actionCodeSettings",!0),Zr(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[he(null,!0)]},cd:{name:"unlink",j:[he("provider")]},Cb:{name:"updateEmail",j:[he("email")]},Db:{name:"updatePassword",j:[he("password")]},ed:{name:"updatePhoneNumber",j:[Ki("phone")]},Eb:{name:"updateProfile",j:[Dt("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[he("email"),Tt(Dt("opt_actionCodeSettings",!0),Zr(null,!0),"opt_actionCodeSettings",!0)]}}),pt(ha.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),pt(ll.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),pt(Me.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),o1(E_.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:lv("appVerificationDisabledForTesting")}}),pt(Tg.prototype,{confirm:{name:"confirm",j:[he("verificationCode")]}}),jt(ta,"fromJSON",function(i){i=typeof i=="string"?JSON.parse(i):i;for(var a,l=[HD,GD,WD,KD],d=0;d<l.length;d++)if(a=l[d](i))return a;return null},[Tt(he(),Dt(),"json")]),jt(vr,"credential",function(i,a){return new Bi(i,a)},[he("email"),he("password")]),pt(Bi.prototype,{w:{name:"toJSON",j:[he(null,!0)]}}),pt(zo.prototype,{Ca:{name:"addScope",j:[he("scope")]},Ka:{name:"setCustomParameters",j:[Dt("customOAuthParameters")]}}),jt(zo,"credential",aS,[Tt(he(),Dt(),"token")]),jt(vr,"credentialWithLink",hS,[he("email"),he("emailLink")]),pt(qo.prototype,{Ca:{name:"addScope",j:[he("scope")]},Ka:{name:"setCustomParameters",j:[Dt("customOAuthParameters")]}}),jt(qo,"credential",uS,[Tt(he(),Dt(),"token")]),pt(Ko.prototype,{Ca:{name:"addScope",j:[he("scope")]},Ka:{name:"setCustomParameters",j:[Dt("customOAuthParameters")]}}),jt(Ko,"credential",lS,[Tt(he(),Tt(Dt(),Zr()),"idToken"),Tt(he(),Zr(),"accessToken",!0)]),pt(ra.prototype,{Ka:{name:"setCustomParameters",j:[Dt("customOAuthParameters")]}}),jt(ra,"credential",cS,[Tt(he(),Dt(),"token"),he("secret",!0)]),pt(Yn.prototype,{Ca:{name:"addScope",j:[he("scope")]},credential:{name:"credential",j:[Tt(he(),Tt(Dt(),Zr()),"optionsOrIdToken"),Tt(he(),Zr(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Dt("customOAuthParameters")]}}),pt(pi.prototype,{w:{name:"toJSON",j:[he(null,!0)]}}),pt(Vo.prototype,{w:{name:"toJSON",j:[he(null,!0)]}}),jt(mi,"credential",fS,[he("verificationId"),he("verificationCode")]),pt(mi.prototype,{gb:{name:"verifyPhoneNumber",j:[Tt(he(),function(i,a){return{name:i||"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(l){return l?l.session&&l.phoneNumber?cv(l.session,zu)&&typeof l.phoneNumber=="string":l.session&&l.multiFactorHint?cv(l.session,vh)&&i1(l.multiFactorHint):l.session&&l.multiFactorUid?cv(l.session,vh)&&typeof l.multiFactorUid=="string":l.phoneNumber?typeof l.phoneNumber=="string":!1:!1}}}(),"phoneInfoOptions"),Yh()]}}),pt(zi.prototype,{w:{name:"toJSON",j:[he(null,!0)]}}),pt(T.prototype,{toJSON:{name:"toJSON",j:[he(null,!0)]}}),pt(Ku.prototype,{toJSON:{name:"toJSON",j:[he(null,!0)]}}),pt(Pm.prototype,{toJSON:{name:"toJSON",j:[he(null,!0)]}}),pt(Cg.prototype,{toJSON:{name:"toJSON",j:[he(null,!0)]}}),pt(kg.prototype,{Rc:{name:"resolveSignIn",j:[r1()]}}),pt(Dg.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[r1(),he("displayName",!0)]},bd:{name:"unenroll",j:[Tt({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:i1},he(),"multiFactorInfoIdentifier")]}}),pt(uv.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),jt(Em,"parseLink",zb,[he("link")]),jt(tv,"assertion",function(i){return new C_(i)},[Ki("phone")]),function(){if(typeof de<"u"&&de.INTERNAL&&de.INTERNAL.registerComponent){var i={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ch,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:Nm,VERIFY_AND_CHANGE_EMAIL:Vu,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Mr,AuthCredential:ta,Error:T};jt(i,"EmailAuthProvider",vr,[]),jt(i,"FacebookAuthProvider",zo,[]),jt(i,"GithubAuthProvider",qo,[]),jt(i,"GoogleAuthProvider",Ko,[]),jt(i,"TwitterAuthProvider",ra,[]),jt(i,"OAuthProvider",Yn,[he("providerId")]),jt(i,"SAMLAuthProvider",sS,[he("providerId")]),jt(i,"PhoneAuthProvider",mi,[bO()]),jt(i,"RecaptchaVerifier",uv,[Tt(he(),xO(),"recaptchaContainer"),Dt("recaptchaParameters",!0),SO()]),jt(i,"ActionCodeURL",Em,[]),jt(i,"PhoneMultiFactorGenerator",tv,[]),de.INTERNAL.registerComponent({name:"auth",instanceFactory:function(a){return a=a.getProvider("app").getImmediate(),new Mr(a)},multipleInstances:!1,serviceProps:i,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(a){a.getProvider("auth-internal").initialize()}}),de.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(a){return a=a.getProvider("auth").getImmediate(),{getUid:x(a.getUid,a),getToken:x(a.nc,a),addAuthTokenListener:x(a.cc,a),removeAuthTokenListener:x(a.Pc,a)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),de.registerVersion("@firebase/auth","0.16.8"),de.INTERNAL.extendNamespace({User:Qn})}else throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.")}()}).apply(typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gy=function(e,t){return Gy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},Gy(e,t)};function QU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Gy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Cj(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var XU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ce,ww=ww||{},Ie=XU||self;function yd(){}function Wy(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function up(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function JU(e,t,n){return e.call.apply(e.bind,arguments)}function ZU(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,r),e.apply(t,o)}}return function(){return e.apply(t,arguments)}}function rn(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?rn=JU:rn=ZU,rn.apply(null,arguments)}function mf(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function an(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(r,o,s){for(var u=Array(arguments.length-2),c=2;c<arguments.length;c++)u[c-2]=arguments[c];return t.prototype[o].apply(r,u)}}function To(){this.s=this.s,this.o=this.o}var eF=0;To.prototype.s=!1;To.prototype.na=function(){!this.s&&(this.s=!0,this.M(),eF!=0)};To.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Aj=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Dj=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,o=typeof e=="string"?e.split(""):e,s=0;s<r;s++)s in o&&t.call(n,o[s],s,e)};function tF(e){e:{for(var t=GF,n=e.length,r=typeof e=="string"?e.split(""):e,o=0;o<n;o++)if(o in r&&t.call(void 0,r[o],o,e)){t=o;break e}t=-1}return 0>t?null:typeof e=="string"?e.charAt(t):e[t]}function wN(e){return Array.prototype.concat.apply([],arguments)}function xw(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function wd(e){return/^[\s\xa0]*$/.test(e)}var xN=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function En(e,t){return e.indexOf(t)!=-1}function $v(e,t){return e<t?-1:e>t?1:0}var In;e:{var bN=Ie.navigator;if(bN){var SN=bN.userAgent;if(SN){In=SN;break e}}In=""}function bw(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Mj(e){var t={};for(var n in e)t[n]=e[n];return t}var _N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Rj(e,t){for(var n,r,o=1;o<arguments.length;o++){r=arguments[o];for(n in r)e[n]=r[n];for(var s=0;s<_N.length;s++)n=_N[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Sw(e){return Sw[" "](e),e}Sw[" "]=yd;function nF(e){var t=oF;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}var rF=En(In,"Opera"),Xa=En(In,"Trident")||En(In,"MSIE"),Oj=En(In,"Edge"),Yy=Oj||Xa,Lj=En(In,"Gecko")&&!(En(In.toLowerCase(),"webkit")&&!En(In,"Edge"))&&!(En(In,"Trident")||En(In,"MSIE"))&&!En(In,"Edge"),iF=En(In.toLowerCase(),"webkit")&&!En(In,"Edge");function Pj(){var e=Ie.document;return e?e.documentMode:void 0}var xd;e:{var Vv="",Bv=function(){var e=In;if(Lj)return/rv:([^\);]+)(\)|;)/.exec(e);if(Oj)return/Edge\/([\d\.]+)/.exec(e);if(Xa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(iF)return/WebKit\/(\S+)/.exec(e);if(rF)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Bv&&(Vv=Bv?Bv[1]:""),Xa){var zv=Pj();if(zv!=null&&zv>parseFloat(Vv)){xd=String(zv);break e}}xd=Vv}var oF={};function sF(){return nF(function(){for(var e=0,t=xN(String(xd)).split("."),n=xN("9").split("."),r=Math.max(t.length,n.length),o=0;e==0&&o<r;o++){var s=t[o]||"",u=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],s[0].length==0&&u[0].length==0)break;e=$v(s[1].length==0?0:parseInt(s[1],10),u[1].length==0?0:parseInt(u[1],10))||$v(s[2].length==0,u[2].length==0)||$v(s[2],u[2]),s=s[3],u=u[3]}while(e==0)}return 0<=e})}var Qy;if(Ie.document&&Xa){var NN=Pj();Qy=NN||parseInt(xd,10)||void 0}else Qy=void 0;var aF=Qy,uF=function(){if(!Ie.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Ie.addEventListener("test",yd,t),Ie.removeEventListener("test",yd,t)}catch{}return e}();function vn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}vn.prototype.h=function(){this.defaultPrevented=!0};function uc(e,t){if(vn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Lj){e:{try{Sw(t.nodeName);var o=!0;break e}catch{}o=!1}o||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:lF[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&uc.Z.h.call(this)}}an(uc,vn);var lF={2:"touch",3:"pen",4:"mouse"};uc.prototype.h=function(){uc.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var lp="closure_listenable_"+(1e6*Math.random()|0),cF=0;function hF(e,t,n,r,o){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=o,this.key=++cF,this.ca=this.fa=!1}function cp(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function hp(e){this.src=e,this.g={},this.h=0}hp.prototype.add=function(e,t,n,r,o){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var u=Jy(e,t,r,o);return-1<u?(t=e[u],n||(t.fa=!1)):(t=new hF(t,this.src,s,!!r,o),t.fa=n,e.push(t)),t};function Xy(e,t){var n=t.type;if(n in e.g){var r=e.g[n],o=Aj(r,t),s;(s=0<=o)&&Array.prototype.splice.call(r,o,1),s&&(cp(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function Jy(e,t,n,r){for(var o=0;o<e.length;++o){var s=e[o];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return o}return-1}var _w="closure_lm_"+(1e6*Math.random()|0),qv={};function Uj(e,t,n,r,o){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Uj(e,t[s],n,r,o);return null}return n=Vj(n),e&&e[lp]?e.N(t,n,up(r)?!!r.capture:!1,o):fF(e,t,n,!1,r,o)}function fF(e,t,n,r,o,s){if(!t)throw Error("Invalid event type");var u=up(o)?!!o.capture:!!o,c=Ew(e);if(c||(e[_w]=c=new hp(e)),n=c.add(t,n,r,u,s),n.proxy)return n;if(r=dF(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)uF||(o=u),o===void 0&&(o=!1),e.addEventListener(t.toString(),r,o);else if(e.attachEvent)e.attachEvent($j(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function dF(){function e(n){return t.call(e.src,e.listener,n)}var t=pF;return e}function Fj(e,t,n,r,o){if(Array.isArray(t))for(var s=0;s<t.length;s++)Fj(e,t[s],n,r,o);else r=up(r)?!!r.capture:!!r,n=Vj(n),e&&e[lp]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],n=Jy(s,n,r,o),-1<n&&(cp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=Ew(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Jy(t,n,r,o)),(n=-1<e?t[e]:null)&&Nw(n))}function Nw(e){if(typeof e!="number"&&e&&!e.ca){var t=e.src;if(t&&t[lp])Xy(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent($j(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ew(t))?(Xy(n,e),n.h==0&&(n.src=null,t[_w]=null)):cp(e)}}}function $j(e){return e in qv?qv[e]:qv[e]="on"+e}function pF(e,t){if(e.ca)e=!0;else{t=new uc(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&Nw(e),e=n.call(r,t)}return e}function Ew(e){return e=e[_w],e instanceof hp?e:null}var Kv="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vj(e){return typeof e=="function"?e:(e[Kv]||(e[Kv]=function(t){return e.handleEvent(t)}),e[Kv])}function Qt(){To.call(this),this.i=new hp(this),this.P=this,this.I=null}an(Qt,To);Qt.prototype[lp]=!0;Qt.prototype.removeEventListener=function(e,t,n,r){Fj(this,e,t,n,r)};function on(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,typeof t=="string")t=new vn(t,e);else if(t instanceof vn)t.target=t.target||e;else{var o=t;t=new vn(r,e),Rj(t,o)}if(o=!0,n)for(var s=n.length-1;0<=s;s--){var u=t.g=n[s];o=gf(u,r,!0,t)&&o}if(u=t.g=e,o=gf(u,r,!0,t)&&o,o=gf(u,r,!1,t)&&o,n)for(s=0;s<n.length;s++)u=t.g=n[s],o=gf(u,r,!1,t)&&o}Qt.prototype.M=function(){if(Qt.Z.M.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)cp(n[r]);delete e.g[t],e.h--}}this.I=null};Qt.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};Qt.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function gf(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var o=!0,s=0;s<t.length;++s){var u=t[s];if(u&&!u.ca&&u.capture==n){var c=u.listener,f=u.ia||u.src;u.fa&&Xy(e.i,u),o=c.call(f,r)!==!1&&o}}return o&&!r.defaultPrevented}var Iw=Ie.JSON.stringify;function mF(){var e=zj,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var gF=function(){function e(){this.h=this.g=null}return e.prototype.add=function(t,n){var r=Bj.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r},e}(),Bj=new(function(){function e(t,n){this.i=t,this.j=n,this.h=0,this.g=null}return e.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},e}())(function(){return new vF},function(e){return e.reset()}),vF=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(t,n){this.h=t,this.g=n,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function yF(e){Ie.setTimeout(function(){throw e},0)}function Tw(e,t){Zy||wF(),e0||(Zy(),e0=!0),zj.add(e,t)}var Zy;function wF(){var e=Ie.Promise.resolve(void 0);Zy=function(){e.then(xF)}}var e0=!1,zj=new gF;function xF(){for(var e;e=mF();){try{e.h.call(e.g)}catch(n){yF(n)}var t=Bj;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}e0=!1}function fp(e,t){Qt.call(this),this.h=e||1,this.g=t||Ie,this.j=rn(this.kb,this),this.l=Date.now()}an(fp,Qt);ce=fp.prototype;ce.da=!1;ce.S=null;ce.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),on(this,"tick"),this.da&&(jw(this),this.start()))}};ce.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function jw(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}ce.M=function(){fp.Z.M.call(this),jw(this),delete this.g};function kw(e,t,n){if(typeof e=="function")n&&(e=rn(e,n));else if(e&&typeof e.handleEvent=="function")e=rn(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:Ie.setTimeout(e,t||0)}function qj(e){e.g=kw(function(){e.g=null,e.i&&(e.i=!1,qj(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}var bF=function(e){QU(t,e);function t(n,r){var o=e.call(this)||this;return o.m=n,o.j=r,o.h=null,o.i=!1,o.g=null,o}return t.prototype.l=function(n){this.h=arguments,this.g?this.i=!0:qj(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(Ie.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(To);function lc(e){To.call(this),this.h=e,this.g={}}an(lc,To);var EN=[];function Kj(e,t,n,r){Array.isArray(n)||(n&&(EN[0]=n.toString()),n=EN);for(var o=0;o<n.length;o++){var s=Uj(t,n[o],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Hj(e){bw(e.g,function(t,n){this.g.hasOwnProperty(n)&&Nw(t)},e),e.g={}}lc.prototype.M=function(){lc.Z.M.call(this),Hj(this)};lc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function dp(){this.g=!0}dp.prototype.Aa=function(){this.g=!1};function SF(e,t,n,r,o,s){e.info(function(){if(e.g)if(s)for(var u="",c=s.split("&"),f=0;f<c.length;f++){var p=c[f].split("=");if(1<p.length){var m=p[0];p=p[1];var y=m.split("_");u=2<=y.length&&y[1]=="type"?u+(m+"="+p+"&"):u+(m+"=redacted&")}}else u=null;else u=s;return"XMLHTTP REQ ("+r+") [attempt "+o+"]: "+t+`
`+n+`
`+u})}function _F(e,t,n,r,o,s,u){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+o+"]: "+t+`
`+n+`
`+s+" "+u})}function Ra(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+EF(e,n)+(r?" "+r:"")})}function NF(e,t){e.info(function(){return"TIMEOUT: "+t})}dp.prototype.info=function(){};function EF(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var o=r[1];if(Array.isArray(o)&&!(1>o.length)){var s=o[0];if(s!="noop"&&s!="stop"&&s!="close")for(var u=1;u<o.length;u++)o[u]=""}}}}return Iw(n)}catch{return t}}var Ms={},IN=null;function pp(){return IN=IN||new Qt}Ms.Ma="serverreachability";function Gj(e){vn.call(this,Ms.Ma,e)}an(Gj,vn);function cc(e){var t=pp();on(t,new Gj(t))}Ms.STAT_EVENT="statevent";function Wj(e,t){vn.call(this,Ms.STAT_EVENT,e),this.stat=t}an(Wj,vn);function Tn(e){var t=pp();on(t,new Wj(t,e))}Ms.Na="timingevent";function Yj(e,t){vn.call(this,Ms.Na,e),this.size=t}an(Yj,vn);function Dc(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return Ie.setTimeout(function(){e()},t)}var mp={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Qj={};function Cw(){}Cw.prototype.h=null;function TN(e){return e.h||(e.h=e.i())}function Xj(){}var Mc={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Aw(){vn.call(this,"d")}an(Aw,vn);function Dw(){vn.call(this,"c")}an(Dw,vn);var t0;function gp(){}an(gp,Cw);gp.prototype.g=function(){return new XMLHttpRequest};gp.prototype.i=function(){return{}};t0=new gp;function Rc(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new lc(this),this.P=IF,e=Yy?125:void 0,this.W=new fp(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Jj}function Jj(){this.i=null,this.g="",this.h=!1}var IF=45e3,n0={},bd={};ce=Rc.prototype;ce.setTimeout=function(e){this.P=e};function r0(e,t,n){e.K=1,e.v=yp(Di(t)),e.s=n,e.U=!0,Zj(e,null)}function Zj(e,t){e.F=Date.now(),Oc(e),e.A=Di(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),sk(n.h,"t",r),e.C=0,n=e.l.H,e.h=new Jj,e.g=Ik(e.l,n?t:null,!e.s),0<e.O&&(e.L=new bF(rn(e.Ia,e,e.g),e.O)),Kj(e.V,e.g,"readystatechange",e.gb),t=e.H?Mj(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),cc(),SF(e.j,e.u,e.A,e.m,e.X,e.s)}ce.gb=function(e){e=e.target;var t=this.L;t&&Si(e)==3?t.l():this.Ia(e)};ce.Ia=function(e){try{if(e==this.g)e:{var t=Si(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(t!=3||Yy||this.g&&(this.h.h||this.g.ga()||AN(this.g)))){this.I||t!=4||n==7||(n==8||0>=r?cc(3):cc(2)),vp(this);var o=this.g.ba();this.N=o;t:if(ek(this)){var s=AN(this.g);e="";var u=s.length,c=Si(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){as(this),Ll(this);var f="";break t}this.h.i=new Ie.TextDecoder}for(n=0;n<u;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:c&&n==u-1});s.splice(0,u),this.h.g+=e,this.C=0,f=this.h.g}else f=this.g.ga();if(this.i=o==200,_F(this.j,this.u,this.A,this.m,this.X,t,o),this.i){if(this.$&&!this.J){t:{if(this.g){var p,m=this.g;if((p=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wd(p)){var y=p;break t}}y=null}if(o=y)Ra(this.j,this.m,o,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,i0(this,o);else{this.i=!1,this.o=3,Tn(12),as(this),Ll(this);break e}}this.U?(tk(this,t,f),Yy&&this.i&&t==3&&(Kj(this.V,this.W,"tick",this.fb),this.W.start())):(Ra(this.j,this.m,f,null),i0(this,f)),t==4&&as(this),this.i&&!this.I&&(t==4?Sk(this.l,this):(this.i=!1,Oc(this)))}else o==400&&0<f.indexOf("Unknown SID")?(this.o=3,Tn(12)):(this.o=0,Tn(13)),as(this),Ll(this)}}}catch{}finally{}};function ek(e){return e.g?e.u=="GET"&&e.K!=2&&e.l.Ba:!1}function tk(e,t,n){for(var r=!0,o;!e.I&&e.C<n.length;)if(o=TF(e,n),o==bd){t==4&&(e.o=4,Tn(14),r=!1),Ra(e.j,e.m,null,"[Incomplete Response]");break}else if(o==n0){e.o=4,Tn(15),Ra(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else Ra(e.j,e.m,o,null),i0(e,o);ek(e)&&o!=bd&&o!=n0&&(e.h.g="",e.C=0),t!=4||n.length!=0||e.h.h||(e.o=1,Tn(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.aa&&(e.aa=!0,t=e.l,t.g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vw(t),t.L=!0,Tn(11))):(Ra(e.j,e.m,n,"[Invalid Chunked Response]"),as(e),Ll(e))}ce.fb=function(){if(this.g){var e=Si(this.g),t=this.g.ga();this.C<t.length&&(vp(this),tk(this,e,t),this.i&&e!=4&&Oc(this))}};function TF(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?bd:(n=Number(t.substring(n,r)),isNaN(n)?n0:(r+=1,r+n>t.length?bd:(t=t.substr(r,n),e.C=r+n,t)))}ce.cancel=function(){this.I=!0,as(this)};function Oc(e){e.Y=Date.now()+e.P,nk(e,e.P)}function nk(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=Dc(rn(e.eb,e),t)}function vp(e){e.B&&(Ie.clearTimeout(e.B),e.B=null)}ce.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(NF(this.j,this.A),this.K!=2&&(cc(),Tn(17)),as(this),this.o=2,Ll(this)):nk(this,this.Y-e)};function Ll(e){e.l.G==0||e.I||Sk(e.l,e)}function as(e){vp(e);var t=e.L;t&&typeof t.na=="function"&&t.na(),e.L=null,jw(e.W),Hj(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function i0(e,t){try{var n=e.l;if(n.G!=0&&(n.g==e||o0(n.i,e))){if(n.I=e.N,!e.J&&o0(n.i,e)&&n.G==3){try{var r=n.Ca.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var o=r;if(o[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<e.F)Ed(n),bp(n);else break e;$w(n),Tn(18)}}else n.ta=o[1],0<n.ta-n.U&&37500>o[2]&&n.N&&n.A==0&&!n.v&&(n.v=Dc(rn(n.ab,n),6e3));if(1>=lk(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else us(n,11)}else if((e.J||n.g==e)&&Ed(n),!wd(t))for(o=n.Ca.g.parse(t),t=0;t<o.length;t++){var s=o[t];if(n.U=s[0],s=s[1],n.G==2)if(s[0]=="c"){n.J=s[1],n.la=s[2];var u=s[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));var c=s[4];c!=null&&(n.za=c,n.h.info("SVER="+n.za));var f=s[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var p=e.g;if(p){var m=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var y=r.i;!y.g&&(En(m,"spdy")||En(m,"quic")||En(m,"h2"))&&(y.j=y.l,y.g=new Set,y.h&&(Ow(y,y.h),y.h=null))}if(r.D){var v=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.sa=v,ht(r.F,r.D,v))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var w=e;if(r.oa=Ek(r,r.H?r.la:null,r.W),w.J){ck(r.i,w);var E=w,_=r.K;_&&E.setTimeout(_),E.B&&(vp(E),Oc(E)),r.g=w}else xk(r);0<n.l.length&&Sp(n)}else s[0]!="stop"&&s[0]!="close"||us(n,7);else n.G==3&&(s[0]=="stop"||s[0]=="close"?s[0]=="stop"?us(n,7):Fw(n):s[0]!="noop"&&n.j&&n.j.wa(s),n.A=0)}}cc(4)}catch{}}function jF(e){if(e.R&&typeof e.R=="function")return e.R();if(typeof e=="string")return e.split("");if(Wy(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function Mw(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Wy(e)||typeof e=="string")Dj(e,t,void 0);else{if(e.T&&typeof e.T=="function")var n=e.T();else if(e.R&&typeof e.R=="function")n=void 0;else if(Wy(e)||typeof e=="string"){n=[];for(var r=e.length,o=0;o<r;o++)n.push(o)}else for(o in n=[],r=0,e)n[r++]=o;r=jF(e),o=r.length;for(var s=0;s<o;s++)t.call(void 0,r[s],n&&n[s],e)}}function yu(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof yu)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}ce=yu.prototype;ce.R=function(){Rw(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e};ce.T=function(){return Rw(this),this.g.concat()};function Rw(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Ns(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var o={};for(n=t=0;t<e.g.length;)r=e.g[t],Ns(o,r)||(e.g[n++]=r,o[r]=1),t++;e.g.length=n}}ce.get=function(e,t){return Ns(this.h,e)?this.h[e]:t};ce.set=function(e,t){Ns(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t};ce.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var o=n[r],s=this.get(o);e.call(t,s,o,this)}};function Ns(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var rk=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function kF(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),o=null;if(0<=r){var s=e[n].substring(0,r);o=e[n].substring(r+1)}else s=e[n];t(s,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}function Es(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Es){this.g=t!==void 0?t:e.g,Sd(this,e.j),this.s=e.s,_d(this,e.i),Nd(this,e.m),this.l=e.l,t=e.h;var n=new hc;n.i=t.i,t.g&&(n.g=new yu(t.g),n.h=t.h),jN(this,n),this.o=e.o}else e&&(n=String(e).match(rk))?(this.g=!!t,Sd(this,n[1]||"",!0),this.s=Pl(n[2]||""),_d(this,n[3]||"",!0),Nd(this,n[4]),this.l=Pl(n[5]||"",!0),jN(this,n[6]||"",!0),this.o=Pl(n[7]||"")):(this.g=!!t,this.h=new hc(null,this.g))}Es.prototype.toString=function(){var e=[],t=this.j;t&&e.push(El(t,kN,!0),":");var n=this.i;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(El(t,kN,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&e.push("/"),e.push(El(n,n.charAt(0)=="/"?RF:MF,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",El(n,LF)),e.join("")};function Di(e){return new Es(e)}function Sd(e,t,n){e.j=n?Pl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function _d(e,t,n){e.i=n?Pl(t,!0):t}function Nd(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function jN(e,t,n){t instanceof hc?(e.h=t,PF(e.h,e.g)):(n||(t=El(t,OF)),e.h=new hc(t,e.g))}function ht(e,t,n){e.h.set(t,n)}function yp(e){return ht(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function CF(e){return e instanceof Es?Di(e):new Es(e,void 0)}function AF(e,t,n,r){var o=new Es(null,void 0);return e&&Sd(o,e),t&&_d(o,t),n&&Nd(o,n),r&&(o.l=r),o}function Pl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function El(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,DF),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function DF(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var kN=/[#\/\?@]/g,MF=/[#\?:]/g,RF=/[#\?]/g,OF=/[#\?@]/g,LF=/#/g;function hc(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jo(e){e.g||(e.g=new yu,e.h=0,e.i&&kF(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}ce=hc.prototype;ce.add=function(e,t){jo(this),this.i=null,e=wu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function ik(e,t){jo(e),t=wu(e,t),Ns(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,e=e.g,Ns(e.h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Rw(e)))}function ok(e,t){return jo(e),t=wu(e,t),Ns(e.g.h,t)}ce.forEach=function(e,t){jo(this),this.g.forEach(function(n,r){Dj(n,function(o){e.call(t,o,r,this)},this)},this)};ce.T=function(){jo(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var o=e[r],s=0;s<o.length;s++)n.push(t[r]);return n};ce.R=function(e){jo(this);var t=[];if(typeof e=="string")ok(this,e)&&(t=wN(t,this.g.get(wu(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=wN(t,e[n])}return t};ce.set=function(e,t){return jo(this),this.i=null,e=wu(this,e),ok(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};ce.get=function(e,t){return e?(e=this.R(e),0<e.length?String(e[0]):t):t};function sk(e,t,n){ik(e,t),0<n.length&&(e.i=null,e.g.set(wu(e,t),xw(n)),e.h+=n.length)}ce.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],o=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var u=o;r[s]!==""&&(u+="="+encodeURIComponent(String(r[s]))),e.push(u)}}return this.i=e.join("&")};function wu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function PF(e,t){t&&!e.j&&(jo(e),e.i=null,e.g.forEach(function(n,r){var o=r.toLowerCase();r!=o&&(ik(this,r),sk(this,o,n))},e)),e.j=t}var UF=function(){function e(t,n){this.h=t,this.g=n}return e}();function ak(e){this.l=e||FF,Ie.PerformanceNavigationTiming?(e=Ie.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(Ie.g&&Ie.g.Ea&&Ie.g.Ea()&&Ie.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var FF=10;function uk(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function lk(e){return e.h?1:e.g?e.g.size:0}function o0(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Ow(e,t){e.g?e.g.add(t):e.h=t}function ck(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}ak.prototype.cancel=function(){var e,t;if(this.i=hk(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){try{for(var n=Cj(this.g.values()),r=n.next();!r.done;r=n.next()){var o=r.value;o.cancel()}}catch(s){e={error:s}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}};function hk(e){var t,n;if(e.h!=null)return e.i.concat(e.h.D);if(e.g!=null&&e.g.size!==0){var r=e.i;try{for(var o=Cj(e.g.values()),s=o.next();!s.done;s=o.next()){var u=s.value;r=r.concat(u.D)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}return xw(e.i)}function Lw(){}Lw.prototype.stringify=function(e){return Ie.JSON.stringify(e,void 0)};Lw.prototype.parse=function(e){return Ie.JSON.parse(e,void 0)};function $F(){this.g=new Lw}function VF(e,t,n){var r=n||"";try{Mw(e,function(o,s){var u=o;up(o)&&(u=Iw(o)),t.push(r+s+"="+encodeURIComponent(u))})}catch(o){throw t.push(r+"type="+encodeURIComponent("_badmap")),o}}function BF(e,t){var n=new dp;if(Ie.Image){var r=new Image;r.onload=mf(vf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=mf(vf,n,r,"TestLoadImage: error",!1,t),r.onabort=mf(vf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=mf(vf,n,r,"TestLoadImage: timeout",!1,t),Ie.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function vf(e,t,n,r,o){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,o(r)}catch{}}function Lc(e){this.l=e.$b||null,this.j=e.ib||!1}an(Lc,Cw);Lc.prototype.g=function(){return new wp(this.l,this.j)};Lc.prototype.i=function(e){return function(){return e}}({});function wp(e,t){Qt.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Pw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}an(wp,Qt);var Pw=0;ce=wp.prototype;ce.open=function(e,t){if(this.readyState!=Pw)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,fc(this)};ce.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Ie).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))};ce.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pc(this)),this.readyState=Pw};ce.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,fc(this)),this.g&&(this.readyState=3,fc(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof Ie.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fk(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))};function fk(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}ce.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pc(this):fc(this),this.readyState==3&&fk(this)}};ce.Ua=function(e){this.g&&(this.response=this.responseText=e,Pc(this))};ce.Ta=function(e){this.g&&(this.response=e,Pc(this))};ce.ha=function(){this.g&&Pc(this)};function Pc(e){e.readyState=4,e.l=null,e.j=null,e.A=null,fc(e)}ce.setRequestHeader=function(e,t){this.v.append(e,t)};ce.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};ce.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function fc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(wp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var zF=Ie.JSON.parse;function Ut(e){Qt.call(this),this.headers=new yu,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=dk,this.K=this.L=!1}an(Ut,Qt);var dk="",qF=/^https?$/i,KF=["POST","PUT"];ce=Ut.prototype;ce.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():t0.g(),this.C=this.u?TN(this.u):TN(t0),this.g.onreadystatechange=rn(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){CN(this,s);return}e=n||"";var o=new yu(this.headers);r&&Mw(r,function(s,u){o.set(u,s)}),r=tF(o.T()),n=Ie.FormData&&e instanceof Ie.FormData,!(0<=Aj(KF,t))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(s,u){this.g.setRequestHeader(u,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{gk(this),0<this.B&&((this.K=HF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=rn(this.pa,this)):this.A=kw(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){CN(this,s)}};function HF(e){return Xa&&sF()&&typeof e.timeout=="number"&&e.ontimeout!==void 0}function GF(e){return e.toLowerCase()=="content-type"}ce.pa=function(){typeof ww<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,on(this,"timeout"),this.abort(8))};function CN(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,pk(e),xp(e)}function pk(e){e.D||(e.D=!0,on(e,"complete"),on(e,"error"))}ce.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,on(this,"complete"),on(this,"abort"),xp(this))};ce.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),xp(this,!0)),Ut.Z.M.call(this)};ce.Fa=function(){this.s||(this.F||this.v||this.l?mk(this):this.cb())};ce.cb=function(){mk(this)};function mk(e){if(e.h&&typeof ww<"u"&&(!e.C[1]||Si(e)!=4||e.ba()!=2)){if(e.v&&Si(e)==4)kw(e.Fa,0,e);else if(on(e,"readystatechange"),Si(e)==4){e.h=!1;try{var t=e.ba();e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break e;default:n=!1}var r;if(!(r=n)){var o;if(o=t===0){var s=String(e.H).match(rk)[1]||null;if(!s&&Ie.self&&Ie.self.location){var u=Ie.self.location.protocol;s=u.substr(0,u.length-1)}o=!qF.test(s?s.toLowerCase():"")}r=o}if(r)on(e,"complete"),on(e,"success");else{e.m=6;try{var c=2<Si(e)?e.g.statusText:""}catch{c=""}e.j=c+" ["+e.ba()+"]",pk(e)}}finally{xp(e)}}}}function xp(e,t){if(e.g){gk(e);var n=e.g,r=e.C[0]?yd:null;e.g=null,e.C=null,t||on(e,"ready");try{n.onreadystatechange=r}catch{}}}function gk(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Ie.clearTimeout(e.A),e.A=null)}function Si(e){return e.g?e.g.readyState:0}ce.ba=function(){try{return 2<Si(this)?this.g.status:-1}catch{return-1}};ce.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};ce.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),zF(t)}};function AN(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case dk:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}ce.Da=function(){return this.m};ce.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function WF(e){var t="";return bw(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function Uw(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=WF(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):ht(e,t,n))}function yl(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function vk(e){this.za=0,this.l=[],this.h=new dp,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=yl("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=yl("baseRetryDelayMs",5e3,e),this.$a=yl("retryDelaySeedMs",1e4,e),this.Ya=yl("forwardChannelMaxRetries",2,e),this.ra=yl("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new ak(e&&e.concurrentRequestLimit),this.Ca=new $F,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||e.Xb!==!1}ce=vk.prototype;ce.ma=8;ce.G=1;function Fw(e){if(yk(e),e.G==3){var t=e.V++,n=Di(e.F);ht(n,"SID",e.J),ht(n,"RID",t),ht(n,"TYPE","terminate"),Uc(e,n),t=new Rc(e,e.h,t,void 0),t.K=2,t.v=yp(Di(n)),n=!1,Ie.navigator&&Ie.navigator.sendBeacon&&(n=Ie.navigator.sendBeacon(t.v.toString(),"")),!n&&Ie.Image&&(new Image().src=t.v,n=!0),n||(t.g=Ik(t.l,null),t.g.ea(t.v)),t.F=Date.now(),Oc(t)}Nk(e)}ce.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}};function bp(e){e.g&&(Vw(e),e.g.cancel(),e.g=null)}function yk(e){bp(e),e.u&&(Ie.clearTimeout(e.u),e.u=null),Ed(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&Ie.clearTimeout(e.m),e.m=null)}function Hv(e,t){e.l.push(new UF(e.Za++,t)),e.G==3&&Sp(e)}function Sp(e){uk(e.i)||e.m||(e.m=!0,Tw(e.Ha,e),e.C=0)}function YF(e,t){return lk(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.l=t.D.concat(e.l),!0):e.G==1||e.G==2||e.C>=(e.Xa?0:e.Ya)?!1:(e.m=Dc(rn(e.Ha,e,t),_k(e,e.C)),e.C++,!0)}ce.Ha=function(e){if(this.m)if(this.m=null,this.G==1){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new Rc(this,this.h,e,void 0),n=this.s;if(this.P&&(n?(n=Mj(n),Rj(n,this.P)):n=this.P),this.o===null&&(t.H=n),this.ja)e:{for(var r=0,o=0;o<this.l.length;o++){t:{var s=this.l[o];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(r+=s,4096<r){r=o;break e}if(r===4096||o===this.l.length-1){r=o+1;break e}}r=1e3}else r=1e3;r=wk(this,t,r),o=Di(this.F),ht(o,"RID",e),ht(o,"CVER",22),this.D&&ht(o,"X-HTTP-Session-Id",this.D),Uc(this,o),this.o&&n&&Uw(o,this.o,n),Ow(this.i,t),this.Ra&&ht(o,"TYPE","init"),this.ja?(ht(o,"$req",r),ht(o,"SID","null"),t.$=!0,r0(t,o,null)):r0(t,o,r),this.G=2}}else this.G==3&&(e?DN(this,e):this.l.length==0||uk(this.i)||DN(this))};function DN(e,t){var n;t?n=t.m:n=e.V++;var r=Di(e.F);ht(r,"SID",e.J),ht(r,"RID",n),ht(r,"AID",e.U),Uc(e,r),e.o&&e.s&&Uw(r,e.o,e.s),n=new Rc(e,e.h,n,e.C+1),e.o===null&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=wk(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Ow(e.i,n),r0(n,r,t)}function Uc(e,t){e.j&&Mw({},function(n,r){ht(t,r,n)})}function wk(e,t,n){n=Math.min(e.l.length,n);var r=e.j?rn(e.j.Oa,e.j,e):null;e:for(var o=e.l,s=-1;;){var u=["count="+n];s==-1?0<n?(s=o[0].h,u.push("ofs="+s)):s=0:u.push("ofs="+s);for(var c=!0,f=0;f<n;f++){var p=o[f].h,m=o[f].g;if(p-=s,0>p)s=Math.max(0,o[f].h-100),c=!1;else try{VF(m,u,"req"+p+"_")}catch{r&&r(m)}}if(c){r=u.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function xk(e){e.g||e.u||(e.Y=1,Tw(e.Ga,e),e.A=0)}function $w(e){return e.g||e.u||3<=e.A?!1:(e.Y++,e.u=Dc(rn(e.Ga,e),_k(e,e.A)),e.A++,!0)}ce.Ga=function(){if(this.u=null,bk(this),this.$&&!(this.L||this.g==null||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Dc(rn(this.bb,this),e)}};ce.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Tn(10),bp(this),bk(this))};function Vw(e){e.B!=null&&(Ie.clearTimeout(e.B),e.B=null)}function bk(e){e.g=new Rc(e,e.h,"rpc",e.Y),e.o===null&&(e.g.H=e.s),e.g.O=0;var t=Di(e.oa);ht(t,"RID","rpc"),ht(t,"SID",e.J),ht(t,"CI",e.N?"0":"1"),ht(t,"AID",e.U),Uc(e,t),ht(t,"TYPE","xmlhttp"),e.o&&e.s&&Uw(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=yp(Di(t)),n.s=null,n.U=!0,Zj(n,e)}ce.ab=function(){this.v!=null&&(this.v=null,bp(this),$w(this),Tn(19))};function Ed(e){e.v!=null&&(Ie.clearTimeout(e.v),e.v=null)}function Sk(e,t){var n=null;if(e.g==t){Ed(e),Vw(e),e.g=null;var r=2}else if(o0(e.i,t))n=t.D,ck(e.i,t),r=1;else return;if(e.I=t.N,e.G!=0){if(t.i)if(r==1){n=t.s?t.s.length:0,t=Date.now()-t.F;var o=e.C;r=pp(),on(r,new Yj(r,n)),Sp(e)}else xk(e);else if(o=t.o,o==3||o==0&&0<e.I||!(r==1&&YF(e,t)||r==2&&$w(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),o){case 1:us(e,5);break;case 4:us(e,10);break;case 3:us(e,6);break;default:us(e,2)}}}function _k(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function us(e,t){if(e.h.info("Error code "+t),t==2){var n=null;e.j&&(n=null);var r=rn(e.jb,e);n||(n=new Es("//www.google.com/images/cleardot.gif"),Ie.location&&Ie.location.protocol=="http"||Sd(n,"https"),yp(n)),BF(n.toString(),r)}else Tn(2);e.G=0,e.j&&e.j.va(t),Nk(e),yk(e)}ce.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Tn(2)):(this.h.info("Failed to ping google.com"),Tn(1))};function Nk(e){e.G=0,e.I=-1,e.j&&((hk(e.i).length!=0||e.l.length!=0)&&(e.i.i.length=0,xw(e.l),e.l.length=0),e.j.ua())}function Ek(e,t,n){var r=CF(n);if(r.i!="")t&&_d(r,t+"."+r.i),Nd(r,r.m);else{var o=Ie.location;r=AF(o.protocol,t?t+"."+o.hostname:o.hostname,+o.port,n)}return e.aa&&bw(e.aa,function(s,u){ht(r,u,s)}),t=e.D,n=e.sa,t&&n&&ht(r,t,n),ht(r,"VER",e.ma),Uc(e,r),r}function Ik(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return t=n&&e.Ba&&!e.qa?new Ut(new Lc({ib:!0})):new Ut(e.qa),t.L=e.H,t}function Tk(){}ce=Tk.prototype;ce.xa=function(){};ce.wa=function(){};ce.va=function(){};ce.ua=function(){};ce.Oa=function(){};function Id(){if(Xa&&!(10<=Number(aF)))throw Error("Environmental error: no available transport.")}Id.prototype.g=function(e,t){return new ur(e,t)};function ur(e,t){Qt.call(this),this.g=new vk(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!wd(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!wd(t)&&(this.g.D=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new xu(this)}an(ur,Qt);ur.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Tw(rn(e.hb,e,t))),Tn(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Ek(e,null,e.W),Sp(e)};ur.prototype.close=function(){Fw(this.g)};ur.prototype.u=function(e){if(typeof e=="string"){var t={};t.__data__=e,Hv(this.g,t)}else this.v?(t={},t.__data__=Iw(e),Hv(this.g,t)):Hv(this.g,e)};ur.prototype.M=function(){this.g.j=null,delete this.j,Fw(this.g),delete this.g,ur.Z.M.call(this)};function jk(e){Aw.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}an(jk,Aw);function kk(){Dw.call(this),this.status=1}an(kk,Dw);function xu(e){this.g=e}an(xu,Tk);xu.prototype.xa=function(){on(this.g,"a")};xu.prototype.wa=function(e){on(this.g,new jk(e))};xu.prototype.va=function(e){on(this.g,new kk)};xu.prototype.ua=function(){on(this.g,"b")};Id.prototype.createWebChannel=Id.prototype.g;ur.prototype.send=ur.prototype.u;ur.prototype.open=ur.prototype.m;ur.prototype.close=ur.prototype.close;mp.NO_ERROR=0;mp.TIMEOUT=8;mp.HTTP_ERROR=6;Qj.COMPLETE="complete";Xj.EventType=Mc;Mc.OPEN="a";Mc.CLOSE="b";Mc.ERROR="c";Mc.MESSAGE="d";Qt.prototype.listen=Qt.prototype.N;Ut.prototype.listenOnce=Ut.prototype.O;Ut.prototype.getLastError=Ut.prototype.La;Ut.prototype.getLastErrorCode=Ut.prototype.Da;Ut.prototype.getStatus=Ut.prototype.ba;Ut.prototype.getResponseJson=Ut.prototype.Qa;Ut.prototype.getResponseText=Ut.prototype.ga;Ut.prototype.send=Ut.prototype.ea;var QF=function(){return new Id},XF=function(){return pp()},Gv=mp,JF=Qj,ZF=Ms,MN={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},e$=Lc,yf=Xj,t$=Ut,n$={};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr=function(){function e(t,n){var r=this;this.previousValue=t,n&&(n.sequenceNumberHandler=function(o){return r.t(o)},this.i=function(o){return n.writeSequenceNumber(o)})}return e.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},e.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},e}();rr.o=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Y=function(e){function t(n,r){var o=this;return(o=e.call(this,r)||this).code=n,o.message=r,o.name="FirebaseError",o.toString=function(){return o.name+": [code="+o.code+"]: "+o.message},o}return be(t,e),t}(Error),Vr=new Ij("@firebase/firestore");function s0(){return Vr.logLevel}function ne(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Vr.logLevel<=Ke.DEBUG){var r=t.map(Bw);Vr.debug.apply(Vr,_t(["Firestore (8.10.1): "+e],r))}}function Lt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Vr.logLevel<=Ke.ERROR){var r=t.map(Bw);Vr.error.apply(Vr,_t(["Firestore (8.10.1): "+e],r))}}function Td(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Vr.logLevel<=Ke.WARN){var r=t.map(Bw);Vr.warn.apply(Vr,_t(["Firestore (8.10.1): "+e],r))}}function Bw(e){if(typeof e=="string")return e;try{return t=e,JSON.stringify(t)}catch{return e}var t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(e){e===void 0&&(e="Unexpected state");var t="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+e;throw Lt(t),new Error(t)}function _e(e,t){e||pe()}function ue(e,t){return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r$(e){var t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ck=function(){function e(){}return e.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length,r="";r.length<20;)for(var o=r$(40),s=0;s<o.length;++s)r.length<20&&o[s]<n&&(r+=t.charAt(o[s]%t.length));return r},e}();function Pe(e,t){return e<t?-1:e>t?1:0}function Ja(e,t,n){return e.length===t.length&&e.every(function(r,o){return n(r,t[o])})}function Ak(e){return e+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zn=function(){function e(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(t){return this.seconds===t.seconds?Pe(this.nanoseconds,t.nanoseconds):Pe(this.seconds,t.seconds)},e.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),Ae=function(){function e(t){this.timestamp=t}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new zn(0,0))},e.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},e.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Rs(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Dk(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mk=function(){function e(t,n,r){n===void 0?n=0:n>t.length&&pe(),r===void 0?r=t.length-n:r>t.length-n&&pe(),this.segments=t,this.offset=n,this.len=r}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return e.comparator(this,t)===0},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(r){n.push(r)}):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(t){return this.segments[this.offset+t]},e.prototype.isEmpty=function(){return this.length===0},e.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.forEach=function(t){for(var n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(t,n){for(var r=Math.min(t.length,n.length),o=0;o<r;o++){var s=t.get(o),u=n.get(o);if(s<u)return-1;if(s>u)return 1}return t.length<n.length?-1:t.length>n.length?1:0},e}(),He=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype.construct=function(n,r,o){return new t(n,r,o)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var o=[],s=0,u=n;s<u.length;s++){var c=u[s];if(c.indexOf("//")>=0)throw new Y(F.INVALID_ARGUMENT,"Invalid segment ("+c+"). Paths must not contain // in them.");o.push.apply(o,c.split("/").filter(function(f){return f.length>0}))}return new t(o)},t.emptyPath=function(){return new t([])},t}(Mk),i$=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Kr=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype.construct=function(n,r,o){return new t(n,r,o)},t.isValidIdentifier=function(n){return i$.test(n)},t.prototype.canonicalString=function(){return this.toArray().map(function(n){return n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(n)||(n="`"+n+"`"),n}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return this.length===1&&this.get(0)==="__name__"},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(n){for(var r=[],o="",s=0,u=function(){if(o.length===0)throw new Y(F.INVALID_ARGUMENT,"Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");r.push(o),o=""},c=!1;s<n.length;){var f=n[s];if(f==="\\"){if(s+1===n.length)throw new Y(F.INVALID_ARGUMENT,"Path has trailing escape character: "+n);var p=n[s+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Y(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);o+=p,s+=2}else f==="`"?(c=!c,s++):f!=="."||c?(o+=f,s++):(u(),s++)}if(u(),c)throw new Y(F.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new t(r)},t.emptyPath=function(){return new t([])},t}(Mk),Za=function(){function e(t){this.fields=t,t.sort(Kr.comparator)}return e.prototype.covers=function(t){for(var n=0,r=this.fields;n<r.length;n++)if(r[n].isPrefixOf(t))return!0;return!1},e.prototype.isEqual=function(t){return Ja(this.fields,t.fields,function(n,r){return n.isEqual(r)})},e}(),qn=function(){function e(t){this.binaryString=t}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(n){for(var r="",o=0;o<n.length;++o)r+=String.fromCharCode(n[o]);return r}(t))},e.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},e.prototype.toUint8Array=function(){return function(t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(t){return Pe(this.binaryString,t.binaryString)},e.prototype.isEqual=function(t){return this.binaryString===t.binaryString},e}();qn.EMPTY_BYTE_STRING=new qn("");var o$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function So(e){if(_e(!!e),typeof e=="string"){var t=0,n=o$.exec(e);if(_e(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var o=new Date(e);return{seconds:Math.floor(o.getTime()/1e3),nanos:t}}return{seconds:Rt(e.seconds),nanos:Rt(e.nanos)}}function Rt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function eu(e){return typeof e=="string"?qn.fromBase64String(e):qn.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Rk(e){var t=e.mapValue.fields.__previous_value__;return zw(t)?Rk(t):t}function dc(e){var t=So(e.mapValue.fields.__local_write_time__.timestampValue);return new zn(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(e){return e==null}function jd(e){return e===0&&1/e==-1/0}function Ok(e){return typeof e=="number"&&Number.isInteger(e)&&!jd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me=function(){function e(t){this.path=t}return e.fromPath=function(t){return new e(He.fromString(t))},e.fromName=function(t){return new e(He.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},e.prototype.isEqual=function(t){return t!==null&&He.comparator(this.path,t.path)===0},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(t,n){return He.comparator(t.path,n.path)},e.isDocumentKey=function(t){return t.length%2==0},e.fromSegments=function(t){return new e(new He(t.slice()))},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?zw(e)?4:10:pe()}function li(e,t){var n=Is(e);if(n!==Is(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dc(e).isEqual(dc(t));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;var s=So(r.timestampValue),u=So(o.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,o){return eu(r.bytesValue).isEqual(eu(o.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,o){return Rt(r.geoPointValue.latitude)===Rt(o.geoPointValue.latitude)&&Rt(r.geoPointValue.longitude)===Rt(o.geoPointValue.longitude)}(e,t);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return Rt(r.integerValue)===Rt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){var s=Rt(r.doubleValue),u=Rt(o.doubleValue);return s===u?jd(s)===jd(u):isNaN(s)&&isNaN(u)}return!1}(e,t);case 9:return Ja(e.arrayValue.values||[],t.arrayValue.values||[],li);case 10:return function(r,o){var s=r.mapValue.fields||{},u=o.mapValue.fields||{};if(RN(s)!==RN(u))return!1;for(var c in s)if(s.hasOwnProperty(c)&&(u[c]===void 0||!li(s[c],u[c])))return!1;return!0}(e,t);default:return pe()}}function pc(e,t){return(e.values||[]).find(function(n){return li(n,t)})!==void 0}function tu(e,t){var n=Is(e),r=Is(t);if(n!==r)return Pe(n,r);switch(n){case 0:return 0;case 1:return Pe(e.booleanValue,t.booleanValue);case 2:return function(o,s){var u=Rt(o.integerValue||o.doubleValue),c=Rt(s.integerValue||s.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(e,t);case 3:return ON(e.timestampValue,t.timestampValue);case 4:return ON(dc(e),dc(t));case 5:return Pe(e.stringValue,t.stringValue);case 6:return function(o,s){var u=eu(o),c=eu(s);return u.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(o,s){for(var u=o.split("/"),c=s.split("/"),f=0;f<u.length&&f<c.length;f++){var p=Pe(u[f],c[f]);if(p!==0)return p}return Pe(u.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(o,s){var u=Pe(Rt(o.latitude),Rt(s.latitude));return u!==0?u:Pe(Rt(o.longitude),Rt(s.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(o,s){for(var u=o.values||[],c=s.values||[],f=0;f<u.length&&f<c.length;++f){var p=tu(u[f],c[f]);if(p)return p}return Pe(u.length,c.length)}(e.arrayValue,t.arrayValue);case 10:return function(o,s){var u=o.fields||{},c=Object.keys(u),f=s.fields||{},p=Object.keys(f);c.sort(),p.sort();for(var m=0;m<c.length&&m<p.length;++m){var y=Pe(c[m],p[m]);if(y!==0)return y;var v=tu(u[c[m]],f[p[m]]);if(v!==0)return v}return Pe(c.length,p.length)}(e.mapValue,t.mapValue);default:throw pe()}}function ON(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Pe(e,t);var n=So(e),r=So(t),o=Pe(n.seconds,r.seconds);return o!==0?o:Pe(n.nanos,r.nanos)}function qw(e){return a0(e)}function a0(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){var o=So(r);return"time("+o.seconds+","+o.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?eu(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,me.fromName(n).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(r){for(var o="[",s=!0,u=0,c=r.values||[];u<c.length;u++)s?s=!1:o+=",",o+=a0(c[u]);return o+"]"}(e.arrayValue):"mapValue"in e?function(r){for(var o="{",s=!0,u=0,c=Object.keys(r.fields||{}).sort();u<c.length;u++){var f=c[u];s?s=!1:o+=",",o+=f+":"+a0(r.fields[f])}return o+"}"}(e.mapValue):pe();var t,n}function kd(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function u0(e){return!!e&&"integerValue"in e}function Kw(e){return!!e&&"arrayValue"in e}function LN(e){return!!e&&"nullValue"in e}function PN(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $f(e){return!!e&&"mapValue"in e}function Ul(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Rs(e.mapValue.fields,function(o,s){return t.mapValue.fields[o]=Ul(s)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ul(e.arrayValue.values[r]);return n}return Object.assign({},e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var er=function(){function e(t){this.value=t}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(t){if(t.isEmpty())return this.value;for(var n=this.value,r=0;r<t.length-1;++r)if(!$f(n=(n.mapValue.fields||{})[t.get(r)]))return null;return(n=(n.mapValue.fields||{})[t.lastSegment()])||null},e.prototype.set=function(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ul(n)},e.prototype.setAll=function(t){var n=this,r=Kr.emptyPath(),o={},s=[];t.forEach(function(c,f){if(!r.isImmediateParentOf(f)){var p=n.getFieldsMap(r);n.applyChanges(p,o,s),o={},s=[],r=f.popLast()}c?o[f.lastSegment()]=Ul(c):s.push(f.lastSegment())});var u=this.getFieldsMap(r);this.applyChanges(u,o,s)},e.prototype.delete=function(t){var n=this.field(t.popLast());$f(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]},e.prototype.isEqual=function(t){return li(this.value,t.value)},e.prototype.getFieldsMap=function(t){var n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(var r=0;r<t.length;++r){var o=n.mapValue.fields[t.get(r)];$f(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=o),n=o}return n.mapValue.fields},e.prototype.applyChanges=function(t,n,r){Rs(n,function(c,f){return t[c]=f});for(var o=0,s=r;o<s.length;o++){var u=s[o];delete t[u]}},e.prototype.clone=function(){return new e(Ul(this.value))},e}();function Lk(e){var t=[];return Rs(e.fields,function(n,r){var o=new Kr([n]);if($f(r)){var s=Lk(r.mapValue).fields;if(s.length===0)t.push(o);else for(var u=0,c=s;u<c.length;u++){var f=c[u];t.push(o.child(f))}}else t.push(o)}),new Za(t)}var wn=function(){function e(t,n,r,o,s){this.key=t,this.documentType=n,this.version=r,this.data=o,this.documentState=s}return e.newInvalidDocument=function(t){return new e(t,0,Ae.min(),er.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,er.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,er.empty(),2)},e.prototype.convertToFoundDocument=function(t,n){return this.version=t,this.documentType=1,this.data=n,this.documentState=0,this},e.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=er.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=er.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return this.documentState===1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return this.documentState===2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return this.documentType!==0},e.prototype.isFoundDocument=function(){return this.documentType===1},e.prototype.isNoDocument=function(){return this.documentType===2},e.prototype.isUnknownDocument=function(){return this.documentType===3},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),s$=function(e,t,n,r,o,s,u){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s=null),u===void 0&&(u=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=o,this.startAt=s,this.endAt=u,this.h=null};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(e,t,n,r,o,s,u){return t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s=null),u===void 0&&(u=null),new s$(e,t,n,r,o,s,u)}function Fc(e){var t=ue(e);if(t.h===null){var n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(r){return function(o){return o.field.canonicalString()+o.op.toString()+qw(o.value)}(r)}).join(","),n+="|ob:",n+=t.orderBy.map(function(r){return function(o){return o.field.canonicalString()+o.dir}(r)}).join(","),Os(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=Ad(t.startAt)),t.endAt&&(n+="|ub:",n+=Ad(t.endAt)),t.h=n}return t.h}function _p(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!p$(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(o=e.filters[r],s=t.filters[r],o.op!==s.op||!o.field.isEqual(s.field)||!li(o.value,s.value))return!1;var o,s;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!$N(e.startAt,t.startAt)&&$N(e.endAt,t.endAt)}function Cd(e){return me.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}var ir=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).field=n,s.op=r,s.value=o,s}return be(t,e),t.create=function(n,r,o){return n.isKeyField()?r==="in"||r==="not-in"?this.l(n,r,o):new a$(n,r,o):r==="array-contains"?new c$(n,o):r==="in"?new h$(n,o):r==="not-in"?new f$(n,o):r==="array-contains-any"?new d$(n,o):new t(n,r,o)},t.l=function(n,r,o){return r==="in"?new u$(n,o):new l$(n,o)},t.prototype.matches=function(n){var r=n.data.field(this.field);return this.op==="!="?r!==null&&this.m(tu(r,this.value)):r!==null&&Is(this.value)===Is(r)&&this.m(tu(r,this.value))},t.prototype.m=function(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return n===0;case"!=":return n!==0;case">":return n>0;case">=":return n>=0;default:return pe()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}(function(){}),a$=function(e){function t(n,r,o){var s=this;return(s=e.call(this,n,r,o)||this).key=me.fromName(o.referenceValue),s}return be(t,e),t.prototype.matches=function(n){var r=me.comparator(n.key,this.key);return this.m(r)},t}(ir),u$=function(e){function t(n,r){var o=this;return(o=e.call(this,n,"in",r)||this).keys=Pk("in",r),o}return be(t,e),t.prototype.matches=function(n){return this.keys.some(function(r){return r.isEqual(n.key)})},t}(ir),l$=function(e){function t(n,r){var o=this;return(o=e.call(this,n,"not-in",r)||this).keys=Pk("not-in",r),o}return be(t,e),t.prototype.matches=function(n){return!this.keys.some(function(r){return r.isEqual(n.key)})},t}(ir);function Pk(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(function(r){return me.fromName(r.referenceValue)})}var c$=function(e){function t(n,r){return e.call(this,n,"array-contains",r)||this}return be(t,e),t.prototype.matches=function(n){var r=n.data.field(this.field);return Kw(r)&&pc(r.arrayValue,this.value)},t}(ir),h$=function(e){function t(n,r){return e.call(this,n,"in",r)||this}return be(t,e),t.prototype.matches=function(n){var r=n.data.field(this.field);return r!==null&&pc(this.value.arrayValue,r)},t}(ir),f$=function(e){function t(n,r){return e.call(this,n,"not-in",r)||this}return be(t,e),t.prototype.matches=function(n){if(pc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var r=n.data.field(this.field);return r!==null&&!pc(this.value.arrayValue,r)},t}(ir),d$=function(e){function t(n,r){return e.call(this,n,"array-contains-any",r)||this}return be(t,e),t.prototype.matches=function(n){var r=this,o=n.data.field(this.field);return!(!Kw(o)||!o.arrayValue.values)&&o.arrayValue.values.some(function(s){return pc(r.value.arrayValue,s)})},t}(ir),mc=function(e,t){this.position=e,this.before=t};function Ad(e){return(e.before?"b":"a")+":"+e.position.map(function(t){return qw(t)}).join(",")}var Ba=function(e,t){t===void 0&&(t="asc"),this.field=e,this.dir=t};function p$(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function FN(e,t,n){for(var r=0,o=0;o<e.position.length;o++){var s=t[o],u=e.position[o];if(r=s.field.isKeyField()?me.comparator(me.fromName(u.referenceValue),n.key):tu(u,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return e.before?r<=0:r<0}function $N(e,t){if(e===null)return t===null;if(t===null||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!li(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oi=function(e,t,n,r,o,s,u,c){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s="F"),u===void 0&&(u=null),c===void 0&&(c=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=c,this.p=null,this.T=null,this.startAt,this.endAt};function Uk(e,t,n,r,o,s,u,c){return new Oi(e,t,n,r,o,s,u,c)}function $c(e){return new Oi(e)}function Vf(e){return!Os(e.limit)&&e.limitType==="F"}function Dd(e){return!Os(e.limit)&&e.limitType==="L"}function Hw(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Gw(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function Ww(e){return e.collectionGroup!==null}function nu(e){var t=ue(e);if(t.p===null){t.p=[];var n=Gw(t),r=Hw(t);if(n!==null&&r===null)n.isKeyField()||t.p.push(new Ba(n)),t.p.push(new Ba(Kr.keyField(),"asc"));else{for(var o=!1,s=0,u=t.explicitOrderBy;s<u.length;s++){var c=u[s];t.p.push(c),c.field.isKeyField()&&(o=!0)}if(!o){var f=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new Ba(Kr.keyField(),f))}}}return t.p}function ci(e){var t=ue(e);if(!t.T)if(t.limitType==="F")t.T=UN(t.path,t.collectionGroup,nu(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,o=nu(t);r<o.length;r++){var s=o[r],u=s.dir==="desc"?"asc":"desc";n.push(new Ba(s.field,u))}var c=t.endAt?new mc(t.endAt.position,!t.endAt.before):null,f=t.startAt?new mc(t.startAt.position,!t.startAt.before):null;t.T=UN(t.path,t.collectionGroup,n,t.filters,t.limit,c,f)}return t.T}function Fk(e,t,n){return new Oi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Vc(e,t){return _p(ci(e),ci(t))&&e.limitType===t.limitType}function $k(e){return Fc(ci(e))+"|lt:"+e.limitType}function l0(e){return"Query(target="+function(t){var n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: ["+t.filters.map(function(r){return(o=r).field.canonicalString()+" "+o.op+" "+qw(o.value);var o}).join(", ")+"]"),Os(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: ["+t.orderBy.map(function(r){return function(o){return o.field.canonicalString()+" ("+o.dir+")"}(r)}).join(", ")+"]"),t.startAt&&(n+=", startAt: "+Ad(t.startAt)),t.endAt&&(n+=", endAt: "+Ad(t.endAt)),"Target("+n+")"}(ci(e))+"; limitType="+e.limitType+")"}function Bc(e,t){return t.isFoundDocument()&&function(n,r){var o=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):me.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(e,t)&&function(n,r){for(var o=0,s=n.explicitOrderBy;o<s.length;o++){var u=s[o];if(!u.field.isKeyField()&&r.data.field(u.field)===null)return!1}return!0}(e,t)&&function(n,r){for(var o=0,s=n.filters;o<s.length;o++)if(!s[o].matches(r))return!1;return!0}(e,t)&&function(n,r){return!(n.startAt&&!FN(n.startAt,nu(n),r))&&(!n.endAt||!FN(n.endAt,nu(n),r))}(e,t)}function Vk(e){return function(t,n){for(var r=!1,o=0,s=nu(e);o<s.length;o++){var u=s[o],c=m$(u,t,n);if(c!==0)return c;r=r||u.field.isKeyField()}return 0}}function m$(e,t,n){var r=e.field.isKeyField()?me.comparator(t.key,n.key):function(o,s,u){var c=s.data.field(o),f=u.data.field(o);return c!==null&&f!==null?tu(c,f):pe()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return pe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jd(t)?"-0":t}}function zk(e){return{integerValue:""+e}}function qk(e,t){return Ok(t)?zk(t):Bk(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Np=function(){this._=void 0};function g$(e,t,n){return e instanceof ru?function(r,o){var s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&(s.fields.__previous_value__=o),{mapValue:s}}(n,t):e instanceof Ts?Hk(e,t):e instanceof js?Gk(e,t):function(r,o){var s=Kk(r,o),u=VN(s)+VN(r.A);return u0(s)&&u0(r.A)?zk(u):Bk(r.R,u)}(e,t)}function v$(e,t,n){return e instanceof Ts?Hk(e,t):e instanceof js?Gk(e,t):n}function Kk(e,t){return e instanceof iu?u0(n=t)||function(r){return!!r&&"doubleValue"in r}(n)?t:{integerValue:0}:null;var n}var ru=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t}(Np),Ts=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return be(t,e),t}(Np);function Hk(e,t){for(var n=Wk(t),r=function(u){n.some(function(c){return li(c,u)})||n.push(u)},o=0,s=e.elements;o<s.length;o++)r(s[o]);return{arrayValue:{values:n}}}var js=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return be(t,e),t}(Np);function Gk(e,t){for(var n=Wk(t),r=function(u){n=n.filter(function(c){return!li(c,u)})},o=0,s=e.elements;o<s.length;o++)r(s[o]);return{arrayValue:{values:n}}}var iu=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).R=n,o.A=r,o}return be(t,e),t}(Np);function VN(e){return Rt(e.integerValue||e.doubleValue)}function Wk(e){return Kw(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zc=function(e,t){this.field=e,this.transform=t},y$=function(e,t){this.version=e,this.transformResults=t},gn=function(){function e(t,n){this.updateTime=t,this.exists=n}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return this.updateTime===void 0&&this.exists===void 0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},e}();function Bf(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}var Ep=function(){};function w$(e,t,n){e instanceof qc?function(r,o,s){var u=r.value.clone(),c=qN(r.fieldTransforms,o,s.transformResults);u.setAll(c),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(e,t,n):e instanceof ko?function(r,o,s){if(Bf(r.precondition,o)){var u=qN(r.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(Yk(r)),c.setAll(u),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}else o.convertToUnknownDocument(s.version)}(e,t,n):function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,t,n)}function c0(e,t,n){e instanceof qc?function(r,o,s){if(Bf(r.precondition,o)){var u=r.value.clone(),c=KN(r.fieldTransforms,s,o);u.setAll(c),o.convertToFoundDocument(zN(o),u).setHasLocalMutations()}}(e,t,n):e instanceof ko?function(r,o,s){if(Bf(r.precondition,o)){var u=KN(r.fieldTransforms,s,o),c=o.data;c.setAll(Yk(r)),c.setAll(u),o.convertToFoundDocument(zN(o),c).setHasLocalMutations()}}(e,t,n):function(r,o){Bf(r.precondition,o)&&o.convertToNoDocument(Ae.min())}(e,t)}function x$(e,t){for(var n=null,r=0,o=e.fieldTransforms;r<o.length;r++){var s=o[r],u=t.data.field(s.field),c=Kk(s.transform,u||null);c!=null&&(n==null&&(n=er.empty()),n.set(s.field,c))}return n||null}function BN(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Ja(n,r,function(o,s){return function(u,c){return u.field.isEqual(c.field)&&function(f,p){return f instanceof Ts&&p instanceof Ts||f instanceof js&&p instanceof js?Ja(f.elements,p.elements,li):f instanceof iu&&p instanceof iu?li(f.A,p.A):f instanceof ru&&p instanceof ru}(u.transform,c.transform)}(o,s)})}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function zN(e){return e.isFoundDocument()?e.version:Ae.min()}var qc=function(e){function t(n,r,o,s){s===void 0&&(s=[]);var u=this;return(u=e.call(this)||this).key=n,u.value=r,u.precondition=o,u.fieldTransforms=s,u.type=0,u}return be(t,e),t}(Ep),ko=function(e){function t(n,r,o,s,u){u===void 0&&(u=[]);var c=this;return(c=e.call(this)||this).key=n,c.data=r,c.fieldMask=o,c.precondition=s,c.fieldTransforms=u,c.type=1,c}return be(t,e),t}(Ep);function Yk(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function qN(e,t,n){var r=new Map;_e(e.length===n.length);for(var o=0;o<n.length;o++){var s=e[o],u=s.transform,c=t.data.field(s.field);r.set(s.field,v$(u,c,n[o]))}return r}function KN(e,t,n){for(var r=new Map,o=0,s=e;o<s.length;o++){var u=s[o],c=u.transform,f=n.data.field(u.field);r.set(u.field,g$(c,f,t))}return r}var Mt,$e,Kc=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).key=n,o.precondition=r,o.type=2,o.fieldTransforms=[],o}return be(t,e),t}(Ep),Yw=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).key=n,o.precondition=r,o.type=3,o.fieldTransforms=[],o}return be(t,e),t}(Ep),b$=function(e){this.count=e};function Qk(e){switch(e){case F.OK:return pe();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return pe()}}function Xk(e){if(e===void 0)return Lt("GRPC error has no .code"),F.UNKNOWN;switch(e){case Mt.OK:return F.OK;case Mt.CANCELLED:return F.CANCELLED;case Mt.UNKNOWN:return F.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return F.INTERNAL;case Mt.UNAVAILABLE:return F.UNAVAILABLE;case Mt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Mt.NOT_FOUND:return F.NOT_FOUND;case Mt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Mt.ABORTED:return F.ABORTED;case Mt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Mt.DATA_LOSS:return F.DATA_LOSS;default:return pe()}}($e=Mt||(Mt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn=function(){function e(t,n){this.comparator=t,this.root=n||no.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,no.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,no.BLACK,null,null))},e.prototype.get=function(t){for(var n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null},e.prototype.indexOf=function(t){for(var n=0,r=this.root;!r.isEmpty();){var o=this.comparator(t,r.key);if(o===0)return n+r.left.size;o<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},e.prototype.forEach=function(t){this.inorderTraversal(function(n,r){return t(n,r),!1})},e.prototype.toString=function(){var t=[];return this.inorderTraversal(function(n,r){return t.push(n+":"+r),!1}),"{"+t.join(", ")+"}"},e.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},e.prototype.getIterator=function(){return new wf(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(t){return new wf(this.root,t,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new wf(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(t){return new wf(this.root,t,this.comparator,!0)},e}(),wf=function(){function e(t,n,r,o){this.isReverse=o,this.nodeStack=[];for(var s=1;!t.isEmpty();)if(s=n?r(t.key,n):1,o&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return e.prototype.getNext=function(){var t=this.nodeStack.pop(),n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(this.nodeStack.length===0)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},e}(),no=function(){function e(t,n,r,o,s){this.key=t,this.value=n,this.color=r??e.RED,this.left=o??e.EMPTY,this.right=s??e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,o,s){return new e(t??this.key,n??this.value,r??this.color,o??this.left,s??this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},e.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(t,n,r){var o=this,s=r(t,o.key);return(o=s<0?o.copy(null,null,null,o.left.insert(t,n,r),null):s===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(t,n,r))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,o=this;if(n(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(t,o.key)===0){if(o.right.isEmpty())return e.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,n))}return o.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},e.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},e.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)},e.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw pe();var t=this.left.check();if(t!==this.right.check())throw pe();return t+(this.isRed()?0:1)},e}();no.EMPTY=null,no.RED=!0,no.BLACK=!1,no.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw pe()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw pe()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw pe()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw pe()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw pe()},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,n,r,o,s){return this},e.prototype.insert=function(t,n,r){return new no(t,n)},e.prototype.remove=function(t,n){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(t){return!1},e.prototype.reverseTraversal=function(t){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt=function(){function e(t){this.comparator=t,this.data=new xn(this.comparator)}return e.prototype.has=function(t){return this.data.get(t)!==null},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(t){return this.data.indexOf(t)},e.prototype.forEach=function(t){this.data.inorderTraversal(function(n,r){return t(n),!1})},e.prototype.forEachInRange=function(t,n){for(var r=this.data.getIteratorFrom(t[0]);r.hasNext();){var o=r.getNext();if(this.comparator(o.key,t[1])>=0)return;n(o.key)}},e.prototype.forEachWhile=function(t,n){var r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return},e.prototype.firstAfterOrEqual=function(t){var n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null},e.prototype.getIterator=function(){return new HN(this.data.getIterator())},e.prototype.getIteratorFrom=function(t){return new HN(this.data.getIteratorFrom(t))},e.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},e.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(t){var n=this;return n.size<t.size&&(n=t,t=this),t.forEach(function(r){n=n.add(r)}),n},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var o=n.getNext().key,s=r.getNext().key;if(this.comparator(o,s)!==0)return!1}return!0},e.prototype.toArray=function(){var t=[];return this.forEach(function(n){t.push(n)}),t},e.prototype.toString=function(){var t=[];return this.forEach(function(n){return t.push(n)}),"SortedSet("+t.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),HN=function(){function e(t){this.iter=t}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),S$=new xn(me.comparator);function Br(){return S$}var _$=new xn(me.comparator);function h0(){return _$}var N$=new xn(me.comparator);function E$(){return N$}var I$=new zt(me.comparator);function nt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=I$,r=0,o=e;r<o.length;r++){var s=o[r];n=n.add(s)}return n}var T$=new zt(Pe);function Ip(){return T$}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qw=function(){function e(t,n,r,o,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=s}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,Xw.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Ae.min(),r,Ip(),Br(),nt())},e}(),Xw=function(){function e(t,n,r,o,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=s}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(qn.EMPTY_BYTE_STRING,n,nt(),nt(),nt())},e}(),zf=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},Jk=function(e,t){this.targetId=e,this.V=t},Zk=function(e,t,n,r){n===void 0&&(n=qn.EMPTY_BYTE_STRING),r===void 0&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},GN=function(){function e(){this.S=0,this.D=YN(),this.C=qn.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"F",{get:function(){return this.S!==0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),e.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},e.prototype.M=function(){var t=nt(),n=nt(),r=nt();return this.D.forEach(function(o,s){switch(s){case 0:t=t.add(o);break;case 2:n=n.add(o);break;case 1:r=r.add(o);break;default:pe()}}),new Xw(this.C,this.N,t,n,r)},e.prototype.L=function(){this.k=!1,this.D=YN()},e.prototype.B=function(t,n){this.k=!0,this.D=this.D.insert(t,n)},e.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.k=!0,this.N=!0},e}(),j$=function(){function e(t){this.W=t,this.G=new Map,this.H=Br(),this.J=WN(),this.Y=new zt(Pe)}return e.prototype.X=function(t){for(var n=0,r=t.v;n<r.length;n++){var o=r[n];t.P&&t.P.isFoundDocument()?this.Z(o,t.P):this.tt(o,t.key,t.P)}for(var s=0,u=t.removedTargetIds;s<u.length;s++)o=u[s],this.tt(o,t.key,t.P)},e.prototype.et=function(t){var n=this;this.forEachTarget(t,function(r){var o=n.nt(r);switch(t.state){case 0:n.st(r)&&o.O(t.resumeToken);break;case 1:o.K(),o.F||o.L(),o.O(t.resumeToken);break;case 2:o.K(),o.F||n.removeTarget(r);break;case 3:n.st(r)&&(o.j(),o.O(t.resumeToken));break;case 4:n.st(r)&&(n.it(r),o.O(t.resumeToken));break;default:pe()}})},e.prototype.forEachTarget=function(t,n){var r=this;t.targetIds.length>0?t.targetIds.forEach(n):this.G.forEach(function(o,s){r.st(s)&&n(s)})},e.prototype.rt=function(t){var n=t.targetId,r=t.V.count,o=this.ot(n);if(o){var s=o.target;if(Cd(s))if(r===0){var u=new me(s.path);this.tt(n,u,wn.newNoDocument(u,Ae.min()))}else _e(r===1);else this.ct(n)!==r&&(this.it(n),this.Y=this.Y.add(n))}},e.prototype.ut=function(t){var n=this,r=new Map;this.G.forEach(function(u,c){var f=n.ot(c);if(f){if(u.current&&Cd(f.target)){var p=new me(f.target.path);n.H.get(p)!==null||n.at(c,p)||n.tt(c,p,wn.newNoDocument(p,t))}u.$&&(r.set(c,u.M()),u.L())}});var o=nt();this.J.forEach(function(u,c){var f=!0;c.forEachWhile(function(p){var m=n.ot(p);return!m||m.purpose===2||(f=!1,!1)}),f&&(o=o.add(u))});var s=new Qw(t,r,this.Y,this.H,o);return this.H=Br(),this.J=WN(),this.Y=new zt(Pe),s},e.prototype.Z=function(t,n){if(this.st(t)){var r=this.at(t,n.key)?2:0;this.nt(t).B(n.key,r),this.H=this.H.insert(n.key,n),this.J=this.J.insert(n.key,this.ht(n.key).add(t))}},e.prototype.tt=function(t,n,r){if(this.st(t)){var o=this.nt(t);this.at(t,n)?o.B(n,1):o.q(n),this.J=this.J.insert(n,this.ht(n).delete(t)),r&&(this.H=this.H.insert(n,r))}},e.prototype.removeTarget=function(t){this.G.delete(t)},e.prototype.ct=function(t){var n=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size},e.prototype.U=function(t){this.nt(t).U()},e.prototype.nt=function(t){var n=this.G.get(t);return n||(n=new GN,this.G.set(t,n)),n},e.prototype.ht=function(t){var n=this.J.get(t);return n||(n=new zt(Pe),this.J=this.J.insert(t,n)),n},e.prototype.st=function(t){var n=this.ot(t)!==null;return n||ne("WatchChangeAggregator","Detected inactive target",t),n},e.prototype.ot=function(t){var n=this.G.get(t);return n&&n.F?null:this.W.lt(t)},e.prototype.it=function(t){var n=this;this.G.set(t,new GN),this.W.getRemoteKeysForTarget(t).forEach(function(r){n.tt(t,r,null)})},e.prototype.at=function(t,n){return this.W.getRemoteKeysForTarget(t).has(n)},e}();function WN(){return new xn(me.comparator)}function YN(){return new xn(me.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var k$={asc:"ASCENDING",desc:"DESCENDING"},C$={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},A$=function(e,t){this.databaseId=e,this.I=t};function gc(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function eC(e,t){return e.I?t.toBase64():t.toUint8Array()}function D$(e,t){return gc(e,t.toTimestamp())}function jn(e){return _e(!!e),Ae.fromTimestamp(function(t){var n=So(t);return new zn(n.seconds,n.nanos)}(e))}function Jw(e,t){return function(n){return new He(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function tC(e){var t=He.fromString(e);return _e(uC(t)),t}function vc(e,t){return Jw(e.databaseId,t.path)}function Ei(e,t){var n=tC(t);if(n.get(1)!==e.databaseId.projectId)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new me(rC(n))}function f0(e,t){return Jw(e.databaseId,t)}function nC(e){var t=tC(e);return t.length===4?He.emptyPath():rC(t)}function yc(e){return new He(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function rC(e){return _e(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function QN(e,t,n){return{name:vc(e,t),fields:n.value.mapValue.fields}}function M$(e,t,n){var r=Ei(e,t.name),o=jn(t.updateTime),s=new er({mapValue:{fields:t.fields}}),u=wn.newFoundDocument(r,o,s);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function Md(e,t){var n;if(t instanceof qc)n={update:QN(e,t.key,t.value)};else if(t instanceof Kc)n={delete:vc(e,t.key)};else if(t instanceof ko)n={update:QN(e,t.key,t.data),updateMask:U$(t.fieldMask)};else{if(!(t instanceof Yw))return pe();n={verify:vc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(r){return function(o,s){var u=s.transform;if(u instanceof ru)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ts)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof js)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof iu)return{fieldPath:s.field.canonicalString(),increment:u.A};throw pe()}(0,r)})),t.precondition.isNone||(n.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:D$(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:pe()}(e,t.precondition)),n}function XN(e,t){var n=t.currentDocument?function(p){return p.updateTime!==void 0?gn.updateTime(jn(p.updateTime)):p.exists!==void 0?gn.exists(p.exists):gn.none()}(t.currentDocument):gn.none(),r=t.updateTransforms?t.updateTransforms.map(function(p){return function(m,y){var v=null;if("setToServerValue"in y)_e(y.setToServerValue==="REQUEST_TIME"),v=new ru;else if("appendMissingElements"in y){var w=y.appendMissingElements.values||[];v=new Ts(w)}else if("removeAllFromArray"in y){var E=y.removeAllFromArray.values||[];v=new js(E)}else"increment"in y?v=new iu(m,y.increment):pe();var _=Kr.fromServerFormat(y.fieldPath);return new zc(_,v)}(e,p)}):[];if(t.update){t.update.name;var o=Ei(e,t.update.name),s=new er({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=function(p){var m=p.fieldPaths||[];return new Za(m.map(function(y){return Kr.fromServerFormat(y)}))}(t.updateMask);return new ko(o,s,u,n,r)}return new qc(o,s,n,r)}if(t.delete){var c=Ei(e,t.delete);return new Kc(c,n)}if(t.verify){var f=Ei(e,t.verify);return new Yw(f,n)}return pe()}function iC(e,t){return{documents:[f0(e,t.path)]}}function oC(e,t){var n={structuredQuery:{}},r=t.path;t.collectionGroup!==null?(n.parent=f0(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=f0(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var o=function(c){if(c.length!==0){var f=c.map(function(p){return function(m){if(m.op==="=="){if(PN(m.value))return{unaryFilter:{field:ma(m.field),op:"IS_NAN"}};if(LN(m.value))return{unaryFilter:{field:ma(m.field),op:"IS_NULL"}}}else if(m.op==="!="){if(PN(m.value))return{unaryFilter:{field:ma(m.field),op:"IS_NOT_NAN"}};if(LN(m.value))return{unaryFilter:{field:ma(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ma(m.field),op:O$(m.op),value:m.value}}}(p)});return f.length===1?f[0]:{compositeFilter:{op:"AND",filters:f}}}}(t.filters);o&&(n.structuredQuery.where=o);var s=function(c){if(c.length!==0)return c.map(function(f){return function(p){return{field:ma(p.field),direction:R$(p.dir)}}(f)})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);var u=function(c,f){return c.I||Os(f)?f:{value:f}}(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=JN(t.startAt)),t.endAt&&(n.structuredQuery.endAt=JN(t.endAt)),n}function sC(e){var t=nC(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,o=null;if(r>0){_e(r===1);var s=n.from[0];s.allDescendants?o=s.collectionId:t=t.child(s.collectionId)}var u=[];n.where&&(u=aC(n.where));var c=[];n.orderBy&&(c=n.orderBy.map(function(y){return function(v){return new Ba(Oa(v.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(y)}));var f=null;n.limit&&(f=function(y){var v;return Os(v=typeof y=="object"?y.value:y)?null:v}(n.limit));var p=null;n.startAt&&(p=ZN(n.startAt));var m=null;return n.endAt&&(m=ZN(n.endAt)),Uk(t,o,c,u,f,"F",p,m)}function aC(e){return e?e.unaryFilter!==void 0?[P$(e)]:e.fieldFilter!==void 0?[L$(e)]:e.compositeFilter!==void 0?e.compositeFilter.filters.map(function(t){return aC(t)}).reduce(function(t,n){return t.concat(n)}):pe():[]}function JN(e){return{before:e.before,values:e.position}}function ZN(e){var t=!!e.before,n=e.values||[];return new mc(n,t)}function R$(e){return k$[e]}function O$(e){return C$[e]}function ma(e){return{fieldPath:e.canonicalString()}}function Oa(e){return Kr.fromServerFormat(e.fieldPath)}function L$(e){return ir.create(Oa(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return pe()}}(e.fieldFilter.op),e.fieldFilter.value)}function P$(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Oa(e.unaryFilter.field);return ir.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Oa(e.unaryFilter.field);return ir.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Oa(e.unaryFilter.field);return ir.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var o=Oa(e.unaryFilter.field);return ir.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return pe()}}function U$(e){var t=[];return e.fields.forEach(function(n){return t.push(n.canonicalString())}),{fieldPaths:t}}function uC(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=eE(t)),t=F$(e.get(n),t);return eE(t)}function F$(e,t){for(var n=t,r=e.length,o=0;o<r;o++){var s=e.charAt(o);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function eE(e){return e+""}function _i(e){var t=e.length;if(_e(t>=2),t===2)return _e(e.charAt(0)===""&&e.charAt(1)===""),He.emptyPath();for(var n=t-2,r=[],o="",s=0;s<t;){var u=e.indexOf("",s);switch((u<0||u>n)&&pe(),e.charAt(u+1)){case"":var c=e.substring(s,u),f=void 0;o.length===0?f=c:(f=o+=c,o=""),r.push(f);break;case"":o+=e.substring(s,u),o+="\0";break;case"":o+=e.substring(s,u+1);break;default:pe()}s=u+2}return new He(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $$=function(e,t){this.seconds=e,this.nanoseconds=t},Jn=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};Jn.store="owner",Jn.key="owner";var vo=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};vo.store="mutationQueues",vo.keyPath="userId";var it=function(e,t,n,r,o){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=o};it.store="mutations",it.keyPath="batchId",it.userMutationsIndex="userMutationsIndex",it.userMutationsKeyPath=["userId","batchId"];var fn=function(){function e(){}return e.prefixForUser=function(t){return[t]},e.prefixForPath=function(t,n){return[t,zr(n)]},e.key=function(t,n,r){return[t,zr(n),r]},e}();fn.store="documentMutations",fn.PLACEHOLDER=new fn;var V$=function(e,t){this.path=e,this.readTime=t},B$=function(e,t){this.path=e,this.version=t},St=function(e,t,n,r,o,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=o,this.parentPath=s};St.store="remoteDocuments",St.readTimeIndex="readTimeIndex",St.readTimeIndexPath="readTime",St.collectionReadTimeIndex="collectionReadTimeIndex",St.collectionReadTimeIndexPath=["parentPath","readTime"];var oi=function(e){this.byteSize=e};oi.store="remoteDocumentGlobal",oi.key="remoteDocumentGlobalKey";var Fn=function(e,t,n,r,o,s,u){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=o,this.lastLimboFreeSnapshotVersion=s,this.query=u};Fn.store="targets",Fn.keyPath="targetId",Fn.queryTargetsIndexName="queryTargetsIndex",Fn.queryTargetsKeyPath=["canonicalId","targetId"];var tn=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};tn.store="targetDocuments",tn.keyPath=["targetId","path"],tn.documentTargetsIndex="documentTargetsIndex",tn.documentTargetsKeyPath=["path","targetId"];var Zn=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Zn.key="targetGlobalKey",Zn.store="targetGlobal";var ds=function(e,t){this.collectionId=e,this.parent=t};ds.store="collectionParents",ds.keyPath=["collectionId","parent"];var Ii=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Ii.store="clientMetadata",Ii.keyPath="clientId";var ou=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};ou.store="bundles",ou.keyPath="bundleId";var su=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};su.store="namedQueries",su.keyPath="name";var z$=_t(_t([],_t(_t([],_t(_t([],_t(_t([],[vo.store,it.store,fn.store,St.store,Fn.store,Jn.store,Zn.store,tn.store]),[Ii.store])),[oi.store])),[ds.store])),[ou.store,su.store]),lC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",cC=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},e}(),Kn=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},ee=function(){function e(t){var n=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(r){n.isDone=!0,n.result=r,n.nextCallback&&n.nextCallback(r)},function(r){n.isDone=!0,n.error=r,n.catchCallback&&n.catchCallback(r)})}return e.prototype.catch=function(t){return this.next(void 0,t)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(o,s){r.nextCallback=function(u){r.wrapSuccess(t,u).next(o,s)},r.catchCallback=function(u){r.wrapFailure(n,u).next(o,s)}})},e.prototype.toPromise=function(){var t=this;return new Promise(function(n,r){t.next(n,r)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(n,r){n(t)})},e.reject=function(t){return new e(function(n,r){r(t)})},e.waitFor=function(t){return new e(function(n,r){var o=0,s=0,u=!1;t.forEach(function(c){++o,c.next(function(){++s,u&&s===o&&n()},function(f){return r(f)})}),u=!0,s===o&&n()})},e.or=function(t){for(var n=e.resolve(!1),r=function(u){n=n.next(function(c){return c?e.resolve(c):u()})},o=0,s=t;o<s.length;o++)r(s[o]);return n},e.forEach=function(t,n){var r=this,o=[];return t.forEach(function(s,u){o.push(n.call(r,s,u))}),this.waitFor(o)},e}(),hC=function(){function e(t,n){var r=this;this.action=t,this.transaction=n,this.aborted=!1,this.ft=new Kn,this.transaction.oncomplete=function(){r.ft.resolve()},this.transaction.onabort=function(){n.error?r.ft.reject(new Fl(t,n.error)):r.ft.resolve()},this.transaction.onerror=function(o){var s=Zw(o.target.error);r.ft.reject(new Fl(t,s))}}return e.open=function(t,n,r,o){try{return new e(n,t.transaction(o,r))}catch(s){throw new Fl(n,s)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(ne("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(t){var n=this.transaction.objectStore(t);return new K$(n)},e}(),au=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,e._t(_s())===12.2&&Lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return ne("SimpleDb","Removing database:",t),rs(window.indexedDB.deleteDatabase(t)).toPromise()},e.yt=function(){if(typeof indexedDB>"u")return!1;if(e.gt())return!0;var t=_s(),n=e._t(t),r=0<n&&n<10,o=e.Et(t),s=0<o&&o<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||s)},e.gt=function(){var t;return typeof process<"u"&&((t=n$)===null||t===void 0?void 0:t.Tt)==="YES"},e.It=function(t,n){return t.store(n)},e._t=function(t){var n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)},e.Et=function(t){var n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)},e.prototype.At=function(t){return W(this,void 0,void 0,function(){var n,r=this;return H(this,function(o){switch(o.label){case 0:return this.db?[3,2]:(ne("SimpleDb","Opening database:",this.name),n=this,[4,new Promise(function(s,u){var c=indexedDB.open(r.name,r.version);c.onsuccess=function(f){var p=f.target.result;s(p)},c.onblocked=function(){u(new Fl(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},c.onerror=function(f){var p=f.target.error;p.name==="VersionError"?u(new Y(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u(new Fl(t,p))},c.onupgradeneeded=function(f){ne("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',f.oldVersion);var p=f.target.result;r.wt.Rt(p,c.transaction,f.oldVersion,r.version).next(function(){ne("SimpleDb","Database upgrade to version "+r.version+" complete")})}})]);case 1:n.db=o.sent(),o.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(s){return r.bt(s)}),this.db)]}})})},e.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(n){return t(n)})},e.prototype.runTransaction=function(t,n,r,o){return W(this,void 0,void 0,function(){var s,u,c,f,p;return H(this,function(m){switch(m.label){case 0:s=n==="readonly",u=0,c=function(){var y,v,w,E,_;return H(this,function(C){switch(C.label){case 0:++u,C.label=1;case 1:return C.trys.push([1,4,,5]),[4,f.At(t)];case 2:return f.db=C.sent(),y=hC.open(f.db,t,s?"readonly":"readwrite",r),v=o(y).catch(function(b){return y.abort(b),ee.reject(b)}).toPromise(),w={},v.catch(function(){}),[4,y.dt];case 3:return[2,(w.value=(C.sent(),v),w)];case 4:return E=C.sent(),_=E.name!=="FirebaseError"&&u<3,ne("SimpleDb","Transaction failed with error:",E.message,"Retrying:",_),f.close(),_?[3,5]:[2,{value:Promise.reject(E)}];case 5:return[2]}})},f=this,m.label=1;case 1:return[5,c()];case 2:if(typeof(p=m.sent())=="object")return[2,p.value];m.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),q$=function(){function e(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(t){this.St=t},e.prototype.delete=function(){return rs(this.Pt.delete())},e}(),Fl=function(e){function t(n,r){var o=this;return(o=e.call(this,F.UNAVAILABLE,"IndexedDB transaction '"+n+"' failed: "+r)||this).name="IndexedDbTransactionError",o}return be(t,e),t}(Y);function Ls(e){return e.name==="IndexedDbTransactionError"}var K$=function(){function e(t){this.store=t}return e.prototype.put=function(t,n){var r;return n!==void 0?(ne("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(ne("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),rs(r)},e.prototype.add=function(t){return ne("SimpleDb","ADD",this.store.name,t,t),rs(this.store.add(t))},e.prototype.get=function(t){var n=this;return rs(this.store.get(t)).next(function(r){return r===void 0&&(r=null),ne("SimpleDb","GET",n.store.name,t,r),r})},e.prototype.delete=function(t){return ne("SimpleDb","DELETE",this.store.name,t),rs(this.store.delete(t))},e.prototype.count=function(){return ne("SimpleDb","COUNT",this.store.name),rs(this.store.count())},e.prototype.Nt=function(t,n){var r=this.cursor(this.options(t,n)),o=[];return this.xt(r,function(s,u){o.push(u)}).next(function(){return o})},e.prototype.kt=function(t,n){ne("SimpleDb","DELETE ALL",this.store.name);var r=this.options(t,n);r.Ft=!1;var o=this.cursor(r);return this.xt(o,function(s,u,c){return c.delete()})},e.prototype.$t=function(t,n){var r;n?r=t:(r={},n=t);var o=this.cursor(r);return this.xt(o,n)},e.prototype.Ot=function(t){var n=this.cursor({});return new ee(function(r,o){n.onerror=function(s){var u=Zw(s.target.error);o(u)},n.onsuccess=function(s){var u=s.target.result;u?t(u.primaryKey,u.value).next(function(c){c?u.continue():r()}):r()}})},e.prototype.xt=function(t,n){var r=[];return new ee(function(o,s){t.onerror=function(u){s(u.target.error)},t.onsuccess=function(u){var c=u.target.result;if(c){var f=new q$(c),p=n(c.primaryKey,c.value,f);if(p instanceof ee){var m=p.catch(function(y){return f.done(),ee.reject(y)});r.push(m)}f.isDone?o():f.Dt===null?c.continue():c.continue(f.Dt)}else o()}}).next(function(){return ee.waitFor(r)})},e.prototype.options=function(t,n){var r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}},e.prototype.cursor=function(t){var n="next";if(t.reverse&&(n="prev"),t.index){var r=this.store.index(t.index);return t.Ft?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)},e}();function rs(e){return new ee(function(t,n){e.onsuccess=function(r){var o=r.target.result;t(o)},e.onerror=function(r){var o=Zw(r.target.error);n(o)}})}var tE=!1;function Zw(e){var t=au._t(_s());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new Y("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return tE||(tE=!0,setTimeout(function(){throw r},0)),r}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nE=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).Mt=n,o.currentSequenceNumber=r,o}return be(t,e),t}(cC);function Hn(e,t){var n=ue(e);return au.It(n.Mt,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ex=function(){function e(t,n,r,o){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=o}return e.prototype.applyToRemoteDocument=function(t,n){for(var r=n.mutationResults,o=0;o<this.mutations.length;o++){var s=this.mutations[o];s.key.isEqual(t.key)&&w$(s,t,r[o])}},e.prototype.applyToLocalView=function(t){for(var n=0,r=this.baseMutations;n<r.length;n++)(u=r[n]).key.isEqual(t.key)&&c0(u,t,this.localWriteTime);for(var o=0,s=this.mutations;o<s.length;o++){var u;(u=s[o]).key.isEqual(t.key)&&c0(u,t,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(t){var n=this;this.mutations.forEach(function(r){var o=t.get(r.key),s=o;n.applyToLocalView(s),o.isValidDocument()||s.convertToNoDocument(Ae.min())})},e.prototype.keys=function(){return this.mutations.reduce(function(t,n){return t.add(n.key)},nt())},e.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ja(this.mutations,t.mutations,function(n,r){return BN(n,r)})&&Ja(this.baseMutations,t.baseMutations,function(n,r){return BN(n,r)})},e}(),H$=function(){function e(t,n,r,o){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=o}return e.from=function(t,n,r){_e(t.mutations.length===r.length);for(var o=E$(),s=t.mutations,u=0;u<s.length;u++)o=o.insert(s[u].key,r[u].version);return new e(t,n,r,o)},e}(),Tp=function(){function e(t,n,r,o,s,u,c){s===void 0&&(s=Ae.min()),u===void 0&&(u=Ae.min()),c===void 0&&(c=qn.EMPTY_BYTE_STRING),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=c}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),fC=function(e){this.Lt=e};function d0(e,t){if(t.document)return M$(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=me.fromSegments(t.noDocument.path),r=lu(t.noDocument.readTime),o=wn.newNoDocument(n,r);return t.hasCommittedMutations?o.setHasCommittedMutations():o}if(t.unknownDocument){var s=me.fromSegments(t.unknownDocument.path);return r=lu(t.unknownDocument.version),wn.newUnknownDocument(s,r)}return pe()}function rE(e,t,n){var r=tx(n),o=t.key.path.popLast().toArray();if(t.isFoundDocument()){var s=function(y,v){return{name:vc(y,v.key),fields:v.data.value.mapValue.fields,updateTime:gc(y,v.version.toTimestamp())}}(e.Lt,t),u=t.hasCommittedMutations;return new St(null,null,s,u,r,o)}if(t.isNoDocument()){var c=t.key.path.toArray(),f=uu(t.version);return u=t.hasCommittedMutations,new St(null,new V$(c,f),null,u,r,o)}if(t.isUnknownDocument()){var p=t.key.path.toArray(),m=uu(t.version);return new St(new B$(p,m),null,null,!0,r,o)}return pe()}function tx(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function dC(e){var t=new zn(e[0],e[1]);return Ae.fromTimestamp(t)}function uu(e){var t=e.toTimestamp();return new $$(t.seconds,t.nanoseconds)}function lu(e){var t=new zn(e.seconds,e.nanoseconds);return Ae.fromTimestamp(t)}function xa(e,t){for(var n=(t.baseMutations||[]).map(function(f){return XN(e.Lt,f)}),r=0;r<t.mutations.length-1;++r){var o=t.mutations[r];if(r+1<t.mutations.length&&t.mutations[r+1].transform!==void 0){var s=t.mutations[r+1];o.updateTransforms=s.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var u=t.mutations.map(function(f){return XN(e.Lt,f)}),c=zn.fromMillis(t.localWriteTimeMs);return new ex(t.batchId,c,n,u)}function Il(e){var t,n,r=lu(e.readTime),o=e.lastLimboFreeSnapshotVersion!==void 0?lu(e.lastLimboFreeSnapshotVersion):Ae.min();return e.query.documents!==void 0?(_e((n=e.query).documents.length===1),t=ci($c(nC(n.documents[0])))):t=function(s){return ci(sC(s))}(e.query),new Tp(t,e.targetId,0,e.lastListenSequenceNumber,r,o,qn.fromBase64String(e.resumeToken))}function pC(e,t){var n,r=uu(t.snapshotVersion),o=uu(t.lastLimboFreeSnapshotVersion);n=Cd(t.target)?iC(e.Lt,t.target):oC(e.Lt,t.target);var s=t.resumeToken.toBase64();return new Fn(t.targetId,Fc(t.target),r,s,t.sequenceNumber,o,n)}function mC(e){var t=sC({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Fk(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var G$=function(){function e(){}return e.prototype.getBundleMetadata=function(t,n){return iE(t).get(n).next(function(r){if(r)return{id:(o=r).bundleId,createTime:lu(o.createTime),version:o.version};var o})},e.prototype.saveBundleMetadata=function(t,n){return iE(t).put({bundleId:(r=n).id,createTime:uu(jn(r.createTime)),version:r.version});var r},e.prototype.getNamedQuery=function(t,n){return oE(t).get(n).next(function(r){if(r)return{name:(o=r).name,query:mC(o.bundledQuery),readTime:lu(o.readTime)};var o})},e.prototype.saveNamedQuery=function(t,n){return oE(t).put(function(r){return{name:r.name,readTime:uu(jn(r.readTime)),bundledQuery:r.bundledQuery}}(n))},e}();function iE(e){return Hn(e,ou.store)}function oE(e){return Hn(e,su.store)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var W$=function(){function e(){this.Bt=new nx}return e.prototype.addToCollectionParentIndex=function(t,n){return this.Bt.add(n),ee.resolve()},e.prototype.getCollectionParents=function(t,n){return ee.resolve(this.Bt.getEntries(n))},e}(),nx=function(){function e(){this.index={}}return e.prototype.add=function(t){var n=t.lastSegment(),r=t.popLast(),o=this.index[n]||new zt(He.comparator),s=!o.has(r);return this.index[n]=o.add(r),s},e.prototype.has=function(t){var n=t.lastSegment(),r=t.popLast(),o=this.index[n];return o&&o.has(r)},e.prototype.getEntries=function(t){return(this.index[t]||new zt(He.comparator)).toArray()},e}(),Y$=function(){function e(){this.qt=new nx}return e.prototype.addToCollectionParentIndex=function(t,n){var r=this;if(!this.qt.has(n)){var o=n.lastSegment(),s=n.popLast();t.addOnCommittedListener(function(){r.qt.add(n)});var u={collectionId:o,parent:zr(s)};return sE(t).put(u)}return ee.resolve()},e.prototype.getCollectionParents=function(t,n){var r=[],o=IDBKeyRange.bound([n,""],[Ak(n),""],!1,!0);return sE(t).Nt(o).next(function(s){for(var u=0,c=s;u<c.length;u++){var f=c[u];if(f.collectionId!==n)break;r.push(_i(f.parent))}return r})},e}();function sE(e){return Hn(e,ds.store)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ri=function(){function e(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(e,t,n){var r=e.store(it.store),o=e.store(fn.store),s=[],u=IDBKeyRange.only(n.batchId),c=0,f=r.$t({range:u},function(E,_,C){return c++,C.delete()});s.push(f.next(function(){_e(c===1)}));for(var p=[],m=0,y=n.mutations;m<y.length;m++){var v=y[m],w=fn.key(t,v.key.path,n.batchId);s.push(o.delete(w)),p.push(v.key)}return ee.waitFor(s).next(function(){return p})}function Rd(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw pe();t=e.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ri.DEFAULT_COLLECTION_PERCENTILE=10,ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ri.DEFAULT=new ri(41943040,ri.DEFAULT_COLLECTION_PERCENTILE,ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ri.DISABLED=new ri(-1,0,0);var Q$=function(){function e(t,n,r,o){this.userId=t,this.R=n,this.Ut=r,this.referenceDelegate=o,this.Kt={}}return e.Qt=function(t,n,r,o){return _e(t.uid!==""),new e(t.isAuthenticated()?t.uid:"",n,r,o)},e.prototype.checkEmpty=function(t){var n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wi(t).$t({index:it.userMutationsIndex,range:r},function(o,s,u){n=!1,u.done()}).next(function(){return n})},e.prototype.addMutationBatch=function(t,n,r,o){var s=this,u=ba(t),c=Wi(t);return c.add({}).next(function(f){_e(typeof f=="number");for(var p=new ex(f,n,r,o),m=function(b,N,x){var j=x.baseMutations.map(function(A){return Md(b.Lt,A)}),k=x.mutations.map(function(A){return Md(b.Lt,A)});return new it(N,x.batchId,x.localWriteTime.toMillis(),j,k)}(s.R,s.userId,p),y=[],v=new zt(function(b,N){return Pe(b.canonicalString(),N.canonicalString())}),w=0,E=o;w<E.length;w++){var _=E[w],C=fn.key(s.userId,_.key.path,f);v=v.add(_.key.path.popLast()),y.push(c.put(m)),y.push(u.put(C,fn.PLACEHOLDER))}return v.forEach(function(b){y.push(s.Ut.addToCollectionParentIndex(t,b))}),t.addOnCommittedListener(function(){s.Kt[f]=p.keys()}),ee.waitFor(y).next(function(){return p})})},e.prototype.lookupMutationBatch=function(t,n){var r=this;return Wi(t).get(n).next(function(o){return o?(_e(o.userId===r.userId),xa(r.R,o)):null})},e.prototype.jt=function(t,n){var r=this;return this.Kt[n]?ee.resolve(this.Kt[n]):this.lookupMutationBatch(t,n).next(function(o){if(o){var s=o.keys();return r.Kt[n]=s,s}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(t,n){var r=this,o=n+1,s=IDBKeyRange.lowerBound([this.userId,o]),u=null;return Wi(t).$t({index:it.userMutationsIndex,range:s},function(c,f,p){f.userId===r.userId&&(_e(f.batchId>=o),u=xa(r.R,f)),p.done()}).next(function(){return u})},e.prototype.getHighestUnacknowledgedBatchId=function(t){var n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Wi(t).$t({index:it.userMutationsIndex,range:n,reverse:!0},function(o,s,u){r=s.batchId,u.done()}).next(function(){return r})},e.prototype.getAllMutationBatches=function(t){var n=this,r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Wi(t).Nt(it.userMutationsIndex,r).next(function(o){return o.map(function(s){return xa(n.R,s)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,n){var r=this,o=fn.prefixForPath(this.userId,n.path),s=IDBKeyRange.lowerBound(o),u=[];return ba(t).$t({range:s},function(c,f,p){var m=c[0],y=c[1],v=c[2],w=_i(y);if(m===r.userId&&n.path.isEqual(w))return Wi(t).get(v).next(function(E){if(!E)throw pe();_e(E.userId===r.userId),u.push(xa(r.R,E))});p.done()}).next(function(){return u})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,n){var r=this,o=new zt(Pe),s=[];return n.forEach(function(u){var c=fn.prefixForPath(r.userId,u.path),f=IDBKeyRange.lowerBound(c),p=ba(t).$t({range:f},function(m,y,v){var w=m[0],E=m[1],_=m[2],C=_i(E);w===r.userId&&u.path.isEqual(C)?o=o.add(_):v.done()});s.push(p)}),ee.waitFor(s).next(function(){return r.Wt(t,o)})},e.prototype.getAllMutationBatchesAffectingQuery=function(t,n){var r=this,o=n.path,s=o.length+1,u=fn.prefixForPath(this.userId,o),c=IDBKeyRange.lowerBound(u),f=new zt(Pe);return ba(t).$t({range:c},function(p,m,y){var v=p[0],w=p[1],E=p[2],_=_i(w);v===r.userId&&o.isPrefixOf(_)?_.length===s&&(f=f.add(E)):y.done()}).next(function(){return r.Wt(t,f)})},e.prototype.Wt=function(t,n){var r=this,o=[],s=[];return n.forEach(function(u){s.push(Wi(t).get(u).next(function(c){if(c===null)throw pe();_e(c.userId===r.userId),o.push(xa(r.R,c))}))}),ee.waitFor(s).next(function(){return o})},e.prototype.removeMutationBatch=function(t,n){var r=this;return gC(t.Mt,this.userId,n).next(function(o){return t.addOnCommittedListener(function(){r.Gt(n.batchId)}),ee.forEach(o,function(s){return r.referenceDelegate.markPotentiallyOrphaned(t,s)})})},e.prototype.Gt=function(t){delete this.Kt[t]},e.prototype.performConsistencyCheck=function(t){var n=this;return this.checkEmpty(t).next(function(r){if(!r)return ee.resolve();var o=IDBKeyRange.lowerBound(fn.prefixForUser(n.userId)),s=[];return ba(t).$t({range:o},function(u,c,f){if(u[0]===n.userId){var p=_i(u[1]);s.push(p)}else f.done()}).next(function(){_e(s.length===0)})})},e.prototype.containsKey=function(t,n){return vC(t,this.userId,n)},e.prototype.zt=function(t){var n=this;return yC(t).get(this.userId).next(function(r){return r||new vo(n.userId,-1,"")})},e}();function vC(e,t,n){var r=fn.prefixForPath(t,n.path),o=r[1],s=IDBKeyRange.lowerBound(r),u=!1;return ba(e).$t({range:s,Ft:!0},function(c,f,p){var m=c[0],y=c[1];c[2],m===t&&y===o&&(u=!0),p.done()}).next(function(){return u})}function Wi(e){return Hn(e,it.store)}function ba(e){return Hn(e,fn.store)}function yC(e){return Hn(e,vo.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Od=function(){function e(t){this.Ht=t}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),X$=function(){function e(t,n){this.referenceDelegate=t,this.R=n}return e.prototype.allocateTargetId=function(t){var n=this;return this.Xt(t).next(function(r){var o=new Od(r.highestTargetId);return r.highestTargetId=o.next(),n.Zt(t,r).next(function(){return r.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(n){return Ae.fromTimestamp(new zn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(n){return n.highestListenSequenceNumber})},e.prototype.setTargetsMetadata=function(t,n,r){var o=this;return this.Xt(t).next(function(s){return s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),o.Zt(t,s)})},e.prototype.addTargetData=function(t,n){var r=this;return this.te(t,n).next(function(){return r.Xt(t).next(function(o){return o.targetCount+=1,r.ee(n,o),r.Zt(t,o)})})},e.prototype.updateTargetData=function(t,n){return this.te(t,n)},e.prototype.removeTargetData=function(t,n){var r=this;return this.removeMatchingKeysForTargetId(t,n.targetId).next(function(){return ga(t).delete(n.targetId)}).next(function(){return r.Xt(t)}).next(function(o){return _e(o.targetCount>0),o.targetCount-=1,r.Zt(t,o)})},e.prototype.removeTargets=function(t,n,r){var o=this,s=0,u=[];return ga(t).$t(function(c,f){var p=Il(f);p.sequenceNumber<=n&&r.get(p.targetId)===null&&(s++,u.push(o.removeTargetData(t,p)))}).next(function(){return ee.waitFor(u)}).next(function(){return s})},e.prototype.forEachTarget=function(t,n){return ga(t).$t(function(r,o){var s=Il(o);n(s)})},e.prototype.Xt=function(t){return uE(t).get(Zn.key).next(function(n){return _e(n!==null),n})},e.prototype.Zt=function(t,n){return uE(t).put(Zn.key,n)},e.prototype.te=function(t,n){return ga(t).put(pC(this.R,n))},e.prototype.ee=function(t,n){var r=!1;return t.targetId>n.highestTargetId&&(n.highestTargetId=t.targetId,r=!0),t.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t.sequenceNumber,r=!0),r},e.prototype.getTargetCount=function(t){return this.Xt(t).next(function(n){return n.targetCount})},e.prototype.getTargetData=function(t,n){var r=Fc(n),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return ga(t).$t({range:o,index:Fn.queryTargetsIndexName},function(u,c,f){var p=Il(c);_p(n,p.target)&&(s=p,f.done())}).next(function(){return s})},e.prototype.addMatchingKeys=function(t,n,r){var o=this,s=[],u=ro(t);return n.forEach(function(c){var f=zr(c.path);s.push(u.put(new tn(r,f))),s.push(o.referenceDelegate.addReference(t,r,c))}),ee.waitFor(s)},e.prototype.removeMatchingKeys=function(t,n,r){var o=this,s=ro(t);return ee.forEach(n,function(u){var c=zr(u.path);return ee.waitFor([s.delete([r,c]),o.referenceDelegate.removeReference(t,r,u)])})},e.prototype.removeMatchingKeysForTargetId=function(t,n){var r=ro(t),o=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(o)},e.prototype.getMatchingKeysForTargetId=function(t,n){var r=IDBKeyRange.bound([n],[n+1],!1,!0),o=ro(t),s=nt();return o.$t({range:r,Ft:!0},function(u,c,f){var p=_i(u[1]),m=new me(p);s=s.add(m)}).next(function(){return s})},e.prototype.containsKey=function(t,n){var r=zr(n.path),o=IDBKeyRange.bound([r],[Ak(r)],!1,!0),s=0;return ro(t).$t({index:tn.documentTargetsIndex,Ft:!0,range:o},function(u,c,f){var p=u[0];u[1],p!==0&&(s++,f.done())}).next(function(){return s>0})},e.prototype.lt=function(t,n){return ga(t).get(n).next(function(r){return r?Il(r):null})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(e){return Hn(e,Fn.store)}function uE(e){return Hn(e,Zn.store)}function ro(e){return Hn(e,tn.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(e){return W(this,void 0,void 0,function(){return H(this,function(t){if(e.code!==F.FAILED_PRECONDITION||e.message!==lC)throw e;return ne("LocalStore","Unexpectedly lost primary lease"),[2]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(e,t){var n=e[0],r=e[1],o=t[0],s=t[1],u=Pe(n,o);return u===0?Pe(r,s):u}var J$=function(){function e(t){this.ne=t,this.buffer=new zt(lE),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(t){var n=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(n);else{var r=this.buffer.last();lE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),Z$=function(){function e(t,n){this.garbageCollector=t,this.asyncQueue=n,this.oe=!1,this.ce=null}return e.prototype.start=function(t){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.ue(t)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return this.ce!==null},enumerable:!1,configurable:!0}),e.prototype.ue=function(t){var n=this,r=this.oe?3e5:6e4;ne("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",r,function(){return W(n,void 0,void 0,function(){var o;return H(this,function(s){switch(s.label){case 0:this.ce=null,this.oe=!0,s.label=1;case 1:return s.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return s.sent(),[3,7];case 3:return Ls(o=s.sent())?(ne("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",o),[3,6]):[3,4];case 4:return[4,Ps(o)];case 5:s.sent(),s.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return s.sent(),[2]}})})})},e}(),e4=function(){function e(t,n){this.ae=t,this.params=n}return e.prototype.calculateTargetCount=function(t,n){return this.ae.he(t).next(function(r){return Math.floor(n/100*r)})},e.prototype.nthSequenceNumber=function(t,n){var r=this;if(n===0)return ee.resolve(rr.o);var o=new J$(n);return this.ae.forEachTarget(t,function(s){return o.re(s.sequenceNumber)}).next(function(){return r.ae.le(t,function(s){return o.re(s)})}).next(function(){return o.maxValue})},e.prototype.removeTargets=function(t,n,r){return this.ae.removeTargets(t,n,r)},e.prototype.removeOrphanedDocuments=function(t,n){return this.ae.removeOrphanedDocuments(t,n)},e.prototype.collect=function(t,n){var r=this;return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(aE)):this.getCacheSize(t).next(function(o){return o<r.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector","Garbage collection skipped; Cache size "+o+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),aE):r.fe(t,n)})},e.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},e.prototype.fe=function(t,n){var r,o,s,u,c,f,p,m=this,y=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(v){return v>m.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+m.params.maximumSequenceNumbersToCollect+" from "+v),o=m.params.maximumSequenceNumbersToCollect):o=v,u=Date.now(),m.nthSequenceNumber(t,o)}).next(function(v){return r=v,c=Date.now(),m.removeTargets(t,r,n)}).next(function(v){return s=v,f=Date.now(),m.removeOrphanedDocuments(t,r)}).next(function(v){return p=Date.now(),s0()<=Ke.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in `+(u-y)+`ms
	Determined least recently used `+o+" in "+(c-u)+`ms
	Removed `+s+" targets in "+(f-c)+`ms
	Removed `+v+" documents in "+(p-f)+`ms
Total Duration: `+(p-y)+"ms"),ee.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:s,documentsRemoved:v})})},e}(),t4=function(){function e(t,n){this.db=t,this.garbageCollector=function(r,o){return new e4(r,o)}(this,n)}return e.prototype.he=function(t){var n=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(r){return n.next(function(o){return r+o})})},e.prototype.de=function(t){var n=0;return this.le(t,function(r){n++}).next(function(){return n})},e.prototype.forEachTarget=function(t,n){return this.db.getTargetCache().forEachTarget(t,n)},e.prototype.le=function(t,n){return this.we(t,function(r,o){return n(o)})},e.prototype.addReference=function(t,n,r){return xf(t,r)},e.prototype.removeReference=function(t,n,r){return xf(t,r)},e.prototype.removeTargets=function(t,n,r){return this.db.getTargetCache().removeTargets(t,n,r)},e.prototype.markPotentiallyOrphaned=function(t,n){return xf(t,n)},e.prototype._e=function(t,n){return function(r,o){var s=!1;return yC(r).Ot(function(u){return vC(r,u,o).next(function(c){return c&&(s=!0),ee.resolve(!c)})}).next(function(){return s})}(t,n)},e.prototype.removeOrphanedDocuments=function(t,n){var r=this,o=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],u=0;return this.we(t,function(c,f){if(f<=n){var p=r._e(t,c).next(function(m){if(!m)return u++,o.getEntry(t,c).next(function(){return o.removeEntry(c),ro(t).delete([0,zr(c.path)])})});s.push(p)}}).next(function(){return ee.waitFor(s)}).next(function(){return o.apply(t)}).next(function(){return u})},e.prototype.removeTarget=function(t,n){var r=n.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,r)},e.prototype.updateLimboDocument=function(t,n){return xf(t,n)},e.prototype.we=function(t,n){var r,o=ro(t),s=rr.o;return o.$t({index:tn.documentTargetsIndex},function(u,c){var f=u[0];u[1];var p=c.path,m=c.sequenceNumber;f===0?(s!==rr.o&&n(new me(_i(r)),s),s=m,r=p):s=rr.o}).next(function(){s!==rr.o&&n(new me(_i(r)),s)})},e.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},e}();function xf(e,t){return ro(e).put(function(n,r){return new tn(0,zr(n.path),r)}(t,e.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bu=function(){function e(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return e.prototype.get=function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0)for(var o=0,s=r;o<s.length;o++){var u=s[o],c=u[0],f=u[1];if(this.equalsFn(c,t))return f}},e.prototype.has=function(t){return this.get(t)!==void 0},e.prototype.set=function(t,n){var r=this.mapKeyFn(t),o=this.inner[r];if(o!==void 0){for(var s=0;s<o.length;s++)if(this.equalsFn(o[s][0],t))return void(o[s]=[t,n]);o.push([t,n])}else this.inner[r]=[[t,n]]},e.prototype.delete=function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(var o=0;o<r.length;o++)if(this.equalsFn(r[o][0],t))return r.length===1?delete this.inner[n]:r.splice(o,1),!0;return!1},e.prototype.forEach=function(t){Rs(this.inner,function(n,r){for(var o=0,s=r;o<s.length;o++){var u=s[o],c=u[0],f=u[1];t(c,f)}})},e.prototype.isEmpty=function(){return Dk(this.inner)},e}(),wC=function(){function e(){this.changes=new bu(function(t){return t.toString()},function(t,n){return t.isEqual(n)}),this.changesApplied=!1}return e.prototype.getReadTime=function(t){var n=this.changes.get(t);return n?n.readTime:Ae.min()},e.prototype.addEntry=function(t,n){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:n})},e.prototype.removeEntry=function(t,n){n===void 0&&(n=null),this.assertNotApplied(),this.changes.set(t,{document:wn.newInvalidDocument(t),readTime:n})},e.prototype.getEntry=function(t,n){this.assertNotApplied();var r=this.changes.get(n);return r!==void 0?ee.resolve(r.document):this.getFromCache(t,n)},e.prototype.getEntries=function(t,n){return this.getAllFromCache(t,n)},e.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},e.prototype.assertNotApplied=function(){},e}(),n4=function(){function e(t,n){this.R=t,this.Ut=n}return e.prototype.addEntry=function(t,n,r){return Ji(t).put(bf(n),r)},e.prototype.removeEntry=function(t,n){var r=Ji(t),o=bf(n);return r.delete(o)},e.prototype.updateMetadata=function(t,n){var r=this;return this.getMetadata(t).next(function(o){return o.byteSize+=n,r.me(t,o)})},e.prototype.getEntry=function(t,n){var r=this;return Ji(t).get(bf(n)).next(function(o){return r.ye(n,o)})},e.prototype.ge=function(t,n){var r=this;return Ji(t).get(bf(n)).next(function(o){return{document:r.ye(n,o),size:Rd(o)}})},e.prototype.getEntries=function(t,n){var r=this,o=Br();return this.pe(t,n,function(s,u){var c=r.ye(s,u);o=o.insert(s,c)}).next(function(){return o})},e.prototype.Ee=function(t,n){var r=this,o=Br(),s=new xn(me.comparator);return this.pe(t,n,function(u,c){var f=r.ye(u,c);o=o.insert(u,f),s=s.insert(u,Rd(c))}).next(function(){return{documents:o,Te:s}})},e.prototype.pe=function(t,n,r){if(n.isEmpty())return ee.resolve();var o=IDBKeyRange.bound(n.first().path.toArray(),n.last().path.toArray()),s=n.getIterator(),u=s.getNext();return Ji(t).$t({range:o},function(c,f,p){for(var m=me.fromSegments(c);u&&me.comparator(u,m)<0;)r(u,null),u=s.getNext();u&&u.isEqual(m)&&(r(u,f),u=s.hasNext()?s.getNext():null),u?p.Ct(u.path.toArray()):p.done()}).next(function(){for(;u;)r(u,null),u=s.hasNext()?s.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(t,n,r){var o=this,s=Br(),u=n.path.length+1,c={};if(r.isEqual(Ae.min())){var f=n.path.toArray();c.range=IDBKeyRange.lowerBound(f)}else{var p=n.path.toArray(),m=tx(r);c.range=IDBKeyRange.lowerBound([p,m],!0),c.index=St.collectionReadTimeIndex}return Ji(t).$t(c,function(y,v,w){if(y.length===u){var E=d0(o.R,v);n.path.isPrefixOf(E.key.path)?Bc(n,E)&&(s=s.insert(E.key,E)):w.done()}}).next(function(){return s})},e.prototype.newChangeBuffer=function(t){return new r4(this,!!t&&t.trackRemovals)},e.prototype.getSize=function(t){return this.getMetadata(t).next(function(n){return n.byteSize})},e.prototype.getMetadata=function(t){return cE(t).get(oi.key).next(function(n){return _e(!!n),n})},e.prototype.me=function(t,n){return cE(t).put(oi.key,n)},e.prototype.ye=function(t,n){if(n){var r=d0(this.R,n);if(!r.isNoDocument()||!r.version.isEqual(Ae.min()))return r}return wn.newInvalidDocument(t)},e}(),r4=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).Ie=n,o.trackRemovals=r,o.Ae=new bu(function(s){return s.toString()},function(s,u){return s.isEqual(u)}),o}return be(t,e),t.prototype.applyChanges=function(n){var r=this,o=[],s=0,u=new zt(function(c,f){return Pe(c.canonicalString(),f.canonicalString())});return this.changes.forEach(function(c,f){var p=r.Ae.get(c);if(f.document.isValidDocument()){var m=rE(r.Ie.R,f.document,r.getReadTime(c));u=u.add(c.path.popLast());var y=Rd(m);s+=y-p,o.push(r.Ie.addEntry(n,c,m))}else if(s-=p,r.trackRemovals){var v=rE(r.Ie.R,wn.newNoDocument(c,Ae.min()),r.getReadTime(c));o.push(r.Ie.addEntry(n,c,v))}else o.push(r.Ie.removeEntry(n,c))}),u.forEach(function(c){o.push(r.Ie.Ut.addToCollectionParentIndex(n,c))}),o.push(this.Ie.updateMetadata(n,s)),ee.waitFor(o)},t.prototype.getFromCache=function(n,r){var o=this;return this.Ie.ge(n,r).next(function(s){return o.Ae.set(r,s.size),s.document})},t.prototype.getAllFromCache=function(n,r){var o=this;return this.Ie.Ee(n,r).next(function(s){var u=s.documents;return s.Te.forEach(function(c,f){o.Ae.set(c,f)}),u})},t}(wC);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(e){return Hn(e,oi.store)}function Ji(e){return Hn(e,St.store)}function bf(e){return e.path.toArray()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i4=function(){function e(t){this.R=t}return e.prototype.Rt=function(t,n,r,o){var s=this;_e(r<o&&r>=0&&o<=11);var u=new hC("createOrUpgrade",n);r<1&&o>=1&&(function(f){f.createObjectStore(Jn.store)}(t),function(f){f.createObjectStore(vo.store,{keyPath:vo.keyPath}),f.createObjectStore(it.store,{keyPath:it.keyPath,autoIncrement:!0}).createIndex(it.userMutationsIndex,it.userMutationsKeyPath,{unique:!0}),f.createObjectStore(fn.store)}(t),hE(t),function(f){f.createObjectStore(St.store)}(t));var c=ee.resolve();return r<3&&o>=3&&(r!==0&&(function(f){f.deleteObjectStore(tn.store),f.deleteObjectStore(Fn.store),f.deleteObjectStore(Zn.store)}(t),hE(t)),c=c.next(function(){return function(f){var p=f.store(Zn.store),m=new Zn(0,0,Ae.min().toTimestamp(),0);return p.put(Zn.key,m)}(u)})),r<4&&o>=4&&(r!==0&&(c=c.next(function(){return function(f,p){return p.store(it.store).Nt().next(function(m){f.deleteObjectStore(it.store),f.createObjectStore(it.store,{keyPath:it.keyPath,autoIncrement:!0}).createIndex(it.userMutationsIndex,it.userMutationsKeyPath,{unique:!0});var y=p.store(it.store),v=m.map(function(w){return y.put(w)});return ee.waitFor(v)})}(t,u)})),c=c.next(function(){(function(f){f.createObjectStore(Ii.store,{keyPath:Ii.keyPath})})(t)})),r<5&&o>=5&&(c=c.next(function(){return s.Re(u)})),r<6&&o>=6&&(c=c.next(function(){return function(f){f.createObjectStore(oi.store)}(t),s.be(u)})),r<7&&o>=7&&(c=c.next(function(){return s.ve(u)})),r<8&&o>=8&&(c=c.next(function(){return s.Pe(t,u)})),r<9&&o>=9&&(c=c.next(function(){(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(t),function(f){var p=f.objectStore(St.store);p.createIndex(St.readTimeIndex,St.readTimeIndexPath,{unique:!1}),p.createIndex(St.collectionReadTimeIndex,St.collectionReadTimeIndexPath,{unique:!1})}(n)})),r<10&&o>=10&&(c=c.next(function(){return s.Ve(u)})),r<11&&o>=11&&(c=c.next(function(){(function(f){f.createObjectStore(ou.store,{keyPath:ou.keyPath})})(t),function(f){f.createObjectStore(su.store,{keyPath:su.keyPath})}(t)})),c},e.prototype.be=function(t){var n=0;return t.store(St.store).$t(function(r,o){n+=Rd(o)}).next(function(){var r=new oi(n);return t.store(oi.store).put(oi.key,r)})},e.prototype.Re=function(t){var n=this,r=t.store(vo.store),o=t.store(it.store);return r.Nt().next(function(s){return ee.forEach(s,function(u){var c=IDBKeyRange.bound([u.userId,-1],[u.userId,u.lastAcknowledgedBatchId]);return o.Nt(it.userMutationsIndex,c).next(function(f){return ee.forEach(f,function(p){_e(p.userId===u.userId);var m=xa(n.R,p);return gC(t,u.userId,m).next(function(){})})})})})},e.prototype.ve=function(t){var n=t.store(tn.store),r=t.store(St.store);return t.store(Zn.store).get(Zn.key).next(function(o){var s=[];return r.$t(function(u,c){var f=new He(u),p=function(m){return[0,zr(m)]}(f);s.push(n.get(p).next(function(m){return m?ee.resolve():function(y){return n.put(new tn(0,zr(y),o.highestListenSequenceNumber))}(f)}))}).next(function(){return ee.waitFor(s)})})},e.prototype.Pe=function(t,n){t.createObjectStore(ds.store,{keyPath:ds.keyPath});var r=n.store(ds.store),o=new nx,s=function(u){if(o.add(u)){var c=u.lastSegment(),f=u.popLast();return r.put({collectionId:c,parent:zr(f)})}};return n.store(St.store).$t({Ft:!0},function(u,c){var f=new He(u);return s(f.popLast())}).next(function(){return n.store(fn.store).$t({Ft:!0},function(u,c){u[0];var f=u[1];u[2];var p=_i(f);return s(p.popLast())})})},e.prototype.Ve=function(t){var n=this,r=t.store(Fn.store);return r.$t(function(o,s){var u=Il(s),c=pC(n.R,u);return r.put(c)})},e}();function hE(e){e.createObjectStore(tn.store,{keyPath:tn.keyPath}).createIndex(tn.documentTargetsIndex,tn.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Fn.store,{keyPath:Fn.keyPath}).createIndex(Fn.queryTargetsIndexName,Fn.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Zn.store)}var Wv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",o4=function(){function e(t,n,r,o,s,u,c,f,p,m){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=s,this.window=u,this.document=c,this.De=p,this.Ce=m,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(y){return Promise.resolve()},!e.yt())throw new Y(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new t4(this,o),this.Le=n+"main",this.R=new fC(f),this.Be=new au(this.Le,11,new i4(this.R)),this.qe=new X$(this.referenceDelegate,this.R),this.Ut=new Y$,this.Ue=function(y,v){return new n4(y,v)}(this.R,this.Ut),this.Ke=new G$,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,m===!1&&Lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Y(F.FAILED_PRECONDITION,Wv);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(n){return t.qe.getHighestSequenceNumber(n)})}).then(function(n){t.Ne=new rr(n,t.De)}).then(function(){t.xe=!0}).catch(function(n){return t.Be&&t.Be.close(),Promise.reject(n)})},e.prototype.He=function(t){var n=this;return this.Me=function(r){return W(n,void 0,void 0,function(){return H(this,function(o){return this.started?[2,t(r)]:[2]})})},t(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(t){var n=this;this.Be.vt(function(r){return W(n,void 0,void 0,function(){return H(this,function(o){switch(o.label){case 0:return r.newVersion===null?[4,t()]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return W(n,void 0,void 0,function(){return H(this,function(r){switch(r.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}))},e.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(n){return Sf(n).put(new Ii(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(n).next(function(r){r||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(n)}).next(function(r){return t.isPrimary&&!r?t.Xe(n).next(function(){return!1}):!!r&&t.Ze(n).next(function(){return!0})})}).catch(function(n){if(Ls(n))return ne("IndexedDbPersistence","Failed to extend owner lease: ",n),t.isPrimary;if(!t.allowTabSynchronization)throw n;return ne("IndexedDbPersistence","Releasing owner lease after error during lease refresh",n),!1}).then(function(n){t.isPrimary!==n&&t.Se.enqueueRetryable(function(){return t.Me(n)}),t.isPrimary=n})},e.prototype.Je=function(t){var n=this;return wl(t).get(Jn.key).next(function(r){return ee.resolve(n.tn(r))})},e.prototype.en=function(t){return Sf(t).delete(this.clientId)},e.prototype.nn=function(){return W(this,void 0,void 0,function(){var t,n,r,o,s=this;return H(this,function(u){switch(u.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(c){var f=Hn(c,Ii.store);return f.Nt().next(function(p){var m=s.rn(p,18e5),y=p.filter(function(v){return m.indexOf(v)===-1});return ee.forEach(y,function(v){return f.delete(v.clientId)}).next(function(){return y})})}).catch(function(){return[]})]);case 1:if(t=u.sent(),this.Qe)for(n=0,r=t;n<r.length;n++)o=r[n],this.Qe.removeItem(this.on(o.clientId));u.label=2;case 2:return[2]}})})},e.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},e.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},e.prototype.Ye=function(t){var n=this;return this.Ce?ee.resolve(!0):wl(t).get(Jn.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)){if(n.tn(r)&&n.networkEnabled)return!0;if(!n.tn(r)){if(!r.allowTabSynchronization)throw new Y(F.FAILED_PRECONDITION,Wv);return!1}}return!(!n.networkEnabled||!n.inForeground)||Sf(t).Nt().next(function(o){return n.rn(o,5e3).find(function(s){if(n.clientId!==s.clientId){var u=!n.networkEnabled&&s.networkEnabled,c=!n.inForeground&&s.inForeground,f=n.networkEnabled===s.networkEnabled;if(u||c&&f)return!0}return!1})===void 0})}).next(function(r){return n.isPrimary!==r&&ne("IndexedDbPersistence","Client "+(r?"is":"is not")+" eligible for a primary lease."),r})},e.prototype.shutdown=function(){return W(this,void 0,void 0,function(){var t=this;return H(this,function(n){switch(n.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Jn.store,Ii.store],function(r){var o=new nE(r,rr.o);return t.Xe(o).next(function(){return t.en(o)})})];case 1:return n.sent(),this.Be.close(),this.ln(),[2]}})})},e.prototype.rn=function(t,n){var r=this;return t.filter(function(o){return r.sn(o.updateTimeMs,n)&&!r.cn(o.clientId)})},e.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(n){return Sf(n).Nt().next(function(r){return t.rn(r,18e5).map(function(o){return o.clientId})})})},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(t){return Q$.Qt(t,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(t,n,r){var o=this;ne("IndexedDbPersistence","Starting transaction:",t);var s,u=n==="readonly"?"readonly":"readwrite";return this.Be.runTransaction(t,u,z$,function(c){return s=new nE(c,o.Ne?o.Ne.next():rr.o),n==="readwrite-primary"?o.Je(s).next(function(f){return!!f||o.Ye(s)}).next(function(f){if(!f)throw Lt("Failed to obtain primary lease for action '"+t+"'."),o.isPrimary=!1,o.Se.enqueueRetryable(function(){return o.Me(!1)}),new Y(F.FAILED_PRECONDITION,lC);return r(s)}).next(function(f){return o.Ze(s).next(function(){return f})}):o.dn(s).next(function(){return r(s)})}).then(function(c){return s.raiseOnCommittedEvent(),c})},e.prototype.dn=function(t){var n=this;return wl(t).get(Jn.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)&&!n.tn(r)&&!(n.Ce||n.allowTabSynchronization&&r.allowTabSynchronization))throw new Y(F.FAILED_PRECONDITION,Wv)})},e.prototype.Ze=function(t){var n=new Jn(this.clientId,this.allowTabSynchronization,Date.now());return wl(t).put(Jn.key,n)},e.yt=function(){return au.yt()},e.prototype.Xe=function(t){var n=this,r=wl(t);return r.get(Jn.key).next(function(o){return n.tn(o)?(ne("IndexedDbPersistence","Releasing primary lease."),r.delete(Jn.key)):ee.resolve()})},e.prototype.sn=function(t,n){var r=Date.now();return!(t<r-n||t>r&&(Lt("Detected an update time that is in the future: "+t+" > "+r),1))},e.prototype.We=function(){var t=this;this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Fe=function(){t.Se.enqueueAndForget(function(){return t.inForeground=t.document.visibilityState==="visible",t.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground=this.document.visibilityState==="visible")},e.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},e.prototype.Ge=function(){var t,n=this;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.ke=function(){n.un(),hU()&&navigator.appVersion.match("Version/14")&&n.Se.enterRestrictedMode(!0),n.Se.enqueueAndForget(function(){return n.shutdown()})},this.window.addEventListener("pagehide",this.ke))},e.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},e.prototype.cn=function(t){var n;try{var r=((n=this.Qe)===null||n===void 0?void 0:n.getItem(this.on(t)))!==null;return ne("IndexedDbPersistence","Client '"+t+"' "+(r?"is":"is not")+" zombied in LocalStorage"),r}catch(o){return Lt("IndexedDbPersistence","Failed to get zombied client id.",o),!1}},e.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Lt("Failed to set zombie client id.",t)}},e.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch{}},e.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},e}();function wl(e){return Hn(e,Jn.store)}function Sf(e){return Hn(e,Ii.store)}function rx(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var xC=function(){function e(t,n,r){this.Ue=t,this._n=n,this.Ut=r}return e.prototype.mn=function(t,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,n).next(function(o){return r.yn(t,n,o)})},e.prototype.yn=function(t,n,r){return this.Ue.getEntry(t,n).next(function(o){for(var s=0,u=r;s<u.length;s++)u[s].applyToLocalView(o);return o})},e.prototype.gn=function(t,n){t.forEach(function(r,o){for(var s=0,u=n;s<u.length;s++)u[s].applyToLocalView(o)})},e.prototype.pn=function(t,n){var r=this;return this.Ue.getEntries(t,n).next(function(o){return r.En(t,o).next(function(){return o})})},e.prototype.En=function(t,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,n).next(function(o){return r.gn(n,o)})},e.prototype.getDocumentsMatchingQuery=function(t,n,r){return function(o){return me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.Tn(t,n.path):Ww(n)?this.In(t,n,r):this.An(t,n,r)},e.prototype.Tn=function(t,n){return this.mn(t,new me(n)).next(function(r){var o=h0();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})},e.prototype.In=function(t,n,r){var o=this,s=n.collectionGroup,u=h0();return this.Ut.getCollectionParents(t,s).next(function(c){return ee.forEach(c,function(f){var p=function(m,y){return new Oi(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,f.child(s));return o.An(t,p,r).next(function(m){m.forEach(function(y,v){u=u.insert(y,v)})})}).next(function(){return u})})},e.prototype.An=function(t,n,r){var o,s,u=this;return this.Ue.getDocumentsMatchingQuery(t,n,r).next(function(c){return o=c,u._n.getAllMutationBatchesAffectingQuery(t,n)}).next(function(c){return s=c,u.Rn(t,s,o).next(function(f){o=f;for(var p=0,m=s;p<m.length;p++)for(var y=m[p],v=0,w=y.mutations;v<w.length;v++){var E=w[v],_=E.key,C=o.get(_);C==null&&(C=wn.newInvalidDocument(_),o=o.insert(_,C)),c0(E,C,y.localWriteTime),C.isFoundDocument()||(o=o.remove(_))}})}).next(function(){return o.forEach(function(c,f){Bc(n,f)||(o=o.remove(c))}),o})},e.prototype.Rn=function(t,n,r){for(var o=nt(),s=0,u=n;s<u.length;s++)for(var c=0,f=u[s].mutations;c<f.length;c++){var p=f[c];p instanceof ko&&r.get(p.key)===null&&(o=o.add(p.key))}var m=r;return this.Ue.getEntries(t,o).next(function(y){return y.forEach(function(v,w){w.isFoundDocument()&&(m=m.insert(v,w))}),m})},e}(),s4=function(){function e(t,n,r,o){this.targetId=t,this.fromCache=n,this.bn=r,this.vn=o}return e.Pn=function(t,n){for(var r=nt(),o=nt(),s=0,u=n.docChanges;s<u.length;s++){var c=u[s];switch(c.type){case 0:r=r.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}}return new e(t,n.fromCache,r,o)},e}(),bC=function(){function e(){}return e.prototype.Vn=function(t){this.Sn=t},e.prototype.getDocumentsMatchingQuery=function(t,n,r,o){var s=this;return function(u){return u.filters.length===0&&u.limit===null&&u.startAt==null&&u.endAt==null&&(u.explicitOrderBy.length===0||u.explicitOrderBy.length===1&&u.explicitOrderBy[0].field.isKeyField())}(n)||r.isEqual(Ae.min())?this.Dn(t,n):this.Sn.pn(t,o).next(function(u){var c=s.Cn(n,u);return(Vf(n)||Dd(n))&&s.Nn(n.limitType,c,o,r)?s.Dn(t,n):(s0()<=Ke.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),l0(n)),s.Sn.getDocumentsMatchingQuery(t,n,r).next(function(f){return c.forEach(function(p){f=f.insert(p.key,p)}),f}))})},e.prototype.Cn=function(t,n){var r=new zt(Vk(t));return n.forEach(function(o,s){Bc(t,s)&&(r=r.add(s))}),r},e.prototype.Nn=function(t,n,r,o){if(r.size!==n.size)return!0;var s=t==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)},e.prototype.Dn=function(t,n){return s0()<=Ke.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",l0(n)),this.Sn.getDocumentsMatchingQuery(t,n,Ae.min())},e}(),a4=function(){function e(t,n,r,o){this.persistence=t,this.xn=n,this.R=o,this.kn=new xn(Pe),this.Fn=new bu(function(s){return Fc(s)},_p),this.$n=Ae.min(),this._n=t.getMutationQueue(r),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new xC(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(t){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(r){return t.collect(r,n.kn)})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(e,t,n,r){return new a4(e,t,n,r)}function _C(e,t){return W(this,void 0,void 0,function(){var n,r,o,s;return H(this,function(u){switch(u.label){case 0:return n=ue(e),r=n._n,o=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(c){var f;return n._n.getAllMutationBatches(c).next(function(p){return f=p,r=n.persistence.getMutationQueue(t),o=new xC(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(c)}).next(function(p){for(var m=[],y=[],v=nt(),w=0,E=f;w<E.length;w++){var _=E[w];m.push(_.batchId);for(var C=0,b=_.mutations;C<b.length;C++){var N=b[C];v=v.add(N.key)}}for(var x=0,j=p;x<j.length;x++){var k=j[x];y.push(k.batchId);for(var A=0,T=k.mutations;A<T.length;A++){var L=T[A];v=v.add(L.key)}}return o.pn(c,v).next(function(U){return{Ln:U,removedBatchIds:m,addedBatchIds:y}})})})];case 1:return s=u.sent(),[2,(n._n=r,n.Mn=o,n.xn.Vn(n.Mn),s)]}})})}function u4(e,t){var n=ue(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(r){var o=t.batch.keys(),s=n.On.newChangeBuffer({trackRemovals:!0});return function(u,c,f,p){var m=f.batch,y=m.keys(),v=ee.resolve();return y.forEach(function(w){v=v.next(function(){return p.getEntry(c,w)}).next(function(E){var _=f.docVersions.get(w);_e(_!==null),E.version.compareTo(_)<0&&(m.applyToRemoteDocument(E,f),E.isValidDocument()&&p.addEntry(E,f.commitVersion))})}),v.next(function(){return u._n.removeMutationBatch(c,m)})}(n,r,t,s).next(function(){return s.apply(r)}).next(function(){return n._n.performConsistencyCheck(r)}).next(function(){return n.Mn.pn(r,o)})})}function NC(e){var t=ue(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(n){return t.qe.getLastRemoteSnapshotVersion(n)})}function l4(e,t){var n=ue(e),r=t.snapshotVersion,o=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var u=n.On.newChangeBuffer({trackRemovals:!0});o=n.kn;var c=[];t.targetChanges.forEach(function(m,y){var v=o.get(y);if(v){c.push(n.qe.removeMatchingKeys(s,m.removedDocuments,y).next(function(){return n.qe.addMatchingKeys(s,m.addedDocuments,y)}));var w=m.resumeToken;if(w.approximateByteSize()>0){var E=v.withResumeToken(w,r).withSequenceNumber(s.currentSequenceNumber);o=o.insert(y,E),function(_,C,b){return _e(C.resumeToken.approximateByteSize()>0),_.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8||b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(v,E,m)&&c.push(n.qe.updateTargetData(s,E))}}});var f=Br();if(t.documentUpdates.forEach(function(m,y){t.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(s,m))}),c.push(c4(s,u,t.documentUpdates,r).next(function(m){f=m})),!r.isEqual(Ae.min())){var p=n.qe.getLastRemoteSnapshotVersion(s).next(function(m){return n.qe.setTargetsMetadata(s,s.currentSequenceNumber,r)});c.push(p)}return ee.waitFor(c).next(function(){return u.apply(s)}).next(function(){return n.Mn.En(s,f)}).next(function(){return f})}).then(function(s){return n.kn=o,s})}function c4(e,t,n,r,o){var s=nt();return n.forEach(function(u){return s=s.add(u)}),t.getEntries(e,s).next(function(u){var c=Br();return n.forEach(function(f,p){var m=u.get(f),y=r;p.isNoDocument()&&p.version.isEqual(Ae.min())?(t.removeEntry(f,y),c=c.insert(f,p)):!m.isValidDocument()||p.version.compareTo(m.version)>0||p.version.compareTo(m.version)===0&&m.hasPendingWrites?(t.addEntry(p,y),c=c.insert(f,p)):ne("LocalStore","Ignoring outdated watch update for ",f,". Current version:",m.version," Watch version:",p.version)}),c})}function h4(e,t){var n=ue(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(r){return t===void 0&&(t=-1),n._n.getNextMutationBatchAfterBatchId(r,t)})}function Ld(e,t){var n=ue(e);return n.persistence.runTransaction("Allocate target","readwrite",function(r){var o;return n.qe.getTargetData(r,t).next(function(s){return s?(o=s,ee.resolve(o)):n.qe.allocateTargetId(r).next(function(u){return o=new Tp(t,u,0,r.currentSequenceNumber),n.qe.addTargetData(r,o).next(function(){return o})})})}).then(function(r){var o=n.kn.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.kn=n.kn.insert(r.targetId,r),n.Fn.set(t,r.targetId)),r})}function cu(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u;return H(this,function(c){switch(c.label){case 0:r=ue(e),o=r.kn.get(t),s=n?"readwrite":"readwrite-primary",c.label=1;case 1:return c.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,function(f){return r.persistence.referenceDelegate.removeTarget(f,o)})];case 2:c.sent(),c.label=3;case 3:return[3,5];case 4:if(!Ls(u=c.sent()))throw u;return ne("LocalStore","Failed to update sequence numbers for target "+t+": "+u),[3,5];case 5:return r.kn=r.kn.remove(t),r.Fn.delete(o.target),[2]}})})}function Pd(e,t,n){var r=ue(e),o=Ae.min(),s=nt();return r.persistence.runTransaction("Execute query","readonly",function(u){return function(c,f,p){var m=ue(c),y=m.Fn.get(p);return y!==void 0?ee.resolve(m.kn.get(y)):m.qe.getTargetData(f,p)}(r,u,ci(t)).next(function(c){if(c)return o=c.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(u,c.targetId).next(function(f){s=f})}).next(function(){return r.xn.getDocumentsMatchingQuery(u,t,n?o:Ae.min(),n?s:nt())}).next(function(c){return{documents:c,Bn:s}})})}function EC(e,t){var n=ue(e),r=ue(n.qe),o=n.kn.get(t);return o?Promise.resolve(o.target):n.persistence.runTransaction("Get target data","readonly",function(s){return r.lt(s,t).next(function(u){return u?u.target:null})})}function IC(e){var t=ue(e);return t.persistence.runTransaction("Get new document changes","readonly",function(n){return function(r,o,s){var u=ue(r),c=Br(),f=tx(s),p=Ji(o),m=IDBKeyRange.lowerBound(f,!0);return p.$t({index:St.readTimeIndex,range:m},function(y,v){var w=d0(u.R,v);c=c.insert(w.key,w),f=v.readTime}).next(function(){return{wn:c,readTime:dC(f)}})}(t.On,n,t.$n)}).then(function(n){var r=n.wn,o=n.readTime;return t.$n=o,r})}function f4(e){return W(this,void 0,void 0,function(){var t;return H(this,function(n){return[2,(t=ue(e)).persistence.runTransaction("Synchronize last document change read time","readonly",function(r){return function(o){var s=Ji(o),u=Ae.min();return s.$t({index:St.readTimeIndex,reverse:!0},function(c,f,p){f.readTime&&(u=dC(f.readTime)),p.done()}).next(function(){return u})}(r)}).then(function(r){t.$n=r})]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var d4=function(){function e(t){this.R=t,this.Qn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(t,n){return ee.resolve(this.Qn.get(n))},e.prototype.saveBundleMetadata=function(t,n){var r;return this.Qn.set(n.id,{id:(r=n).id,version:r.version,createTime:jn(r.createTime)}),ee.resolve()},e.prototype.getNamedQuery=function(t,n){return ee.resolve(this.jn.get(n))},e.prototype.saveNamedQuery=function(t,n){return this.jn.set(n.name,function(r){return{name:r.name,query:mC(r.bundledQuery),readTime:jn(r.readTime)}}(n)),ee.resolve()},e}(),ix=function(){function e(){this.Wn=new zt(Gt.Gn),this.zn=new zt(Gt.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(t,n){var r=new Gt(t,n);this.Wn=this.Wn.add(r),this.zn=this.zn.add(r)},e.prototype.Jn=function(t,n){var r=this;t.forEach(function(o){return r.addReference(o,n)})},e.prototype.removeReference=function(t,n){this.Yn(new Gt(t,n))},e.prototype.Xn=function(t,n){var r=this;t.forEach(function(o){return r.removeReference(o,n)})},e.prototype.Zn=function(t){var n=this,r=new me(new He([])),o=new Gt(r,t),s=new Gt(r,t+1),u=[];return this.zn.forEachInRange([o,s],function(c){n.Yn(c),u.push(c.key)}),u},e.prototype.ts=function(){var t=this;this.Wn.forEach(function(n){return t.Yn(n)})},e.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},e.prototype.es=function(t){var n=new me(new He([])),r=new Gt(n,t),o=new Gt(n,t+1),s=nt();return this.zn.forEachInRange([r,o],function(u){s=s.add(u.key)}),s},e.prototype.containsKey=function(t){var n=new Gt(t,0),r=this.Wn.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)},e}(),Gt=function(){function e(t,n){this.key=t,this.ns=n}return e.Gn=function(t,n){return me.comparator(t.key,n.key)||Pe(t.ns,n.ns)},e.Hn=function(t,n){return Pe(t.ns,n.ns)||me.comparator(t.key,n.key)},e}(),p4=function(){function e(t,n){this.Ut=t,this.referenceDelegate=n,this._n=[],this.ss=1,this.rs=new zt(Gt.Gn)}return e.prototype.checkEmpty=function(t){return ee.resolve(this._n.length===0)},e.prototype.addMutationBatch=function(t,n,r,o){var s=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var u=new ex(s,n,r,o);this._n.push(u);for(var c=0,f=o;c<f.length;c++){var p=f[c];this.rs=this.rs.add(new Gt(p.key,s)),this.Ut.addToCollectionParentIndex(t,p.key.path.popLast())}return ee.resolve(u)},e.prototype.lookupMutationBatch=function(t,n){return ee.resolve(this.os(n))},e.prototype.getNextMutationBatchAfterBatchId=function(t,n){var r=n+1,o=this.cs(r),s=o<0?0:o;return ee.resolve(this._n.length>s?this._n[s]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return ee.resolve(this._n.length===0?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(t){return ee.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,n){var r=this,o=new Gt(n,0),s=new Gt(n,Number.POSITIVE_INFINITY),u=[];return this.rs.forEachInRange([o,s],function(c){var f=r.os(c.ns);u.push(f)}),ee.resolve(u)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,n){var r=this,o=new zt(Pe);return n.forEach(function(s){var u=new Gt(s,0),c=new Gt(s,Number.POSITIVE_INFINITY);r.rs.forEachInRange([u,c],function(f){o=o.add(f.ns)})}),ee.resolve(this.us(o))},e.prototype.getAllMutationBatchesAffectingQuery=function(t,n){var r=n.path,o=r.length+1,s=r;me.isDocumentKey(s)||(s=s.child(""));var u=new Gt(new me(s),0),c=new zt(Pe);return this.rs.forEachWhile(function(f){var p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===o&&(c=c.add(f.ns)),!0)},u),ee.resolve(this.us(c))},e.prototype.us=function(t){var n=this,r=[];return t.forEach(function(o){var s=n.os(o);s!==null&&r.push(s)}),r},e.prototype.removeMutationBatch=function(t,n){var r=this;_e(this.hs(n.batchId,"removed")===0),this._n.shift();var o=this.rs;return ee.forEach(n.mutations,function(s){var u=new Gt(s.key,n.batchId);return o=o.delete(u),r.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(function(){r.rs=o})},e.prototype.Gt=function(t){},e.prototype.containsKey=function(t,n){var r=new Gt(n,0),o=this.rs.firstAfterOrEqual(r);return ee.resolve(n.isEqual(o&&o.key))},e.prototype.performConsistencyCheck=function(t){return this._n.length,ee.resolve()},e.prototype.hs=function(t,n){return this.cs(t)},e.prototype.cs=function(t){return this._n.length===0?0:t-this._n[0].batchId},e.prototype.os=function(t){var n=this.cs(t);return n<0||n>=this._n.length?null:this._n[n]},e}(),m4=function(){function e(t,n){this.Ut=t,this.ls=n,this.docs=new xn(me.comparator),this.size=0}return e.prototype.addEntry=function(t,n,r){var o=n.key,s=this.docs.get(o),u=s?s.size:0,c=this.ls(n);return this.docs=this.docs.insert(o,{document:n.clone(),size:c,readTime:r}),this.size+=c-u,this.Ut.addToCollectionParentIndex(t,o.path.popLast())},e.prototype.removeEntry=function(t){var n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)},e.prototype.getEntry=function(t,n){var r=this.docs.get(n);return ee.resolve(r?r.document.clone():wn.newInvalidDocument(n))},e.prototype.getEntries=function(t,n){var r=this,o=Br();return n.forEach(function(s){var u=r.docs.get(s);o=o.insert(s,u?u.document.clone():wn.newInvalidDocument(s))}),ee.resolve(o)},e.prototype.getDocumentsMatchingQuery=function(t,n,r){for(var o=Br(),s=new me(n.path.child("")),u=this.docs.getIteratorFrom(s);u.hasNext();){var c=u.getNext(),f=c.key,p=c.value,m=p.document,y=p.readTime;if(!n.path.isPrefixOf(f.path))break;y.compareTo(r)<=0||Bc(n,m)&&(o=o.insert(m.key,m.clone()))}return ee.resolve(o)},e.prototype.fs=function(t,n){return ee.forEach(this.docs,function(r){return n(r)})},e.prototype.newChangeBuffer=function(t){return new g4(this)},e.prototype.getSize=function(t){return ee.resolve(this.size)},e}(),g4=function(e){function t(n){var r=this;return(r=e.call(this)||this).Ie=n,r}return be(t,e),t.prototype.applyChanges=function(n){var r=this,o=[];return this.changes.forEach(function(s,u){u.document.isValidDocument()?o.push(r.Ie.addEntry(n,u.document,r.getReadTime(s))):r.Ie.removeEntry(s)}),ee.waitFor(o)},t.prototype.getFromCache=function(n,r){return this.Ie.getEntry(n,r)},t.prototype.getAllFromCache=function(n,r){return this.Ie.getEntries(n,r)},t}(wC),v4=function(){function e(t){this.persistence=t,this.ds=new bu(function(n){return Fc(n)},_p),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.ws=0,this._s=new ix,this.targetCount=0,this.ys=Od.Jt()}return e.prototype.forEachTarget=function(t,n){return this.ds.forEach(function(r,o){return n(o)}),ee.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(t){return ee.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(t){return ee.resolve(this.ws)},e.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),ee.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ws&&(this.ws=n),ee.resolve()},e.prototype.te=function(t){this.ds.set(t.target,t);var n=t.targetId;n>this.highestTargetId&&(this.ys=new Od(n),this.highestTargetId=n),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},e.prototype.addTargetData=function(t,n){return this.te(n),this.targetCount+=1,ee.resolve()},e.prototype.updateTargetData=function(t,n){return this.te(n),ee.resolve()},e.prototype.removeTargetData=function(t,n){return this.ds.delete(n.target),this._s.Zn(n.targetId),this.targetCount-=1,ee.resolve()},e.prototype.removeTargets=function(t,n,r){var o=this,s=0,u=[];return this.ds.forEach(function(c,f){f.sequenceNumber<=n&&r.get(f.targetId)===null&&(o.ds.delete(c),u.push(o.removeMatchingKeysForTargetId(t,f.targetId)),s++)}),ee.waitFor(u).next(function(){return s})},e.prototype.getTargetCount=function(t){return ee.resolve(this.targetCount)},e.prototype.getTargetData=function(t,n){var r=this.ds.get(n)||null;return ee.resolve(r)},e.prototype.addMatchingKeys=function(t,n,r){return this._s.Jn(n,r),ee.resolve()},e.prototype.removeMatchingKeys=function(t,n,r){this._s.Xn(n,r);var o=this.persistence.referenceDelegate,s=[];return o&&n.forEach(function(u){s.push(o.markPotentiallyOrphaned(t,u))}),ee.waitFor(s)},e.prototype.removeMatchingKeysForTargetId=function(t,n){return this._s.Zn(n),ee.resolve()},e.prototype.getMatchingKeysForTargetId=function(t,n){var r=this._s.es(n);return ee.resolve(r)},e.prototype.containsKey=function(t,n){return ee.resolve(this._s.containsKey(n))},e}(),y4=function(){function e(t,n){var r=this;this.gs={},this.Ne=new rr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new v4(this),this.Ut=new W$,this.Ue=function(o,s){return new m4(o,function(u){return r.referenceDelegate.ps(u)})}(this.Ut),this.R=new fC(n),this.Ke=new d4(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(t){var n=this.gs[t.toKey()];return n||(n=new p4(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=n),n},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(t,n,r){var o=this;ne("MemoryPersistence","Starting transaction:",t);var s=new w4(this.Ne.next());return this.referenceDelegate.Es(),r(s).next(function(u){return o.referenceDelegate.Ts(s).next(function(){return u})}).toPromise().then(function(u){return s.raiseOnCommittedEvent(),u})},e.prototype.Is=function(t,n){return ee.or(Object.values(this.gs).map(function(r){return function(){return r.containsKey(t,n)}}))},e}(),w4=function(e){function t(n){var r=this;return(r=e.call(this)||this).currentSequenceNumber=n,r}return be(t,e),t}(cC),x4=function(){function e(t){this.persistence=t,this.As=new ix,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw pe()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(t,n,r){return this.As.addReference(r,n),this.vs.delete(r.toString()),ee.resolve()},e.prototype.removeReference=function(t,n,r){return this.As.removeReference(r,n),this.vs.add(r.toString()),ee.resolve()},e.prototype.markPotentiallyOrphaned=function(t,n){return this.vs.add(n.toString()),ee.resolve()},e.prototype.removeTarget=function(t,n){var r=this;this.As.Zn(n.targetId).forEach(function(s){return r.vs.add(s.toString())});var o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(t,n.targetId).next(function(s){s.forEach(function(u){return r.vs.add(u.toString())})}).next(function(){return o.removeTargetData(t,n)})},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(t){var n=this,r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.vs,function(o){var s=me.fromPath(o);return n.Ps(t,s).next(function(u){u||r.removeEntry(s)})}).next(function(){return n.Rs=null,r.apply(t)})},e.prototype.updateLimboDocument=function(t,n){var r=this;return this.Ps(t,n).next(function(o){o?r.vs.delete(n.toString()):r.vs.add(n.toString())})},e.prototype.ps=function(t){return 0},e.prototype.Ps=function(t,n){var r=this;return ee.or([function(){return ee.resolve(r.As.containsKey(n))},function(){return r.persistence.getTargetCache().containsKey(t,n)},function(){return r.persistence.Is(t,n)}])},e}(),en=function(){function e(t){this.uid=t}return e.prototype.isAuthenticated=function(){return this.uid!=null},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(t){return t.uid===this.uid},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(e,t){return"firestore_clients_"+e+"_"+t}function dE(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function Yv(e,t){return"firestore_targets_"+e+"_"+t}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");var pE=function(){function e(t,n,r,o){this.user=t,this.batchId=n,this.state=r,this.error=o}return e.Vs=function(t,n,r){var o,s=JSON.parse(r),u=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return u&&s.error&&(u=typeof s.error.message=="string"&&typeof s.error.code=="string")&&(o=new Y(s.error.code,s.error.message)),u?new e(t,n,s.state,o):(Lt("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),Qv=function(){function e(t,n,r){this.targetId=t,this.state=n,this.error=r}return e.Vs=function(t,n){var r,o=JSON.parse(n),s=typeof o=="object"&&["not-current","current","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return s&&o.error&&(s=typeof o.error.message=="string"&&typeof o.error.code=="string")&&(r=new Y(o.error.code,o.error.message)),s?new e(t,o.state,r):(Lt("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),mE=function(){function e(t,n){this.clientId=t,this.activeTargetIds=n}return e.Vs=function(t,n){for(var r=JSON.parse(n),o=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Ip(),u=0;o&&u<r.activeTargetIds.length;++u)o=Ok(r.activeTargetIds[u]),s=s.add(r.activeTargetIds[u]);return o?new e(t,s):(Lt("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),b4=function(){function e(t,n){this.clientId=t,this.onlineState=n}return e.Vs=function(t){var n=JSON.parse(t);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new e(n.clientId,n.onlineState):(Lt("SharedClientState","Failed to parse online state: "+t),null)},e}(),p0=function(){function e(){this.activeTargetIds=Ip()}return e.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},e.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},e.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},e}(),Xv=function(){function e(t,n,r,o,s){this.window=t,this.Se=n,this.persistenceKey=r,this.Ns=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new xn(Pe),this.started=!1,this.$s=[];var u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Os=fE(this.persistenceKey,this.Ns),this.Ms=function(c){return"firestore_sequence_number_"+c}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new p0),this.Ls=new RegExp("^firestore_clients_"+u+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+u+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+u+"_(\\d+)$"),this.Us=function(c){return"firestore_online_state_"+c}(this.persistenceKey),this.Ks=function(c){return"firestore_bundle_loaded_"+c}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(t){return!(!t||!t.localStorage)},e.prototype.start=function(){return W(this,void 0,void 0,function(){var t,n,r,o,s,u,c,f,p,m,y,v=this;return H(this,function(w){switch(w.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=w.sent(),n=0,r=t;n<r.length;n++)(o=r[n])!==this.Ns&&(s=this.getItem(fE(this.persistenceKey,o)))&&(u=mE.Vs(o,s))&&(this.Fs=this.Fs.insert(u.clientId,u));for(this.Qs(),(c=this.storage.getItem(this.Us))&&(f=this.js(c))&&this.Ws(f),p=0,m=this.$s;p<m.length;p++)y=m[p],this.ks(y);return this.$s=[],this.window.addEventListener("pagehide",function(){return v.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},e.prototype.isActiveQueryTarget=function(t){var n=!1;return this.Fs.forEach(function(r,o){o.activeTargetIds.has(t)&&(n=!0)}),n},e.prototype.addPendingMutation=function(t){this.zs(t,"pending")},e.prototype.updateMutationState=function(t,n,r){this.zs(t,n,r),this.Hs(t)},e.prototype.addLocalQueryTarget=function(t){var n="not-current";if(this.isActiveQueryTarget(t)){var r=this.storage.getItem(Yv(this.persistenceKey,t));if(r){var o=Qv.Vs(t,r);o&&(n=o.state)}}return this.Js.Ds(t),this.Qs(),n},e.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},e.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},e.prototype.clearQueryState=function(t){this.removeItem(Yv(this.persistenceKey,t))},e.prototype.updateQueryState=function(t,n,r){this.Ys(t,n,r)},e.prototype.handleUserChange=function(t,n,r){var o=this;n.forEach(function(s){o.Hs(s)}),this.currentUser=t,r.forEach(function(s){o.addPendingMutation(s)})},e.prototype.setOnlineState=function(t){this.Xs(t)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},e.prototype.getItem=function(t){var n=this.storage.getItem(t);return ne("SharedClientState","READ",t,n),n},e.prototype.setItem=function(t,n){ne("SharedClientState","SET",t,n),this.storage.setItem(t,n)},e.prototype.removeItem=function(t){ne("SharedClientState","REMOVE",t),this.storage.removeItem(t)},e.prototype.ks=function(t){var n=this,r=t;if(r.storageArea===this.storage){if(ne("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Os)return void Lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return W(n,void 0,void 0,function(){var o,s,u,c,f,p;return H(this,function(m){if(this.started){if(r.key!==null){if(this.Ls.test(r.key)){if(r.newValue==null)return o=this.ti(r.key),[2,this.ei(o,null)];if(s=this.ni(r.key,r.newValue))return[2,this.ei(s.clientId,s)]}else if(this.Bs.test(r.key)){if(r.newValue!==null&&(u=this.si(r.key,r.newValue)))return[2,this.ii(u)]}else if(this.qs.test(r.key)){if(r.newValue!==null&&(c=this.ri(r.key,r.newValue)))return[2,this.oi(c)]}else if(r.key===this.Us){if(r.newValue!==null&&(f=this.js(r.newValue)))return[2,this.Ws(f)]}else if(r.key===this.Ms)(p=function(y){var v=rr.o;if(y!=null)try{var w=JSON.parse(y);_e(typeof w=="number"),v=w}catch(E){Lt("SharedClientState","Failed to read sequence number from WebStorage",E)}return v}(r.newValue))!==rr.o&&this.sequenceNumberHandler(p);else if(r.key===this.Ks)return[2,this.syncEngine.ci()]}}else this.$s.push(r);return[2]})})})}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},e.prototype.zs=function(t,n,r){var o=new pE(this.currentUser,t,n,r),s=dE(this.persistenceKey,this.currentUser,t);this.setItem(s,o.Ss())},e.prototype.Hs=function(t){var n=dE(this.persistenceKey,this.currentUser,t);this.removeItem(n)},e.prototype.Xs=function(t){var n={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(n))},e.prototype.Ys=function(t,n,r){var o=Yv(this.persistenceKey,t),s=new Qv(t,n,r);this.setItem(o,s.Ss())},e.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},e.prototype.ti=function(t){var n=this.Ls.exec(t);return n?n[1]:null},e.prototype.ni=function(t,n){var r=this.ti(t);return mE.Vs(r,n)},e.prototype.si=function(t,n){var r=this.Bs.exec(t),o=Number(r[1]),s=r[2]!==void 0?r[2]:null;return pE.Vs(new en(s),o,n)},e.prototype.ri=function(t,n){var r=this.qs.exec(t),o=Number(r[1]);return Qv.Vs(o,n)},e.prototype.js=function(t){return b4.Vs(t)},e.prototype.ii=function(t){return W(this,void 0,void 0,function(){return H(this,function(n){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(ne("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},e.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},e.prototype.ei=function(t,n){var r=this,o=n?this.Fs.insert(t,n):this.Fs.remove(t),s=this.Gs(this.Fs),u=this.Gs(o),c=[],f=[];return u.forEach(function(p){s.has(p)||c.push(p)}),s.forEach(function(p){u.has(p)||f.push(p)}),this.syncEngine.hi(c,f).then(function(){r.Fs=o})},e.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},e.prototype.Gs=function(t){var n=Ip();return t.forEach(function(r,o){n=n.unionWith(o.activeTargetIds)}),n},e}(),TC=function(){function e(){this.li=new p0,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(t){},e.prototype.updateMutationState=function(t,n,r){},e.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},e.prototype.updateQueryState=function(t,n,r){this.fi[t]=n},e.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},e.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},e.prototype.clearQueryState=function(t){delete this.fi[t]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},e.prototype.start=function(){return this.li=new p0,Promise.resolve()},e.prototype.handleUserChange=function(t,n,r){},e.prototype.setOnlineState=function(t){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(t){},e.prototype.notifyBundleLoaded=function(){},e}(),S4=function(){function e(){}return e.prototype.di=function(t){},e.prototype.shutdown=function(){},e}(),gE=function(){function e(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return e.prototype.di=function(t){this.gi.push(t)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,n=this.gi;t<n.length;t++)(0,n[t])(0)},e.prototype.yi=function(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,n=this.gi;t<n.length;t++)(0,n[t])(1)},e.yt=function(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0},e}(),_4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},N4=function(){function e(t){this.Ei=t.Ei,this.Ti=t.Ti}return e.prototype.Ii=function(t){this.Ai=t},e.prototype.Ri=function(t){this.bi=t},e.prototype.onMessage=function(t){this.vi=t},e.prototype.close=function(){this.Ti()},e.prototype.send=function(t){this.Ei(t)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(t){this.bi(t)},e.prototype.Si=function(t){this.vi(t)},e}(),E4=function(e){function t(n){var r=this;return(r=e.call(this,n)||this).forceLongPolling=n.forceLongPolling,r.autoDetectLongPolling=n.autoDetectLongPolling,r.useFetchStreams=n.useFetchStreams,r}return be(t,e),t.prototype.Fi=function(n,r,o,s){return new Promise(function(u,c){var f=new t$;f.listenOnce(JF.COMPLETE,function(){try{switch(f.getLastErrorCode()){case Gv.NO_ERROR:var m=f.getResponseJson();ne("Connection","XHR received:",JSON.stringify(m)),u(m);break;case Gv.TIMEOUT:ne("Connection",'RPC "'+n+'" timed out'),c(new Y(F.DEADLINE_EXCEEDED,"Request time out"));break;case Gv.HTTP_ERROR:var y=f.getStatus();if(ne("Connection",'RPC "'+n+'" failed with status:',y,"response text:",f.getResponseText()),y>0){var v=f.getResponseJson().error;if(v&&v.status&&v.message){var w=function(E){var _=E.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(_)>=0?_:F.UNKNOWN}(v.status);c(new Y(w,v.message))}else c(new Y(F.UNKNOWN,"Server responded with status "+f.getStatus()))}else c(new Y(F.UNAVAILABLE,"Connection failed."));break;default:pe()}}finally{ne("Connection",'RPC "'+n+'" completed.')}});var p=JSON.stringify(s);f.send(r,"POST",p,o,15)})},t.prototype.Oi=function(n,r){var o=[this.Di,"/","google.firestore.v1.Firestore","/",n,"/channel"],s=QF(),u=XF(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new e$({})),this.ki(c.initMessageHeaders,r),iU()||aU()||uU()||lU()||cU()||sU()||(c.httpHeadersOverwriteParam="$httpHeaders");var f=o.join("");ne("Connection","Creating WebChannel: "+f,c);var p=s.createWebChannel(f,c),m=!1,y=!1,v=new N4({Ei:function(E){y?ne("Connection","Not sending because WebChannel is closed:",E):(m||(ne("Connection","Opening WebChannel transport."),p.open(),m=!0),ne("Connection","WebChannel sending:",E),p.send(E))},Ti:function(){return p.close()}}),w=function(E,_,C){E.listen(_,function(b){try{C(b)}catch(N){setTimeout(function(){throw N},0)}})};return w(p,yf.EventType.OPEN,function(){y||ne("Connection","WebChannel transport opened.")}),w(p,yf.EventType.CLOSE,function(){y||(y=!0,ne("Connection","WebChannel transport closed"),v.Vi())}),w(p,yf.EventType.ERROR,function(E){y||(y=!0,Td("Connection","WebChannel transport errored:",E),v.Vi(new Y(F.UNAVAILABLE,"The operation could not be completed")))}),w(p,yf.EventType.MESSAGE,function(E){var _;if(!y){var C=E.data[0];_e(!!C);var b=C,N=b.error||((_=b[0])===null||_===void 0?void 0:_.error);if(N){ne("Connection","WebChannel received error:",N);var x=N.status,j=function(A){var T=Mt[A];if(T!==void 0)return Xk(T)}(x),k=N.message;j===void 0&&(j=F.INTERNAL,k="Unknown error status: "+x+" with message "+N.message),y=!0,v.Vi(new Y(j,k)),p.close()}else ne("Connection","WebChannel received:",C),v.Si(C)}}),w(u,ZF.STAT_EVENT,function(E){E.stat===MN.PROXY?ne("Connection","Detected buffering proxy"):E.stat===MN.NOPROXY&&ne("Connection","Detected no buffering proxy")}),setTimeout(function(){v.Pi()},0),v},t}(function(){function e(t){this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.Di=n+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(t,n,r,o){var s=this.xi(t,n);ne("RestConnection","Sending: ",s,r);var u={};return this.ki(u,o),this.Fi(t,s,u,r).then(function(c){return ne("RestConnection","Received: ",c),c},function(c){throw Td("RestConnection",t+" failed with error: ",c,"url: ",s,"request:",r),c})},e.prototype.$i=function(t,n,r,o){return this.Ni(t,n,r,o)},e.prototype.ki=function(t,n){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n)for(var r in n.authHeaders)n.authHeaders.hasOwnProperty(r)&&(t[r]=n.authHeaders[r])},e.prototype.xi=function(t,n){var r=_4[t];return this.Di+"/v1/"+n+":"+r},e}());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(){return typeof window<"u"?window:null}function qf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(e){return new A$(e,!0)}var ox=function(){function e(t,n,r,o,s){r===void 0&&(r=1e3),o===void 0&&(o=1.5),s===void 0&&(s=6e4),this.Se=t,this.timerId=n,this.Mi=r,this.Li=o,this.Bi=s,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Qi=function(){this.qi=this.Bi},e.prototype.ji=function(t){var n=this;this.cancel();var r=Math.floor(this.qi+this.Wi()),o=Math.max(0,Date.now()-this.Ki),s=Math.max(0,r-o);s>0&&ne("ExponentialBackoff","Backing off for "+s+" ms (base delay: "+this.qi+" ms, delay with jitter: "+r+" ms, last attempt: "+o+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,s,function(){return n.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){this.Ui!==null&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){this.Ui!==null&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),kC=function(){function e(t,n,r,o,s,u){this.Se=t,this.zi=r,this.Hi=o,this.Ji=s,this.listener=u,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new ox(t,n)}return e.prototype.tr=function(){return this.state===1||this.state===2||this.state===4},e.prototype.er=function(){return this.state===2},e.prototype.start=function(){this.state!==3?this.auth():this.nr()},e.prototype.stop=function(){return W(this,void 0,void 0,function(){return H(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var t=this;this.er()&&this.Xi===null&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},e.prototype.cr=function(t){this.ur(),this.stream.send(t)},e.prototype.rr=function(){return W(this,void 0,void 0,function(){return H(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(t,n){return W(this,void 0,void 0,function(){return H(this,function(r){switch(r.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,t!==3?this.Zi.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Lt(n.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):n&&n.code===F.UNAUTHENTICATED&&this.Ji.invalidateToken(),this.stream!==null&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(n)];case 1:return r.sent(),[2]}})})},e.prototype.ar=function(){},e.prototype.auth=function(){var t=this;this.state=1;var n=this.hr(this.Yi),r=this.Yi;this.Ji.getToken().then(function(o){t.Yi===r&&t.lr(o)},function(o){n(function(){var s=new Y(F.UNKNOWN,"Fetching auth token failed: "+o.message);return t.dr(s)})})},e.prototype.lr=function(t){var n=this,r=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){r(function(){return n.state=2,n.listener.Ii()})}),this.stream.Ri(function(o){r(function(){return n.dr(o)})}),this.stream.onMessage(function(o){r(function(){return n.onMessage(o)})})},e.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return W(t,void 0,void 0,function(){return H(this,function(n){return this.state=0,this.start(),[2]})})})},e.prototype.dr=function(t){return ne("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},e.prototype.hr=function(t){var n=this;return function(r){n.Se.enqueueAndForget(function(){return n.Yi===t?r():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),I4=function(e){function t(n,r,o,s,u){var c=this;return(c=e.call(this,n,"listen_stream_connection_backoff","listen_stream_idle",r,o,u)||this).R=s,c}return be(t,e),t.prototype.wr=function(n){return this.Hi.Oi("Listen",n)},t.prototype.onMessage=function(n){this.Zi.reset();var r=function(s,u){var c;if("targetChange"in u){u.targetChange;var f=function(C){return C==="NO_CHANGE"?0:C==="ADD"?1:C==="REMOVE"?2:C==="CURRENT"?3:C==="RESET"?4:pe()}(u.targetChange.targetChangeType||"NO_CHANGE"),p=u.targetChange.targetIds||[],m=function(C,b){return C.I?(_e(b===void 0||typeof b=="string"),qn.fromBase64String(b||"")):(_e(b===void 0||b instanceof Uint8Array),qn.fromUint8Array(b||new Uint8Array))}(s,u.targetChange.resumeToken),y=(v=u.targetChange.cause)&&function(C){var b=C.code===void 0?F.UNKNOWN:Xk(C.code);return new Y(b,C.message||"")}(v);c=new Zk(f,p,m,y||null)}else if("documentChange"in u){u.documentChange,(f=u.documentChange).document,f.document.name,f.document.updateTime,p=Ei(s,f.document.name),m=jn(f.document.updateTime);var v=new er({mapValue:{fields:f.document.fields}}),w=(y=wn.newFoundDocument(p,m,v),f.targetIds||[]),E=f.removedTargetIds||[];c=new zf(w,E,y.key,y)}else if("documentDelete"in u)u.documentDelete,(f=u.documentDelete).document,p=Ei(s,f.document),m=f.readTime?jn(f.readTime):Ae.min(),v=wn.newNoDocument(p,m),y=f.removedTargetIds||[],c=new zf([],y,v.key,v);else if("documentRemove"in u)u.documentRemove,(f=u.documentRemove).document,p=Ei(s,f.document),m=f.removedTargetIds||[],c=new zf([],m,p,null);else{if(!("filter"in u))return pe();u.filter;var _=u.filter;_.targetId,f=_.count||0,p=new b$(f),m=_.targetId,c=new Jk(m,p)}return c}(this.R,n),o=function(s){if(!("targetChange"in s))return Ae.min();var u=s.targetChange;return u.targetIds&&u.targetIds.length?Ae.min():u.readTime?jn(u.readTime):Ae.min()}(n);return this.listener._r(r,o)},t.prototype.mr=function(n){var r={};r.database=yc(this.R),r.addTarget=function(s,u){var c,f=u.target;return(c=Cd(f)?{documents:iC(s,f)}:{query:oC(s,f)}).targetId=u.targetId,u.resumeToken.approximateByteSize()>0?c.resumeToken=eC(s,u.resumeToken):u.snapshotVersion.compareTo(Ae.min())>0&&(c.readTime=gc(s,u.snapshotVersion.toTimestamp())),c}(this.R,n);var o=function(s,u){var c=function(f,p){switch(p){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return pe()}}(0,u.purpose);return c==null?null:{"goog-listen-tags":c}}(this.R,n);o&&(r.labels=o),this.cr(r)},t.prototype.yr=function(n){var r={};r.database=yc(this.R),r.removeTarget=n,this.cr(r)},t}(kC),T4=function(e){function t(n,r,o,s,u){var c=this;return(c=e.call(this,n,"write_stream_connection_backoff","write_stream_idle",r,o,u)||this).R=s,c.gr=!1,c}return be(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(n){return this.Hi.Oi("Write",n)},t.prototype.onMessage=function(n){if(_e(!!n.streamToken),this.lastStreamToken=n.streamToken,this.gr){this.Zi.reset();var r=function(s,u){return s&&s.length>0?(_e(u!==void 0),s.map(function(c){return function(f,p){var m=f.updateTime?jn(f.updateTime):jn(p);return m.isEqual(Ae.min())&&(m=jn(p)),new y$(m,f.transformResults||[])}(c,u)})):[]}(n.writeResults,n.commitTime),o=jn(n.commitTime);return this.listener.Tr(o,r)}return _e(!n.writeResults||n.writeResults.length===0),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var n={};n.database=yc(this.R),this.cr(n)},t.prototype.Er=function(n){var r=this,o={streamToken:this.lastStreamToken,writes:n.map(function(s){return Md(r.R,s)})};this.cr(o)},t}(kC),j4=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).credentials=n,s.Hi=r,s.R=o,s.Rr=!1,s}return be(t,e),t.prototype.br=function(){if(this.Rr)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(n,r,o){var s=this;return this.br(),this.credentials.getToken().then(function(u){return s.Hi.Ni(n,r,o,u)}).catch(function(u){throw u.name==="FirebaseError"?(u.code===F.UNAUTHENTICATED&&s.credentials.invalidateToken(),u):new Y(F.UNKNOWN,u.toString())})},t.prototype.$i=function(n,r,o){var s=this;return this.br(),this.credentials.getToken().then(function(u){return s.Hi.$i(n,r,o,u)}).catch(function(u){throw u.name==="FirebaseError"?(u.code===F.UNAUTHENTICATED&&s.credentials.invalidateToken(),u):new Y(F.UNKNOWN,u.toString())})},t.prototype.terminate=function(){this.Rr=!0},t}(function(){}),k4=function(){function e(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var t=this;this.vr===0&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},e.prototype.Nr=function(t){this.state==="Online"?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},e.prototype.set=function(t){this.kr(),this.vr=0,t==="Online"&&(this.Vr=!1),this.Dr(t)},e.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},e.prototype.Cr=function(t){var n="Could not reach Cloud Firestore backend. "+t+`
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(Lt(n),this.Vr=!1):ne("OnlineStateTracker",n)},e.prototype.kr=function(){this.Pr!==null&&(this.Pr.cancel(),this.Pr=null)},e}(),C4=function(e,t,n,r,o){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=o,this.Lr.di(function(u){n.enqueueAndForget(function(){return W(s,void 0,void 0,function(){return H(this,function(c){switch(c.label){case 0:return Co(this)?(ne("RemoteStore","Restarting streams for network reachability change."),[4,function(f){return W(this,void 0,void 0,function(){var p;return H(this,function(m){switch(m.label){case 0:return(p=ue(f)).Or.add(4),[4,Su(p)];case 1:return m.sent(),p.Br.set("Unknown"),p.Or.delete(4),[4,Hc(p)];case 2:return m.sent(),[2]}})})}(this)]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})})}),this.Br=new k4(n,r)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(e){return W(this,void 0,void 0,function(){var t,n;return H(this,function(r){switch(r.label){case 0:if(!Co(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function Su(e){return W(this,void 0,void 0,function(){var t,n;return H(this,function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function kp(e,t){var n=ue(e);n.$r.has(t.targetId)||(n.$r.set(t.targetId,t),ux(n)?ax(n):Nu(n).er()&&sx(n,t))}function wc(e,t){var n=ue(e),r=Nu(n);n.$r.delete(t),r.er()&&CC(n,t),n.$r.size===0&&(r.er()?r.ir():Co(n)&&n.Br.set("Unknown"))}function sx(e,t){e.qr.U(t.targetId),Nu(e).mr(t)}function CC(e,t){e.qr.U(t),Nu(e).yr(t)}function ax(e){e.qr=new j$({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),Nu(e).start(),e.Br.Sr()}function ux(e){return Co(e)&&!Nu(e).tr()&&e.$r.size>0}function Co(e){return ue(e).Or.size===0}function AC(e){e.qr=void 0}function A4(e){return W(this,void 0,void 0,function(){return H(this,function(t){return e.$r.forEach(function(n,r){sx(e,n)}),[2]})})}function D4(e,t){return W(this,void 0,void 0,function(){return H(this,function(n){return AC(e),ux(e)?(e.Br.Nr(t),ax(e)):e.Br.set("Unknown"),[2]})})}function M4(e,t,n){return W(this,void 0,void 0,function(){var r,o,s;return H(this,function(u){switch(u.label){case 0:if(e.Br.set("Online"),!(t instanceof Zk&&t.state===2&&t.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(c,f){return W(this,void 0,void 0,function(){var p,m,y,v;return H(this,function(w){switch(w.label){case 0:p=f.cause,m=0,y=f.targetIds,w.label=1;case 1:return m<y.length?(v=y[m],c.$r.has(v)?[4,c.remoteSyncer.rejectListen(v,p)]:[3,3]):[3,5];case 2:w.sent(),c.$r.delete(v),c.qr.removeTarget(v),w.label=3;case 3:w.label=4;case 4:return m++,[3,1];case 5:return[2]}})})}(e,t)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),ne("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,Ud(e,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof zf?e.qr.X(t):t instanceof Jk?e.qr.rt(t):e.qr.et(t),n.isEqual(Ae.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,NC(e.localStore)];case 8:return o=u.sent(),n.compareTo(o)>=0?[4,function(c,f){var p=c.qr.ut(f);return p.targetChanges.forEach(function(m,y){if(m.resumeToken.approximateByteSize()>0){var v=c.$r.get(y);v&&c.$r.set(y,v.withResumeToken(m.resumeToken,f))}}),p.targetMismatches.forEach(function(m){var y=c.$r.get(m);if(y){c.$r.set(m,y.withResumeToken(qn.EMPTY_BYTE_STRING,y.snapshotVersion)),CC(c,m);var v=new Tp(y.target,m,1,y.sequenceNumber);sx(c,v)}}),c.remoteSyncer.applyRemoteEvent(p)}(e,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return ne("RemoteStore","Failed to raise snapshot:",s=u.sent()),[4,Ud(e,s)];case 12:return u.sent(),[3,13];case 13:return[2]}})})}function Ud(e,t,n){return W(this,void 0,void 0,function(){var r=this;return H(this,function(o){switch(o.label){case 0:if(!Ls(t))throw t;return e.Or.add(1),[4,Su(e)];case 1:return o.sent(),e.Br.set("Offline"),n||(n=function(){return NC(e.localStore)}),e.asyncQueue.enqueueRetryable(function(){return W(r,void 0,void 0,function(){return H(this,function(s){switch(s.label){case 0:return ne("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return s.sent(),e.Or.delete(1),[4,Hc(e)];case 2:return s.sent(),[2]}})})}),[2]}})})}function DC(e,t){return t().catch(function(n){return Ud(e,n,t)})}function _u(e){return W(this,void 0,void 0,function(){var t,n,r,o,s;return H(this,function(u){switch(u.label){case 0:t=ue(e),n=_o(t),r=t.Fr.length>0?t.Fr[t.Fr.length-1].batchId:-1,u.label=1;case 1:if(!function(c){return Co(c)&&c.Fr.length<10}(t))return[3,7];u.label=2;case 2:return u.trys.push([2,4,,6]),[4,h4(t.localStore,r)];case 3:return(o=u.sent())===null?(t.Fr.length===0&&n.ir(),[3,7]):(r=o.batchId,function(c,f){c.Fr.push(f);var p=_o(c);p.er()&&p.pr&&p.Er(f.mutations)}(t,o),[3,6]);case 4:return s=u.sent(),[4,Ud(t,s)];case 5:return u.sent(),[3,6];case 6:return[3,1];case 7:return MC(t)&&RC(t),[2]}})})}function MC(e){return Co(e)&&!_o(e).tr()&&e.Fr.length>0}function RC(e){_o(e).start()}function R4(e){return W(this,void 0,void 0,function(){return H(this,function(t){return _o(e).Ar(),[2]})})}function O4(e){return W(this,void 0,void 0,function(){var t,n,r,o;return H(this,function(s){for(t=_o(e),n=0,r=e.Fr;n<r.length;n++)o=r[n],t.Er(o.mutations);return[2]})})}function L4(e,t,n){return W(this,void 0,void 0,function(){var r,o;return H(this,function(s){switch(s.label){case 0:return r=e.Fr.shift(),o=H$.from(r,t,n),[4,DC(e,function(){return e.remoteSyncer.applySuccessfulWrite(o)})];case 1:return s.sent(),[4,_u(e)];case 2:return s.sent(),[2]}})})}function P4(e,t){return W(this,void 0,void 0,function(){return H(this,function(n){switch(n.label){case 0:return t&&_o(e).pr?[4,function(r,o){return W(this,void 0,void 0,function(){var s,u;return H(this,function(c){switch(c.label){case 0:return Qk(u=o.code)&&u!==F.ABORTED?(s=r.Fr.shift(),_o(r).sr(),[4,DC(r,function(){return r.remoteSyncer.rejectFailedWrite(s.batchId,o)})]):[3,3];case 1:return c.sent(),[4,_u(r)];case 2:c.sent(),c.label=3;case 3:return[2]}})})}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return MC(e)&&RC(e),[2]}})})}function m0(e,t){return W(this,void 0,void 0,function(){var n;return H(this,function(r){switch(r.label){case 0:return n=ue(e),t?(n.Or.delete(2),[4,Hc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Or.add(2),[4,Su(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Nu(e){var t=this;return e.Ur||(e.Ur=function(n,r,o){var s=ue(n);return s.br(),new I4(r,s.Hi,s.credentials,s.R,o)}(e.datastore,e.asyncQueue,{Ii:A4.bind(null,e),Ri:D4.bind(null,e),_r:M4.bind(null,e)}),e.Mr.push(function(n){return W(t,void 0,void 0,function(){return H(this,function(r){switch(r.label){case 0:return n?(e.Ur.sr(),ux(e)?ax(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:r.sent(),AC(e),r.label=3;case 3:return[2]}})})})),e.Ur}function _o(e){var t=this;return e.Kr||(e.Kr=function(n,r,o){var s=ue(n);return s.br(),new T4(r,s.Hi,s.credentials,s.R,o)}(e.datastore,e.asyncQueue,{Ii:R4.bind(null,e),Ri:P4.bind(null,e),Ir:O4.bind(null,e),Tr:L4.bind(null,e)}),e.Mr.push(function(n){return W(t,void 0,void 0,function(){return H(this,function(r){switch(r.label){case 0:return n?(e.Kr.sr(),[4,_u(e)]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.Kr.stop()];case 3:r.sent(),e.Fr.length>0&&(ne("RemoteStore","Stopping write stream with "+e.Fr.length+" pending writes"),e.Fr=[]),r.label=4;case 4:return[2]}})})})),e.Kr}var U4=function(){function e(t,n,r,o,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=o,this.removalCallback=s,this.deferred=new Kn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(u){})}return e.createAndSchedule=function(t,n,r,o,s){var u=new e(t,n,Date.now()+r,o,s);return u.start(r),u},e.prototype.start=function(t){var n=this;this.timerHandle=setTimeout(function(){return n.handleDelayElapsed()},t)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(F.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},e.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return t.timerHandle!==null?(t.clearTimeout(),t.op().then(function(n){return t.deferred.resolve(n)})):Promise.resolve()})},e.prototype.clearTimeout=function(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function Eu(e,t){if(Lt("AsyncQueue",t+": "+e),Ls(e))return new Y(F.UNAVAILABLE,t+": "+e);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OC=function(){function e(t){this.comparator=t?function(n,r){return t(n,r)||me.comparator(n.key,r.key)}:function(n,r){return me.comparator(n.key,r.key)},this.keyedMap=h0(),this.sortedSet=new xn(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(t){return this.keyedMap.get(t)!=null},e.prototype.get=function(t){return this.keyedMap.get(t)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(t){var n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(n,r){return t(n),!1})},e.prototype.add=function(t){var n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))},e.prototype.delete=function(t){var n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var o=n.getNext().key,s=r.getNext().key;if(!o.isEqual(s))return!1}return!0},e.prototype.toString=function(){var t=[];return this.forEach(function(n){t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),vE=function(){function e(){this.Qr=new xn(me.comparator)}return e.prototype.track=function(t){var n=t.doc.key,r=this.Qr.get(n);r?t.type!==0&&r.type===3?this.Qr=this.Qr.insert(n,t):t.type===3&&r.type!==1?this.Qr=this.Qr.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.Qr=this.Qr.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.Qr=this.Qr.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.Qr=this.Qr.remove(n):t.type===1&&r.type===2?this.Qr=this.Qr.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.Qr=this.Qr.insert(n,{type:2,doc:t.doc}):pe():this.Qr=this.Qr.insert(n,t)},e.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(n,r){t.push(r)}),t},e}(),Fd=function(){function e(t,n,r,o,s,u,c,f){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=s,this.fromCache=u,this.syncStateChanged=c,this.excludesMetadataChanges=f}return e.fromInitialDocuments=function(t,n,r,o){var s=[];return n.forEach(function(u){s.push({type:0,doc:u})}),new e(t,n,OC.emptySet(n),s,r,o,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Vc(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(n[o].type!==r[o].type||!n[o].doc.isEqual(r[o].doc))return!1;return!0},e}(),F4=function(){this.Wr=void 0,this.listeners=[]},$4=function(){this.queries=new bu(function(e){return $k(e)},Vc),this.onlineState="Unknown",this.Gr=new Set};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(e,t){return W(this,void 0,void 0,function(){var n,r,o,s,u,c,f;return H(this,function(p){switch(p.label){case 0:if(n=ue(e),r=t.query,o=!1,(s=n.queries.get(r))||(o=!0,s=new F4),!o)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),u=s,[4,n.onListen(r)];case 2:return u.Wr=p.sent(),[3,4];case 3:return c=p.sent(),f=Eu(c,"Initialization of query '"+l0(t.query)+"' failed"),[2,void t.onError(f)];case 4:return n.queries.set(r,s),s.listeners.push(t),t.zr(n.onlineState),s.Wr&&t.Hr(s.Wr)&&hx(n),[2]}})})}function cx(e,t){return W(this,void 0,void 0,function(){var n,r,o,s,u;return H(this,function(c){return n=ue(e),r=t.query,o=!1,(s=n.queries.get(r))&&(u=s.listeners.indexOf(t))>=0&&(s.listeners.splice(u,1),o=s.listeners.length===0),o?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function V4(e,t){for(var n=ue(e),r=!1,o=0,s=t;o<s.length;o++){var u=s[o],c=u.query,f=n.queries.get(c);if(f){for(var p=0,m=f.listeners;p<m.length;p++)m[p].Hr(u)&&(r=!0);f.Wr=u}}r&&hx(n)}function B4(e,t,n){var r=ue(e),o=r.queries.get(t);if(o)for(var s=0,u=o.listeners;s<u.length;s++)u[s].onError(n);r.queries.delete(t)}function hx(e){e.Gr.forEach(function(t){t.next()})}var fx=function(){function e(t,n,r){this.query=t,this.Jr=n,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=r||{}}return e.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var n=[],r=0,o=t.docChanges;r<o.length;r++){var s=o[r];s.type!==3&&n.push(s)}t=new Fd(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var u=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),u=!0):this.eo(t,this.onlineState)&&(this.no(t),u=!0),this.Xr=t,u},e.prototype.onError=function(t){this.Jr.error(t)},e.prototype.zr=function(t){this.onlineState=t;var n=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),n=!0),n},e.prototype.eo=function(t,n){if(!t.fromCache)return!0;var r=n!=="Offline";return!(this.options.so&&r||t.docs.isEmpty()&&n!=="Offline")},e.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var n=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0},e.prototype.no=function(t){t=Fd.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LC=function(e){this.key=e},PC=function(e){this.key=e},UC=function(){function e(t,n){this.query=t,this.uo=n,this.ao=null,this.current=!1,this.ho=nt(),this.mutatedKeys=nt(),this.lo=Vk(t),this.fo=new OC(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(t,n){var r=this,o=n?n.mo:new vE,s=n?n.fo:this.fo,u=n?n.mutatedKeys:this.mutatedKeys,c=s,f=!1,p=Vf(this.query)&&s.size===this.query.limit?s.last():null,m=Dd(this.query)&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(function(v,w){var E=s.get(v),_=Bc(r.query,w)?w:null,C=!!E&&r.mutatedKeys.has(E.key),b=!!_&&(_.hasLocalMutations||r.mutatedKeys.has(_.key)&&_.hasCommittedMutations),N=!1;E&&_?E.data.isEqual(_.data)?C!==b&&(o.track({type:3,doc:_}),N=!0):r.yo(E,_)||(o.track({type:2,doc:_}),N=!0,(p&&r.lo(_,p)>0||m&&r.lo(_,m)<0)&&(f=!0)):!E&&_?(o.track({type:0,doc:_}),N=!0):E&&!_&&(o.track({type:1,doc:E}),N=!0,(p||m)&&(f=!0)),N&&(_?(c=c.add(_),u=b?u.add(v):u.delete(v)):(c=c.delete(v),u=u.delete(v)))}),Vf(this.query)||Dd(this.query))for(;c.size>this.query.limit;){var y=Vf(this.query)?c.last():c.first();c=c.delete(y.key),u=u.delete(y.key),o.track({type:1,doc:y})}return{fo:c,mo:o,Nn:f,mutatedKeys:u}},e.prototype.yo=function(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations},e.prototype.applyChanges=function(t,n,r){var o=this,s=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var u=t.mo.jr();u.sort(function(m,y){return function(v,w){var E=function(_){switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe()}};return E(v)-E(w)}(m.type,y.type)||o.lo(m.doc,y.doc)}),this.po(r);var c=n?this.Eo():[],f=this.ho.size===0&&this.current?1:0,p=f!==this.ao;return this.ao=f,u.length!==0||p?{snapshot:new Fd(this.query,t.fo,s,u,t.mutatedKeys,f===0,p,!1),To:c}:{To:c}},e.prototype.zr=function(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({fo:this.fo,mo:new vE,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},e.prototype.po=function(t){var n=this;t&&(t.addedDocuments.forEach(function(r){return n.uo=n.uo.add(r)}),t.modifiedDocuments.forEach(function(r){}),t.removedDocuments.forEach(function(r){return n.uo=n.uo.delete(r)}),this.current=t.current)},e.prototype.Eo=function(){var t=this;if(!this.current)return[];var n=this.ho;this.ho=nt(),this.fo.forEach(function(o){t.Io(o.key)&&(t.ho=t.ho.add(o.key))});var r=[];return n.forEach(function(o){t.ho.has(o)||r.push(new PC(o))}),this.ho.forEach(function(o){n.has(o)||r.push(new LC(o))}),r},e.prototype.Ao=function(t){this.uo=t.Bn,this.ho=nt();var n=this._o(t.documents);return this.applyChanges(n,!0)},e.prototype.Ro=function(){return Fd.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,this.ao===0)},e}(),z4=function(e,t,n){this.query=e,this.targetId=t,this.view=n},q4=function(e){this.key=e,this.bo=!1},K4=function(){function e(t,n,r,o,s,u){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=u,this.vo={},this.Po=new bu(function(c){return $k(c)},Vc),this.Vo=new Map,this.So=new Set,this.Do=new xn(me.comparator),this.Co=new Map,this.No=new ix,this.xo={},this.ko=new Map,this.Fo=Od.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return this.$o===!0},enumerable:!1,configurable:!0}),e}();function H4(e,t){return W(this,void 0,void 0,function(){var n,r,o,s,u,c;return H(this,function(f){switch(f.label){case 0:return n=vx(e),(s=n.Po.get(t))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),o=s.view.Ro(),[3,4]):[3,1];case 1:return[4,Ld(n.localStore,ci(t))];case 2:return u=f.sent(),c=n.sharedClientState.addLocalQueryTarget(u.targetId),r=u.targetId,[4,dx(n,t,r,c==="current")];case 3:o=f.sent(),n.isPrimaryClient&&kp(n.remoteStore,u),f.label=4;case 4:return[2,o]}})})}function dx(e,t,n,r){return W(this,void 0,void 0,function(){var o,s,u,c,f,p;return H(this,function(m){switch(m.label){case 0:return e.Oo=function(y,v,w){return function(E,_,C,b){return W(this,void 0,void 0,function(){var N,x,j;return H(this,function(k){switch(k.label){case 0:return N=_.view._o(C),N.Nn?[4,Pd(E.localStore,_.query,!1).then(function(A){var T=A.documents;return _.view._o(T,N)})]:[3,2];case 1:N=k.sent(),k.label=2;case 2:return x=b&&b.targetChanges.get(_.targetId),j=_.view.applyChanges(N,E.isPrimaryClient,x),[2,(g0(E,_.targetId,j.To),j.snapshot)]}})})}(e,y,v,w)},[4,Pd(e.localStore,t,!0)];case 1:return o=m.sent(),s=new UC(t,o.Bn),u=s._o(o.documents),c=Xw.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline"),f=s.applyChanges(u,e.isPrimaryClient,c),g0(e,n,f.To),p=new z4(t,n,s),[2,(e.Po.set(t,p),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),f.snapshot)]}})})}function G4(e,t){return W(this,void 0,void 0,function(){var n,r,o;return H(this,function(s){switch(s.label){case 0:return n=ue(e),r=n.Po.get(t),(o=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,o.filter(function(u){return!Vc(u,t)})),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,cu(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),wc(n.remoteStore,r.targetId),hu(n,r.targetId)}).catch(Ps)]):[3,3];case 1:s.sent(),s.label=2;case 2:return[3,5];case 3:return hu(n,r.targetId),[4,cu(n.localStore,r.targetId,!0)];case 4:s.sent(),s.label=5;case 5:return[2]}})})}function W4(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u;return H(this,function(c){switch(c.label){case 0:r=yx(e),c.label=1;case 1:return c.trys.push([1,5,,6]),[4,function(f,p){var m,y=ue(f),v=zn.now(),w=p.reduce(function(E,_){return E.add(_.key)},nt());return y.persistence.runTransaction("Locally write mutations","readwrite",function(E){return y.Mn.pn(E,w).next(function(_){m=_;for(var C=[],b=0,N=p;b<N.length;b++){var x=N[b],j=x$(x,m.get(x.key));j!=null&&C.push(new ko(x.key,j,Lk(j.value.mapValue),gn.exists(!0)))}return y._n.addMutationBatch(E,v,C,p)})}).then(function(E){return E.applyToLocalDocumentSet(m),{batchId:E.batchId,changes:m}})}(r.localStore,t)];case 2:return o=c.sent(),r.sharedClientState.addPendingMutation(o.batchId),function(f,p,m){var y=f.xo[f.currentUser.toKey()];y||(y=new xn(Pe)),y=y.insert(p,m),f.xo[f.currentUser.toKey()]=y}(r,o.batchId,n),[4,Ao(r,o.changes)];case 3:return c.sent(),[4,_u(r.remoteStore)];case 4:return c.sent(),[3,6];case 5:return s=c.sent(),u=Eu(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}})})}function FC(e,t){return W(this,void 0,void 0,function(){var n,r;return H(this,function(o){switch(o.label){case 0:n=ue(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,l4(n.localStore,t)];case 2:return r=o.sent(),t.targetChanges.forEach(function(s,u){var c=n.Co.get(u);c&&(_e(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?c.bo=!0:s.modifiedDocuments.size>0?_e(c.bo):s.removedDocuments.size>0&&(_e(c.bo),c.bo=!1))}),[4,Ao(n,r,t)];case 3:return o.sent(),[3,6];case 4:return[4,Ps(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function yE(e,t,n){var r=ue(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){var o=[];r.Po.forEach(function(s,u){var c=u.view.zr(t);c.snapshot&&o.push(c.snapshot)}),function(s,u){var c=ue(s);c.onlineState=u;var f=!1;c.queries.forEach(function(p,m){for(var y=0,v=m.listeners;y<v.length;y++)v[y].zr(u)&&(f=!0)}),f&&hx(c)}(r.eventManager,t),o.length&&r.vo._r(o),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Y4(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u,c,f;return H(this,function(p){switch(p.label){case 0:return(r=ue(e)).sharedClientState.updateQueryState(t,"rejected",n),o=r.Co.get(t),(s=o&&o.key)?(u=(u=new xn(me.comparator)).insert(s,wn.newNoDocument(s,Ae.min())),c=nt().add(s),f=new Qw(Ae.min(),new Map,new zt(Pe),u,c),[4,FC(r,f)]):[3,2];case 1:return p.sent(),r.Do=r.Do.remove(s),r.Co.delete(t),gx(r),[3,4];case 2:return[4,cu(r.localStore,t,!1).then(function(){return hu(r,t,n)}).catch(Ps)];case 3:p.sent(),p.label=4;case 4:return[2]}})})}function Q4(e,t){return W(this,void 0,void 0,function(){var n,r,o;return H(this,function(s){switch(s.label){case 0:n=ue(e),r=t.batch.batchId,s.label=1;case 1:return s.trys.push([1,4,,6]),[4,u4(n.localStore,t)];case 2:return o=s.sent(),mx(n,r,null),px(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Ao(n,o)];case 3:return s.sent(),[3,6];case 4:return[4,Ps(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}})})}function X4(e,t,n){return W(this,void 0,void 0,function(){var r,o;return H(this,function(s){switch(s.label){case 0:r=ue(e),s.label=1;case 1:return s.trys.push([1,4,,6]),[4,function(u,c){var f=ue(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",function(p){var m;return f._n.lookupMutationBatch(p,c).next(function(y){return _e(y!==null),m=y.keys(),f._n.removeMutationBatch(p,y)}).next(function(){return f._n.performConsistencyCheck(p)}).next(function(){return f.Mn.pn(p,m)})})}(r.localStore,t)];case 2:return o=s.sent(),mx(r,t,n),px(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,Ao(r,o)];case 3:return s.sent(),[3,6];case 4:return[4,Ps(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}})})}function J4(e,t){return W(this,void 0,void 0,function(){var n,r,o,s,u;return H(this,function(c){switch(c.label){case 0:Co((n=ue(e)).remoteStore)||ne("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,function(f){var p=ue(f);return p.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(m){return p._n.getHighestUnacknowledgedBatchId(m)})}(n.localStore)];case 2:return(r=c.sent())===-1?[2,void t.resolve()]:((o=n.ko.get(r)||[]).push(t),n.ko.set(r,o),[3,4]);case 3:return s=c.sent(),u=Eu(s,"Initialization of waitForPendingWrites() operation failed"),t.reject(u),[3,4];case 4:return[2]}})})}function px(e,t){(e.ko.get(t)||[]).forEach(function(n){n.resolve()}),e.ko.delete(t)}function mx(e,t,n){var r=ue(e),o=r.xo[r.currentUser.toKey()];if(o){var s=o.get(t);s&&(n?s.reject(n):s.resolve(),o=o.remove(t)),r.xo[r.currentUser.toKey()]=o}}function hu(e,t,n){n===void 0&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,o=e.Vo.get(t);r<o.length;r++){var s=o[r];e.Po.delete(s),n&&e.vo.Mo(s,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(u){e.No.containsKey(u)||$C(e,u)})}function $C(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);n!==null&&(wc(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),gx(e))}function g0(e,t,n){for(var r=0,o=n;r<o.length;r++){var s=o[r];s instanceof LC?(e.No.addReference(s.key,t),Z4(e,s)):s instanceof PC?(ne("SyncEngine","Document no longer in limbo: "+s.key),e.No.removeReference(s.key,t),e.No.containsKey(s.key)||$C(e,s.key)):pe()}}function Z4(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(ne("SyncEngine","New document in limbo: "+n),e.So.add(r),gx(e))}function gx(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new me(He.fromString(t)),r=e.Fo.next();e.Co.set(r,new q4(n)),e.Do=e.Do.insert(n,r),kp(e.remoteStore,new Tp(ci($c(n.path)),r,2,rr.o))}}function Ao(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u;return H(this,function(c){switch(c.label){case 0:return r=ue(e),o=[],s=[],u=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(f,p){u.push(r.Oo(p,t,n).then(function(m){if(m){r.isPrimaryClient&&r.sharedClientState.updateQueryState(p.targetId,m.fromCache?"not-current":"current"),o.push(m);var y=s4.Pn(p.targetId,m);s.push(y)}}))}),[4,Promise.all(u)]);case 1:return c.sent(),r.vo._r(o),[4,function(f,p){return W(this,void 0,void 0,function(){var m,y,v,w,E,_,C,b,N;return H(this,function(x){switch(x.label){case 0:m=ue(f),x.label=1;case 1:return x.trys.push([1,3,,4]),[4,m.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(j){return ee.forEach(p,function(k){return ee.forEach(k.bn,function(A){return m.persistence.referenceDelegate.addReference(j,k.targetId,A)}).next(function(){return ee.forEach(k.vn,function(A){return m.persistence.referenceDelegate.removeReference(j,k.targetId,A)})})})})];case 2:return x.sent(),[3,4];case 3:if(!Ls(y=x.sent()))throw y;return ne("LocalStore","Failed to update sequence numbers: "+y),[3,4];case 4:for(v=0,w=p;v<w.length;v++)E=w[v],_=E.targetId,E.fromCache||(C=m.kn.get(_),b=C.snapshotVersion,N=C.withLastLimboFreeSnapshotVersion(b),m.kn=m.kn.insert(_,N));return[2]}})})}(r.localStore,s)];case 2:c.sent(),c.label=3;case 3:return[2]}})})}function eV(e,t){return W(this,void 0,void 0,function(){var n,r;return H(this,function(o){switch(o.label){case 0:return(n=ue(e)).currentUser.isEqual(t)?[3,3]:(ne("SyncEngine","User change. New user:",t.toKey()),[4,_C(n.localStore,t)]);case 1:return r=o.sent(),n.currentUser=t,function(s,u){s.ko.forEach(function(c){c.forEach(function(f){f.reject(new Y(F.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ko.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,Ao(n,r.Ln)];case 2:o.sent(),o.label=3;case 3:return[2]}})})}function tV(e,t){var n=ue(e),r=n.Co.get(t);if(r&&r.bo)return nt().add(r.key);var o=nt(),s=n.Vo.get(t);if(!s)return o;for(var u=0,c=s;u<c.length;u++){var f=c[u],p=n.Po.get(f);o=o.unionWith(p.view.wo)}return o}function nV(e,t){return W(this,void 0,void 0,function(){var n,r,o;return H(this,function(s){switch(s.label){case 0:return[4,Pd((n=ue(e)).localStore,t.query,!0)];case 1:return r=s.sent(),o=t.view.Ao(r),[2,(n.isPrimaryClient&&g0(n,t.targetId,o.To),o)]}})})}function rV(e){return W(this,void 0,void 0,function(){var t;return H(this,function(n){return[2,IC((t=ue(e)).localStore).then(function(r){return Ao(t,r)})]})})}function iV(e,t,n,r){return W(this,void 0,void 0,function(){var o,s;return H(this,function(u){switch(u.label){case 0:return[4,function(c,f){var p=ue(c),m=ue(p._n);return p.persistence.runTransaction("Lookup mutation documents","readonly",function(y){return m.jt(y,f).next(function(v){return v?p.Mn.pn(y,v):ee.resolve(null)})})}((o=ue(e)).localStore,t)];case 1:return(s=u.sent())===null?[3,6]:n!=="pending"?[3,3]:[4,_u(o.remoteStore)];case 2:return u.sent(),[3,4];case 3:n==="acknowledged"||n==="rejected"?(mx(o,t,r||null),px(o,t),function(c,f){ue(ue(c)._n).Gt(f)}(o.localStore,t)):pe(),u.label=4;case 4:return[4,Ao(o,s)];case 5:return u.sent(),[3,7];case 6:ne("SyncEngine","Cannot apply mutation batch with id: "+t),u.label=7;case 7:return[2]}})})}function oV(e,t){return W(this,void 0,void 0,function(){var n,r,o,s,u,c,f,p;return H(this,function(m){switch(m.label){case 0:return vx(n=ue(e)),yx(n),t!==!0||n.$o===!0?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,wE(n,r.toArray())]);case 1:return o=m.sent(),n.$o=!0,[4,m0(n.remoteStore,!0)];case 2:for(m.sent(),s=0,u=o;s<u.length;s++)c=u[s],kp(n.remoteStore,c);return[3,7];case 3:return t!==!1||n.$o===!1?[3,7]:(f=[],p=Promise.resolve(),n.Vo.forEach(function(y,v){n.sharedClientState.isLocalQueryTarget(v)?f.push(v):p=p.then(function(){return hu(n,v),cu(n.localStore,v,!0)}),wc(n.remoteStore,v)}),[4,p]);case 4:return m.sent(),[4,wE(n,f)];case 5:return m.sent(),function(y){var v=ue(y);v.Co.forEach(function(w,E){wc(v.remoteStore,E)}),v.No.ts(),v.Co=new Map,v.Do=new xn(me.comparator)}(n),n.$o=!1,[4,m0(n.remoteStore,!1)];case 6:m.sent(),m.label=7;case 7:return[2]}})})}function wE(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u,c,f,p,m,y,v,w,E,_,C;return H(this,function(b){switch(b.label){case 0:r=ue(e),o=[],s=[],u=0,c=t,b.label=1;case 1:return u<c.length?(f=c[u],p=void 0,(m=r.Vo.get(f))&&m.length!==0?[4,Ld(r.localStore,ci(m[0]))]:[3,7]):[3,13];case 2:p=b.sent(),y=0,v=m,b.label=3;case 3:return y<v.length?(w=v[y],E=r.Po.get(w),[4,nV(r,E)]):[3,6];case 4:(_=b.sent()).snapshot&&s.push(_.snapshot),b.label=5;case 5:return y++,[3,3];case 6:return[3,11];case 7:return[4,EC(r.localStore,f)];case 8:return C=b.sent(),[4,Ld(r.localStore,C)];case 9:return p=b.sent(),[4,dx(r,VC(C),f,!1)];case 10:b.sent(),b.label=11;case 11:o.push(p),b.label=12;case 12:return u++,[3,1];case 13:return[2,(r.vo._r(s),o)]}})})}function VC(e){return Uk(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function sV(e){var t=ue(e);return ue(ue(t.localStore).persistence).fn()}function aV(e,t,n,r){return W(this,void 0,void 0,function(){var o,s,u;return H(this,function(c){switch(c.label){case 0:return(o=ue(e)).$o?(ne("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,IC(o.localStore)];case 3:return s=c.sent(),u=Qw.createSynthesizedRemoteEventForCurrentChange(t,n==="current"),[4,Ao(o,s,u)];case 4:return c.sent(),[3,8];case 5:return[4,cu(o.localStore,t,!0)];case 6:return c.sent(),hu(o,t,r),[3,8];case 7:pe(),c.label=8;case 8:return[2]}})})}function uV(e,t,n){return W(this,void 0,void 0,function(){var r,o,s,u,c,f,p,m,y,v;return H(this,function(w){switch(w.label){case 0:if(!(r=vx(e)).$o)return[3,10];o=0,s=t,w.label=1;case 1:return o<s.length?(u=s[o],r.Vo.has(u)?(ne("SyncEngine","Adding an already active target "+u),[3,5]):[4,EC(r.localStore,u)]):[3,6];case 2:return c=w.sent(),[4,Ld(r.localStore,c)];case 3:return f=w.sent(),[4,dx(r,VC(c),f.targetId,!1)];case 4:w.sent(),kp(r.remoteStore,f),w.label=5;case 5:return o++,[3,1];case 6:p=function(E){return H(this,function(_){switch(_.label){case 0:return r.Vo.has(E)?[4,cu(r.localStore,E,!1).then(function(){wc(r.remoteStore,E),hu(r,E)}).catch(Ps)]:[3,2];case 1:_.sent(),_.label=2;case 2:return[2]}})},m=0,y=n,w.label=7;case 7:return m<y.length?(v=y[m],[5,p(v)]):[3,10];case 8:w.sent(),w.label=9;case 9:return m++,[3,7];case 10:return[2]}})})}function vx(e){var t=ue(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=FC.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=tV.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Y4.bind(null,t),t.vo._r=V4.bind(null,t.eventManager),t.vo.Mo=B4.bind(null,t.eventManager),t}function yx(e){var t=ue(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Q4.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=X4.bind(null,t),t}var BC=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(t){return W(this,void 0,void 0,function(){return H(this,function(n){switch(n.label){case 0:return this.R=jp(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return n.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},e.prototype.Uo=function(t){return null},e.prototype.Ko=function(t){return SC(this.persistence,new bC,t.initialUser,this.R)},e.prototype.qo=function(t){return new y4(x4.bs,this.R)},e.prototype.Bo=function(t){return new TC},e.prototype.terminate=function(){return W(this,void 0,void 0,function(){return H(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},e}(),zC=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).Qo=n,s.cacheSizeBytes=r,s.forceOwnership=o,s.synchronizeTabs=!1,s}return be(t,e),t.prototype.initialize=function(n){return W(this,void 0,void 0,function(){var r=this;return H(this,function(o){switch(o.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return o.sent(),[4,f4(this.localStore)];case 2:return o.sent(),[4,this.Qo.initialize(this,n)];case 3:return o.sent(),[4,yx(this.Qo.syncEngine)];case 4:return o.sent(),[4,_u(this.Qo.remoteStore)];case 5:return o.sent(),[4,this.persistence.He(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()})];case 6:return o.sent(),[2]}})})},t.prototype.Ko=function(n){return SC(this.persistence,new bC,n.initialUser,this.R)},t.prototype.Uo=function(n){var r=this.persistence.referenceDelegate.garbageCollector;return new Z$(r,n.asyncQueue)},t.prototype.qo=function(n){var r=rx(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey),o=this.cacheSizeBytes!==void 0?ri.withCacheSize(this.cacheSizeBytes):ri.DEFAULT;return new o4(this.synchronizeTabs,r,n.clientId,o,n.asyncQueue,jC(),qf(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(n){return new TC},t}(BC),lV=function(e){function t(n,r){var o=this;return(o=e.call(this,n,r,!1)||this).Qo=n,o.cacheSizeBytes=r,o.synchronizeTabs=!0,o}return be(t,e),t.prototype.initialize=function(n){return W(this,void 0,void 0,function(){var r,o=this;return H(this,function(s){switch(s.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return s.sent(),r=this.Qo.syncEngine,this.sharedClientState instanceof Xv?(this.sharedClientState.syncEngine={ui:iV.bind(null,r),ai:aV.bind(null,r),hi:uV.bind(null,r),fn:sV.bind(null,r),ci:rV.bind(null,r)},[4,this.sharedClientState.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.He(function(u){return W(o,void 0,void 0,function(){return H(this,function(c){switch(c.label){case 0:return[4,oV(this.Qo.syncEngine,u)];case 1:return c.sent(),this.gcScheduler&&(u&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):u||this.gcScheduler.stop()),[2]}})})})];case 4:return s.sent(),[2]}})})},t.prototype.Bo=function(n){var r=jC();if(!Xv.yt(r))throw new Y(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var o=rx(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey);return new Xv(r,n.asyncQueue,o,n.clientId,n.initialUser)},t}(zC),v0=function(){function e(){}return e.prototype.initialize=function(t,n){return W(this,void 0,void 0,function(){var r=this;return H(this,function(o){switch(o.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(s){return yE(r.syncEngine,s,1)},this.remoteStore.remoteSyncer.handleCredentialChange=eV.bind(null,this.syncEngine),[4,m0(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.createEventManager=function(t){return new $4},e.prototype.createDatastore=function(t){var n,r=jp(t.databaseInfo.databaseId),o=(n=t.databaseInfo,new E4(n));return function(s,u,c){return new j4(s,u,c)}(t.credentials,o,r)},e.prototype.createRemoteStore=function(t){var n,r,o,s,u,c=this;return n=this.localStore,r=this.datastore,o=t.asyncQueue,s=function(f){return yE(c.syncEngine,f,0)},u=gE.yt()?new gE:new S4,new C4(n,r,o,s,u)},e.prototype.createSyncEngine=function(t,n){return function(r,o,s,u,c,f,p){var m=new K4(r,o,s,u,c,f);return p&&(m.$o=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)},e.prototype.terminate=function(){return function(t){return W(this,void 0,void 0,function(){var n;return H(this,function(r){switch(r.label){case 0:return n=ue(t),ne("RemoteStore","RemoteStore shutting down."),n.Or.add(5),[4,Su(n)];case 1:return r.sent(),n.Lr.shutdown(),n.Br.set("Unknown"),[2]}})})}(this.remoteStore)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cp=function(){function e(t){this.observer=t,this.muted=!1}return e.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},e.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(t,n){var r=this;this.muted||setTimeout(function(){r.muted||t(n)},0)},e}(),cV=function(){function e(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(t){return W(this,void 0,void 0,function(){var n,r=this;return H(this,function(o){switch(o.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Y(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return W(this,void 0,void 0,function(){var c,f,p,m,y,v;return H(this,function(w){switch(w.label){case 0:return c=ue(s),f=yc(c.R)+"/documents",p={documents:u.map(function(E){return vc(c.R,E)})},[4,c.$i("BatchGetDocuments",f,p)];case 1:return m=w.sent(),y=new Map,m.forEach(function(E){var _=function(C,b){return"found"in b?function(N,x){_e(!!x.found),x.found.name,x.found.updateTime;var j=Ei(N,x.found.name),k=jn(x.found.updateTime),A=new er({mapValue:{fields:x.found.fields}});return wn.newFoundDocument(j,k,A)}(C,b):"missing"in b?function(N,x){_e(!!x.missing),_e(!!x.readTime);var j=Ei(N,x.missing),k=jn(x.readTime);return wn.newNoDocument(j,k)}(C,b):pe()}(c.R,E);y.set(_.key.toString(),_)}),v=[],[2,(u.forEach(function(E){var _=y.get(E.toString());_e(!!_),v.push(_)}),v)]}})})}(this.datastore,t)];case 1:return[2,((n=o.sent()).forEach(function(s){return r.recordVersion(s)}),n)]}})})},e.prototype.set=function(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},e.prototype.update=function(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(t.toString())},e.prototype.delete=function(t){this.write(new Kc(t,this.precondition(t))),this.writtenDocs.add(t.toString())},e.prototype.commit=function(){return W(this,void 0,void 0,function(){var t,n=this;return H(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(o){t.delete(o.key.toString())}),t.forEach(function(o,s){var u=me.fromPath(s);n.mutations.push(new Yw(u,n.precondition(u)))}),[4,function(o,s){return W(this,void 0,void 0,function(){var u,c,f;return H(this,function(p){switch(p.label){case 0:return u=ue(o),c=yc(u.R)+"/documents",f={writes:s.map(function(m){return Md(u.R,m)})},[4,u.Ni("Commit",c,f)];case 1:return p.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return r.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(t){var n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw pe();n=Ae.min()}var r=this.readVersions.get(t.key.toString());if(r){if(!n.isEqual(r))throw new Y(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)},e.prototype.precondition=function(t){var n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?gn.updateTime(n):gn.none()},e.prototype.preconditionForUpdate=function(t){var n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(Ae.min()))throw new Y(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gn.updateTime(n)}return gn.exists(!0)},e.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},e.prototype.ensureCommitNotCalled=function(){},e}(),hV=function(){function e(t,n,r,o){this.asyncQueue=t,this.datastore=n,this.updateFunction=r,this.deferred=o,this.ec=5,this.Zi=new ox(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.ec-=1,this.nc()},e.prototype.nc=function(){var t=this;this.Zi.ji(function(){return W(t,void 0,void 0,function(){var n,r,o=this;return H(this,function(s){return n=new cV(this.datastore),(r=this.sc(n))&&r.then(function(u){o.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){o.deferred.resolve(u)}).catch(function(c){o.ic(c)})})}).catch(function(u){o.ic(u)}),[2]})})})},e.prototype.sc=function(t){try{var n=this.updateFunction(t);return!Os(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}},e.prototype.ic=function(t){var n=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return n.nc(),Promise.resolve()})):this.deferred.reject(t)},e.prototype.rc=function(t){if(t.name==="FirebaseError"){var n=t.code;return n==="aborted"||n==="failed-precondition"||!Qk(n)}return!1},e}(),fV=function(){function e(t,n,r){var o=this;this.credentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=en.UNAUTHENTICATED,this.clientId=Ck.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(n,function(s){return W(o,void 0,void 0,function(){return H(this,function(u){switch(u.label){case 0:return ne("FirestoreClient","Received user=",s.uid),[4,this.credentialListener(s)];case 1:return u.sent(),this.user=s,[2]}})})})}return e.prototype.getConfiguration=function(){return W(this,void 0,void 0,function(){return H(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},e.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var n=new Kn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return W(t,void 0,void 0,function(){var r,o;return H(this,function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:s.sent(),s.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:s.sent(),s.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return r=s.sent(),o=Eu(r,"Failed to shutdown persistence"),n.reject(o),[3,6];case 6:return[2]}})})}),n.promise},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(e,t){return W(this,void 0,void 0,function(){var n,r,o=this;return H(this,function(s){switch(s.label){case 0:return e.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=s.sent(),[4,t.initialize(n)];case 2:return s.sent(),r=n.initialUser,e.setCredentialChangeListener(function(u){return W(o,void 0,void 0,function(){return H(this,function(c){switch(c.label){case 0:return r.isEqual(u)?[3,2]:[4,_C(t.localStore,u)];case 1:c.sent(),r=u,c.label=2;case 2:return[2]}})})}),t.persistence.setDatabaseDeletedListener(function(){return e.terminate()}),e.offlineComponents=t,[2]}})})}function KC(e,t){return W(this,void 0,void 0,function(){var n,r;return H(this,function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,wx(e)];case 1:return n=o.sent(),ne("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=o.sent(),[4,t.initialize(n,r)];case 3:return o.sent(),e.setCredentialChangeListener(function(s){return function(u,c){return W(this,void 0,void 0,function(){var f,p;return H(this,function(m){switch(m.label){case 0:return(f=ue(u)).asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials"),p=Co(f),f.Or.add(3),[4,Su(f)];case 1:return m.sent(),p&&f.Br.set("Unknown"),[4,f.remoteSyncer.handleCredentialChange(c)];case 2:return m.sent(),f.Or.delete(3),[4,Hc(f)];case 3:return m.sent(),[2]}})})}(t.remoteStore,s)}),e.onlineComponents=t,[2]}})})}function wx(e){return W(this,void 0,void 0,function(){return H(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(ne("FirestoreClient","Using default OfflineComponentProvider"),[4,qC(e,new BC)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function Ap(e){return W(this,void 0,void 0,function(){return H(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(ne("FirestoreClient","Using default OnlineComponentProvider"),[4,KC(e,new v0)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function xE(e){return wx(e).then(function(t){return t.persistence})}function HC(e){return wx(e).then(function(t){return t.localStore})}function bE(e){return Ap(e).then(function(t){return t.remoteStore})}function GC(e){return Ap(e).then(function(t){return t.syncEngine})}function fu(e){return W(this,void 0,void 0,function(){var t,n;return H(this,function(r){switch(r.label){case 0:return[4,Ap(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=H4.bind(null,t.syncEngine),n.onUnlisten=G4.bind(null,t.syncEngine),n)]}})})}function SE(e,t,n){var r=this;n===void 0&&(n={});var o=new Kn;return e.asyncQueue.enqueueAndForget(function(){return W(r,void 0,void 0,function(){var s;return H(this,function(u){switch(u.label){case 0:return s=function(c,f,p,m,y){var v=new Cp({next:function(E){f.enqueueAndForget(function(){return cx(c,w)});var _=E.docs.has(p);!_&&E.fromCache?y.reject(new Y(F.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&E.fromCache&&m&&m.source==="server"?y.reject(new Y(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:function(E){return y.reject(E)}}),w=new fx($c(p.path),v,{includeMetadataChanges:!0,so:!0});return lx(c,w)},[4,fu(e)];case 1:return[2,s.apply(void 0,[u.sent(),e.asyncQueue,t,n,o])]}})})}),o.promise}function _E(e,t,n){var r=this;n===void 0&&(n={});var o=new Kn;return e.asyncQueue.enqueueAndForget(function(){return W(r,void 0,void 0,function(){var s;return H(this,function(u){switch(u.label){case 0:return s=function(c,f,p,m,y){var v=new Cp({next:function(E){f.enqueueAndForget(function(){return cx(c,w)}),E.fromCache&&m.source==="server"?y.reject(new Y(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:function(E){return y.reject(E)}}),w=new fx(p,v,{includeMetadataChanges:!0,so:!0});return lx(c,w)},[4,fu(e)];case 1:return[2,s.apply(void 0,[u.sent(),e.asyncQueue,t,n,o])]}})})}),o.promise}var dV=function(e,t,n,r,o,s,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.useFetchStreams=c},$d=function(){function e(t,n){this.projectId=t,this.database=n||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database==="(default)"},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),NE=new Map,WC=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},EE=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(t,n){this.changeListener=n,t.enqueueRetryable(function(){return n(en.UNAUTHENTICATED)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),pV=function(){function e(t){this.token=t,this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(this.token)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(t,n){var r=this;this.changeListener=n,t.enqueueRetryable(function(){return n(r.token.user)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),mV=function(){function e(t){var n=this;this.currentUser=en.UNAUTHENTICATED,this.oc=new Kn,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){n.cc++,n.currentUser=n.ac(),n.oc.resolve(),n.changeListener&&n.asyncQueue.enqueueRetryable(function(){return n.changeListener(n.currentUser)})};var r=function(o){ne("FirebaseCredentialsProvider","Auth detected"),n.auth=o,n.auth.addAuthTokenListener(n.uc)};t.onInit(function(o){return r(o)}),setTimeout(function(){if(!n.auth){var o=t.getImmediate({optional:!0});o?r(o):(ne("FirebaseCredentialsProvider","Auth not yet detected"),n.oc.resolve())}},0)}return e.prototype.getToken=function(){var t=this,n=this.cc,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(function(o){return t.cc!==n?(ne("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):o?(_e(typeof o.accessToken=="string"),new WC(o.accessToken,t.currentUser)):null}):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(t,n){var r=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return W(r,void 0,void 0,function(){return H(this,function(o){switch(o.label){case 0:return[4,this.oc.promise];case 1:return o.sent(),[4,n(this.currentUser)];case 2:return o.sent(),this.changeListener=n,[2]}})})})},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},e.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return _e(t===null||typeof t=="string"),new en(t)},e}(),gV=function(){function e(t,n,r){this.hc=t,this.lc=n,this.fc=r,this.type="FirstParty",this.user=en.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},n=this.hc.auth.getAuthHeaderValueForFirstParty([]);return n&&(t.Authorization=n),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),e}(),vV=function(){function e(t,n,r){this.hc=t,this.lc=n,this.fc=r}return e.prototype.getToken=function(){return Promise.resolve(new gV(this.hc,this.lc,this.fc))},e.prototype.setChangeListener=function(t,n){t.enqueueRetryable(function(){return n(en.FIRST_PARTY)})},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xx(e,t,n){if(!n)throw new Y(F.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function bx(e,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new Y(F.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function YC(e,t,n,r){if(t===!0&&r===!0)throw new Y(F.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function IE(e){if(!me.isDocumentKey(e))throw new Y(F.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function TE(e){if(me.isDocumentKey(e))throw new Y(F.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function Dp(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";var t=function(n){if(n.constructor){var r=/function\s+([^\s(]+)\s*\(/.exec(n.constructor.toString());if(r&&r.length>1)return r[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return typeof e=="function"?"a function":pe()}function Ye(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Y(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Dp(e);throw new Y(F.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function jE(e,t){if(t<=0)throw new Y(F.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kE=function(){function e(t){var n;if(t.host===void 0){if(t.ssl!==void 0)throw new Y(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Y(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,YC("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},e}(),xc=function(){function e(t,n){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kE({}),this._settingsFrozen=!1,t instanceof $d?(this._databaseId=t,this._credentials=new EE):(this._app=t,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new Y(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $d(r.options.projectId)}(t),this._credentials=new mV(n))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new Y(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return this._terminateTask!==void 0},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Y(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kE(t),t.credentials!==void 0&&(this._credentials=function(n){if(!n)return new EE;switch(n.type){case"gapi":var r=n.client;return _e(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new vV(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new Y(F.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return t=this,(n=NE.get(t))&&(ne("ComponentProvider","Removing Datastore"),NE.delete(t),n.terminate()),Promise.resolve();var t,n},e}(),gt=function(){function e(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new yo(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),sr=function(){function e(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),yo=function(e){function t(n,r,o){var s=this;return(s=e.call(this,n,r,$c(o))||this)._path=o,s.type="collection",s}return be(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this._path.popLast();return n.isEmpty()?null:new gt(this.firestore,null,new me(n))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(n){return new t(this.firestore,n,this._path)},t}(sr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(e,t){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(e=Pt(e),xx("collection","path",t),e instanceof xc)return TE(n=He.fromString.apply(He,_t([t],r))),new yo(e,null,n);if(!(e instanceof gt||e instanceof yo))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return TE(n=He.fromString.apply(He,_t([e.path],r)).child(He.fromString(t))),new yo(e.firestore,null,n)}function Kf(e,t){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(e=Pt(e),arguments.length===1&&(t=Ck.u()),xx("doc","path",t),e instanceof xc)return IE(n=He.fromString.apply(He,_t([t],r))),new gt(e,null,new me(n));if(!(e instanceof gt||e instanceof yo))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return IE(n=e._path.child(He.fromString.apply(He,_t([t],r)))),new gt(e.firestore,e instanceof yo?e.converter:null,new me(n))}function XC(e,t){return e=Pt(e),t=Pt(t),(e instanceof gt||e instanceof yo)&&(t instanceof gt||t instanceof yo)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function JC(e,t){return e=Pt(e),t=Pt(t),e instanceof sr&&t instanceof sr&&e.firestore===t.firestore&&Vc(e._query,t._query)&&e.converter===t.converter}var yV=function(){function e(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new ox(this,"async_queue_retry"),this.Ic=function(){var r=qf();r&&ne("AsyncQueue","Visibility state changed to "+r.visibilityState),t.Zi.Gi()};var n=qf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(t){this.enqueue(t)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},e.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var n=qf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Ic)}},e.prototype.enqueue=function(t){var n=this;if(this.Ac(),this._c)return new Promise(function(){});var r=new Kn;return this.Rc(function(){return n._c&&n.Ec?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)}).then(function(){return r.promise})},e.prototype.enqueueRetryable=function(t){var n=this;this.enqueueAndForget(function(){return n.wc.push(t),n.bc()})},e.prototype.bc=function(){return W(this,void 0,void 0,function(){var t,n=this;return H(this,function(r){switch(r.label){case 0:if(this.wc.length===0)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return r.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ls(t=r.sent()))throw t;return ne("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return n.bc()}),r.label=5;case 5:return[2]}})})},e.prototype.Rc=function(t){var n=this,r=this.dc.then(function(){return n.gc=!0,t().catch(function(o){throw n.yc=o,n.gc=!1,Lt("INTERNAL UNHANDLED ERROR: ",function(s){var u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),u}(o)),o}).then(function(o){return n.gc=!1,o})});return this.dc=r,r},e.prototype.enqueueAfterDelay=function(t,n,r){var o=this;this.Ac(),this.Tc.indexOf(t)>-1&&(n=0);var s=U4.createAndSchedule(this,t,n,r,function(u){return o.vc(u)});return this.mc.push(s),s},e.prototype.Ac=function(){this.yc&&pe()},e.prototype.verifyOperationInProgress=function(){},e.prototype.Pc=function(){return W(this,void 0,void 0,function(){var t;return H(this,function(n){switch(n.label){case 0:return[4,t=this.dc];case 1:n.sent(),n.label=2;case 2:if(t!==this.dc)return[3,0];n.label=3;case 3:return[2]}})})},e.prototype.Vc=function(t){for(var n=0,r=this.mc;n<r.length;n++)if(r[n].timerId===t)return!0;return!1},e.prototype.Sc=function(t){var n=this;return this.Pc().then(function(){n.mc.sort(function(u,c){return u.targetTimeMs-c.targetTimeMs});for(var r=0,o=n.mc;r<o.length;r++){var s=o[r];if(s.skipDelay(),t!=="all"&&s.timerId===t)break}return n.Pc()})},e.prototype.Dc=function(t){this.Tc.push(t)},e.prototype.vc=function(t){var n=this.mc.indexOf(t);this.mc.splice(n,1)},e}();function du(e){return function(t,n){if(typeof t!="object"||t===null)return!1;for(var r=t,o=0,s=["next","error","complete"];o<s.length;o++){var u=s[o];if(u in r&&typeof r[u]=="function")return!0}return!1}(e)}var wV=-1,Bt=function(e){function t(n,r){var o=this;return(o=e.call(this,n,r)||this).type="firestore",o._queue=new yV,o._persistenceKey="name"in n?n.name:"[DEFAULT]",o}return be(t,e),t.prototype._terminate=function(){return this._firestoreClient||ZC(this),this._firestoreClient.terminate()},t}(xc);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(e){return e._firestoreClient||ZC(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ZC(e){var t,n=e._freezeSettings(),r=function(o,s,u,c){return new dV(o,s,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new fV(e._credentials,e._queue,r)}function CE(e,t,n){var r=this,o=new Kn;return e.asyncQueue.enqueue(function(){return W(r,void 0,void 0,function(){var s;return H(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,qC(e,n)];case 1:return u.sent(),[4,KC(e,t)];case 2:return u.sent(),o.resolve(),[3,4];case 3:if(!function(c){return c.name==="FirebaseError"?c.code===F.FAILED_PRECONDITION||c.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&c instanceof DOMException)||c.code===22||c.code===20||c.code===11}(s=u.sent()))throw s;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),o.reject(s),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function AE(e){if(e._initialized||e._terminated)throw new Y(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ui=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0;r<t.length;++r)if(t[r].length===0)throw new Y(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kr(t)}return e.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},e}(),ks=function(){function e(t){this._byteString=t}return e.fromBase64String=function(t){try{return new e(qn.fromBase64String(t))}catch(n){throw new Y(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},e.fromUint8Array=function(t){return new e(qn.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},e}(),Us=function(e){this._methodName=e},Mp=function(){function e(t,n){if(!isFinite(t)||t<-90||t>90)throw new Y(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Y(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(t){return Pe(this._lat,t._lat)||Pe(this._long,t._long)},e}(),xV=/^__.*__$/,bV=function(){function e(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}return e.prototype.toMutation=function(t,n){return this.fieldMask!==null?new ko(t,this.data,this.fieldMask,n,this.fieldTransforms):new qc(t,this.data,n,this.fieldTransforms)},e}(),eA=function(){function e(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}return e.prototype.toMutation=function(t,n){return new ko(t,this.data,this.fieldMask,n,this.fieldTransforms)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe()}}var nA=function(){function e(t,n,r,o,s,u){this.settings=t,this.databaseId=n,this.R=r,this.ignoreUndefinedProperties=o,s===void 0&&this.Cc(),this.fieldTransforms=s||[],this.fieldMask=u||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),e.prototype.xc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.kc=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),o=this.xc({path:r,Fc:!1});return o.$c(t),o},e.prototype.Oc=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),o=this.xc({path:r,Fc:!1});return o.Cc(),o},e.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},e.prototype.Lc=function(t){return Vd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},e.prototype.contains=function(t){return this.fieldMask.find(function(n){return t.isPrefixOf(n)})!==void 0||this.fieldTransforms.find(function(n){return t.isPrefixOf(n.field)})!==void 0},e.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},e.prototype.$c=function(t){if(t.length===0)throw this.Lc("Document fields must not be empty");if(tA(this.Nc)&&xV.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},e}(),SV=function(){function e(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.R=r||jp(t)}return e.prototype.Uc=function(t,n,r,o){return o===void 0&&(o=!1),new nA({Nc:t,methodName:n,qc:r,path:Kr.emptyPath(),Fc:!1,Bc:o},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function Fs(e){var t=e._freezeSettings(),n=jp(e._databaseId);return new SV(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Rp(e,t,n,r,o,s){s===void 0&&(s={});var u=e.Uc(s.merge||s.mergeFields?2:0,t,n,o);Ex("Data must be an object, but it was:",u,r);var c,f,p=oA(r,u);if(s.merge)c=new Za(u.fieldMask),f=u.fieldTransforms;else if(s.mergeFields){for(var m=[],y=0,v=s.mergeFields;y<v.length;y++){var w=y0(t,v[y],n);if(!u.contains(w))throw new Y(F.INVALID_ARGUMENT,"Field '"+w+"' is specified in your field mask but missing from your input data.");aA(m,w)||m.push(w)}c=new Za(m),f=u.fieldTransforms.filter(function(E){return c.covers(E.field)})}else c=null,f=u.fieldTransforms;return new bV(new er(p),c,f)}var Sx=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype._toFieldTransform=function(n){if(n.Nc!==2)throw n.Nc===1?n.Lc(this._methodName+"() can only appear at the top level of your update data"):n.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return n.fieldMask.push(n.path),null},t.prototype.isEqual=function(n){return n instanceof t},t}(Us);function rA(e,t,n){return new nA({Nc:3,qc:t.settings.qc,methodName:e._methodName,Fc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var _V=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype._toFieldTransform=function(n){return new zc(n.path,new ru)},t.prototype.isEqual=function(n){return n instanceof t},t}(Us),NV=function(e){function t(n,r){var o=this;return(o=e.call(this,n)||this).Kc=r,o}return be(t,e),t.prototype._toFieldTransform=function(n){var r=rA(this,n,!0),o=this.Kc.map(function(u){return $s(u,r)}),s=new Ts(o);return new zc(n.path,s)},t.prototype.isEqual=function(n){return this===n},t}(Us),EV=function(e){function t(n,r){var o=this;return(o=e.call(this,n)||this).Kc=r,o}return be(t,e),t.prototype._toFieldTransform=function(n){var r=rA(this,n,!0),o=this.Kc.map(function(u){return $s(u,r)}),s=new js(o);return new zc(n.path,s)},t.prototype.isEqual=function(n){return this===n},t}(Us),IV=function(e){function t(n,r){var o=this;return(o=e.call(this,n)||this).Qc=r,o}return be(t,e),t.prototype._toFieldTransform=function(n){var r=new iu(n.R,qk(n.R,this.Qc));return new zc(n.path,r)},t.prototype.isEqual=function(n){return this===n},t}(Us);function _x(e,t,n,r){var o=e.Uc(1,t,n);Ex("Data must be an object, but it was:",o,r);var s=[],u=er.empty();Rs(r,function(f,p){var m=Ix(t,f,n);p=Pt(p);var y=o.Oc(m);if(p instanceof Sx)s.push(m);else{var v=$s(p,y);v!=null&&(s.push(m),u.set(m,v))}});var c=new Za(s);return new eA(u,c,o.fieldTransforms)}function Nx(e,t,n,r,o,s){var u=e.Uc(1,t,n),c=[y0(t,r,n)],f=[o];if(s.length%2!=0)throw new Y(F.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var p=0;p<s.length;p+=2)c.push(y0(t,s[p])),f.push(s[p+1]);for(var m=[],y=er.empty(),v=c.length-1;v>=0;--v)if(!aA(m,c[v])){var w=c[v],E=f[v];E=Pt(E);var _=u.Oc(w);if(E instanceof Sx)m.push(w);else{var C=$s(E,_);C!=null&&(m.push(w),y.set(w,C))}}var b=new Za(m);return new eA(y,b,u.fieldTransforms)}function iA(e,t,n,r){return r===void 0&&(r=!1),$s(n,e.Uc(r?4:3,t))}function $s(e,t){if(sA(e=Pt(e)))return Ex("Unsupported field value:",t,e),oA(e,t);if(e instanceof Us)return function(n,r){if(!tA(r.Nc))throw r.Lc(n._methodName+"() can only be used with update() and set()");if(!r.path)throw r.Lc(n._methodName+"() is not currently supported inside arrays");var o=n._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&t.Nc!==4)throw t.Lc("Nested arrays are not supported");return function(n,r){for(var o=[],s=0,u=0,c=n;u<c.length;u++){var f=$s(c[u],r.Mc(s));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),s++}return{arrayValue:{values:o}}}(e,t)}return function(n,r){if((n=Pt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return qk(r.R,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){var o=zn.fromDate(n);return{timestampValue:gc(r.R,o)}}if(n instanceof zn)return o=new zn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3)),{timestampValue:gc(r.R,o)};if(n instanceof Mp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ks)return{bytesValue:eC(r.R,n._byteString)};if(n instanceof gt){o=r.databaseId;var s=n.firestore._databaseId;if(!s.isEqual(o))throw r.Lc("Document reference is for database "+s.projectId+"/"+s.database+" but should be for database "+o.projectId+"/"+o.database);return{referenceValue:Jw(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.Lc("Unsupported field value: "+Dp(n))}(e,t)}function oA(e,t){var n={};return Dk(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Rs(e,function(r,o){var s=$s(o,t.kc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function sA(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof zn||e instanceof Mp||e instanceof ks||e instanceof gt||e instanceof Us)}function Ex(e,t,n){if(!sA(n)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(n)){var r=Dp(n);throw r==="an object"?t.Lc(e+" a custom object"):t.Lc(e+" "+r)}}function y0(e,t,n){if((t=Pt(t))instanceof ui)return t._internalPath;if(typeof t=="string")return Ix(e,t);throw Vd("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var TV=new RegExp("[~\\*/\\[\\]]");function Ix(e,t,n){if(t.search(TV)>=0)throw Vd("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return new(ui.bind.apply(ui,_t([void 0],t.split("."))))()._internalPath}catch{throw Vd("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function Vd(e,t,n,r,o){var s=r&&!r.isEmpty(),u=o!==void 0,c="Function "+t+"() called with invalid data";n&&(c+=" (via `toFirestore()`)");var f="";return(s||u)&&(f+=" (found",s&&(f+=" in field "+r),u&&(f+=" in document "+o),f+=")"),new Y(F.INVALID_ARGUMENT,(c+=". ")+e+f)}function aA(e,t){return e.some(function(n){return n.isEqual(t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bc=function(){function e(t,n,r,o,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=o,this._converter=s}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new gt(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return this._document!==null},e.prototype.data=function(){if(this._document){if(this._converter){var t=new jV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},e.prototype.get=function(t){if(this._document){var n=this._document.data.field(Bd("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}},e}(),jV=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(bc);function Bd(e,t){return typeof t=="string"?Ix(e,t):t instanceof ui?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ls=function(){function e(t,n){this.hasPendingWrites=t,this.fromCache=n}return e.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},e}(),Ti=function(e){function t(n,r,o,s,u,c){var f=this;return(f=e.call(this,n,r,o,s,c)||this)._firestore=n,f._firestoreImpl=n,f.metadata=u,f}return be(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(n){if(n===void 0&&(n={}),this._document){if(this._converter){var r=new $l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}},t.prototype.get=function(n,r){if(r===void 0&&(r={}),this._document){var o=this._document.data.field(Bd("DocumentSnapshot.get",n));if(o!==null)return this._userDataWriter.convertValue(o,r.serverTimestamps)}},t}(bc),$l=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype.data=function(n){return n===void 0&&(n={}),e.prototype.data.call(this,n)},t}(Ti),io=function(){function e(t,n,r,o){this._firestore=t,this._userDataWriter=n,this._snapshot=o,this.metadata=new ls(o.hasPendingWrites,o.fromCache),this.query=r}return Object.defineProperty(e.prototype,"docs",{get:function(){var t=[];return this.forEach(function(n){return t.push(n)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.size===0},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t,n){var r=this;this._snapshot.docs.forEach(function(o){t.call(n,new $l(r._firestore,r._userDataWriter,o.key,o,new ls(r._snapshot.mutatedKeys.has(o.key),r._snapshot.fromCache),r.query.converter))})},e.prototype.docChanges=function(t){t===void 0&&(t={});var n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){var s=0;return r._snapshot.docChanges.map(function(c){return{type:"added",doc:new $l(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ls(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}})}var u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(function(c){return o||c.type!==3}).map(function(c){var f=new $l(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ls(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),p=-1,m=-1;return c.type!==0&&(p=u.indexOf(c.doc.key),u=u.delete(c.doc.key)),c.type!==1&&(m=(u=u.add(c.doc)).indexOf(c.doc.key)),{type:kV(c.type),doc:f,oldIndex:p,newIndex:m}})}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges},e}();function kV(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe()}}function uA(e,t){return e instanceof Ti&&t instanceof Ti?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(e._document===null?t._document===null:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof io&&t instanceof io&&e._firestore===t._firestore&&JC(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(e){if(Dd(e)&&e.explicitOrderBy.length===0)throw new Y(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gc=function(){};function Yi(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,o=t;r<o.length;r++){var s=o[r];e=s._apply(e)}return e}var CV=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).jc=n,s.Wc=r,s.Gc=o,s.type="where",s}return be(t,e),t.prototype._apply=function(n){var r=Fs(n.firestore),o=function(s,u,c,f,p,m,y){var v;if(p.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Y(F.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+m+"' queries on FieldPath.documentId().");if(m==="in"||m==="not-in"){LE(y,m);for(var w=[],E=0,_=y;E<_.length;E++){var C=_[E];w.push(OE(f,s,C))}v={arrayValue:{values:w}}}else v=OE(f,s,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||LE(y,m),v=iA(c,"where",y,m==="in"||m==="not-in");var b=ir.create(p,m,v);return function(N,x){if(x.g()){var j=Gw(N);if(j!==null&&!j.isEqual(x.field))throw new Y(F.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+j.toString()+"' and '"+x.field.toString()+"'");var k=Hw(N);k!==null&&hA(N,x.field,k)}var A=function(T,L){for(var U=0,K=T.filters;U<K.length;U++){var $=K[U];if(L.indexOf($.op)>=0)return $.op}return null}(N,function(T){switch(T){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(x.op));if(A!==null)throw A===x.op?new Y(F.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+x.op.toString()+"' filter."):new Y(F.INVALID_ARGUMENT,"Invalid query. You cannot use '"+x.op.toString()+"' filters with '"+A.toString()+"' filters.")}(s,b),b}(n._query,0,r,n.firestore._databaseId,this.jc,this.Wc,this.Gc);return new sr(n.firestore,n.converter,function(s,u){var c=s.filters.concat([u]);return new Oi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),c,s.limit,s.limitType,s.startAt,s.endAt)}(n._query,o))},t}(Gc),AV=function(e){function t(n,r){var o=this;return(o=e.call(this)||this).jc=n,o.zc=r,o.type="orderBy",o}return be(t,e),t.prototype._apply=function(n){var r=function(o,s,u){if(o.startAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var c=new Ba(s,u);return function(f,p){if(Hw(f)===null){var m=Gw(f);m!==null&&hA(f,m,p.field)}}(o,c),c}(n._query,this.jc,this.zc);return new sr(n.firestore,n.converter,function(o,s){var u=o.explicitOrderBy.concat([s]);return new Oi(o.path,o.collectionGroup,u,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(n._query,r))},t}(Gc),DE=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).type=n,s.Hc=r,s.Jc=o,s}return be(t,e),t.prototype._apply=function(n){return new sr(n.firestore,n.converter,Fk(n._query,this.Hc,this.Jc))},t}(Gc),ME=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).type=n,s.Yc=r,s.Xc=o,s}return be(t,e),t.prototype._apply=function(n){var r=cA(n,this.type,this.Yc,this.Xc);return new sr(n.firestore,n.converter,function(o,s){return new Oi(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,s,o.endAt)}(n._query,r))},t}(Gc),RE=function(e){function t(n,r,o){var s=this;return(s=e.call(this)||this).type=n,s.Yc=r,s.Xc=o,s}return be(t,e),t.prototype._apply=function(n){var r=cA(n,this.type,this.Yc,this.Xc);return new sr(n.firestore,n.converter,function(o,s){return new Oi(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,s)}(n._query,r))},t}(Gc);function cA(e,t,n,r){if(n[0]=Pt(n[0]),n[0]instanceof bc)return function(s,u,c,f,p){if(!f)throw new Y(F.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var m=[],y=0,v=nu(s);y<v.length;y++){var w=v[y];if(w.field.isKeyField())m.push(kd(u,f.key));else{var E=f.data.field(w.field);if(zw(E))throw new Y(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){var _=w.field.canonicalString();throw new Y(F.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+_+"' (used as the orderBy) does not exist.")}m.push(E)}}return new mc(m,p)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var o=Fs(e.firestore);return function(s,u,c,f,p,m){var y=s.explicitOrderBy;if(p.length>y.length)throw new Y(F.INVALID_ARGUMENT,"Too many arguments provided to "+f+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var v=[],w=0;w<p.length;w++){var E=p[w];if(y[w].field.isKeyField()){if(typeof E!="string")throw new Y(F.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+f+"(), but got a "+typeof E);if(!Ww(s)&&E.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+f+"() must be a plain document ID, but '"+E+"' contains a slash.");var _=s.path.child(He.fromString(E));if(!me.isDocumentKey(_))throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+f+"() must result in a valid document path, but '"+_+"' is not because it contains an odd number of segments.");var C=new me(_);v.push(kd(u,C))}else{var b=iA(c,f,E);v.push(b)}}return new mc(v,m)}(e._query,e.firestore._databaseId,o,t,n,r)}function OE(e,t,n){if(typeof(n=Pt(n))=="string"){if(n==="")throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ww(t)&&n.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(He.fromString(n));if(!me.isDocumentKey(r))throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return kd(e,new me(r))}if(n instanceof gt)return kd(e,n._key);throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dp(n)+".")}function LE(e,t){if(!Array.isArray(e)||e.length===0)throw new Y(F.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new Y(F.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function hA(e,t,n){if(!n.isEqual(t))throw new Y(F.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tx=function(){function e(){}return e.prototype.convertValue=function(t,n){switch(n===void 0&&(n="none"),Is(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Rt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(eu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw pe()}},e.prototype.convertObject=function(t,n){var r=this,o={};return Rs(t.fields,function(s,u){o[s]=r.convertValue(u,n)}),o},e.prototype.convertGeoPoint=function(t){return new Mp(Rt(t.latitude),Rt(t.longitude))},e.prototype.convertArray=function(t,n){var r=this;return(t.values||[]).map(function(o){return r.convertValue(o,n)})},e.prototype.convertServerTimestamp=function(t,n){switch(n){case"previous":var r=Rk(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(dc(t));default:return null}},e.prototype.convertTimestamp=function(t){var n=So(t);return new zn(n.seconds,n.nanos)},e.prototype.convertDocumentKey=function(t,n){var r=He.fromString(t);_e(uC(r));var o=new $d(r.get(1),r.get(3)),s=new me(r.popFirst(5));return o.isEqual(n)||Lt("Document "+s+" contains a document reference within a different database ("+o.projectId+"/"+o.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),s},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var DV=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return be(t,e),t.prototype.convertBytes=function(n){return new ks(n)},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new gt(this.firestore,null,r)},t}(Tx),MV=function(){function e(t,n){this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Fs(t)}return e.prototype.set=function(t,n,r){this._verifyNotCommitted();var o=oo(t,this._firestore),s=Op(o.converter,n,r),u=Rp(this._dataReader,"WriteBatch.set",o._key,s,o.converter!==null,r);return this._mutations.push(u.toMutation(o._key,gn.none())),this},e.prototype.update=function(t,n,r){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this._verifyNotCommitted();var u,c=oo(t,this._firestore);return u=typeof(n=Pt(n))=="string"||n instanceof ui?Nx(this._dataReader,"WriteBatch.update",c._key,n,r,o):_x(this._dataReader,"WriteBatch.update",c._key,n),this._mutations.push(u.toMutation(c._key,gn.exists(!0))),this},e.prototype.delete=function(t){this._verifyNotCommitted();var n=oo(t,this._firestore);return this._mutations=this._mutations.concat(new Kc(n._key,gn.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new Y(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(e,t){if((e=Pt(e)).firestore!==t)throw new Y(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ps=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return be(t,e),t.prototype.convertBytes=function(n){return new ks(n)},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new gt(this.firestore,null,r)},t}(Tx);function PE(e,t,n){e=Ye(e,gt);var r=Ye(e.firestore,Bt),o=Op(e.converter,t,n);return Wc(r,[Rp(Fs(r),"setDoc",e._key,o,e.converter!==null,n).toMutation(e._key,gn.none())])}function UE(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];e=Ye(e,gt);var s=Ye(e.firestore,Bt),u=Fs(s);return Wc(s,[(typeof(t=Pt(t))=="string"||t instanceof ui?Nx(u,"updateDoc",e._key,t,n,r):_x(u,"updateDoc",e._key,t)).toMutation(e._key,gn.exists(!0))])}function fA(e){for(var t,n,r,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];e=Pt(e);var u={includeMetadataChanges:!1},c=0;typeof o[c]!="object"||du(o[c])||(u=o[c],c++);var f,p,m,y={includeMetadataChanges:u.includeMetadataChanges};if(du(o[c])){var v=o[c];o[c]=(t=v.next)===null||t===void 0?void 0:t.bind(v),o[c+1]=(n=v.error)===null||n===void 0?void 0:n.bind(v),o[c+2]=(r=v.complete)===null||r===void 0?void 0:r.bind(v)}if(e instanceof gt)p=Ye(e.firestore,Bt),m=$c(e._key.path),f={next:function(_){o[c]&&o[c](w0(p,e,_))},error:o[c+1],complete:o[c+2]};else{var w=Ye(e,sr);p=Ye(w.firestore,Bt),m=w._query;var E=new ps(p);f={next:function(_){o[c]&&o[c](new io(p,E,w,_))},error:o[c+1],complete:o[c+2]},lA(e._query)}return function(_,C,b,N){var x=this,j=new Cp(N),k=new fx(C,j,b);return _.asyncQueue.enqueueAndForget(function(){return W(x,void 0,void 0,function(){var A;return H(this,function(T){switch(T.label){case 0:return A=lx,[4,fu(_)];case 1:return[2,A.apply(void 0,[T.sent(),k])]}})})}),function(){j.Wo(),_.asyncQueue.enqueueAndForget(function(){return W(x,void 0,void 0,function(){var A;return H(this,function(T){switch(T.label){case 0:return A=cx,[4,fu(_)];case 1:return[2,A.apply(void 0,[T.sent(),k])]}})})})}}(dn(p),m,y,f)}function Wc(e,t){return function(n,r){var o=this,s=new Kn;return n.asyncQueue.enqueueAndForget(function(){return W(o,void 0,void 0,function(){var u;return H(this,function(c){switch(c.label){case 0:return u=W4,[4,GC(n)];case 1:return[2,u.apply(void 0,[c.sent(),r,s])]}})})}),s.promise}(dn(e),t)}function w0(e,t,n){var r=n.docs.get(t._key),o=new ps(e);return new Ti(e,o,t._key,r,new ls(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var RV=function(e){function t(n,r){var o=this;return(o=e.call(this,n,r)||this)._firestore=n,o}return be(t,e),t.prototype.get=function(n){var r=this,o=oo(n,this._firestore),s=new ps(this._firestore);return e.prototype.get.call(this,n).then(function(u){return new Ti(r._firestore,s,o._key,u._document,new ls(!1,!1),o.converter)})},t}(function(){function e(t,n){this._firestore=t,this._transaction=n,this._dataReader=Fs(t)}return e.prototype.get=function(t){var n=this,r=oo(t,this._firestore),o=new DV(this._firestore);return this._transaction.lookup([r._key]).then(function(s){if(!s||s.length!==1)return pe();var u=s[0];if(u.isFoundDocument())return new bc(n._firestore,o,u.key,u,r.converter);if(u.isNoDocument())return new bc(n._firestore,o,r._key,null,r.converter);throw pe()})},e.prototype.set=function(t,n,r){var o=oo(t,this._firestore),s=Op(o.converter,n,r),u=Rp(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,r);return this._transaction.set(o._key,u),this},e.prototype.update=function(t,n,r){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];var u,c=oo(t,this._firestore);return u=typeof(n=Pt(n))=="string"||n instanceof ui?Nx(this._dataReader,"Transaction.update",c._key,n,r,o):_x(this._dataReader,"Transaction.update",c._key,n),this._transaction.update(c._key,u),this},e.prototype.delete=function(t){var n=oo(t,this._firestore);return this._transaction.delete(n._key),this},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(){if(typeof Uint8Array>"u")throw new Y(F.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $E(){if(typeof atob>"u")throw new Y(F.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var dA=function(){function e(t){this._delegate=t}return e.fromBase64String=function(t){return $E(),new e(ks.fromBase64String(t))},e.fromUint8Array=function(t){return FE(),new e(ks.fromUint8Array(t))},e.prototype.toBase64=function(){return $E(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return FE(),this._delegate.toUint8Array()},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),OV=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(t,n){return function(r,o){AE(r=Ye(r,Bt));var s=dn(r),u=r._freezeSettings(),c=new v0;return CE(s,c,new zC(c,u.cacheSizeBytes,o==null?void 0:o.forceOwnership))}(t._delegate,{forceOwnership:n})},e.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(n){AE(n=Ye(n,Bt));var r=dn(n),o=n._freezeSettings(),s=new v0;return CE(r,s,new lV(s,o.cacheSizeBytes))}(t._delegate)},e.prototype.clearIndexedDbPersistence=function(t){return function(n){var r=this;if(n._initialized&&!n._terminated)throw new Y(F.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var o=new Kn;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return W(r,void 0,void 0,function(){var s;return H(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(c){return W(this,void 0,void 0,function(){var f;return H(this,function(p){switch(p.label){case 0:return au.yt()?(f=c+"main",[4,au.delete(f)]):[2,Promise.resolve()];case 1:return p.sent(),[2]}})})}(rx(n._databaseId,n._persistenceKey))];case 1:return u.sent(),o.resolve(),[3,3];case 2:return s=u.sent(),o.reject(s),[3,3];case 3:return[2]}})})}),o.promise}(t._delegate)},e}(),pA=function(){function e(t,n,r){var o=this;this._delegate=n,this.Zc=r,this.INTERNAL={delete:function(){return o.terminate()}},t instanceof $d||(this.tu=t)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){var n=this._delegate._getSettings();t.merge||n.host===t.host||Td("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},n),t)).merge,this._delegate._setSettings(t)},e.prototype.useEmulator=function(t,n,r){r===void 0&&(r={}),function(o,s,u,c){var f;c===void 0&&(c={});var p=(o=Ye(o,xc))._getSettings();if(p.host!=="firestore.googleapis.com"&&p.host!==s&&Td("Host has been set in both settings() and useEmulator(), emulator host will be used"),o._setSettings(Object.assign(Object.assign({},p),{host:s+":"+u,ssl:!1})),c.mockUserToken){var m,y;if(typeof c.mockUserToken=="string")m=c.mockUserToken,y=en.MOCK_USER;else{m=rU(c.mockUserToken,(f=o._app)===null||f===void 0?void 0:f.options.projectId);var v=c.mockUserToken.sub||c.mockUserToken.user_id;if(!v)throw new Y(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new en(v)}o._credentials=new pV(new WC(m,y))}}(this._delegate,t,n,r)},e.prototype.enableNetwork=function(){return function(t){var n=this;return t.asyncQueue.enqueue(function(){return W(n,void 0,void 0,function(){var r,o;return H(this,function(s){switch(s.label){case 0:return[4,xE(t)];case 1:return r=s.sent(),[4,bE(t)];case 2:return o=s.sent(),[2,(r.setNetworkEnabled(!0),function(u){var c=ue(u);return c.Or.delete(0),Hc(c)}(o))]}})})})}(dn(Ye(this._delegate,Bt)))},e.prototype.disableNetwork=function(){return function(t){var n=this;return t.asyncQueue.enqueue(function(){return W(n,void 0,void 0,function(){var r,o;return H(this,function(s){switch(s.label){case 0:return[4,xE(t)];case 1:return r=s.sent(),[4,bE(t)];case 2:return o=s.sent(),[2,(r.setNetworkEnabled(!1),function(u){return W(this,void 0,void 0,function(){var c;return H(this,function(f){switch(f.label){case 0:return(c=ue(u)).Or.add(0),[4,Su(c)];case 1:return f.sent(),c.Br.set("Offline"),[2]}})})}(o))]}})})})}(dn(Ye(this._delegate,Bt)))},e.prototype.enablePersistence=function(t){var n=!1,r=!1;return t&&YC("synchronizeTabs",n=!!t.synchronizeTabs,"experimentalForceOwningTab",r=!!t.experimentalForceOwningTab),n?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,r)},e.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var n=this,r=new Kn;return t.asyncQueue.enqueueAndForget(function(){return W(n,void 0,void 0,function(){var o;return H(this,function(s){switch(s.label){case 0:return o=J4,[4,GC(t)];case 1:return[2,o.apply(void 0,[s.sent(),r])]}})})}),r.promise}(dn(Ye(this._delegate,Bt)))},e.prototype.onSnapshotsInSync=function(t){return function(n,r){return function(o,s){var u=this,c=new Cp(s);return o.asyncQueue.enqueueAndForget(function(){return W(u,void 0,void 0,function(){var f;return H(this,function(p){switch(p.label){case 0:return f=function(m,y){ue(m).Gr.add(y),y.next()},[4,fu(o)];case 1:return[2,f.apply(void 0,[p.sent(),c])]}})})}),function(){c.Wo(),o.asyncQueue.enqueueAndForget(function(){return W(u,void 0,void 0,function(){var f;return H(this,function(p){switch(p.label){case 0:return f=function(m,y){ue(m).Gr.delete(y)},[4,fu(o)];case 1:return[2,f.apply(void 0,[p.sent(),c])]}})})})}}(dn(n=Ye(n,Bt)),du(r)?r:{next:r})}(this._delegate,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.tu)throw new Y(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new zd(this,QC(this._delegate,t))}catch(n){throw Nn(n,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new ms(this,Kf(this._delegate,t))}catch(n){throw Nn(n,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Up(this,function(n,r){if(n=Ye(n,xc),xx("collectionGroup","collection id",r),r.indexOf("/")>=0)throw new Y(F.INVALID_ARGUMENT,"Invalid collection ID '"+r+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new sr(n,null,function(o){return new Oi(He.emptyPath(),o)}(r))}(this._delegate,t))}catch(n){throw Nn(n,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var n=this;return function(r,o){return function(s,u){var c=this,f=new Kn;return s.asyncQueue.enqueueAndForget(function(){return W(c,void 0,void 0,function(){var p;return H(this,function(m){switch(m.label){case 0:return[4,function(y){return Ap(y).then(function(v){return v.datastore})}(s)];case 1:return p=m.sent(),new hV(s.asyncQueue,p,u,f).run(),[2]}})})}),f.promise}(dn(r),function(s){return o(new RV(r,s))})}(this._delegate,function(r){return t(new mA(n,r))})},e.prototype.batch=function(){var t=this;return dn(this._delegate),new gA(new MV(this._delegate,function(n){return Wc(t._delegate,n)}))},e.prototype.loadBundle=function(t){throw new Y(F.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Y(F.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),Lp=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return be(t,e),t.prototype.convertBytes=function(n){return new dA(new ks(n))},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return ms.eu(r,this.firestore,null)},t}(Tx);function LV(e){var t;t=e,Vr.setLogLevel(t)}var mA=function(){function e(t,n){this._firestore=t,this._delegate=n,this._userDataWriter=new Lp(t)}return e.prototype.get=function(t){var n=this,r=cs(t);return this._delegate.get(r).then(function(o){return new Sc(n._firestore,new Ti(n._firestore._delegate,n._userDataWriter,o._key,o._document,o.metadata,r.converter))})},e.prototype.set=function(t,n,r){var o=cs(t);return r?(bx("Transaction.set",r),this._delegate.set(o,n,r)):this._delegate.set(o,n),this},e.prototype.update=function(t,n,r){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var c=cs(t);return arguments.length===2?this._delegate.update(c,n):(o=this._delegate).update.apply(o,_t([c,n,r],s)),this},e.prototype.delete=function(t){var n=cs(t);return this._delegate.delete(n),this},e}(),gA=function(){function e(t){this._delegate=t}return e.prototype.set=function(t,n,r){var o=cs(t);return r?(bx("WriteBatch.set",r),this._delegate.set(o,n,r)):this._delegate.set(o,n),this},e.prototype.update=function(t,n,r){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var c=cs(t);return arguments.length===2?this._delegate.update(c,n):(o=this._delegate).update.apply(o,_t([c,n,r],s)),this},e.prototype.delete=function(t){var n=cs(t);return this._delegate.delete(n),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),Pp=function(){function e(t,n,r){this._firestore=t,this._userDataWriter=n,this._delegate=r}return e.prototype.fromFirestore=function(t,n){var r=new $l(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new _c(this._firestore,r),n??{})},e.prototype.toFirestore=function(t,n){return n?this._delegate.toFirestore(t,n):this._delegate.toFirestore(t)},e.nu=function(t,n){var r=e.su,o=r.get(t);o||(o=new WeakMap,r.set(t,o));var s=o.get(n);return s||(s=new e(t,new Lp(t),n),o.set(n,s)),s},e}();Pp.su=new WeakMap;var ms=function(){function e(t,n){this.firestore=t,this._delegate=n,this._userDataWriter=new Lp(t)}return e.iu=function(t,n,r){if(t.length%2!=0)throw new Y(F.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new gt(n._delegate,r,new me(t)))},e.eu=function(t,n,r){return new e(n,new gt(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new zd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new zd(this.firestore,QC(this._delegate,t))}catch(n){throw Nn(n,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return(t=Pt(t))instanceof gt&&XC(this._delegate,t)},e.prototype.set=function(t,n){n=bx("DocumentReference.set",n);try{return n?PE(this._delegate,t,n):PE(this._delegate,t)}catch(r){throw Nn(r,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];try{return arguments.length===1?UE(this._delegate,t):UE.apply(void 0,_t([this._delegate,t,n],r))}catch(s){throw Nn(s,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Wc(Ye((t=this._delegate).firestore,Bt),[new Kc(t._key,gn.none())]);var t},e.prototype.onSnapshot=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=vA(n),s=yA(n,function(u){return new Sc(t.firestore,new Ti(t.firestore._delegate,t._userDataWriter,u._key,u._document,u.metadata,t._delegate.converter))});return fA(this._delegate,o,s)},e.prototype.get=function(t){var n=this;return((t==null?void 0:t.source)==="cache"?function(r){r=Ye(r,gt);var o=Ye(r.firestore,Bt),s=dn(o),u=new ps(o);return function(c,f){var p=this,m=new Kn;return c.asyncQueue.enqueueAndForget(function(){return W(p,void 0,void 0,function(){var y;return H(this,function(v){switch(v.label){case 0:return y=function(w,E,_){return W(this,void 0,void 0,function(){var C,b;return H(this,function(N){switch(N.label){case 0:return N.trys.push([0,2,,3]),[4,function(x,j){var k=ue(x);return k.persistence.runTransaction("read document","readonly",function(A){return k.Mn.mn(A,j)})}(w,E)];case 1:return(b=N.sent()).isFoundDocument()?_.resolve(b):b.isNoDocument()?_.resolve(null):_.reject(new Y(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return C=N.sent(),b=Eu(C,"Failed to get document '"+E+" from cache"),_.reject(b),[3,3];case 3:return[2]}})})},[4,HC(c)];case 1:return[2,y.apply(void 0,[v.sent(),f,m])]}})})}),m.promise}(s,r._key).then(function(c){return new Ti(o,u,r._key,c,new ls(c!==null&&c.hasLocalMutations,!0),r.converter)})}(this._delegate):(t==null?void 0:t.source)==="server"?function(r){r=Ye(r,gt);var o=Ye(r.firestore,Bt);return SE(dn(o),r._key,{source:"server"}).then(function(s){return w0(o,r,s)})}(this._delegate):function(r){r=Ye(r,gt);var o=Ye(r.firestore,Bt);return SE(dn(o),r._key).then(function(s){return w0(o,r,s)})}(this._delegate)).then(function(r){return new Sc(n.firestore,new Ti(n.firestore._delegate,n._userDataWriter,r._key,r._document,r.metadata,n._delegate.converter))})},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Pp.nu(this.firestore,t)):this._delegate.withConverter(null))},e}();function Nn(e,t,n){return e.message=e.message.replace(t,n),e}function vA(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(typeof r=="object"&&!du(r))return r}return{}}function yA(e,t){var n,r,o;return{next:function(s){o.next&&o.next(t(s))},error:(n=(o=du(e[0])?e[0]:du(e[1])?e[1]:typeof e[0]=="function"?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)===null||n===void 0?void 0:n.bind(o),complete:(r=o.complete)===null||r===void 0?void 0:r.bind(o)}}var Sc=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"ref",{get:function(){return new ms(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._delegate.data(t)},e.prototype.get=function(t,n){return this._delegate.get(t,n)},e.prototype.isEqual=function(t){return uA(this._delegate,t._delegate)},e}(),_c=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return be(t,e),t.prototype.data=function(n){return this._delegate.data(n)},t}(Sc),Up=function(){function e(t,n){this.firestore=t,this._delegate=n,this._userDataWriter=new Lp(t)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,Yi(this._delegate,function(o,s,u){var c=s,f=Bd("where",o);return new CV(f,c,u)}(t,n,r)))}catch(o){throw Nn(o,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Yi(this._delegate,function(r,o){o===void 0&&(o="asc");var s=o,u=Bd("orderBy",r);return new AV(u,s)}(t,n)))}catch(r){throw Nn(r,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Yi(this._delegate,function(n){return jE("limit",n),new DE("limit",n,"F")}(t)))}catch(n){throw Nn(n,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Yi(this._delegate,function(n){return jE("limitToLast",n),new DE("limitToLast",n,"L")}(t)))}catch(n){throw Nn(n,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yi(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new ME("startAt",r,!0)}).apply(void 0,t)))}catch(r){throw Nn(r,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yi(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new ME("startAfter",r,!1)}).apply(void 0,t)))}catch(r){throw Nn(r,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yi(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new RE("endBefore",r,!0)}).apply(void 0,t)))}catch(r){throw Nn(r,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yi(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new RE("endAt",r,!1)}).apply(void 0,t)))}catch(r){throw Nn(r,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return JC(this._delegate,t._delegate)},e.prototype.get=function(t){var n=this;return((t==null?void 0:t.source)==="cache"?function(r){r=Ye(r,sr);var o=Ye(r.firestore,Bt),s=dn(o),u=new ps(o);return function(c,f){var p=this,m=new Kn;return c.asyncQueue.enqueueAndForget(function(){return W(p,void 0,void 0,function(){var y;return H(this,function(v){switch(v.label){case 0:return y=function(w,E,_){return W(this,void 0,void 0,function(){var C,b,N,x,j;return H(this,function(k){switch(k.label){case 0:return k.trys.push([0,2,,3]),[4,Pd(w,E,!0)];case 1:return j=k.sent(),C=new UC(E,j.Bn),b=C._o(j.documents),N=C.applyChanges(b,!1),_.resolve(N.snapshot),[3,3];case 2:return x=k.sent(),j=Eu(x,"Failed to execute query '"+E+" against cache"),_.reject(j),[3,3];case 3:return[2]}})})},[4,HC(c)];case 1:return[2,y.apply(void 0,[v.sent(),f,m])]}})})}),m.promise}(s,r._query).then(function(c){return new io(o,u,r,c)})}(this._delegate):(t==null?void 0:t.source)==="server"?function(r){r=Ye(r,sr);var o=Ye(r.firestore,Bt),s=dn(o),u=new ps(o);return _E(s,r._query,{source:"server"}).then(function(c){return new io(o,u,r,c)})}(this._delegate):function(r){r=Ye(r,sr);var o=Ye(r.firestore,Bt),s=dn(o),u=new ps(o);return lA(r._query),_E(s,r._query).then(function(c){return new io(o,u,r,c)})}(this._delegate)).then(function(r){return new x0(n.firestore,new io(n.firestore._delegate,n._userDataWriter,n._delegate,r._snapshot))})},e.prototype.onSnapshot=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=vA(n),s=yA(n,function(u){return new x0(t.firestore,new io(t.firestore._delegate,t._userDataWriter,t._delegate,u._snapshot))});return fA(this._delegate,o,s)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Pp.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(),PV=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new _c(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),x0=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"query",{get:function(){return new Up(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(n){return new _c(t._firestore,n)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var n=this;return this._delegate.docChanges(t).map(function(r){return new PV(n._firestore,r)})},e.prototype.forEach=function(t,n){var r=this;this._delegate.forEach(function(o){t.call(n,new _c(r._firestore,o))})},e.prototype.isEqual=function(t){return uA(this._delegate,t._delegate)},e}(),zd=function(e){function t(n,r){var o=this;return(o=e.call(this,n,r)||this).firestore=n,o._delegate=r,o}return be(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this._delegate.parent;return n?new ms(this.firestore,n):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(n){try{return new ms(this.firestore,n===void 0?Kf(this._delegate):Kf(this._delegate,n))}catch(r){throw Nn(r,"doc()","CollectionReference.doc()")}},t.prototype.add=function(n){var r=this;return function(o,s){var u=Ye(o.firestore,Bt),c=Kf(o),f=Op(o.converter,s);return Wc(u,[Rp(Fs(o.firestore),"addDoc",c._key,f,o.converter!==null,{}).toMutation(c._key,gn.exists(!1))]).then(function(){return c})}(this._delegate,n).then(function(o){return new ms(r.firestore,o)})},t.prototype.isEqual=function(n){return XC(this._delegate,n._delegate)},t.prototype.withConverter=function(n){return new t(this.firestore,n?this._delegate.withConverter(Pp.nu(this.firestore,n)):this._delegate.withConverter(null))},t}(Up);function cs(e){return Ye(e,gt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UV=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._delegate=new(ui.bind.apply(ui,_t([void 0],t)))}return e.documentId=function(){return new e(Kr.keyField().canonicalString())},e.prototype.isEqual=function(t){return(t=Pt(t))instanceof ui&&this._delegate._internalPath.isEqual(t._internalPath)},e}(),FV=function(){function e(t){this._delegate=t}return e.serverTimestamp=function(){var t=new _V("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Sx("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new NV("arrayUnion",o)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new EV("arrayRemove",o)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(r){return new IV("increment",r)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e}(),$V={Firestore:pA,GeoPoint:Mp,Timestamp:zn,Blob:dA,Transaction:mA,WriteBatch:gA,DocumentReference:ms,DocumentSnapshot:Sc,Query:Up,QueryDocumentSnapshot:_c,QuerySnapshot:x0,CollectionReference:zd,FieldPath:UV,FieldValue:FV,setLogLevel:LV,CACHE_SIZE_UNLIMITED:wV};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(e){(function(t,n){t.INTERNAL.registerComponent(new ap("firestore",function(r){var o=r.getProvider("app").getImmediate();return n(o,r.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},$V)))})(e,function(t,n){return new pA(t,new Bt(t,n),new OV)}),e.registerVersion("@firebase/firestore","2.4.1")}VV(de);const BV={apiKey:"   - `VITE_FIREBASE_API_KEY` = AIzaSyD7p6iK1b0lG7sGP187VU7tBlTZyGo1wBA\n   - `VITE_FIREBASE_AUTH_DOMAIN` = alsani-cockpit-v3.firebaseapp.com\n   - `VITE_FIREBASE_PROJECT_ID` = alsani-cockpit-v3\n   - `VITE_FIREBASE_STORAGE_BUCKET` = alsani-cockpit-v3.firebasestorage.app\n   - `VITE_FIREBASE_MESSAGING_SENDER_ID` = 1055161240393\n   - `VITE_FIREBASE_APP_ID` = 1:1055161240393:web:64428acfb48922fbc76898\n   - `VITE_GEMINI_API_KEY` = AIzaSyBJeuf5Ne_IsEvgKlxIfbsOS7Sm9Xjl4Ws\n",authDomain:"alsani-cockpit-v3.firebaseapp.com",projectId:"alsani-cockpit-v3",storageBucket:"alsani-cockpit-v3.firebasestorage.app",messagingSenderId:"1055161240393",appId:"1:1055161240393:web:64428acfb48922fbc76898"};console.log("🔍 Firebase Environment Variables:");console.log("API Key:","✅ Set from env");console.log("Auth Domain:","⚠️ Using fallback");console.log("Project ID:","⚠️ Using fallback");de.apps.length||de.initializeApp(BV);const Nc=de.auth(),Se=de.firestore(),zV=async e=>{try{const t=await Se.collection("users").doc(e).get();if(t.exists){const n=t.data();return(n==null?void 0:n.status)||null}return null}catch(t){return console.error("Error getting user status:",t),null}},qV=async e=>{const t=await zV(e);return t==="approved"||t==="active"},KV=()=>{const[e,t]=M.useState({user:null,profile:null,loading:!0,isApproved:!1});return M.useEffect(()=>{const n=Nc.onAuthStateChanged(async r=>{var o,s;if(r)try{let u=null;const f=await Se.collection("users").doc(r.uid).get();if(f.exists)u=f.data();else{const y=await Se.collection("users").where("uid","==",r.uid).limit(1).get();y.empty||(u=y.docs[0].data())}if(u){const p=await qV(r.uid);if(!p&&u.role==="admin"){console.log("Admin user without status field, auto-approving...");try{await Se.collection("users").doc(r.uid).update({status:"approved",approvedAt:de.firestore.FieldValue.serverTimestamp(),approvedBy:"system"}),t({user:r,profile:{...u,status:"approved"},loading:!1,isApproved:!0});return}catch(m){console.error("Error auto-approving admin:",m)}}if(t({user:r,profile:u,loading:!1,isApproved:p}),!p){console.log("User not approved, signing out..."),await Nc.signOut(),t({user:null,profile:null,loading:!1,isApproved:!1});return}}else{console.warn(`No profile document found for user with uid ${r.uid}. Falling back to default profile.`);const p={id:r.uid,name:r.displayName||((o=r.email)==null?void 0:o.split("@")[0])||"User",email:r.email||"",role:"employee"};t({user:r,profile:p,loading:!1,isApproved:!1})}}catch(u){console.error("Error fetching user profile:",u);const c={id:r.uid,name:r.displayName||((s=r.email)==null?void 0:s.split("@")[0])||"User",email:r.email||"",role:"employee"};t({user:r,profile:c,loading:!1,isApproved:!1})}else t({user:null,profile:null,loading:!1,isApproved:!1})});return()=>n()},[]),e},VE={en:{dashboard:"Dashboard",employees:"Employees",stores:"Stores",products:"Products",settings:"Settings",logout:"Logout",login:"Login",signup:"Sign Up",welcome:"Welcome",total_sales:"Total Sales",total_transactions:"Total Transactions",avg_transaction_value:"ATV",achievement:"Achievement",store:"Store",employee:"Employee",name:"Name",sales:"Sales",target:"Target",performance:"Performance",add_store:"Add Store",add_employee:"Add Employee",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",search:"Search",filter:"Filter",export:"Export",import:"Import",upload:"Upload",download:"Download",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",no_tasks:"You have no tasks or alerts.",smart_upload:"Smart Upload",lfl_comparison:"LFL Comparison",commissions:"Commissions",duvets:"Duvets",my_tasks_and_alerts:"My Tasks & Alerts",conversion_rate:"Conversion Rate",sales_per_visitor:"Sales Per Visitor",monthly_sales_performance:"Monthly Sales Performance",daily_sales_performance:"Daily Sales Performance",sales_by_store:"Sales by Store",greeting_evening:"Good evening",all_months:"All Months",all_days:"All Days",all_area_managers:"All Areas",all_stores:"All Stores",top_stores_by_achievement:"Top Stores by Achievement",top_employees_by_achievement:"Top Employees by Achievement",top_products_by_sales_value:"Top Products by Sales Value",dynamic_daily_target:"Dynamic Daily Target",ai_performance_review:"AI Performance Review",sales_by_product_category:"Sales by Product Category",daily_average_sales:"Daily Average Sales",monthly_average_sales:"Monthly Average Sales",user_management:"User Management",pending_approvals:"Pending Approvals",update_employees:"Update Employees",update_employees_desc:"Add linkedAccount field to all employees to activate new registration system",update_all_employees:"Update All Employees",updating:"Updating...",employees_updated_successfully:"Employees updated successfully",employees_already_updated:"All employees already updated",error_updating_employees:"Error updating employees",confirm_update_employees:"Are you sure you want to update all employees? This will add linkedAccount field for employees who don't have it.",role_statistics:"Role Statistics",manage_user_roles:"Manage User Roles",modify_roles_for_approved_users:"Modify roles for approved users",change_role:"Change Role",permissions_guide:"Permissions Guide",view_own_sales_only:"View own sales only",manage_branch_employees:"Manage branch employees and send tasks",edit_employee_targets:"Edit employee targets in their area",view_all_areas:"View all areas and edit targets",full_permissions:"Full permissions and complete control",manage_new_registration_requests:"Manage New Registration Requests",total_requests:"Total Requests",no_pending_requests:"No pending requests",all_requests_processed:"All requests have been processed",user_name:"User Name",current_role:"Current Role",undefined:"Undefined",approved:"Approved",pending:"Pending",role_updated_successfully:"Role updated successfully",failed_to_update_role:"Failed to update role",roles_guide:"Roles Guide",roles_guide_description:"This section allows you to assign roles",roles_guide_header:"دليل الصلاحيات — اختر الدور المناسب حسب مهام المستخدم.",roles_management:"Manage User Roles",modify_roles:"Modify roles for approved users",roles_description:"Choose the appropriate role for each user",role_updated:"Role updated successfully",role_failed:"Failed to update role",year:"Year",month:"Month",day:"Day",filter_mode:"Filter Mode",single_day:"Single Day",day_range:"Day Range",from_day:"From Day",to_day:"To Day",required_daily_avg_90:"Required Daily Avg (90%)",deleting:"Deleting...",delete_data_button:"Delete Data",no_users_found:"No Users Found",check_firebase_or_signup:"Check Firebase connection or sign up new users",total_users:"Total Users",please_sign_in:"Please sign in to continue",email_or_id:"Email or Employee ID",email_or_id_placeholder:"Enter email or employee ID",password:"Password",sign_in:"Sign In",signing_in:"Signing in...",sign_up:"Sign Up",sign_up_title:"Create Account",employee_id:"Employee ID",email:"Email",no_account:"Don't have an account?",sign_up_success:"Account created. Awaiting approval.",forgot_password:"Forgot your password?",welcome_back_title:"Welcome Back!",welcome_back_text:"To keep connected, please login with your personal info",hello_friend_title:"Hello, Friend!",hello_friend_text:"Enter your details and start your journey with us",sign_in_cta:"Sign In",sign_up_cta:"Sign Up",error_no_user_id:"No user found with this ID",error_no_user_email:"This user does not have an email",error_login_failed:"Login failed",create_your_account:"Create Your Account",confirm_password:"Confirm Password",already_have_account:"Already have an account?",passwords_do_not_match:"Passwords do not match"},ar:{dashboard:"لوحة التحكم",employees:"الموظفين",stores:"المعرض",products:"المنتجات",settings:"الإعدادات",logout:"تسجيل الخروج",login:"تسجيل الدخول",signup:"إنشاء حساب",welcome:"مرحباً",total_sales:"إجمالي المبيعات",total_transactions:"إجمالي المعاملات",avg_transaction_value:"ATV",achievement:"الإنجاز",store:"المعرض",employee:"الموظف",name:"الاسم",sales:"المبيعات",target:"الهدف",performance:"الأداء",add_store:"إضافة معرض",add_employee:"إضافة موظف",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",upload:"رفع",download:"تحميل",loading:"جاري التحميل...",error:"خطأ",success:"نجح",warning:"تحذير",info:"معلومات",no_tasks:"ليس لديك مهام أو تنبيهات.",smart_upload:"الرفع الذكي",lfl_comparison:"مقارنة LFL",commissions:"العمولات",duvets:"الألحفة",my_tasks_and_alerts:"مهامي وتنبيهاتي",conversion_rate:"معدل التحويل",sales_per_visitor:"مبيعات كل زائر",monthly_sales_performance:"أداء المبيعات الشهري",daily_sales_performance:"أداء المبيعات اليومي",sales_by_store:"المبيعات حسب المعرض",greeting_evening:"مساء الخير",all_months:"كل الشهور",all_days:"كل الأيام",all_area_managers:"كل المناطق",all_stores:"كل المعارض",top_stores_by_achievement:"أفضل المعارض حسب الإنجاز",top_employees_by_achievement:"أفضل الموظفين حسب الإنجاز",top_products_by_sales_value:"أفضل المنتجات حسب قيمة المبيعات",dynamic_daily_target:"الهدف اليومي الديناميكي",ai_performance_review:"مراجعة الأداء بالذكاء الاصطناعي",sales_by_product_category:"المبيعات حسب فئة المنتج",daily_average_sales:"معدل البيع اليومي",monthly_average_sales:"معدل البيع الشهري",user_management:"إدارة المستخدمين",pending_approvals:"الطلبات المعلقة",update_employees:"تحديث بيانات الموظفين",update_employees_desc:"إضافة حقل linkedAccount لجميع الموظفين لتفعيل نظام التسجيل الجديد",update_all_employees:"تحديث جميع الموظفين",updating:"جاري التحديث...",employees_updated_successfully:"تم تحديث الموظفين بنجاح",employees_already_updated:"جميع الموظفين محدثين مسبقاً",error_updating_employees:"خطأ في تحديث الموظفين",confirm_update_employees:"هل أنت متأكد من تحديث جميع الموظفين؟ سيتم إضافة حقل linkedAccount للموظفين الذين لا يملكونه.",role_statistics:"إحصائيات الأدوار",manage_user_roles:"إدارة أدوار المستخدمين",modify_roles_for_approved_users:"تعديل أدوار المستخدمين المعتمدين",change_role:"تغيير الدور",permissions_guide:"دليل الصلاحيات",view_own_sales_only:"عرض مبيعاته الشخصية فقط",manage_branch_employees:"إدارة موظفي فرعه وإرسال مهام",edit_employee_targets:"تعديل أهداف الموظفين في منطقته",view_all_areas:"عرض كل المناطق وتعديل الأهداف",full_permissions:"جميع الصلاحيات والتحكم الكامل",manage_new_registration_requests:"إدارة طلبات التسجيل الجديدة",total_requests:"إجمالي الطلبات",no_pending_requests:"لا توجد طلبات معلقة",all_requests_processed:"جميع الطلبات تمت معالجتها",user_name:"اسم المستخدم",current_role:"الدور الحالي",undefined:"غير محدد",approved:"معتمد",pending:"معلق",role_updated_successfully:"تم تحديث الصلاحية بنجاح",failed_to_update_role:"فشل في تحديث الصلاحية",roles_guide:"دليل الصلاحيات",roles_guide_description:"يمكنك هنا تعيين الصلاحيات لكل مستخدم",roles_guide_header:"دليل الصلاحيات — اختر الدور المناسب حسب مهام المستخدم.",roles_management:"إدارة صلاحيات المستخدمين",modify_roles:"تعديل صلاحيات المستخدمين الموافق عليهم",roles_description:"اختر الدور المناسب لكل مستخدم حسب مهامه",role_updated:"تم تحديث الصلاحية بنجاح",role_failed:"فشل في تحديث الصلاحية",year:"السنة",month:"الشهر",day:"اليوم",filter_mode:"نوع التصفية",single_day:"يوم واحد",day_range:"نطاق أيام",from_day:"من يوم",to_day:"إلى يوم",required_daily_avg_90:"المتوسط اليومي المطلوب (90%)",deleting:"جاري الحذف...",delete_data_button:"حذف البيانات",no_users_found:"لا يوجد مستخدمين",check_firebase_or_signup:"تحقق من اتصال Firebase أو سجل مستخدمين جدد",total_users:"إجمالي المستخدمين",please_sign_in:"يرجى تسجيل الدخول للمتابعة",email_or_id:"البريد الإلكتروني أو رقم الموظف",email_or_id_placeholder:"أدخل البريد الإلكتروني أو رقم الموظف",password:"كلمة المرور",sign_in:"تسجيل الدخول",signing_in:"جاري تسجيل الدخول...",sign_up:"إنشاء حساب",sign_up_title:"إنشاء حساب جديد",employee_id:"رقم الموظف",email:"البريد الإلكتروني",no_account:"ليس لديك حساب؟",sign_up_success:"تم إنشاء الحساب. بانتظار الموافقة.",forgot_password:"نسيت كلمة المرور؟",welcome_back_title:"مرحباً بعودتك!",welcome_back_text:"للبقاء على اتصال، سجل دخولك بمعلوماتك الشخصية",hello_friend_title:"مرحباً صديقنا!",hello_friend_text:"أدخل بياناتك وابدأ رحلتك معنا",sign_in_cta:"تسجيل الدخول",sign_up_cta:"إنشاء حساب",error_no_user_id:"لا يوجد مستخدم بهذا الرقم",error_no_user_email:"هذا المستخدم لا يملك بريد إلكتروني",error_login_failed:"فشل تسجيل الدخول",create_your_account:"أنشئ حسابك",confirm_password:"تأكيد كلمة المرور",already_have_account:"لديك حساب بالفعل؟",passwords_do_not_match:"كلمتا المرور غير متطابقتين"}},wA=M.createContext({locale:"en",setLocale:()=>{},t:e=>e}),HV=({children:e})=>{const[t,n]=M.useState(()=>{const s=navigator.language.startsWith("ar")?"ar":"en";return localStorage.getItem("locale")||s});M.useEffect(()=>{localStorage.setItem("locale",t)},[t]);const r=s=>{n(s)},o=M.useCallback((s,u)=>{var f,p;let c=((f=VE[t])==null?void 0:f[s])||((p=VE.ar)==null?void 0:p[s])||s;return u&&Object.keys(u).forEach(m=>{c=c.replace(`{{${m}}}`,String(u[m]))}),c},[t]);return h.jsx(wA.Provider,{value:{locale:t,setLocale:r,t:o},children:e})},Oe=()=>M.useContext(wA);function _f(e){if(!e)return null;if(typeof e=="number"){const o=new Date(Date.UTC(1899,11,30));return new Date(o.getTime()+e*86400*1e3).toISOString().split("T")[0]}const t=String(e);if(/^\d{4}-\d{2}-\d{2}/.test(t))return t.substring(0,10);const n=t.split(/[\/\-.]/);if(n.length===3){let[o,s,u]=n;if(u&&u.length===2&&(u="20"+u),o&&s&&u&&u.length===4)return`${u}-${s.padStart(2,"0")}-${o.padStart(2,"0")}`}const r=new Date(t);return isNaN(r.getTime())?null:r.toISOString().split("T")[0]}const qd=e=>{const t=(e.name||"").toLowerCase(),n=String(e.alias||"");return n.startsWith("4")?"Duvets":n.startsWith("2")?"Duvets Full":t.includes("mattresspad")||t.includes("matresspad")?"Toppers":t.includes("pillow")&&!t.includes("case")?"Pillows":"Other"},gs=(e,t)=>{if(!e||!t)return 0;const{year:n,month:r,day:o}=t;if(n==="all")return 0;const s=String(n),u=String(r==="all"?"all":r+1),c=e[s];if(r==="all")return c&&typeof c=="object"?Object.values(c).reduce((m,y)=>m+(Number(y)||0),0):0;const f=c&&typeof c=="object"&&Number(c[u])||0;if(o==="all")return f;const p=new Date(n,r+1,0).getDate();return p>0?f/p:0},wr=e=>{if(e==null)return 0;const t=Number(String(e).replace(/,/g,""));return isNaN(t)?0:t},GV=e=>e>=199&&e<=399?"Low Value (199-399)":e>=495&&e<=695?"Medium Value (495-695)":e>=795&&e<=999?"High Value (795-999)":null,WV=e=>e>=100?.02:e>=90?.01:e>=80?.005:0,Nf=(e,t)=>{if(e.assignments&&t.year!=="all"&&t.month!=="all"){const n=`${t.year}-${String(t.month+1).padStart(2,"0")}`;if(e.assignments[n])return e.assignments[n]}return e.currentStore},YV=({stores:e,employees:t,dailyMetrics:n,kingDuvetSales:r,salesTransactions:o,dateFilter:s,areaStoreFilter:u,profile:c})=>{const f=M.useMemo(()=>t.filter(x=>x.status!=="inactive"),[t]),p=M.useMemo(()=>{var O;if(!c)return{stores:[],employees:[],dailyMetrics:[],kingDuvetSales:[],salesTransactions:[]};const{role:x}=c,j=t.find(R=>c.employeeId&&R.employeeId===c.employeeId||R.userId&&R.userId===c.id||R.userEmail&&R.userEmail===c.email),k=c.store||(j==null?void 0:j.currentStore)||"",A=c.areaManager||((O=e.find(R=>R.name===k))==null?void 0:O.areaManager)||c.areaManager||"";if(x==="admin"||x==="general_manager")return{stores:e,employees:f,dailyMetrics:n,kingDuvetSales:r,salesTransactions:o};let T;if(x==="area_manager")T=e.filter(R=>R.areaManager===A);else if(x==="store_manager"){const R=e.find(X=>X.name===k);T=R?e.filter(X=>X.areaManager===R.areaManager):[]}else T=e.filter(R=>R.name===k);const L=new Set(T.map(R=>R.name));let U;x==="employee"?U=f.filter(R=>R.currentStore===k):x==="store_manager"?U=f.filter(R=>R.currentStore===k):U=f.filter(R=>L.has(Nf(R,s)));const K=R=>L.has(R.store),$=R=>L.has(R["Outlet Name"]);return{stores:T,employees:U,dailyMetrics:n.filter(K),kingDuvetSales:r.filter($),salesTransactions:o.filter($)}},[c,e,f,n,r,o,s]),m=M.useMemo(()=>{const x=T=>{const L="date"in T?T.date:T["Bill Dt."];if(!L||typeof L.toDate!="function")return!1;const U=L.toDate(),K=s.year==="all"||U.getUTCFullYear()===s.year,$=s.month==="all"||U.getUTCMonth()===s.month,O=s.mode??"single";if(!K||!$)return K&&$;if(O==="range"&&s.month!=="all"&&s.year!=="all"){const R=s.dayFrom===void 0?"all":s.dayFrom,X=s.dayTo===void 0?"all":s.dayTo,q=U.getUTCDate();if(R==="all"&&X==="all")return!0;if(R==="all"&&typeof X=="number")return q<=X;if(typeof R=="number"&&X==="all")return q>=R;if(typeof R=="number"&&typeof X=="number"){const J=Math.min(R,X),V=Math.max(R,X);return q>=J&&q<=V}return!0}else{const R=s.day==="all"||U.getUTCDate()===s.day;return K&&$&&R}},k=[...p.salesTransactions,...p.kingDuvetSales].filter(x),A=k.filter(T=>{const L=T["Item Alias"]||"",U=T["Item Name"]||"";return String(L).startsWith("4")&&U.toUpperCase().includes("COMFORTER")});return{metrics:p.dailyMetrics.filter(x),sales:k,duvetSales:A}},[p,s]),y=M.useMemo(()=>{const x=p.stores.filter(A=>(u.areaManager==="All"||A.areaManager===u.areaManager)&&(u.store==="All"||A.name===u.store)),j=new Set(x.map(A=>A.name));let k=p.employees.filter(A=>j.has(Nf(A,s)));if((c==null?void 0:c.role)==="store_manager"){const A=t.find(L=>c.employeeId&&L.employeeId===c.employeeId||L.userId&&L.userId===c.id||L.userEmail&&L.userEmail===c.email),T=c.store||(A==null?void 0:A.currentStore)||"";k=p.employees.filter(L=>Nf(L,s)===T)}return{stores:x,employees:k,metrics:m.metrics.filter(A=>j.has(A.store)),sales:m.sales.filter(A=>j.has(A["Outlet Name"])),duvetSales:m.duvetSales.filter(A=>j.has(A["Outlet Name"]))}},[p,m,u,s]),v=M.useMemo(()=>y.stores.map(x=>{const j=y.metrics.filter(U=>U.store===x.name),k=j.reduce((U,K)=>U+(K.totalSales||0),0),A=j.reduce((U,K)=>U+(K.visitors||0),0),T=j.reduce((U,K)=>U+(K.transactionCount||0),0),L=gs(x.targets,s);return{...x,totalSales:k,transactionCount:T,visitors:A,atv:T>0?k/T:0,visitorRate:A>0?T/A*100:0,effectiveTarget:L,targetAchievement:L>0?k/L*100:0,salesPerVisitor:A>0?k/A:0}}),[y.stores,y.metrics,s]),w=M.useMemo(()=>{const x={};y.employees.forEach(k=>{const A=Nf(k,s);if(!y.stores.some($=>$.name===A))return;const T=y.metrics.filter($=>$.employeeId===k.employeeId||$.employee===k.name),L=T.reduce(($,O)=>$+(O.totalSales||0),0),U=T.reduce(($,O)=>$+(O.transactionCount||0),0),K=gs(k.targets,s);x[A]||(x[A]=[]),x[A].push({...k,store:A,totalSales:L,totalTransactions:U,atv:U>0?L/U:0,effectiveTarget:K,achievement:K>0?L/K*100:0})});const j=new Set;return y.sales.forEach(k=>{var T;const A=k["SalesMan Name"];if(A&&!j.has(A)&&(j.add(A),!Object.values(x).some(U=>U.some(K=>K.name===A)))){const U=y.sales.filter(R=>R["SalesMan Name"]===A),K=U.reduce((R,X)=>R+(X["Net Amount"]||0),0),$=U.length,O=((T=U[0])==null?void 0:T["Outlet Name"])||"Unknown Store";x[O]||(x[O]=[]),x[O].push({id:A.replace(/\s+/g,"_"),name:A,currentStore:O,store:O,totalSales:K,totalTransactions:$,atv:$>0?K/$:0,effectiveTarget:0,achievement:0,status:"active",employeeId:null})}}),x},[y.employees,y.metrics,y.stores,y.sales,s]),E=M.useMemo(()=>{const x=new Map;return y.sales.forEach(j=>{const k=j["Item Alias"],A=j["Sold Qty"]||0,T=j["Item Rate"]||0,L=x.get(k)||{id:k,name:j["Item Name"],alias:k,price:T,soldQty:0,totalValue:0};L.soldQty+=A,L.totalValue+=A*T,x.set(k,L)}),Array.from(x.values()).sort((j,k)=>k.totalValue-j.totalValue)},[y.sales]),_=M.useMemo(()=>y.duvetSales.reduce((x,j)=>{const k=j["Outlet Name"],A=GV(j["Item Rate"]);return A&&(x[k]||(x[k]={name:k,"Low Value (199-399)":0,"Medium Value (495-695)":0,"High Value (795-999)":0,total:0}),x[k][A]+=j["Sold Qty"],x[k].total+=j["Sold Qty"]),x},{}),[y.duvetSales]),C=M.useMemo(()=>{const x={};return Object.values(w).flat().forEach(k=>{const A=v.find(L=>L.name===k.store);if(!A)return;x[A.name]||(x[A.name]={name:A.name,achievement:A.targetAchievement,commissionRate:WV(A.targetAchievement)*100,employees:[]});const T=x[A.name].commissionRate/100*(k.achievement/100);x[A.name].employees.push({...k,finalCommissionRate:T*100,commissionAmount:k.totalSales*T})}),Object.values(x)},[v,w]),b=M.useMemo(()=>{const x=v.reduce((A,T)=>A+T.totalSales,0),j=v.reduce((A,T)=>A+T.transactionCount,0),k=v.reduce((A,T)=>A+T.visitors,0);return{totalSales:x,totalTransactions:j,averageTransactionValue:j>0?x/j:0,conversionRate:k>0?j/k*100:0,salesPerVisitor:k>0?x/k:0}},[v]),N=M.useMemo(()=>{const{year:x,month:j}=s;if(x==="all")return[];if(j!=="all"){const T=new Date(x,j+1,0).getDate(),L=Array.from({length:T},($,O)=>({name:`${O+1}`,Sales:0,Target:0}));let U=0;y.stores.forEach($=>{U+=gs($.targets,{year:x,month:j,day:"all"})});const K=T>0?U/T:0;return L.forEach($=>$.Target=K),y.metrics.forEach($=>{if(!$.date||typeof $.date.toDate!="function")return;const O=$.date.toDate();if(O.getUTCFullYear()===x&&O.getUTCMonth()===j){const R=O.getUTCDate()-1;R>=0&&R<T&&(L[R].Sales+=$.totalSales||0)}}),L}const k={};for(let T=0;T<12;T++)k[T]={sales:0,target:0};y.metrics.forEach(T=>{if(!T.date||typeof T.date.toDate!="function")return;const L=T.date.toDate();if(L.getUTCFullYear()===x){const U=L.getUTCMonth();k[U].sales+=T.totalSales||0}}),y.stores.forEach(T=>{var U;const L=(U=T.targets)==null?void 0:U[x];if(L)for(const K in L){const $=parseInt(K,10)-1;!isNaN($)&&$>=0&&$<12&&(k[$].target+=L[K]||0)}});const A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return Array.from({length:12}).map((T,L)=>({name:A[L],Sales:k[L].sales,Target:k[L].target}))},[y.metrics,y.stores,s]);return{kpiData:b,storeSummary:v,employeeSummary:w,productSummary:E,duvetSummary:_,commissionData:C,salesPerformance:N}};var BE;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(BE||(BE={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zE;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(zE||(zE={}));var qE;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(qE||(qE={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=["user","model","function","system"];var HE;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(HE||(HE={}));var GE;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(GE||(GE={}));var WE;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(WE||(WE={}));var YE;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(YE||(YE={}));var Vl;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(Vl||(Vl={}));var QE;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(QE||(QE={}));var XE;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(XE||(XE={}));var JE;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(JE||(JE={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class va extends mn{constructor(t,n){super(t),this.response=n}}class xA extends mn{constructor(t,n,r,o){super(t),this.status=n,this.statusText=r,this.errorDetails=o}}class wo extends mn{}class bA extends mn{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV="https://generativelanguage.googleapis.com",XV="v1beta",JV="0.24.1",ZV="genai-js";var Cs;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Cs||(Cs={}));class e6{constructor(t,n,r,o,s){this.model=t,this.task=n,this.apiKey=r,this.stream=o,this.requestOptions=s}toString(){var t,n;const r=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||XV;let s=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||QV}/${r}/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}function t6(e){const t=[];return e!=null&&e.apiClient&&t.push(e.apiClient),t.push(`${ZV}/${JV}`),t.join(" ")}async function n6(e){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",t6(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let r=(t=e.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(o){throw new wo(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${o.message}`)}for(const[o,s]of r.entries()){if(o==="x-goog-api-key")throw new wo(`Cannot set reserved header name ${o}`);if(o==="x-goog-api-client")throw new wo(`Header name ${o} can only be set using the apiClient field`);n.append(o,s)}}return n}async function r6(e,t,n,r,o,s){const u=new e6(e,t,n,r,s);return{url:u.toString(),fetchOptions:Object.assign(Object.assign({},a6(s)),{method:"POST",headers:await n6(u),body:o})}}async function Yc(e,t,n,r,o,s={},u=fetch){const{url:c,fetchOptions:f}=await r6(e,t,n,r,o,s);return i6(c,f,u)}async function i6(e,t,n=fetch){let r;try{r=await n(e,t)}catch(o){o6(o,e)}return r.ok||await s6(r,e),r}function o6(e,t){let n=e;throw n.name==="AbortError"?(n=new bA(`Request aborted when fetching ${t.toString()}: ${e.message}`),n.stack=e.stack):e instanceof xA||e instanceof wo||(n=new mn(`Error fetching from ${t.toString()}: ${e.message}`),n.stack=e.stack),n}async function s6(e,t){let n="",r;try{const o=await e.json();n=o.error.message,o.error.details&&(n+=` ${JSON.stringify(o.error.details)}`,r=o.error.details)}catch{}throw new xA(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,r)}function a6(e){const t={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const n=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Hf(e.candidates[0]))throw new va(`${Zi(e)}`,e);return u6(e)}else if(e.promptFeedback)throw new va(`Text not available. ${Zi(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Hf(e.candidates[0]))throw new va(`${Zi(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),ZE(e)[0]}else if(e.promptFeedback)throw new va(`Function call not available. ${Zi(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Hf(e.candidates[0]))throw new va(`${Zi(e)}`,e);return ZE(e)}else if(e.promptFeedback)throw new va(`Function call not available. ${Zi(e)}`,e)},e}function u6(e){var t,n,r,o;const s=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const u of(o=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||o===void 0?void 0:o.parts)u.text&&s.push(u.text),u.executableCode&&s.push("\n```"+u.executableCode.language+`
`+u.executableCode.code+"\n```\n"),u.codeExecutionResult&&s.push("\n```\n"+u.codeExecutionResult.output+"\n```\n");return s.length>0?s.join(""):""}function ZE(e){var t,n,r,o;const s=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const u of(o=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||o===void 0?void 0:o.parts)u.functionCall&&s.push(u.functionCall);if(s.length>0)return s}const l6=[Vl.RECITATION,Vl.SAFETY,Vl.LANGUAGE];function Hf(e){return!!e.finishReason&&l6.includes(e.finishReason)}function Zi(e){var t,n,r;let o="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)o+="Response was blocked",!((t=e.promptFeedback)===null||t===void 0)&&t.blockReason&&(o+=` due to ${e.promptFeedback.blockReason}`),!((n=e.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(o+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((r=e.candidates)===null||r===void 0)&&r[0]){const s=e.candidates[0];Hf(s)&&(o+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(o+=`: ${s.finishMessage}`))}return o}function Ec(e){return this instanceof Ec?(this.v=e,this):new Ec(e)}function c6(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),o,s=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(v){r[v]&&(o[v]=function(w){return new Promise(function(E,_){s.push([v,w,E,_])>1||c(v,w)})})}function c(v,w){try{f(r[v](w))}catch(E){y(s[0][3],E)}}function f(v){v.value instanceof Ec?Promise.resolve(v.value.v).then(p,m):y(s[0][2],v)}function p(v){c("next",v)}function m(v){c("throw",v)}function y(v,w){v(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function h6(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=p6(t),[r,o]=n.tee();return{stream:d6(r),response:f6(o)}}async function f6(e){const t=[],n=e.getReader();for(;;){const{done:r,value:o}=await n.read();if(r)return jx(m6(t));t.push(o)}}function d6(e){return c6(this,arguments,function*(){const n=e.getReader();for(;;){const{value:r,done:o}=yield Ec(n.read());if(o)break;yield yield Ec(jx(r))}})}function p6(e){const t=e.getReader();return new ReadableStream({start(r){let o="";return s();function s(){return t.read().then(({value:u,done:c})=>{if(c){if(o.trim()){r.error(new mn("Failed to parse stream"));return}r.close();return}o+=u;let f=o.match(eI),p;for(;f;){try{p=JSON.parse(f[1])}catch{r.error(new mn(`Error parsing JSON response: "${f[1]}"`));return}r.enqueue(p),o=o.substring(f[0].length),f=o.match(eI)}return s()}).catch(u=>{let c=u;throw c.stack=u.stack,c.name==="AbortError"?c=new bA("Request aborted when reading from the stream"):c=new mn("Error reading from the stream"),c})}}})}function m6(e){const t=e[e.length-1],n={promptFeedback:t==null?void 0:t.promptFeedback};for(const r of e){if(r.candidates){let o=0;for(const s of r.candidates)if(n.candidates||(n.candidates=[]),n.candidates[o]||(n.candidates[o]={index:o}),n.candidates[o].citationMetadata=s.citationMetadata,n.candidates[o].groundingMetadata=s.groundingMetadata,n.candidates[o].finishReason=s.finishReason,n.candidates[o].finishMessage=s.finishMessage,n.candidates[o].safetyRatings=s.safetyRatings,s.content&&s.content.parts){n.candidates[o].content||(n.candidates[o].content={role:s.content.role||"user",parts:[]});const u={};for(const c of s.content.parts)c.text&&(u.text=c.text),c.functionCall&&(u.functionCall=c.functionCall),c.executableCode&&(u.executableCode=c.executableCode),c.codeExecutionResult&&(u.codeExecutionResult=c.codeExecutionResult),Object.keys(u).length===0&&(u.text=""),n.candidates[o].content.parts.push(u)}o++}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SA(e,t,n,r){const o=await Yc(t,Cs.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),r);return h6(o)}async function _A(e,t,n,r){const s=await(await Yc(t,Cs.GENERATE_CONTENT,e,!1,JSON.stringify(n),r)).json();return{response:jx(s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function Ic(e){let t=[];if(typeof e=="string")t=[{text:e}];else for(const n of e)typeof n=="string"?t.push({text:n}):t.push(n);return g6(t)}function g6(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,o=!1;for(const s of e)"functionResponse"in s?(n.parts.push(s),o=!0):(t.parts.push(s),r=!0);if(r&&o)throw new mn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!o)throw new mn("No content is provided for sending chat message.");return r?t:n}function v6(e,t){var n;let r={model:t==null?void 0:t.model,generationConfig:t==null?void 0:t.generationConfig,safetySettings:t==null?void 0:t.safetySettings,tools:t==null?void 0:t.tools,toolConfig:t==null?void 0:t.toolConfig,systemInstruction:t==null?void 0:t.systemInstruction,cachedContent:(n=t==null?void 0:t.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const o=e.generateContentRequest!=null;if(e.contents){if(o)throw new wo("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=e.contents}else if(o)r=Object.assign(Object.assign({},r),e.generateContentRequest);else{const s=Ic(e);r.contents=[s]}return{generateContentRequest:r}}function tI(e){let t;return e.contents?t=e:t={contents:[Ic(e)]},e.systemInstruction&&(t.systemInstruction=NA(e.systemInstruction)),t}function y6(e){return typeof e=="string"||Array.isArray(e)?{content:Ic(e)}:e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],w6={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function x6(e){let t=!1;for(const n of e){const{role:r,parts:o}=n;if(!t&&r!=="user")throw new mn(`First content should be with role 'user', got ${r}`);if(!KE.includes(r))throw new mn(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(KE)}`);if(!Array.isArray(o))throw new mn("Content should have 'parts' property with an array of Parts");if(o.length===0)throw new mn("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of o)for(const f of nI)f in c&&(s[f]+=1);const u=w6[r];for(const c of nI)if(!u.includes(c)&&s[c]>0)throw new mn(`Content with role '${r}' can't contain '${c}' part`);t=!0}}function rI(e){var t;if(e.candidates===void 0||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const r of n.parts)if(r===void 0||Object.keys(r).length===0||r.text!==void 0&&r.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="SILENT_ERROR";class b6{constructor(t,n,r,o={}){this.model=n,this.params=r,this._requestOptions=o,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,r!=null&&r.history&&(x6(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,n={}){var r,o,s,u,c,f;await this._sendPromise;const p=Ic(t),m={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(o=this.params)===null||o===void 0?void 0:o.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(u=this.params)===null||u===void 0?void 0:u.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,p]},y=Object.assign(Object.assign({},this._requestOptions),n);let v;return this._sendPromise=this._sendPromise.then(()=>_A(this._apiKey,this.model,m,y)).then(w=>{var E;if(rI(w.response)){this._history.push(p);const _=Object.assign({parts:[],role:"model"},(E=w.response.candidates)===null||E===void 0?void 0:E[0].content);this._history.push(_)}else{const _=Zi(w.response);_&&console.warn(`sendMessage() was unsuccessful. ${_}. Inspect response object for details.`)}v=w}).catch(w=>{throw this._sendPromise=Promise.resolve(),w}),await this._sendPromise,v}async sendMessageStream(t,n={}){var r,o,s,u,c,f;await this._sendPromise;const p=Ic(t),m={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(o=this.params)===null||o===void 0?void 0:o.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(u=this.params)===null||u===void 0?void 0:u.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,p]},y=Object.assign(Object.assign({},this._requestOptions),n),v=SA(this._apiKey,this.model,m,y);return this._sendPromise=this._sendPromise.then(()=>v).catch(w=>{throw new Error(iI)}).then(w=>w.response).then(w=>{if(rI(w)){this._history.push(p);const E=Object.assign({},w.candidates[0].content);E.role||(E.role="model"),this._history.push(E)}else{const E=Zi(w);E&&console.warn(`sendMessageStream() was unsuccessful. ${E}. Inspect response object for details.`)}}).catch(w=>{w.message!==iI&&console.error(w)}),v}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S6(e,t,n,r){return(await Yc(t,Cs.COUNT_TOKENS,e,!1,JSON.stringify(n),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _6(e,t,n,r){return(await Yc(t,Cs.EMBED_CONTENT,e,!1,JSON.stringify(n),r)).json()}async function N6(e,t,n,r){const o=n.requests.map(u=>Object.assign(Object.assign({},u),{model:t}));return(await Yc(t,Cs.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:o}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(t,n,r={}){this.apiKey=t,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=NA(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(t,n={}){var r;const o=tI(t),s=Object.assign(Object.assign({},this._requestOptions),n);return _A(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},o),s)}async generateContentStream(t,n={}){var r;const o=tI(t),s=Object.assign(Object.assign({},this._requestOptions),n);return SA(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},o),s)}startChat(t){var n;return new b6(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},t),this._requestOptions)}async countTokens(t,n={}){const r=v6(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),o=Object.assign(Object.assign({},this._requestOptions),n);return S6(this.apiKey,this.model,r,o)}async embedContent(t,n={}){const r=y6(t),o=Object.assign(Object.assign({},this._requestOptions),n);return _6(this.apiKey,this.model,r,o)}async batchEmbedContents(t,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return N6(this.apiKey,this.model,t,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(t){this.apiKey=t}getGenerativeModel(t,n){if(!t.model)throw new mn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new oI(this.apiKey,t,n)}getGenerativeModelFromCachedContent(t,n,r){if(!t.name)throw new wo("Cached content must contain a `name` field.");if(!t.model)throw new wo("Cached content must contain a `model` field.");const o=["model","systemInstruction"];for(const u of o)if(n!=null&&n[u]&&t[u]&&(n==null?void 0:n[u])!==t[u]){if(u==="model"){const c=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,f=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(c===f)continue}throw new wo(`Different value for "${u}" specified in modelParams (${n[u]}) and cachedContent (${t[u]})`)}const s=Object.assign(Object.assign({},n),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new oI(this.apiKey,s,r)}}const I6="AIzaSyBJeuf5Ne_IsEvgKlxIfbsOS7Sm9Xjl4Ws";console.log("🔍 Gemini API Key:","⚠️ Using fallback");const T6=new E6(I6),j6=(e,t=5e3)=>{let n=JSON.stringify(e);if(n.length>t){if(Array.isArray(e)){const r={type:"array",length:e.length,sample:e.slice(0,3),summary:`Array with ${e.length} items`};n=JSON.stringify(r)}else if(typeof e=="object"){const r={name:e.name||"Unknown",type:typeof e,keys:Object.keys(e).slice(0,10)};n=JSON.stringify(r)}}return n},b0=async(e,t,n,r=3)=>{var u,c;let o=0,s=1e3;for(;o<r;)try{console.log(`🔍 Gemini API call attempt ${o+1}/${r} with model: ${e}`);const f=T6.getGenerativeModel({model:e});let p;typeof t=="string"?n?p=await f.generateContent({contents:[{role:"user",parts:[{text:t}]}],generationConfig:n}):p=await f.generateContent(t):p=await f.generateContent({contents:t.contents,systemInstruction:t.systemInstruction,generationConfig:t.generationConfig});const m=await p.response;return console.log("✅ Gemini API call successful"),m}catch(f){if(console.error(`❌ Gemini API call failed on attempt ${o+1}:`,{error:f.message,status:f.status||"Unknown",details:f.details||"No additional details"}),f.status===400&&((u=f.message)!=null&&u.includes("token")||(c=f.message)!=null&&c.includes("maximum number of tokens")))throw console.error("❌ Token limit exceeded. Data too large for Gemini API."),new Error("Data size exceeds Gemini API limits. Please reduce the amount of data being analyzed.");if(o>=r-1)throw new Error(`AI analysis failed after ${r} retries. Last error: ${f.message}`);f.status===429?(console.log(`🔄 Rate limit hit, waiting ${s}ms before retry...`),await new Promise(p=>setTimeout(p,s)),s*=2):console.log(`🔄 Retrying in ${s}ms...`),await new Promise(p=>setTimeout(p,s)),s*=2,o++}throw new Error("AI analysis failed after multiple retries.")},hi=async(e,t="gemini-2.5-flash",n=3)=>{var f;if(typeof e=="string")return(await b0(t,e,void 0,n)).text();const r=e.model||t,o=e.systemInstruction||((f=e.config)==null?void 0:f.systemInstruction),s=e.generationConfig||(e.config?Object.fromEntries(Object.entries(e.config).filter(([p])=>p!=="systemInstruction")):void 0),u={contents:e.contents,systemInstruction:o,generationConfig:s};return(await b0(r,u,void 0,n)).text()},k6=async(e,t,n)=>{const r=new Date,o=r.getMonth(),s=r.getFullYear(),u=t.filter(v=>{if(!v.date||typeof v.date.toDate!="function")return!1;const w=v.date.toDate();return w.getMonth()===o&&w.getFullYear()===s}).map(v=>({date:v.date.toDate().toISOString().split("T")[0],sales:v.totalSales||0})),c=n==="ar"?"IMPORTANT: The justification must be in Arabic.":"",f=`You are a predictive retail analyst. Your task is to forecast month-end sales for a store and assess its risk of missing its target.

Store Name: ${e.name}
Monthly Sales Target: ${e.effectiveTarget.toFixed(2)} SAR
Current Sales Data (This Month So Far): ${j6(u,2e3)}

Based ONLY on this data, provide a JSON object with your analysis.
1.  **predictedSales**: Your realistic forecast for total sales by the end of the month.
2.  **riskScore**: An integer from 0 (no risk) to 100 (certain to miss target). A score > 60 is high risk.
3.  **justification**: A brief, one-sentence explanation for your risk score. ${c}`,y=(await b0("gemini-2.5-flash",f,{responseMimeType:"application/json",responseSchema:{type:"object",properties:{predictedSales:{type:"number",description:"Forecasted total sales for the month."},riskScore:{type:"number",description:"Risk of missing target (0-100)."},justification:{type:"string",description:"Brief reason for the risk score."}},required:["predictedSales","riskScore","justification"]}})).text().trim();try{return JSON.parse(y)}catch(v){throw console.error("❌ Failed to parse JSON response:",y),new Error(`Failed to parse AI response as JSON: ${v}`)}},{Timestamp:Ef}=de.firestore,C6=(e,t,n,r,o)=>{const[s,u]=M.useState(null),c=()=>u(null),f=v=>v.toLowerCase().trim().replace(/[\s_.-]+/g,""),p=v=>{if(!v)return null;const w=String(v).trim();let E=w.match(/^(\d{3,4})\b/);return E||(E=w.match(/unknown[\s_\-]*(\d{3,4})/i),E)||(E=w.match(/(\d{3,4})\s*$/),E)?E[1]:null},m=(v,w)=>{const E={};for(const _ in v)E[f(_)]=_;for(const _ of w){if(!_)continue;const C=f(String(_)),b=E[C];if(b!==void 0){const N=v[b];if(N!=null)return N}}};return{handleSmartUpload:async(v,w)=>{var A,T,L;if(!e)return;n(!0),w(0),u(null),t({isOpen:!0,text:"AI is analyzing your file structure...",type:"alert"});let E,_,C;try{const $=`You are an expert data import specialist for a retail company. Analyze the provided file preview. Your task is to identify the file type, its format, and map its columns to our system's required columns.

The possible file types are: 'employee_sales', 'item_wise_sales', 'install', 'visitors'.

Our system's columns for each type are:
- 'employee_sales': ['Sales Man Name', 'Outlet Name', 'Bill Date', 'Net Amount', 'Total Sales Bills']
- 'item_wise_sales': ['Outlet Name', 'SalesMan Name', 'Bill Dt.', 'Item Name', 'Item Alias', 'Sold Qty', 'Item Rate']
- 'install': ['Type', 'Store Name', 'Area Manager', 'Employee Name', 'Employee Store', 'Year', 'Month', 'Store Target', 'Employee Sales Target', 'Employee Duvet Target', 'Employee Email']
- 'visitors': ['Date', 'Store Name', 'Visitors']

**Analysis Rules:**
1.  **Partial 'install' Files:** The 'install' file type is special. It can be a partial file. For example, it might ONLY contain employee targets ('Type', 'Employee Name', 'Year', 'Month', 'Employee Sales Target') or ONLY store targets. You must still identify it as 'install' if it contains a valid subset of the 'install' columns. The 'Type' column is a strong indicator.
2.  **File Formats:** 'employee_sales' can have a "flat" format (one employee per row) or a "grouped" format (employee name in one row, their data in subsequent rows). Your JSON response must include a "format" key for this file type.
3.  **Flexible Column Names:** Match headers intelligently (e.g., 'Net Amount' could be 'Net Sales', 'Sales Man Name' could be 'Employee').

**IMPORTANT EXAMPLE:** If the user uploads a file with headers \`Type, Employee Name, Employee Store, Year, Month, Employee Sales Target\`, you MUST correctly identify it as 'install' and return a headerMap for the columns present.
{
  "fileType": "install",
  "headerMap": {
    "Type": "Type",
    "Employee Name": "Employee Name",
    "Employee Store": "Employee Store",
    "Year": "Year",
    "Month": "Month",
    "Employee Sales Target": "Employee Sales Target"
  }
}

Return ONLY a valid JSON object with "fileType", "headerMap", and a "format" key (null if not 'employee_sales').

File Preview:
${`Headers: ${Object.keys(v[0]).join(", ")}
Sample rows:
${v.slice(0,3).map(q=>Object.values(q).join(", ")).join(`
`)}`}`,R=(A=(await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:$}]}]})).match(/\{.*\}/s))==null?void 0:A[0];if(!R)throw new Error("AI response was not valid JSON.");const X=JSON.parse(R);if(E=X.fileType,_=X.headerMap,C=X.format,!E||!_)throw new Error("AI could not determine file structure.");if(E==="item_wise_sales"){const q=["Bill_No","bill_no","Bill No","Invoice","Invoice No","Transaction_ID","Bill Number"];if(!q.find(V=>Object.keys(_).some(P=>P.toLowerCase().trim()===V.toLowerCase().trim()))){const P=Object.keys(v[0]||{}).find(Z=>q.some(z=>Z.toLowerCase().trim()===z.toLowerCase().trim()));P?_.Bill_No=P:console.warn("Bill number not found, sold-with analysis may be limited")}}t({isOpen:!0,text:`AI identified file as: ${E}. Starting upload...`,type:"alert"})}catch(U){t({isOpen:!0,text:`AI analysis failed: ${U.message}. Please use a template.`,type:"alert"}),n(!1);return}const b=400;let N=[],x=0;const j=new Set;let k=null;for(let U=0;U<v.length;U+=b){const K=v.slice(U,U+b),$=e.batch();let O=null;for(const R of K)try{switch(E){case"employee_sales":{if(C==="flat"){const X=m(R,[_["Sales Man Name"]]),q=m(R,[_["Outlet Name"]]),J=_f(m(R,[_["Bill Date"]])),V=wr(m(R,[_["Net Amount"]])),P=wr(m(R,[_["Total Sales Bills"]]));if(J&&q&&X){const Z=p(X),z=Ef.fromDate(new Date(J)),ae=e.collection("dailyMetrics").doc();$.set(ae,{date:z,store:String(q).trim(),employee:String(X).trim(),employeeId:Z,totalSales:V,transactionCount:P}),N.push({dataType:"Employee Sale",name:X,value:`Sales: ${V}`})}else x++}else{const X=m(R,[_["Sales Man Name"]]),q=m(R,[_["Outlet Name"]]);if(X&&String(X).trim()&&!String(X).toLowerCase().includes("total")){O=String(X).trim();continue}if(!X&&q&&O){const J=_f(m(R,[_["Bill Date"]])),V=wr(m(R,[_["Net Amount"]])),P=wr(m(R,[_["Total Sales Bills"]]));if(J){const Z=p(O),z=Ef.fromDate(new Date(J)),ae=e.collection("dailyMetrics").doc();$.set(ae,{date:z,store:String(q).trim(),employee:O,employeeId:Z,totalSales:V,transactionCount:P}),N.push({dataType:"Employee Sale",name:O,value:`Sales: ${V}`})}else x++}else x++}break}case"item_wise_sales":{const X=_f(m(R,[_["Bill Dt."]])),q=m(R,[_["Outlet Name"]]),J=m(R,[_["SalesMan Name"]]),V=m(R,[_["Item Name"]]),P=m(R,[_["Item Alias"]]),Z=wr(m(R,[_["Sold Qty"]])),z=wr(m(R,[_["Item Rate"]])),ae=m(R,["Bill_No","bill_no","Bill No","BillNo","Invoice","InvoiceNo","Invoice No","Transaction_ID","Transaction ID","Bill Number"]);if(X&&q&&J&&V&&P){const Q=p(J),we=Ef.fromDate(new Date(X)),xe=String(P).startsWith("4")&&String(V).toUpperCase().includes("COMFORTER")?"kingDuvetSales":"salesTransactions",Ve=e.collection(xe).doc(),re={"Bill Dt.":we,"Outlet Name":q,"SalesMan Name":J,employeeId:Q,"Item Name":V,"Item Alias":P,"Sold Qty":Z,"Item Rate":z};ae!=null&&String(ae).trim()!==""?re.bill_no=String(ae).trim():console.warn("Bill number not found, sold-with analysis may be limited"),$.set(Ve,re),N.push({dataType:"Item Sale",name:V,value:`Qty: ${Z}`})}else x++;break}case"install":{const X=(T=m(R,[_.Type]))==null?void 0:T.toLowerCase(),q=wr(m(R,[_.Year])),J=wr(m(R,[_.Month]));if(!X||!q||!J){x++;continue}if(k||(k={year:q,month:J}),X==="store"){const V=m(R,[_["Store Name"]]),P=m(R,[_["Area Manager"]]);if(V&&(o.find(Z=>Z.name===V)||P)){const Z=o.find(we=>we.name===V)||{id:V.replace(/\s+/g,"_")},z=e.collection("stores").doc(Z.id),ae={name:V};P&&(ae.areaManager=P),$.set(z,ae,{merge:!0});const Q=m(R,[_["Store Target"]]);if(Q!==void 0){const we={};we[`targets.${q}.${J}`]=wr(Q),$.update(z,we)}N.push({dataType:"Store Install",name:V,value:"Data updated"})}else x++}else if(X==="employee"){const V=m(R,[_["Employee Name"]]),P=m(R,[_["Employee Store"]]),Z=m(R,[_["Employee Email"]]);if(V){j.add(V);const z=r.find(je=>je.name===V)||{id:V.replace(/\s+/g,"_"),assignments:{}},ae=e.collection("employees").doc(z.id),Q=`${q}-${String(J).padStart(2,"0")}`,we={name:V,status:"active"};P&&(we.currentStore=P,we.assignments={...z.assignments,[Q]:P}),Z&&(we.email=Z);const De=((L=String(V).match(/^\d+/))==null?void 0:L[0])||null;De&&(we.employeeId=De),$.set(ae,we,{merge:!0});const xe={},Ve=m(R,[_["Employee Sales Target"]]);Ve!==void 0&&(xe[`targets.${q}.${J}`]=wr(Ve));const re=m(R,[_["Employee Duvet Target"]]);re!==void 0&&(xe[`duvetTargets.${q}.${J}`]=wr(re)),Object.keys(xe).length>0&&$.update(ae,xe),N.push({dataType:"Employee Install",name:V,value:"Data updated"})}else x++}else x++;break}case"visitors":{const X=_f(m(R,[_.Date])),q=m(R,[_["Store Name"]]),J=wr(m(R,[_.Visitors]));if(X&&q){const V=Ef.fromDate(new Date(X)),P=`${X}_${q.replace(/\s+/g,"-")}`,Z=e.collection("dailyMetrics").doc(P);$.set(Z,{date:V,store:q,visitors:J},{merge:!0}),N.push({dataType:"Visitors",name:q,value:`${J} visitors`})}else x++;break}default:x++}}catch(X){console.error("Error processing row:",R,X),x++}await $.commit(),w((U+K.length)/v.length*100)}if(E==="install"&&j.size>0&&k){const U=e.batch(),K=r.filter($=>$.status==="active"&&!j.has($.name));K.forEach($=>{const O=e.collection("employees").doc($.id);U.update(O,{status:"inactive"})}),await U.commit(),K.length>0&&t({isOpen:!0,text:`Marked ${K.length} employees as inactive.`,type:"alert"})}u({successful:N,skipped:x}),t({isOpen:!0,text:`Upload complete! Processed ${N.length} records.`,type:"alert"}),n(!1)},uploadResult:s,clearUploadResult:c}},Iu=({stores:e,filters:t,setFilters:n,profile:r})=>{const{t:o}=Oe(),s=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="general_manager",u=M.useMemo(()=>{if(!s)return[];const m=new Set(e.map(y=>y.areaManager).filter(Boolean));return["All",...Array.from(m).sort()]},[e,s]),c=M.useMemo(()=>{if(t.areaManager==="All"&&s)return e;const m=s?t.areaManager:r==null?void 0:r.areaManager;return m?e.filter(y=>y.areaManager===m):e},[e,t.areaManager,s,r]),f=m=>{n({areaManager:m.target.value,store:"All"})},p=m=>{n(y=>({...y,store:m.target.value}))};return h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 p-4 bg-white rounded-xl shadow-sm border border-neutral-200",children:[s&&h.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[200px]",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[o("area_manager"),":"]}),h.jsx("select",{value:t.areaManager,onChange:f,className:"input w-full",children:u.map(m=>h.jsx("option",{value:m,children:m==="All"?o("all_area_managers"):m},m))})]}),h.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[200px]",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[o("store"),":"]}),h.jsxs("select",{value:t.store,onChange:p,className:"input w-full",disabled:(r==null?void 0:r.role)==="employee",children:[h.jsx("option",{value:"All",children:o("all_stores")}),c.map(m=>h.jsx("option",{value:m.name,children:m.name},m.id))]})]})]})},Vs=({dateFilter:e,setDateFilter:t,allData:n})=>{const{t:r,locale:o}=Oe(),s=M.useMemo(()=>{const b=new Set;n.forEach(j=>{const k="date"in j?j.date:j["Bill Dt."];if(k&&typeof k.toDate=="function"){const T=k.toDate().getUTCFullYear();isNaN(T)||b.add(T)}});const N=new Date().getFullYear();return b.add(N),["all",...Array.from(b).filter(j=>!isNaN(j)).sort((j,k)=>k-j)]},[n]),u=M.useMemo(()=>o==="ar"?["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],[o]),c=["all",...Array.from({length:31},(b,N)=>N+1)],f=e.mode??"single",p=e.dayFrom??(typeof e.day=="number"?e.day:"all"),m=e.dayTo??(typeof e.day=="number"?e.day:"all"),y=b=>{const N=b.target.value==="all"?"all":Number(b.target.value);t({year:N,month:"all",day:"all"})},v=b=>{const N=b.target.value==="all"?"all":Number(b.target.value);t(x=>({...x,month:N,day:"all"}))},w=b=>{const N=b.target.value;t(x=>({...x,mode:N,dayFrom:N==="range"?typeof x.day=="number"?x.day:"all":void 0,dayTo:N==="range"?typeof x.day=="number"?x.day:"all":void 0}))},E=b=>{const N=b.target.value==="all"?"all":Number(b.target.value);t(x=>({...x,day:N,dayFrom:void 0,dayTo:void 0,mode:"single"}))},_=b=>{const N=b.target.value==="all"?"all":Number(b.target.value);t(x=>({...x,mode:"range",dayFrom:N}))},C=b=>{const N=b.target.value==="all"?"all":Number(b.target.value);t(x=>({...x,mode:"range",dayTo:N}))};return h.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-xl shadow-sm border border-neutral-200",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[h.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[150px]",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("year"),":"]}),h.jsx("select",{value:e.year,onChange:y,className:"input w-full",children:s.map(b=>h.jsx("option",{value:b,children:b==="all"?r("all_years"):b},b))})]}),h.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[150px]",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("month"),":"]}),h.jsxs("select",{value:e.month,onChange:v,className:"input w-full",disabled:e.year==="all",children:[h.jsx("option",{value:"all",children:r("all_months")}),u.map((b,N)=>h.jsx("option",{value:N,children:b},b))]})]}),h.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[150px]",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("filter_mode"),":"]}),h.jsxs("select",{value:f,onChange:w,className:"input w-full",disabled:e.month==="all"||e.year==="all",children:[h.jsx("option",{value:"single",children:r("single_day")}),h.jsx("option",{value:"range",children:r("day_range")})]})]})]}),f==="single"?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("day"),":"]}),h.jsx("select",{value:e.day,onChange:E,className:"input",disabled:e.month==="all"||e.year==="all",children:c.map(b=>h.jsx("option",{value:b,children:b==="all"?r("all_days"):b},b))})]}):h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("from_day"),":"]}),h.jsx("select",{value:p,onChange:_,className:"input",disabled:e.month==="all"||e.year==="all",children:c.map(b=>h.jsx("option",{value:b,children:b==="all"?r("all_days"):b},b))})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"font-semibold text-zinc-600",children:[r("to_day"),":"]}),h.jsx("select",{value:m,onChange:C,className:"input",disabled:e.month==="all"||e.year==="all",children:c.map(b=>h.jsx("option",{value:b,children:b==="all"?r("all_days"):b},b))})]})]})]})},A6=({data:e})=>{if(!e||e.length<2)return null;const t=100,n=30,r=2,o=Math.max(...e),s=Math.min(...e),u=o-s,c=e.map((p,m)=>{const y=m/(e.length-1)*(t-r*2)+r,v=n-r-(p-s)/(u||1)*(n-r*2);return`${y},${v}`}).join(" "),f=e.length>1&&e[e.length-1]>e[0];return h.jsx("svg",{viewBox:`0 0 ${t} ${n}`,className:"w-full h-8",children:h.jsx("polyline",{fill:"none",stroke:f?"#10b981":"#ef4444",strokeWidth:"2",points:c})})},D6=({percentage:e,size:t=60})=>{const n=(t-8)/2,r=2*Math.PI*n,o=r,s=r-e/100*r;return h.jsxs("div",{className:"circular-progress",style:{width:t,height:t},children:[h.jsxs("svg",{width:t,height:t,children:[h.jsx("circle",{cx:t/2,cy:t/2,r:n,className:"circular-progress-bg"}),h.jsx("circle",{cx:t/2,cy:t/2,r:n,className:"circular-progress-fill",strokeDasharray:o,strokeDashoffset:s,style:{strokeDasharray:`${o} ${o}`,strokeDashoffset:s}})]}),h.jsxs("div",{className:"circular-progress-text",children:[Math.round(e),"%"]})]})},M6=({trend:e,value:t})=>{const n=()=>{switch(e){case"up":return"text-green-600";case"down":return"text-red-500";default:return"text-gray-500"}},r=()=>{switch(e){case"up":return"↗";case"down":return"↘";default:return"→"}};return h.jsxs("div",{className:`flex items-center gap-1 text-xs font-semibold ${n()}`,children:[h.jsx("span",{className:"text-lg",children:r()}),t&&h.jsx("span",{children:t})]})},pn=({title:e,value:t,format:n,comparisonValue:r,comparisonLabel:o,icon:s,iconBgColor:u,onClick:c,trendData:f,showProgress:p=!1,progressValue:m=0,trend:y="neutral",trendValue:v})=>{const w=r!==void 0&&t>=r,E=n&&typeof t=="number"?n(t):(t==null?void 0:t.toLocaleString())||0;return h.jsxs("button",{onClick:c,disabled:!c,className:"modern-kpi-card group p-4 flex flex-col text-left w-full h-full disabled:cursor-default",children:[h.jsx("div",{className:"kpi-card-background"}),h.jsxs("div",{className:"relative z-10 flex-1 flex flex-col",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s&&h.jsx("div",{className:"kpi-icon-container flex-shrink-0",children:s}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx("h3",{className:"kpi-title truncate",children:e})})]}),v&&h.jsx(M6,{trend:y,value:v})]}),h.jsx("div",{className:"mb-4 flex-1 flex items-center",children:h.jsx("div",{className:"kpi-value break-all leading-tight",children:E})}),h.jsxs("div",{className:"flex items-end justify-between",children:[h.jsx("div",{className:"flex-1",children:p?h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(D6,{percentage:m,size:50}),h.jsxs("div",{className:"text-xs text-gray-500",children:["التقدم: ",Math.round(m),"%"]})]}):r!==void 0?h.jsxs("div",{className:`text-xs font-semibold flex items-center gap-1 ${w?"text-green-600":"text-red-500"}`,children:[h.jsx("span",{className:"text-sm",children:w?"▲":"▼"}),h.jsxs("span",{children:[o,": ",n?n(r):r.toLocaleString()]})]}):null}),f&&f.length>1&&h.jsx("div",{className:"ml-3",children:h.jsx(A6,{data:f})})]})]})]})},tr=({title:e,children:t})=>h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-neutral-200 h-full flex flex-col transition-all duration-300 hover:shadow-xl hover:border-primary-200",children:[h.jsx("div",{className:"text-xl font-bold text-neutral-800 mb-6 border-b border-neutral-100 pb-3",children:e}),h.jsx("div",{className:"flex-grow relative",children:t})]}),EA=({content:e,x:t,y:n})=>h.jsx("div",{className:"absolute p-2 bg-gray-800 text-white text-xs rounded-md shadow-lg pointer-events-none",style:{left:t,top:n,transform:"translate(-50%, -110%)"},dangerouslySetInnerHTML:{__html:e}}),vs=({data:e,dataKey:t,nameKey:n,format:r})=>{if(!e||e.length===0)return h.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500",children:"No data to display"});const o=Math.max(...e.map(s=>s[t]||0));return o===0?h.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500",children:"No data to display"}):h.jsx("div",{className:"w-full h-full flex flex-col space-y-3",children:e.map((s,u)=>{const c=s[t]||0,f=c/o*100;return h.jsxs("div",{className:"group relative",title:`${s[n]}: ${r?r(c):c}`,children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("span",{className:"text-sm font-medium text-neutral-700 truncate pr-2",children:s[n]}),h.jsx("span",{className:"text-sm font-bold text-neutral-900 whitespace-nowrap",children:r?r(c):c.toLocaleString()})]}),h.jsx("div",{className:"relative h-4 bg-neutral-200 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-600 rounded-full transition-all duration-500 ease-out relative group-hover:from-orange-500 group-hover:to-orange-700",style:{width:`${Math.max(f,2)}%`},children:h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})})})]},`${s[n]}-${u}`)})})},kx=({data:e,onSliceClick:t})=>{const n=M.useRef(null),[r,o]=M.useState(null);if(!e||e.length===0)return h.jsx("div",{className:"flex items-center justify-center h-full text-zinc-500",children:"No data to display"});const s=e.reduce((p,m)=>p+m.value,0);if(s===0)return h.jsx("div",{className:"flex items-center justify-center h-full text-zinc-500",children:"No data to display"});const u=["#f97316","#3b82f6","#6366f1","#14b8a6","#f59e0b","#84cc16","#ef4444","#8b5cf6","#ec4899","#22d3ee"];let c=0;const f=(p,m=50)=>[50+m*Math.cos(p),50+m*Math.sin(p)];return h.jsxs("div",{className:"w-full h-full flex flex-col md:flex-row items-center justify-between gap-4",ref:n,children:[h.jsxs("div",{className:"w-48 h-48 relative flex-shrink-0",children:[r&&h.jsx(EA,{...r}),h.jsx("svg",{viewBox:"0 0 100 100",onMouseLeave:()=>o(null),children:e.map((p,m)=>{const y=p.value/s*2*Math.PI,v=c;c+=y;const w=c,[E,_]=f(v,40),[C,b]=f(w,40),N=y>Math.PI?1:0,x=`M 50,50 L ${E},${_} A 40,40 0 ${N},1 ${C},${b} z`;return h.jsx("path",{d:x,fill:u[m%u.length],className:t?"cursor-pointer hover:opacity-80 transition-opacity":"",onClick:()=>t&&t(p.name),onMouseMove:j=>{if(!n.current)return;const k=n.current.getBoundingClientRect(),A=j.clientX-k.left,T=j.clientY-k.top;o({content:`${p.name}: ${(p.value/s*100).toFixed(1)}%`,x:A,y:T})}},p.name)})})]}),h.jsx("div",{className:"flex-grow overflow-y-auto h-full w-full",children:h.jsxs("ul",{className:"space-y-2",children:[e.slice(0,10).map((p,m)=>h.jsxs("li",{className:"flex items-center text-sm group hover:bg-neutral-50 p-2 rounded-lg transition-all duration-200",children:[h.jsx("div",{className:"w-4 h-4 rounded-full mr-3 shadow-sm",style:{backgroundColor:u[m%u.length]}}),h.jsx("span",{className:"text-neutral-700 flex-grow font-medium whitespace-nowrap",title:p.name,children:p.name}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-neutral-500",children:p.value.toLocaleString()}),h.jsxs("span",{className:"font-bold text-neutral-900 bg-neutral-100 px-2 py-1 rounded-md text-xs",children:[(p.value/s*100).toFixed(1),"%"]})]})]},p.name)),e.length>10&&h.jsxs("li",{className:"text-xs text-neutral-400 mt-3 p-2 bg-neutral-50 rounded-lg text-center",children:["... و ",e.length-10," عناصر أخرى"]})]})})]})},IA=({data:e})=>{const t=M.useRef(null),[n,r]=M.useState(null),o=M.useMemo(()=>!e||e.length===0?[]:Object.keys(e[0]).filter(b=>typeof e[0][b]=="number"&&b!=="monthIndex"),[e]),[s,u]=M.useState(()=>new Set(o));if(M.useEffect(()=>{u(new Set(o))},[o]),!e||e.length===0)return h.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500",children:"No data available"});const c={Sales:"#10b981",Target:"#a78bfa",totalSales:"#f97316",effectiveTarget:"#3b82f6",targetAchievement:"#8b5cf6"},f=600,p=250,m={top:10,right:20,bottom:30,left:40},y=e.flatMap(b=>o.filter(N=>s.has(N)).map(N=>b[N])),v=y.length>0?Math.max(...y,1):1,w=5,E=b=>e.length<2?"":`M ${e.map((x,j)=>{const k=m.left+j*((f-m.left-m.right)/(e.length-1)),A=p-m.bottom-x[b]/v*(p-m.top-m.bottom);return`${k},${A}`}).join(" L ")}`,_=b=>{if(!t.current)return;const N=b.currentTarget,j=new DOMPoint(b.clientX,b.clientY).matrixTransform(N.getScreenCTM().inverse()),k=Math.min(e.length-1,Math.max(0,Math.round((j.x-m.left)/(f-m.left-m.right)*(e.length-1))));if(k>=0&&k<e.length){const A=e[k],T=`<div class="font-bold mb-1">${A.name}</div>${o.filter(U=>s.has(U)).map(U=>`
                <div class="flex items-center justify-between gap-2">
                    <div class="flex items-center">
                       <span class="w-2 h-2 rounded-full mr-1.5" style="background-color: ${c[U]}"></span>
                       <span>${U}:</span>
                    </div>
                    <span class="font-semibold">${A[U].toLocaleString(void 0,{maximumFractionDigits:0})}</span>
                </div>
            `).join("")}`,L=t.current.getBoundingClientRect();r({content:T,x:b.clientX-L.left,y:b.clientY-L.top})}},C=b=>{u(N=>{const x=new Set(N);return x.has(b)?x.delete(b):x.add(b),x})};return h.jsxs("div",{className:"w-full h-full relative flex flex-col",ref:t,children:[h.jsxs("div",{className:"flex-grow",onMouseLeave:()=>r(null),children:[n&&h.jsx(EA,{...n}),h.jsxs("svg",{viewBox:`0 0 ${f} ${p}`,className:"w-full h-full",children:[Array.from({length:w}).map((b,N)=>{const x=p-m.bottom-N*(p-m.top-m.bottom)/(w-1),j=v/(w-1)*N;return h.jsxs("g",{className:"text-gray-400",children:[h.jsx("text",{x:m.left-8,y:x+4,textAnchor:"end",fontSize:"10",fill:"currentColor",children:j>=1e3?`${(j/1e3).toFixed(0)}k`:j.toFixed(0)}),h.jsx("line",{x1:m.left,y1:x,x2:f-m.right,y2:x,stroke:"currentColor",strokeOpacity:"0.2",strokeDasharray:"2 2"})]},N)}),e.map((b,N)=>h.jsx("text",{x:m.left+N*((f-m.left-m.right)/(e.length-1)),y:p-m.bottom+15,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:b.name},b.name)),o.map(b=>s.has(b)&&h.jsx("path",{d:E(b),fill:"none",stroke:c[b]||"#000",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:b.toLowerCase()==="target"?"6 6":"none",className:"transition-all duration-300"},b)),h.jsx("rect",{x:"0",y:"0",width:f,height:p,fill:"transparent",onMouseMove:_})]})]}),h.jsx("div",{className:"flex justify-center gap-6 text-sm mt-2",children:o.map(b=>h.jsxs("button",{onClick:()=>C(b),className:`flex items-center gap-2 transition-opacity ${!s.has(b)&&"opacity-40"}`,children:[h.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:c[b]||"#000"}}),h.jsx("span",{children:b})]},b))})]})},ya=({title:e,current:t,previous:n,isPercentage:r})=>{const o=f=>r?`${f.toFixed(1)}%`:f>=1e3?f.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0}):f.toLocaleString("en-US",{maximumFractionDigits:0}),s=t-n,u=n!==0?s/Math.abs(n)*100:t>0?100:0,c=s>=0;return h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-zinc-500",children:e}),h.jsx("p",{className:"text-2xl font-bold text-zinc-900 mt-1",children:o(t)}),h.jsxs("div",{className:"text-xs text-zinc-400",children:["vs ",o(n)," last year"]}),h.jsxs("div",{className:`mt-2 flex items-center text-sm font-semibold ${c?"text-green-600":"text-red-600"}`,children:[c?"▲":"▼",h.jsx("span",{className:"ml-1",children:o(Math.abs(s))}),h.jsxs("span",{className:"ml-2",children:["(",Math.abs(u).toFixed(1),"%)"]})]})]})},TA=({percentage:e})=>{const t=Math.min(Math.max(e,0),100),n=()=>t<60?"from-orange-300 to-orange-400":t<80?"from-orange-400 to-orange-500":t<95?"from-orange-500 to-orange-600":"from-orange-600 to-orange-700",r=()=>t<60?"text-red-600":t<80?"text-yellow-600":t<95?"text-blue-600":"text-green-600";return h.jsxs("div",{className:"flex items-center gap-2 w-full",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-4 overflow-hidden",children:h.jsx("div",{className:`h-full bg-gradient-to-r ${n()} rounded-full transition-all duration-700 ease-out relative`,style:{width:`${Math.max(t,2)}%`},children:h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"})})}),h.jsx("div",{className:"absolute top-0 h-3 w-0.5 bg-white shadow-sm",style:{left:`${t}%`}})]}),h.jsxs("div",{className:`text-sm font-bold ${r()} min-w-[2.5rem] text-right`,children:[e.toFixed(1),"%"]})]})},Ge=({children:e,className:t="h-6 w-6"})=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e}),R6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),O6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m5-8h1m-1 4h1m-1 4h1M4 21V5a2 2 0 012-2h12a2 2 0 012 2v16"})}),L6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),P6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-14L4 7m8 4v10M4 7v10l8 4"})}),jA=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),kA=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),Cx=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),U6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),F6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),$6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),V6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M19 3v4M17 5h4M5 21v-4M3 19h4M19 21v-4M17 19h4M12 5v14M5 12h14"})}),B6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m-6 4h6m-6 4h6M5 3h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2z"})}),Mi=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M5 17v4M3 19h4M12 3l1.09 2.22L15.31 6l-1.85 1.58L15 10l-2.6-1.8L9.8 10l1.05-2.42L9 6l2.22-.78L12 3zm0 14l-1.09-2.22L8.69 14l1.85-1.58L9 10l2.6 1.8L14.2 10l-1.05 2.42L15 14l-2.22.78L12 17z"})}),z6=()=>h.jsxs(Ge,{children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),q6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),K6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),H6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),CA=()=>h.jsx(Ge,{className:"h-5 w-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),sI=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 12a5 5 0 100-10 5 5 0 000 10z"})}),G6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),W6=()=>h.jsx(Ge,{className:"h-5 w-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),Y6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),Q6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),X6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01M12 18c-1.11 0-2.08-.402-2.599-1M12 18v1m0-1v-.01m6-4a9 9 0 11-18 0 9 9 0 0118 0z"})}),J6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 12a2 2 0 01-2 2H7a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v6z"})}),Z6=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),AA=()=>h.jsx(Ge,{children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0112 12a5.995 5.995 0 016 3.803M15 21a6 6 0 00-9-5.197"})}),e5=()=>h.jsxs(Ge,{children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 3.055A9 9 0 0121.945 13H11V3.055z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 21.945V11H3.055A9 9 0 0013 21.945z"})]}),aI=()=>h.jsx(Ge,{className:"h-5 w-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),uI=()=>h.jsx(Ge,{className:"h-5 w-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Jv=()=>h.jsx(Ge,{className:"h-5 w-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t5=()=>h.jsx("div",{className:"absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-gray-200 to-transparent"}),pu=({className:e})=>h.jsx("div",{className:`relative overflow-hidden bg-gray-100 ${e}`,children:h.jsx(t5,{})}),n5=()=>h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:[h.jsx(pu,{className:"h-4 w-3/4 mb-3 rounded"}),h.jsx(pu,{className:"h-8 w-1/2 rounded"})]}),xl=()=>h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 h-full flex flex-col",children:[h.jsx(pu,{className:"h-6 w-1/2 mb-4 rounded"}),h.jsx("div",{className:"flex-grow",children:h.jsx(pu,{className:"h-full w-full rounded"})})]}),Qc=({rows:e=5})=>h.jsxs("div",{className:"space-y-2 p-4",children:[h.jsx(pu,{className:"h-8 rounded"}),[...Array(e)].map((t,n)=>h.jsx(pu,{className:"h-12 rounded"},n))]}),lI=({task:e,onUpdateStatus:t,isProcessing:n})=>{var c;const{t:r,locale:o}=Oe(),s=(c=e.createdAt)==null?void 0:c.toDate(),u={year:"numeric",month:"short",day:"numeric"};return h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border shadow-sm transition-all hover:shadow-md",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-bold text-zinc-800",children:e.title}),h.jsxs("p",{className:"text-xs text-zinc-500",children:[r("from"),": ",e.senderName," • ",s?s.toLocaleDateString(o,u):""]})]}),e.status==="pending"&&h.jsx("button",{onClick:()=>t(e.id,"completed"),disabled:n,className:"btn-secondary text-xs py-1 px-2",children:r("mark_complete")})]}),h.jsx("p",{className:"mt-2 text-sm text-zinc-700",children:e.message})]})},r5=({tasks:e,onUpdateStatus:t,isProcessing:n})=>{const{t:r}=Oe(),o=e.filter(u=>u.status==="pending"),s=e.filter(u=>u.status==="completed").slice(0,5);return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800 mb-4",children:r("my_tasks_and_alerts")}),e.length===0?h.jsx("p",{className:"text-center text-zinc-500 py-4",children:r("no_tasks")}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold text-zinc-700 mb-2",children:[r("pending_tasks")," (",o.length,")"]}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:o.length>0?o.map(u=>h.jsx(lI,{task:u,onUpdateStatus:t,isProcessing:n},u.id)):h.jsx("p",{className:"text-sm text-zinc-500",children:r("all_tasks_completed")})})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-zinc-700 mb-2",children:r("recently_completed")}),h.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:s.length>0?s.map(u=>h.jsx(lI,{task:u,onUpdateStatus:t,isProcessing:n},u.id)):h.jsx("p",{className:"text-sm text-zinc-500",children:r("no_tasks_completed")})})]})]})]})},i5=({kpiData:e,storeSummary:t,employeeSummary:n,productSummary:r,salesPerformance:o,allStores:s,allDateData:u,dateFilter:c,setDateFilter:f,areaStoreFilter:p,setAreaStoreFilter:m,setModalState:y,isRecalculating:v,dashboardPieFilter:w,setDashboardPieFilter:E,profile:_,tasks:C,onUpdateTaskStatus:b,isProcessing:N})=>{const{t:x}=Oe(),j=(_==null?void 0:_.role)==="employee",k=M.useMemo(()=>{if(!j||!(_!=null&&_.employeeId))return null;const R=Object.values(n).flat().find(X=>X.employeeId===_.employeeId);return R?{totalSales:R.totalSales,totalTransactions:R.totalTransactions,averageTransactionValue:R.atv,conversionRate:0,salesPerVisitor:0}:{totalSales:0,totalTransactions:0,averageTransactionValue:0,conversionRate:0,salesPerVisitor:0}},[j,_,n]),A=j?k:e,T=M.useMemo(()=>Object.values(n).flat().sort((R,X)=>X.achievement-R.achievement).slice(0,10),[n]),L=M.useMemo(()=>({top5:[...r].sort((X,q)=>q.totalValue-X.totalValue).slice(0,5)}),[r]),U=R=>{E(X=>X===R?null:R)},K=c.month==="all"?x("monthly_sales_performance"):x("daily_sales_performance"),{dailyAvgSales:$,monthlyAvgSales:O}=M.useMemo(()=>{if(c.year==="all")return{dailyAvgSales:0,monthlyAvgSales:0};const R=s.filter(Q=>(p.areaManager==="All"||Q.areaManager===p.areaManager)&&(p.store==="All"||Q.name===p.store)).map(Q=>Q.name),X=new Set(R),q=u.filter(Q=>Q&&Q.date&&typeof Q.date.toDate=="function"&&Q.store&&X.has(Q.store)),J=c.year,V=c.month==="all"?"all":c.month,P=c.day==="all"?"all":c.day,Z=Array.from({length:12},()=>0);q.forEach(Q=>{const we=Q.date.toDate();we.getUTCFullYear()===J&&(Z[we.getUTCMonth()]+=Number(Q.totalSales||0))});let z=0;if(V==="all")z=Z.reduce((we,De)=>we+De,0)/12;else{const Q=V,we=Z.slice(0,Q+1).reduce((De,xe)=>De+xe,0);z=Q+1>0?we/(Q+1):0}let ae=0;if(V==="all"){const Q=Z.reduce((De,xe)=>De+xe,0),we=J%4===0&&J%100!==0||J%400===0;ae=Q/(we?366:365)}else{const Q=new Date(J,V+1,0).getDate(),we=Array.from({length:Q},()=>0);q.forEach(Ve=>{const re=Ve.date.toDate();if(re.getUTCFullYear()!==J||re.getUTCMonth()!==V)return;const je=re.getUTCDate()-1;je>=0&&je<Q&&(we[je]+=Number(Ve.totalSales||0))});const De=P==="all"?Q:Math.min(P,Q),xe=we.slice(0,De).reduce((Ve,re)=>Ve+re,0);ae=De>0?xe/De:0}return{dailyAvgSales:ae,monthlyAvgSales:z}},[u,s,p,c]);return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:c,setDateFilter:f,allData:u}),h.jsx(Iu,{stores:s,filters:p,setFilters:m,profile:_})]}),h.jsx(r5,{tasks:C,onUpdateStatus:b,isProcessing:N}),w&&h.jsxs("div",{className:"p-3 bg-orange-50 text-orange-800 rounded-lg flex justify-between items-center shadow-sm",children:[h.jsxs("span",{children:[x("filtered_by")," ",h.jsx("strong",{children:w})]}),h.jsx("button",{onClick:()=>E(null),className:"font-bold text-lg",children:"×"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:v||!A?[...Array(5)].map((R,X)=>h.jsx(n5,{},X)):h.jsxs(h.Fragment,{children:[h.jsx(pn,{title:x("total_sales"),value:A.totalSales,format:R=>R.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0}),icon:h.jsx(X6,{}),iconBgColor:"bg-orange-100 text-orange-600",onClick:()=>!j&&y({type:"kpiBreakdown",data:{title:x("total_sales"),kpi:"totalSales",data:t}})}),h.jsx(pn,{title:x("total_transactions"),value:A.totalTransactions,format:R=>R.toLocaleString("en-US"),icon:h.jsx(J6,{}),iconBgColor:"bg-blue-100 text-blue-600"}),h.jsx(pn,{title:x("avg_transaction_value"),value:A.averageTransactionValue,format:R=>R.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0}),icon:h.jsx(Z6,{}),iconBgColor:"bg-indigo-100 text-indigo-600"}),!j&&h.jsxs(h.Fragment,{children:[h.jsx(pn,{title:x("conversion_rate"),value:A.conversionRate,format:R=>`${R.toFixed(1)}%`,icon:h.jsx(e5,{}),iconBgColor:"bg-amber-100 text-amber-600"}),h.jsx(pn,{title:x("sales_per_visitor"),value:A.salesPerVisitor,format:R=>R.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0}),icon:h.jsx(AA,{}),iconBgColor:"bg-pink-100 text-pink-600"})]})]})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 mt-6",children:[h.jsx("div",{className:"lg:col-span-3",children:v?h.jsx(xl,{}):h.jsx(tr,{title:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{children:K}),h.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.jsxs("span",{className:"px-3 py-1.5 rounded-full bg-green-50 text-green-700 border border-green-200 font-bold",children:["ADS: ",$.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})]}),h.jsxs("span",{className:"px-3 py-1.5 rounded-full bg-teal-50 text-teal-700 border border-teal-200 font-bold",children:["AMS: ",O.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})]})]})]}),children:h.jsx(IA,{data:o})})}),h.jsx("div",{className:"lg:col-span-2",children:v?h.jsx(xl,{}):h.jsx(tr,{title:x("sales_by_store"),children:h.jsx(kx,{data:t.map(R=>({name:R.name,value:R.totalSales})),onSliceClick:U})})})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[v?h.jsx(xl,{}):h.jsx(tr,{title:x("top_stores_by_achievement"),children:h.jsx(vs,{data:[...t].sort((R,X)=>X.targetAchievement-R.targetAchievement).slice(0,10),dataKey:"targetAchievement",nameKey:"name",format:R=>`${R.toFixed(1)}%`})}),v?h.jsx(xl,{}):h.jsx(tr,{title:x("top_employees_by_achievement"),children:h.jsx(vs,{data:T,dataKey:"achievement",nameKey:"name",format:R=>`${R.toFixed(1)}%`})})]}),h.jsx("div",{className:"grid grid-cols-1 mt-6",children:v?h.jsx(xl,{}):h.jsx(tr,{title:x("top_products_by_sales_value"),children:h.jsx(vs,{data:L.top5,dataKey:"totalValue",nameKey:"name",format:R=>R.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})})})]})},o5=(e,t=10,n)=>{const[r,o]=M.useState(1),[s,u]=M.useState(n?{key:n,direction:"desc"}:null),c=M.useMemo(()=>{let y=[...e];return s!==null&&y.sort((v,w)=>{const E=v[s.key],_=w[s.key];return E==null?1:_==null?-1:E<_?s.direction==="asc"?-1:1:E>_?s.direction==="asc"?1:-1:0}),y},[e,s]),f=M.useMemo(()=>{const y=(r-1)*t;return c.slice(y,y+t)},[c,r,t]),p=Math.ceil(e.length/t);return{paginatedData:f,sortConfig:s,requestSort:y=>{let v="asc";s&&s.key===y&&s.direction==="asc"&&(v="desc"),u({key:y,direction:v}),o(1)},currentPage:r,totalPages:p,setCurrentPage:o}},s5=({direction:e})=>e?h.jsx("span",{children:e==="asc"?"▲":"▼"}):h.jsx("span",{className:"text-gray-300",children:"↕"}),Bs=({columns:e,data:t,initialSortKey:n,rowClassName:r,onRowClick:o,renderExpandedRow:s})=>{const{t:u}=Oe(),{paginatedData:c,sortConfig:f,requestSort:p,currentPage:m,totalPages:y,setCurrentPage:v}=o5(t,10,n);return h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-neutral-200 overflow-hidden",children:[h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsx("tr",{className:"bg-gradient-to-r from-neutral-50 to-neutral-100 border-b border-neutral-200",children:e.map(w=>h.jsx("th",{className:"th cursor-pointer group transition-colors duration-200 hover:bg-neutral-200/50",onClick:()=>w.sortable&&p(w.key),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"group-hover:text-primary-600 transition-colors duration-200",children:w.label}),w.sortable&&h.jsx("div",{className:"group-hover:text-primary-600 transition-colors duration-200",children:h.jsx(s5,{direction:(f==null?void 0:f.key)===w.key?f.direction:void 0})})]})},String(w.key)))})}),h.jsx("tbody",{className:"divide-y divide-neutral-100",children:c.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:e.length,className:"text-center py-10 text-gray-500",children:u("no_data_to_display")})}):c.map(w=>{const E=s?s(w):null;return h.jsxs(Bl.Fragment,{children:[h.jsx("tr",{onClick:()=>o&&o(w),className:`transition-all duration-200 ${r?r(w):""} ${o?"cursor-pointer hover:bg-primary-50 hover:shadow-sm":r?"hover:brightness-95":"hover:bg-neutral-50"}`,children:e.map(_=>h.jsx("td",{className:"td",children:_.render?_.render(w[_.key],w):w[_.key]},`${w.id}-${String(_.key)}`))}),E&&h.jsx("tr",{children:h.jsx("td",{colSpan:e.length,className:"p-0 bg-gray-50 border-t-2 border-orange-200",children:E})})]},w.id)})})]})}),y>1&&h.jsxs("div",{className:"px-6 py-4 bg-neutral-50 border-t border-neutral-200 flex justify-between items-center",children:[h.jsx("button",{onClick:()=>v(w=>Math.max(w-1,1)),disabled:m===1,className:"btn-secondary text-sm px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u("previous")}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm text-neutral-600",children:u("page_of",{current:m,total:y})}),h.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,y)},(w,E)=>{const _=m-2+E;return _<1||_>y?null:h.jsx("button",{onClick:()=>v(_),className:`w-8 h-8 rounded-lg text-sm font-medium transition-all duration-200 ${m===_?"bg-primary-500 text-white shadow-md":"text-neutral-600 hover:bg-neutral-200 hover:text-neutral-900"}`,children:_},_)})})]}),h.jsx("button",{onClick:()=>v(w=>Math.min(w+1,y)),disabled:m===y,className:"btn-secondary text-sm px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u("next")})]})]})},DA=M.createContext({storeMap:{},employeeMap:{},loading:!0}),MA=()=>M.useContext(DA),a5=(e,t)=>String((e==null?void 0:e.name)??(e==null?void 0:e.store_name)??(e==null?void 0:e.title)??(e==null?void 0:e.store)??(e==null?void 0:e.storeName)??t),u5=(e,t)=>String((e==null?void 0:e.name)??(e==null?void 0:e.employee_name)??(e==null?void 0:e.fullName)??(e==null?void 0:e.displayName)??(e==null?void 0:e.username)??t),l5=({children:e})=>{const[t,n]=M.useState({}),[r,o]=M.useState({}),[s,u]=M.useState(!0),[c,f]=M.useState();M.useEffect(()=>{let m=!1;u(!0);const y=Se.collection("stores").onSnapshot(w=>{const E={};w.docs.map(_=>{const C=_.data(),b=String((C==null?void 0:C.store_id)??(C==null?void 0:C.id)??_.id).trim();return E[b]=a5(C,b),null}),m||n(E),m||u(!1)},w=>{console.error("DirectoryProvider stores listener error:",w),m||f((w==null?void 0:w.message)||"Missing or insufficient permissions"),m||u(!1)}),v=Se.collection("employees").onSnapshot(w=>{const E={};w.docs.map(_=>{const C=_.data(),b=String((C==null?void 0:C.employee_id)??(C==null?void 0:C.id)??_.id).trim();return E[b]=u5(C,b),null}),m||o(E),m||u(!1)},w=>{console.error("DirectoryProvider employees listener error:",w),m||f((w==null?void 0:w.message)||"Missing or insufficient permissions"),m||u(!1)});return()=>{m=!0,y(),v()}},[]);const p=M.useMemo(()=>({storeMap:t,employeeMap:r,loading:s,error:c}),[t,r,s,c]);return h.jsx(DA.Provider,{value:p,children:e})},c5=({id:e,fallback:t})=>{const{storeMap:n,loading:r}=MA(),o=e!=null?String(e):"",s=o&&n[o]||t;return h.jsx("span",{children:s||(r?"…":"—")})},RA=({id:e,fallback:t})=>{const{employeeMap:n,loading:r}=MA(),o=e!=null?String(e):"",s=o&&n[o]||t;return h.jsx("span",{children:s||(r?"…":"—")})},h5=({storeSummary:e,allStores:t,allDateData:n,dateFilter:r,setDateFilter:o,areaStoreFilter:s,setAreaStoreFilter:u,setModalState:c,onEdit:f,onDelete:p,onSelectStore:m,isRecalculating:y,profile:v})=>{const{t:w}=Oe(),E=(v==null?void 0:v.role)==="admin",_=(v==null?void 0:v.role)==="admin",C=(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="general_manager",b=["admin","general_manager","area_manager","store_manager"].includes((v==null?void 0:v.role)||""),N=[{key:"name",label:w("store"),sortable:!0,render:(k,A)=>h.jsx("span",{onClick:()=>m(A),className:"cursor-pointer font-medium text-blue-600 hover:underline",children:h.jsx(c5,{id:A.store_id??A.id??A.name,fallback:A.name})})},{key:"totalSales",label:w("total_sales"),sortable:!0,render:k=>k.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"effectiveTarget",label:w("sales_target"),sortable:!0,render:k=>k.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"targetAchievement",label:w("achievement"),sortable:!0,render:(k,A)=>h.jsx(TA,{percentage:A.targetAchievement??0})}];(C||_)&&N.push({key:"actions",label:w("actions"),render:(k,A)=>h.jsxs("div",{className:"flex space-x-2",children:[C&&h.jsx("button",{onClick:T=>{T.stopPropagation(),f(A)},className:"text-blue-600 hover:text-blue-800 p-1",title:w("edit_title"),children:h.jsx(kA,{})}),_&&h.jsx("button",{onClick:T=>{T.stopPropagation(),p(A.id,A.name)},className:"text-red-600 hover:text-red-800 p-1",title:w("delete_title"),children:h.jsx(Cx,{})})]})});const x=M.useMemo(()=>{if(!Array.isArray(e)||e.length===0)return{};const k={};for(const A of e){const T=A.areaManager||w("unassigned");k[T]||(k[T]=[]),k[T].push(A)}return k},[e,w]),j=k=>k.targetAchievement>=100?"bg-green-50":k.targetAchievement<80?"bg-red-50":"";return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:r,setDateFilter:o,allData:n}),h.jsx(Iu,{stores:t,filters:s,setFilters:u,profile:v})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800",children:w("stores_overview")}),h.jsxs("div",{className:"flex items-center gap-2",children:[b&&h.jsxs("button",{onClick:()=>c({type:"visitors"}),className:"btn-secondary flex items-center gap-2",children:[h.jsx(AA,{})," ",w("add_visitors")]}),E&&h.jsxs("button",{onClick:()=>c({type:"store"}),className:"btn-primary flex items-center gap-2",children:[h.jsx(jA,{})," ",w("add_store")]})]})]}),h.jsx("div",{className:"space-y-6",children:y?h.jsx(Qc,{}):Object.keys(x).sort((k,A)=>k.localeCompare(A)).map(k=>{const A=x[k];return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("h4",{className:"text-lg font-bold text-zinc-700 mb-4",children:k}),h.jsx(Bs,{columns:N,data:A,initialSortKey:"totalSales",rowClassName:j})]},k)})})]})},f5=({employee:e,allMetrics:t,salesTransactions:n,kingDuvetSales:r,storeSummary:o,dateFilter:s,setModalState:u,allEmployeeSummaries:c})=>{const{t:f}=Oe(),[p,m]=M.useState(null),y=M.useCallback(_=>_>=199&&_<=399?"Low Value (199-399)":_>=495&&_<=695?"Medium Value (495-695)":_>=795&&_<=999?"High Value (795-999)":null,[]),v=M.useMemo(()=>{var ve,Ue;const _=oe=>{const ye="date"in oe?oe.date:oe["Bill Dt."];if(!ye||typeof ye.toDate!="function")return!1;const Te=ye.toDate(),qt=s.year==="all"||Te.getUTCFullYear()===s.year,Kt=s.month==="all"||Te.getUTCMonth()===s.month;if(!qt||!Kt)return qt&&Kt;if((s.mode??"single")==="range"&&s.month!=="all"&&s.year!=="all"){const ze=s.dayFrom===void 0?"all":s.dayFrom,hr=s.dayTo===void 0?"all":s.dayTo,Mn=Te.getUTCDate();if(ze==="all"&&hr==="all")return!0;if(ze==="all"&&typeof hr=="number")return Mn<=hr;if(typeof ze=="number"&&hr==="all")return Mn>=ze;if(typeof ze=="number"&&typeof hr=="number"){const fr=Math.min(ze,hr),qs=Math.max(ze,hr);return Mn>=fr&&Mn<=qs}return!0}const Gn=s.day==="all"||Te.getUTCDate()===s.day;return qt&&Kt&&Gn},C=t.filter(_),b=n.filter(_),N=r.filter(_),x=C.filter(oe=>oe.employee===e.name),j=x.reduce((oe,ye)=>oe+(ye.totalSales||0),0),k=[...b,...N].filter(oe=>oe["SalesMan Name"]===e.name),A=new Set;k.forEach(oe=>{const ye=oe.bill_no||oe.Bill_No||oe.Invoice||oe["Invoice No"]||oe.Transaction_ID||"";ye&&A.add(String(ye))});const T=A.size||x.reduce((oe,ye)=>oe+(ye.transactionCount||0),0),L=T>0?j/T:0,U=gs(e.targets,s),K=U>0?j/U*100:0,$=k.reduce((oe,ye)=>oe+(ye["Sold Qty"]||0),0),O=T>0?$/T:0,R=o.find(oe=>oe.name===e.store),X=R!=null&&R.totalSales&&R.totalSales>0?j/R.totalSales*100:0,q=(R==null?void 0:R.atv)||0,J=[...b,...N].filter(oe=>oe["Outlet Name"]===e.store).reduce((oe,ye)=>oe+(ye["Sold Qty"]||0),0),V=new Set;[...b,...N].filter(oe=>oe["Outlet Name"]===e.store).forEach(oe=>{const ye=oe.bill_no||oe.Bill_No||oe.Invoice||oe["Invoice No"]||oe.Transaction_ID||"";ye&&V.add(String(ye))});const P=V.size||(R==null?void 0:R.transactionCount)||0,Z=P>0?J/P:0,z=k.reduce((oe,ye)=>{const Te={name:ye["Item Name"],alias:ye["Item Alias"]},qt=qd(Te);oe[qt]||(oe[qt]={totalSales:0,products:{}});const Kt=(ye["Sold Qty"]||0)*(ye["Item Rate"]||0);return oe[qt].totalSales+=Kt,oe[qt].products[ye["Item Name"]]=(oe[qt].products[ye["Item Name"]]||0)+(ye["Sold Qty"]||0),oe},{}),ae=Object.entries(z).map(([oe,ye])=>({name:oe,value:ye.totalSales})),we=N.filter(oe=>oe["SalesMan Name"]===e.name).reduce((oe,ye)=>{const Te=y(ye["Item Rate"]);return Te&&(oe[Te]=(oe[Te]||0)+(ye["Sold Qty"]||0)),oe},{"Low Value (199-399)":0,"Medium Value (495-695)":0,"High Value (795-999)":0}),De=Object.values(we).reduce((oe,ye)=>oe+ye,0),xe=[{name:"Low Value (199-399)",count:we["Low Value (199-399)"]},{name:"Medium Value (495-695)",count:we["Medium Value (495-695)"]},{name:"High Value (795-999)",count:we["High Value (795-999)"]}],Ve=new Date,re=Ve.getFullYear(),je=Ve.getMonth(),et=gs(e.targets,{year:re,month:je,day:"all"}),ft=t.filter(oe=>{if(oe.employee!==e.name||!oe.date||typeof oe.date.toDate!="function")return!1;const ye=oe.date.toDate();return ye.getFullYear()===re&&ye.getMonth()===je}).reduce((oe,ye)=>oe+(ye.totalSales||0),0),Ce=et-ft,st=new Date(re,je+1,0).getDate(),Ze=Math.max(0,st-Ve.getDate()+1),at=Ze>0?Math.max(0,Ce)/Ze:0,dt={salesMTD:ft,monthlyTarget:et,remainingTarget:Ce,remainingDays:Ze,requiredDailyAverage:at},Dn=((Ue=(ve=e.duvetTargets)==null?void 0:ve[re])==null?void 0:Ue[String(je+1)])||0,Hr=r.filter(oe=>{if(oe["SalesMan Name"]!==e.name||!oe["Bill Dt."]||typeof oe["Bill Dt."].toDate!="function")return!1;const ye=oe["Bill Dt."].toDate();return ye.getFullYear()===re&&ye.getMonth()===je}).reduce((oe,ye)=>oe+(ye["Sold Qty"]||0),0),Ir=Dn>0?Hr/Dn*100:0;return{totalSales:j,atv:L,achievement:K,contributionPercentage:X,avgItemsPerBill:O,storeAvgAtv:q,storeAvgUpt:Z,categoryData:ae,productsByCategory:z,duvetCategories:xe,totalDuvets:De,dynamicTarget:dt,duvetTargetData:{target:Dn,sold:Hr,achievement:Ir}}},[e,t,n,r,o,s,y]),w=M.useMemo(()=>{var _;return p?Object.entries(((_=v.productsByCategory[p])==null?void 0:_.products)||{}).sort(([,C],[,b])=>Number(b)-Number(C)).slice(0,5).map(([C,b])=>({name:C,soldQty:b})):[]},[p,v.productsByCategory]),E=()=>{u({type:"aiComparison",data:{item:e,allItems:c,type:"employee"}})};return h.jsx("div",{className:"w-full",children:h.jsxs("div",{className:"bg-gray-50 p-4 m-2 border-l-4 border-orange-500 rounded-r-lg animate-fade-in",children:[h.jsx("div",{className:"flex justify-end mb-4",children:h.jsxs("button",{onClick:E,className:"btn-secondary text-sm flex items-center gap-1 py-1 px-2",children:[h.jsx(Mi,{})," ",f("compare_with_ai")]})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 my-4",children:[h.jsx(pn,{title:f("total_sales"),value:v.totalSales,format:_=>_.toLocaleString("en-US",{style:"currency",currency:"SAR"})}),h.jsx(pn,{title:f("avg_transaction_value"),value:v.atv,format:_=>_.toLocaleString("en-US",{style:"currency",currency:"SAR"}),comparisonValue:v.storeAvgAtv,comparisonLabel:f("store_avg")}),h.jsx(pn,{title:f("items_per_bill"),value:v.avgItemsPerBill,format:_=>_.toFixed(2),comparisonValue:v.storeAvgUpt,comparisonLabel:f("store_avg")}),h.jsx(pn,{title:f("achievement"),value:v.achievement,format:_=>`${_.toFixed(1)}%`}),h.jsx(pn,{title:f("contribution_to_store_sales"),value:v.contributionPercentage,format:_=>`${_.toFixed(1)}%`})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[h.jsx(tr,{title:p?`${f("top_products_in")} ${p}`:f("sales_by_product_category"),children:p?h.jsxs("div",{children:[h.jsx("button",{onClick:()=>m(null),className:"btn-secondary text-sm mb-4",children:f("back_to_categories")}),h.jsx(vs,{data:w,dataKey:"soldQty",nameKey:"name",format:_=>`${_} units`})]}):h.jsx(kx,{data:v.categoryData,onSliceClick:_=>m(C=>C===_?null:_)})}),h.jsx(tr,{title:"Duvet Sales Analysis by Value",children:h.jsxs("div",{className:"space-y-2 p-1 h-full flex flex-col justify-center",children:[v.totalDuvets>0?v.duvetCategories.map(_=>{const C=v.totalDuvets>0?_.count/v.totalDuvets*100:0;return h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between text-xs font-medium text-zinc-600 mb-1",children:[h.jsx("span",{children:_.name}),h.jsxs("span",{children:[_.count," units (",C.toFixed(1),"%)"]})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:h.jsx("div",{className:"bg-sky-500 h-3 rounded-full",style:{width:`${C}%`}})})]},_.name)}):h.jsx("p",{className:"text-center text-zinc-500",children:"No duvet sales data for this period."}),h.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-200",children:[h.jsxs("div",{className:"flex justify-between items-center text-xs",children:[h.jsx("span",{className:"font-semibold text-zinc-700",children:"Monthly Duvet Target:"}),h.jsx("span",{className:"font-bold",children:v.duvetTargetData.target})]}),h.jsxs("div",{className:"flex justify-between items-center text-xs mt-1",children:[h.jsx("span",{className:"font-semibold text-zinc-700",children:"Sold (MTD):"}),h.jsx("span",{className:"font-bold",children:v.duvetTargetData.sold})]}),h.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[h.jsx("span",{className:"font-bold text-green-700",children:"Achievement (MTD):"}),h.jsxs("span",{className:"font-extrabold text-green-600",children:[v.duvetTargetData.achievement.toFixed(1),"%"]})]})]})]})}),h.jsx(tr,{title:f("dynamic_daily_target"),children:h.jsx("div",{className:"h-full flex flex-col justify-center",children:h.jsxs("div",{className:"space-y-2 text-sm",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsxs("span",{children:[f("sales_this_month")," (MTD)"]}),h.jsx("span",{className:"font-semibold",children:v.dynamicTarget.salesMTD.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:f("monthly_target")}),h.jsx("span",{className:"font-semibold",children:v.dynamicTarget.monthlyTarget.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{className:"flex justify-between border-t pt-2 mt-2",children:[h.jsx("span",{className:"font-bold",children:f("remaining_target")}),h.jsx("span",{className:"font-bold text-red-600",children:v.dynamicTarget.remainingTarget>0?v.dynamicTarget.remainingTarget.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0}):f("achieved")})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:f("remaining_days")}),h.jsx("span",{className:"font-semibold",children:v.dynamicTarget.remainingDays})]}),h.jsxs("div",{className:"flex justify-between items-center bg-orange-50 p-2 rounded-lg mt-2",children:[h.jsx("span",{className:"font-bold text-orange-700",children:f("required_daily_avg")}),h.jsx("span",{className:"font-bold text-orange-700 text-md",children:v.dynamicTarget.requiredDailyAverage.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]})]})})})]})]})})},d5=({employeeSummary:e,allStores:t,allDateData:n,dateFilter:r,setDateFilter:o,areaStoreFilter:s,setAreaStoreFilter:u,setModalState:c,onEdit:f,onDelete:p,isRecalculating:m,dailyMetrics:y,salesTransactions:v,kingDuvetSales:w,storeSummary:E,allEmployees:_,profile:C})=>{const{t:b}=Oe(),[N,x]=M.useState(""),[j,k]=M.useState(null),A=(C==null?void 0:C.role)==="admin",T=(C==null?void 0:C.role)==="admin",L=(C==null?void 0:C.role)==="admin"||(C==null?void 0:C.role)==="area_manager",U=(C==null?void 0:C.role)!=="employee",K=M.useMemo(()=>{const q=Object.values(e);return Array.isArray(q)?q.flat():[]},[e]),$=M.useMemo(()=>{const q=_.find(V=>(C==null?void 0:C.employeeId)&&V.employeeId===C.employeeId||V.userEmail&&(C==null?void 0:C.email)&&V.userEmail===C.email),J=(C==null?void 0:C.store)||(q==null?void 0:q.currentStore)||"";return Object.entries(e).reduce((V,[P,Z])=>{if((C==null?void 0:C.role)==="store_manager"&&P!==J)return V;const z=Array.isArray(Z)?Z:[];if(!N)return V[P]=z,V;const ae=z.filter(Q=>(Q.name||"").toLowerCase().includes(N.toLowerCase()));return ae.length>0&&(V[P]=ae),V},{})},[e,N]),O=q=>q.achievement>=100?"bg-green-50":q.achievement<80?"bg-red-50":"",R=q=>{k(J=>J===q.id?null:q.id)},X=[{key:"name",label:b("employee"),sortable:!0,render:(q,J)=>h.jsx("span",{className:"font-medium text-blue-600",children:h.jsx(RA,{id:J.employeeId??J.id??J.name,fallback:J.name})})},{key:"totalSales",label:b("total_sales"),sortable:!0,render:q=>q.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"atv",label:b("avg_transaction_value"),sortable:!0,render:q=>q.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"effectiveTarget",label:b("sales_target"),sortable:!0,render:q=>q.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"achievement",label:b("achievement"),sortable:!0,render:(q,J)=>h.jsx(TA,{percentage:J.achievement??0})},{key:"actions",label:b("actions"),render:(q,J)=>h.jsxs("div",{className:"flex space-x-1",children:[h.jsx("button",{onClick:V=>{V.stopPropagation(),c({type:"aiCoaching",data:J})},className:"text-orange-500 p-1",title:b("ai_coaching_title"),children:h.jsx(Mi,{})}),U&&h.jsx("button",{onClick:V=>{V.stopPropagation(),c({type:"task",data:J})},className:"text-gray-600 p-1",title:b("send_task_title"),children:h.jsx(Q6,{})}),L&&h.jsx("button",{onClick:V=>{V.stopPropagation(),c({type:"dailyMetric",data:{mode:"employee",employee:J.name,store:J.store}})},className:"text-green-600 p-1",title:b("add_kpi_title"),children:h.jsx(U6,{})}),L&&h.jsx("button",{onClick:V=>{V.stopPropagation(),f(J)},className:"text-blue-600 p-1",title:b("edit_title"),children:h.jsx(kA,{})}),T&&h.jsx("button",{onClick:V=>{V.stopPropagation(),p(J.id,J.name)},className:"text-red-600 p-1",title:b("delete_title"),children:h.jsx(Cx,{})})]})}];return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:r,setDateFilter:o,allData:n}),h.jsx(Iu,{stores:t,filters:s,setFilters:u,profile:C})]}),h.jsxs("div",{className:"p-4 bg-white rounded-xl shadow-sm border border-gray-200 flex justify-between items-center",children:[h.jsx("input",{type:"text",placeholder:b("search_employee_placeholder"),value:N,onChange:q=>x(q.target.value),className:"input w-full max-w-sm"}),A&&h.jsxs("button",{onClick:()=>c({type:"employee"}),className:"btn-primary flex items-center gap-2",children:[h.jsx(jA,{})," ",b("add_employee")]})]}),h.jsx("div",{className:"space-y-6",children:m?h.jsx(Qc,{}):Object.keys($).length===0?h.jsx("div",{className:"text-center p-10 bg-white rounded-lg shadow",children:h.jsx("p",{children:b("no_employee_data")})}):Object.entries($).sort(([q],[J])=>q.localeCompare(J)).map(([q,J])=>h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800 mb-4",children:q}),h.jsx(Bs,{columns:X,data:J,initialSortKey:"totalSales",rowClassName:O,onRowClick:R,renderExpandedRow:V=>j===V.id&&h.jsx("div",{className:"p-4",children:h.jsx(f5,{employee:V,allMetrics:y,salesTransactions:v,kingDuvetSales:w,storeSummary:E,dateFilter:r,setModalState:c,allEmployeeSummaries:K})})})]},q))})]})},p5=({productSummary:e,allStores:t,allDateData:n,dateFilter:r,setDateFilter:o,areaStoreFilter:s,setAreaStoreFilter:u,setModalState:c,isRecalculating:f,profile:p})=>{var L,U,K,$;const[m,y]=M.useState({name:"",alias:"",category:"All",priceRange:"All"}),v=M.useMemo(()=>e.filter(O=>{var P,Z;const R=(P=O.name)==null?void 0:P.toLowerCase().includes(m.name.toLowerCase()),X=(Z=O.alias)==null?void 0:Z.toLowerCase().includes(m.alias.toLowerCase()),q=m.category==="All"||qd(O)===m.category,J=O.price||0,V=m.priceRange==="All"||m.priceRange==="<150"&&J<150||m.priceRange==="150-500"&&J>=150&&J<=500||m.priceRange===">500"&&J>500;return R&&X&&q&&V}),[e,m]),w=M.useMemo(()=>{let O=0,R=0;for(const X of v)O+=X.soldQty||0,R+=X.totalValue||0;return{qty:O,value:R}},[v]),E=M.useMemo(()=>{const O=r.year==="all"?new Date().getUTCFullYear():r.year,R=r.month==="all"?new Date().getUTCMonth():r.month,X=r.day==="all"?"all":r.day,q=t.filter(ve=>(s.areaManager==="All"||ve.areaManager===s.areaManager)&&(s.store==="All"||ve.name===s.store)).map(ve=>ve.name),J=new Set(q),V=ve=>ve&&ve["Bill Dt."]&&typeof ve["Bill Dt."].toDate=="function"&&ve["Outlet Name"],P=n.filter(V).filter(ve=>J.has(ve["Outlet Name"])),Z=new Date(O,R+1,0).getDate(),z=X==="all"?Z:Math.min(X,Z),ae=P.filter(ve=>{const Ue=ve["Bill Dt."].toDate();return Ue.getUTCFullYear()===O&&Ue.getUTCMonth()===R&&Ue.getUTCDate()<=z}),Q=new Date(Date.UTC(O,R-1,1)),we=Q.getUTCFullYear(),De=Q.getUTCMonth(),xe=P.filter(ve=>{const Ue=ve["Bill Dt."].toDate();return Ue.getUTCFullYear()===we&&Ue.getUTCMonth()===De}),Ve=ve=>{const Ue=new Map;for(const oe of ve){const ye=String(oe["Item Alias"]||oe.alias||oe["Item Name"]||""),Te=String(oe["Item Name"]||ye),qt=Number(oe["Sold Qty"]||0),Kt=Number(oe["Item Rate"]||0),Do=qt*Kt,Gn=Ue.get(ye)||{name:Te,qty:0,value:0,rate:Kt};Gn.qty+=qt,Gn.value+=Do,Gn.rate=Kt||Gn.rate,Ue.set(ye,Gn)}return Ue},re=Ve(ae),je=Ve(xe);let et=0,ft=0;for(const{qty:ve,value:Ue}of re.values())et+=ve,ft+=Ue;let Ce=null,st=null;re.forEach((ve,Ue)=>{var Te;const oe=((Te=je.get(Ue))==null?void 0:Te.value)||0,ye=oe===0?ve.value>0?100:0:(ve.value-oe)/oe*100;(!Ce||ve.value>Ce.value)&&(Ce={name:ve.name,value:ve.value,growth:ye}),ve.value>0&&(!st||ve.value<st.value)&&(st={name:ve.name,value:ve.value,growth:ye})});const Ze=z>0?ft/z:0,at=Array.from(je.values()).reduce((ve,Ue)=>ve+Ue.value,0),dt=at===0?ft>0?100:0:(ft-at)/at*100,Dn=Array.from(re.values()).sort((ve,Ue)=>Ue.qty-ve.qty).slice(0,10).map(ve=>({name:ve.name,value:ve.qty})),Hr=Array.from({length:12},(ve,Ue)=>({name:new Date(0,Ue).toLocaleString("en-US",{month:"short"}),value:0}));P.forEach(ve=>{const Ue=ve["Bill Dt."].toDate();if(Ue.getUTCFullYear()!==O)return;const oe=Ue.getUTCMonth();Hr[oe].value+=Number(ve["Sold Qty"]||0)*Number(ve["Item Rate"]||0)});const Ir=new Map;v.forEach(ve=>{const Ue=qd(ve)||"Other";Ir.set(Ue,(Ir.get(Ue)||0)+(ve.totalValue||0))});const zs=Array.from(Ir.entries()).map(([ve,Ue])=>({name:ve,value:Ue}));return{totalQty:et,totalValue:ft,best:Ce,weak:st,avgDaily:Ze,monthlyGrowth:dt,charts:{top10:Dn,monthlyTrend:Hr,categoryShare:zs}}},[n,t,s,r,v]),_=M.useMemo(()=>{const O=r.year==="all"?new Date().getUTCFullYear():r.year,R=r.month==="all"?new Date().getUTCMonth():r.month,X=t.filter(re=>(s.areaManager==="All"||re.areaManager===s.areaManager)&&(s.store==="All"||re.name===s.store)).map(re=>re.name),q=new Set(X),J=n.filter(re=>re&&re["Bill Dt."]&&typeof re["Bill Dt."].toDate=="function"&&re["Outlet Name"]&&q.has(re["Outlet Name"])),V=new Map;for(const re of J){const je=re["Bill Dt."].toDate();if(je.getUTCFullYear()!==O||r.month!=="all"&&je.getUTCMonth()!==R)continue;const et=(re.bill_no||re.Bill_No||re.Invoice||re.Transaction_ID||re["Bill Number"]||re["Invoice No"]||"").toString(),ft=et?String(et):`${je.getUTCFullYear()}-${je.getUTCMonth()}-${je.getUTCDate()}|${re["Outlet Name"]}|${re["SalesMan Name"]||""}`;et||console.warn("⚠ Missing Bill_No, using fallback mode");const Ce=String(re["Item Name"]||re["Item Alias"]||"");if(!Ce)continue;const st=V.get(ft)||[];st.push({name:Ce}),V.set(ft,st)}const P=new Map;V.forEach(re=>{const je=Array.from(new Set(re.map(et=>et.name)));for(let et=0;et<je.length;et++)for(let ft=et+1;ft<je.length;ft++){const Ce=je[et],st=je[ft],Ze=`${Ce}__::__${st}`,at=P.get(Ze)||{a:Ce,b:st,count:0};at.count+=1,P.set(Ze,at)}});const Z=Array.from(P.values()).sort((re,je)=>je.count-re.count).slice(0,20),z=Array.from(new Set(Z.flatMap(re=>[re.a,re.b]))).slice(0,12),ae=new Map(z.map((re,je)=>[re,je])),Q=z.length,we=Array.from({length:Q},()=>Array.from({length:Q},()=>0));Z.forEach(re=>{const je=ae.get(re.a),et=ae.get(re.b);je===void 0||et===void 0||(we[je][et]+=re.count,we[et][je]+=re.count)});const De=z.map(re=>({id:re,name:re,value:1})),xe=new Set(z),Ve=Z.filter(re=>xe.has(re.a)&&xe.has(re.b)).map(re=>({source:re.a,target:re.b,value:re.count}));return{topPairs:Z,uniqueItems:z,matrix:we,nodes:De,links:Ve}},[n,t,s,r]),[C,b]=M.useState(!1),[N,x]=M.useState(!1),[j,k]=M.useState(null),A=async()=>{try{x(!0);const O={contents:[{role:"user",parts:[{text:`You are a retail analyst. Compare current month vs previous month performance for products.
Current Month (upto selected day):
${JSON.stringify(E,null,2)}

Provide 3-5 concise bullet insights like:
- Product X increased by +24% compared to last month.
- Product Y dropped by -15% — check stock or display.
- Product Z often sells with Product W.
Use short sentences. Output in Arabic.`}]}],systemInstruction:"Keep answers concise and organized as bullets. No long paragraphs."},R=await hi(O,"gemini-2.5-flash");k(R)}catch(O){k(`تعذر توليد التحليلات الآن: ${(O==null?void 0:O.message)||O}`)}finally{x(!1)}},T=[{key:"name",label:"Product Name",sortable:!0,render:O=>O??""},{key:"alias",label:"Code",sortable:!0,render:O=>O??""},{key:"soldQty",label:"Sold Qty",sortable:!0,render:O=>O.toLocaleString("en-US")},{key:"price",label:"Price",sortable:!0,render:O=>O.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"totalValue",label:"Total Sales Value",sortable:!0,render:O=>O.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"actions",label:"Actions",render:(O,R)=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>c({type:"salesPitch",data:R}),className:"text-orange-500 hover:text-orange-700",title:"Get AI Sales Pitch",children:h.jsx(Mi,{})}),h.jsx("button",{onClick:()=>c({type:"productDetails",data:{product:R,allData:n,stores:t}}),className:"text-zinc-600 hover:text-zinc-900",title:"Product Details",children:"⚙"})]})}];return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:r,setDateFilter:o,allData:n}),h.jsx(Iu,{stores:t,filters:s,setFilters:u,profile:p})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Total Products Sold (MTD)"}),h.jsx("div",{className:"text-2xl font-bold",children:E.totalQty.toLocaleString("en-US")})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Total Sales Value (MTD)"}),h.jsx("div",{className:"text-2xl font-bold",children:E.totalValue.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Best Performing Product"}),h.jsx("div",{className:"text-sm font-semibold truncate",title:((L=E.best)==null?void 0:L.name)||"",children:((U=E.best)==null?void 0:U.name)||"-"}),h.jsx("div",{className:"text-green-600 text-xs",children:E.best?`${E.best.growth.toFixed(1)}%`:"-"})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Weakest Performing Product"}),h.jsx("div",{className:"text-sm font-semibold truncate",title:((K=E.weak)==null?void 0:K.name)||"",children:(($=E.weak)==null?void 0:$.name)||"-"}),h.jsx("div",{className:"text-red-600 text-xs",children:E.weak?`${E.weak.growth.toFixed(1)}%`:"-"})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Average Daily Sales"}),h.jsx("div",{className:"text-2xl font-bold",children:E.avgDaily.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Monthly Growth Rate"}),h.jsx("div",{className:`text-2xl font-bold ${E.monthlyGrowth>=0?"text-green-600":"text-red-600"}`,children:`${E.monthlyGrowth.toFixed(1)}%`})]})]}),h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[h.jsx("div",{className:"xl:col-span-1",children:h.jsx(tr,{title:"Top 10 Selling Products",children:h.jsx(vs,{data:E.charts.top10,dataKey:"value",nameKey:"name",format:O=>O.toLocaleString("en-US")})})}),h.jsx("div",{className:"xl:col-span-1",children:h.jsx(tr,{title:"Category Share",children:h.jsx(kx,{data:E.charts.categoryShare})})}),h.jsx("div",{className:"xl:col-span-1",children:h.jsx(tr,{title:"Monthly Sales Trend",children:h.jsx(IA,{data:E.charts.monthlyTrend.map(O=>({name:O.name,Sales:O.value,Target:0}))})})})]}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800 mb-4",children:"Products Overview"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4 p-4 bg-gray-50 rounded-lg",children:[h.jsx("input",{type:"text",placeholder:"Filter by Product Name...",value:m.name,onChange:O=>y(R=>({...R,name:O.target.value})),className:"input"}),h.jsx("input",{type:"text",placeholder:"Filter by Code...",value:m.alias,onChange:O=>y(R=>({...R,alias:O.target.value})),className:"input"}),h.jsxs("select",{value:m.category,onChange:O=>y(R=>({...R,category:O.target.value})),className:"input",children:[h.jsx("option",{value:"All",children:"All Categories"}),h.jsx("option",{value:"Duvets",children:"Duvets"}),h.jsx("option",{value:"Duvets Full",children:"Duvets Full"}),h.jsx("option",{value:"Pillows",children:"Pillows"}),h.jsx("option",{value:"Toppers",children:"Toppers"}),h.jsx("option",{value:"Other",children:"Other"})]}),h.jsxs("select",{value:m.priceRange,onChange:O=>y(R=>({...R,priceRange:O.target.value})),className:"input",children:[h.jsx("option",{value:"All",children:"All Prices"}),h.jsx("option",{value:"<150",children:"< 150 SAR"}),h.jsx("option",{value:"150-500",children:"150 - 500 SAR"}),h.jsx("option",{value:">500",children:"> 500 SAR"})]})]}),f?h.jsx(Qc,{}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-3 text-sm text-zinc-700",children:[h.jsxs("div",{className:"px-3 py-1.5 rounded-md bg-zinc-100 border",children:[h.jsx("span",{className:"font-semibold",children:"Sold Qty:"})," ",w.qty.toLocaleString("en-US")]}),h.jsxs("div",{className:"px-3 py-1.5 rounded-md bg-zinc-100 border",children:[h.jsx("span",{className:"font-semibold",children:"Total Value:"})," ",w.value.toLocaleString("en-US",{style:"currency",currency:"SAR"})]})]}),h.jsx(Bs,{columns:T,data:v,initialSortKey:"totalValue"})]})]}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800",children:"AI Insights"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>b(!C),className:"px-3 py-1.5 rounded-md border text-sm",children:C?"إخفاء":"إظهار"}),h.jsx("button",{onClick:A,disabled:N,className:"btn-primary text-sm",children:N?"تحليل...":"🔁 Reanalyze with AI"})]})]}),C&&h.jsx("div",{className:"mt-4 p-4 rounded-lg bg-blue-50 border border-blue-200 text-blue-900 whitespace-pre-wrap text-sm",children:j||"انقر على زر إعادة التحليل لتوليد الرؤى."})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800",children:"Frequently Sold Together"}),h.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border overflow-auto",children:h.jsx("div",{className:"min-w-[640px]",children:h.jsxs("div",{className:"grid",style:{gridTemplateColumns:`200px repeat(${_.uniqueItems.length}, minmax(48px, 1fr))`},children:[h.jsx("div",{}),_.uniqueItems.map(O=>h.jsx("div",{className:"text-[10px] text-zinc-500 text-center truncate px-1",children:O},`col-${O}`)),_.uniqueItems.map((O,R)=>h.jsxs(Bl.Fragment,{children:[h.jsx("div",{className:"text-[10px] text-zinc-600 truncate px-1 py-1",children:O}),_.uniqueItems.map((X,q)=>{var Z;const J=_.matrix[R][q],P=`rgba(34,197,94,${.1+Math.min(1,J/Math.max(1,((Z=_.topPairs[0])==null?void 0:Z.count)||1))*.6})`;return h.jsx("div",{className:"h-8 m-0.5 rounded",style:{backgroundColor:R===q?"#f1f5f9":P},title:`${J}`},`cell-${R}-${q}`)})]},`row-${O}`))]})})}),h.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:h.jsx("svg",{width:"100%",height:"560",viewBox:"0 0 1200 560",children:(()=>{const J=Math.min(1200,560)/2-60,V=_.nodes.length||1,P=new Map;_.nodes.forEach((z,ae)=>{const Q=ae/V*Math.PI*2;P.set(z.id,{x:600+J*Math.cos(Q),y:280+J*Math.sin(Q)})});const Z=Math.max(1,..._.links.map(z=>z.value));return h.jsxs("g",{children:[_.links.map((z,ae)=>{const Q=P.get(z.source),we=P.get(z.target);if(!Q||!we)return null;const De=.2+.6*(z.value/Z);return h.jsx("line",{x1:Q.x,y1:Q.y,x2:we.x,y2:we.y,stroke:"#0ea5e9",strokeOpacity:De,strokeWidth:2},`link-${ae}`)}),_.nodes.map((z,ae)=>{const Q=P.get(z.id);return Q?h.jsxs("g",{children:[h.jsx("circle",{cx:Q.x,cy:Q.y,r:12,fill:"#34d399",stroke:"#047857"}),h.jsx("text",{x:Q.x+14,y:Q.y+4,fontSize:12,fill:"#334155",children:z.name})]},`node-${ae}`):null})]})})()})})]})]})]})},m5=({duvetSummary:e,allStores:t,allDateData:n,dateFilter:r,setDateFilter:o,areaStoreFilter:s,setAreaStoreFilter:u,isRecalculating:c,profile:f})=>{const p=M.useMemo(()=>Object.values(e).map(y=>({...y,id:y.name})).sort((y,v)=>v.total-y.total),[e]),m=[{key:"name",label:"Store",sortable:!0},{key:"Low Value (199-399)",label:"Low Value",sortable:!0},{key:"Medium Value (495-695)",label:"Medium Value",sortable:!0},{key:"High Value (795-999)",label:"High Value",sortable:!0},{key:"total",label:"Total Units",sortable:!0}];return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:r,setDateFilter:o,allData:n}),h.jsx(Iu,{stores:t,filters:s,setFilters:u,profile:f})]}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800 mb-4",children:"Duvet Sales Overview by Store"}),c?h.jsx(Qc,{}):h.jsx(Bs,{columns:m,data:p,initialSortKey:"total"})]})]})},g5=({commissionData:e,allStores:t,allDateData:n,dateFilter:r,setDateFilter:o,areaStoreFilter:s,setAreaStoreFilter:u,isRecalculating:c,profile:f})=>{const[p,m]=M.useState(e.length>0?e[0].name:null),y=[{key:"name",label:"Employee",sortable:!0,render:(w,E)=>h.jsx(RA,{id:E.employeeId??E.id??E.name,fallback:E.name})},{key:"totalSales",label:"Total Sales",sortable:!0,render:w=>w.toLocaleString("en-US",{style:"currency",currency:"SAR"})},{key:"achievement",label:"Employee Achievement",sortable:!0,render:w=>`${w.toFixed(1)}%`},{key:"finalCommissionRate",label:"Final Commission Rate",sortable:!0,render:w=>h.jsx("span",{className:"font-semibold text-blue-600",children:`${w.toFixed(2)}%`})},{key:"commissionAmount",label:"Commission Amount",sortable:!0,render:w=>h.jsx("span",{className:"font-semibold text-green-600",children:w.toLocaleString("en-US",{style:"currency",currency:"SAR"})})}],v=(f==null?void 0:f.store)||"";return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[h.jsx(Vs,{dateFilter:r,setDateFilter:o,allData:n}),h.jsx(Iu,{stores:t,filters:s,setFilters:u,profile:f})]}),c?h.jsx(Qc,{rows:10}):e.length===0?h.jsx("div",{className:"text-center p-10 bg-white rounded-lg shadow",children:h.jsx("p",{children:"No commission data available for the selected period."})}):h.jsx("div",{className:"space-y-4",children:Array.isArray(e)?e.sort((w,E)=>(w.name||"").localeCompare(E.name||"")).map(w=>h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[h.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50",onClick:()=>m(E=>E===w.name?null:w.name),children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800",children:w.name}),h.jsx("span",{className:"text-xl",children:p===w.name?"−":"+"})]}),h.jsxs("p",{className:"text-sm text-zinc-500 mt-1",children:["Store Achievement: ",w.achievement.toFixed(1),"% | Applicable Commission Rate: ",h.jsxs("strong",{children:[w.commissionRate.toFixed(1),"%"]})]})]}),p===w.name&&h.jsx("div",{className:"p-4 border-t border-gray-200",children:h.jsx(Bs,{columns:y,data:(f==null?void 0:f.role)==="store_manager"&&v?w.employees.filter(E=>E.store===v):w.employees,initialSortKey:"commissionAmount"})})]},w.name)):[]})]})},If=(e,t)=>{if(typeof XLSX>"u"){alert("File library is still loading...");return}const n=XLSX.utils.json_to_sheet([],{header:t}),r=XLSX.utils.book_new();XLSX.utils.book_append_sheet(r,n,"Template"),XLSX.writeFile(r,`${e}.xlsx`)},v5=({onUpload:e,isProcessing:t,uploadResult:n,onClearResult:r})=>{const[o,s]=M.useState(null),[u,c]=M.useState(0),f=m=>{m.target.files&&(s(m.target.files[0]),r(),c(0))},p=()=>{if(!o)return;const m=new FileReader;m.onload=y=>{try{const v=new Uint8Array(y.target.result),w=XLSX.read(v,{type:"array"}),E=w.SheetNames[0],_=w.Sheets[E],C=XLSX.utils.sheet_to_json(_,{raw:!1});e(C,c)}catch(v){alert(`File processing failed: ${v.message}`)}},m.readAsArrayBuffer(o)};return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 space-y-6 max-w-3xl mx-auto",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700",children:"Smart Data Uploader"}),h.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"Upload an XLSX file. The system will automatically detect the file type and import the data."})]}),h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[h.jsx("h4",{className:"font-semibold text-zinc-600 mb-2",children:"Download Templates"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx("button",{onClick:()=>If("Sales_Summary_Template",["Sales Man Name","Outlet Name","Bill Date","Net Amount","Total Sales Bills"]),className:"btn-secondary text-sm",children:"Sales Summary"}),h.jsx("button",{onClick:()=>If("Item_Wise_Sales_Template",["Outlet Name","SalesMan Name","Bill Dt.","Item Name","Item Alias","Sold Qty","Item Rate"]),className:"btn-secondary text-sm",children:"Item-wise Sales"}),h.jsx("button",{onClick:()=>If("Install_Template",["Type","Store Name","Area Manager","Employee Name","Employee Store","Year","Month","Store Target","Employee Sales Target","Employee Duvet Target"]),className:"btn-secondary text-sm",children:"Install File"}),h.jsx("button",{onClick:()=>If("Visitors_Template",["Date","Store Name","Visitors"]),className:"btn-secondary text-sm",children:"Visitors"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label font-semibold",children:"Upload Your File"}),h.jsx("input",{type:"file",onChange:f,accept:".xlsx, .xls",className:"input mt-2"})]}),o&&h.jsx("button",{onClick:p,disabled:t,className:"btn-primary w-full",children:t?"Uploading...":"Upload Data"}),t&&h.jsxs("div",{children:[h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mt-4",children:h.jsx("div",{className:"bg-orange-600 h-2.5 rounded-full",style:{width:`${u}%`}})}),h.jsxs("p",{className:"text-center text-sm text-zinc-600 mt-1",children:[Math.round(u),"% Complete"]})]}),n&&h.jsxs("div",{className:"p-4 rounded-lg bg-green-100 text-green-700",children:[h.jsx("h4",{className:"font-bold",children:"Upload Complete"}),h.jsxs("p",{children:["Successfully processed ",n.successful.length," records. ",n.skipped," rows skipped."]}),h.jsx("button",{onClick:r,className:"btn-secondary mt-2 text-sm",children:"Clear"})]})]})},y5=({value:e,onChange:t})=>{const n=[{id:"daily",label:"Daily"},{id:"mtd",label:"Month-to-Date"},{id:"ytd",label:"Year-to-Date"},{id:"monthly",label:"Full Month"}];return h.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1 border",children:n.map(r=>h.jsx("button",{onClick:()=>t(r.id),className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all duration-200 ${e===r.id?"bg-white shadow-sm text-orange-600":"text-zinc-600 hover:bg-gray-200"}`,children:r.label},r.id))})},w5=({allStores:e,allMetrics:t,profile:n})=>{const[r,o]=M.useState("All"),[s,u]=M.useState(new Date().getMonth()),[c,f]=M.useState(()=>new Date().toISOString().split("T")[0]),[p,m]=M.useState("daily"),y=M.useMemo(()=>{if(!n)return[];if(n.role==="admin"||n.role==="general_manager")return e;const{role:x,areaManager:j,store:k}=n;if(x==="area_manager")return e.filter(A=>A.areaManager===j);if(x==="store_manager"){const A=e.find(T=>T.name===k);return A?e.filter(T=>T.areaManager===A.areaManager):[]}return x==="employee"?e.filter(A=>A.name===k):[]},[e,n]),v=M.useMemo(()=>{const x=(re,je,et)=>{const ft=re.filter(at=>{if(!at.date||typeof at.date.toDate!="function")return!1;const dt=at.date.toDate(),Dn=new Date(Date.UTC(dt.getUTCFullYear(),dt.getUTCMonth(),dt.getUTCDate()));return Dn>=je&&Dn<=et}),Ce=ft.reduce((at,dt)=>at+(dt.totalSales||0),0),st=ft.reduce((at,dt)=>at+(dt.visitors||0),0),Ze=ft.reduce((at,dt)=>at+(dt.transactionCount||0),0);return{totalSales:Ce,totalTransactions:Ze,totalVisitors:st,atv:Ze>0?Ce/Ze:0,visitorRate:st>0?Ze/st*100:0}},j=new Date,k=j.getUTCFullYear(),A=j.getUTCMonth(),T=j.getUTCDate(),L=k-1,U=r==="All"?t:t.filter(re=>re.store===r),K=c.split("-").map(Number),$=new Date(Date.UTC(K[0],K[1]-1,K[2])),O=new Date(Date.UTC($.getUTCFullYear()-1,$.getUTCMonth(),$.getUTCDate())),R={current:x(U,$,$),previous:x(U,O,O)},X=new Date(Date.UTC(k,A,1)),q=new Date(Date.UTC(k,A,T-1)),J=new Date(Date.UTC(L,A,1)),V=new Date(Date.UTC(L,A,T-1)),P={current:x(U,X,q),previous:x(U,J,V)},Z=new Date(Date.UTC(k,0,1)),z=new Date(Date.UTC(L,0,1)),ae={current:x(U,Z,q),previous:x(U,z,V)},Q=new Date(Date.UTC(k,s,1)),we=new Date(Date.UTC(k,s+1,0)),De=new Date(Date.UTC(L,s,1)),xe=new Date(Date.UTC(L,s+1,0)),Ve={current:x(U,Q,we),previous:x(U,De,xe)};return{daily:R,mtd:P,ytd:ae,monthly:Ve}},[t,r,s,c]),w=["January","February","March","April","May","June","July","August","September","October","November","December"],E=new Date().getFullYear(),_=E-1,C=(x,j)=>h.jsxs("div",{className:"mt-6 bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-800 mb-4",children:x}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6",children:[h.jsx(ya,{title:"Sales",current:j.current.totalSales,previous:j.previous.totalSales}),h.jsx(ya,{title:"Visitors",current:j.current.totalVisitors,previous:j.previous.totalVisitors}),h.jsx(ya,{title:"ATV",current:j.current.atv,previous:j.previous.atv}),h.jsx(ya,{title:"Transactions",current:j.current.totalTransactions,previous:j.previous.totalTransactions}),h.jsx(ya,{title:"Visitor Conversion Rate",current:j.current.visitorRate,previous:j.previous.visitorRate,isPercentage:!0}),h.jsx(ya,{title:"Sales per Visitor",current:j.current.totalVisitors>0?j.current.totalSales/j.current.totalVisitors:0,previous:j.previous.totalVisitors>0?j.previous.totalSales/j.previous.totalVisitors:0})]})]}),b=new Date(c),N=()=>{switch(p){case"daily":return C(`Daily Comparison (${b.toLocaleDateString("en-CA")} vs Same Day Last Year)`,v.daily);case"mtd":return C("Month-to-Date Comparison (MTD vs MTD Last Year)",v.mtd);case"ytd":return C("Year-to-Date Comparison (YTD vs YTD Last Year)",v.ytd);case"monthly":return C(`Full Month Comparison (${w[s]} ${E} vs ${_})`,v.monthly);default:return null}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:"Filter by Store:"}),h.jsxs("select",{value:r,onChange:x=>o(x.target.value),className:"input",disabled:(n==null?void 0:n.role)==="employee",children:[h.jsx("option",{value:"All",children:"All Stores"}),y.map(x=>h.jsx("option",{value:x.name,children:x.name},x.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:"Select Comparison Type:"}),h.jsx(y5,{value:p,onChange:m})]})]}),p==="daily"&&h.jsxs("div",{children:[h.jsx("label",{className:"label",children:"Select Day for Daily Comparison:"}),h.jsx("input",{type:"date",value:c,onChange:x=>f(x.target.value),className:"input"})]}),p==="monthly"&&h.jsxs("div",{children:[h.jsx("label",{className:"label",children:"Select Month for Full Month Comparison:"}),h.jsx("select",{value:s,onChange:x=>u(Number(x.target.value)),className:"input",children:w.map((x,j)=>h.jsx("option",{value:j,children:x},j))})]})]}),N()]})},x5=({employeeSummary:e,storeSummary:t,kingDuvetSales:n})=>{const r=(u,c)=>{if(typeof XLSX>"u"){alert("File library is still loading...");return}const f=XLSX.utils.json_to_sheet(u),p=XLSX.utils.book_new();XLSX.utils.book_append_sheet(p,f,"Report"),XLSX.writeFile(p,`${c}.xlsx`)},o=()=>{const u=e.map(c=>({Name:c.name,Store:c.store,"Total Sales":c.totalSales,Target:c.effectiveTarget,"Achievement %":c.achievement.toFixed(2)}));r(u,"Employees_Report")},s=()=>{const u=t.map(c=>({Name:c.name,"Area Manager":c.areaManager,"Total Sales":c.totalSales,Target:c.effectiveTarget,"Achievement %":c.targetAchievement.toFixed(2),Visitors:c.visitors,Transactions:c.transactionCount}));r(u,"Stores_Report")};return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-4",children:"Data Export"}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[h.jsx("button",{onClick:o,className:"btn-secondary flex-1",children:"Export Employees Report"}),h.jsx("button",{onClick:s,className:"btn-secondary flex-1",children:"Export Stores Report"})]})]})},b5=({rules:e,onSave:t,onDelete:n,isProcessing:r})=>{const[o,s]=M.useState(""),u=()=>{o.trim()&&(t(o),s(""))};return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-2",children:"Custom Business Rules"}),h.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:`Add rules for the AI assistant 'Hassan' to remember across all conversations. (e.g., "The ATV target for Al-Noor Mall is 300 SAR")`}),h.jsxs("div",{className:"flex gap-2 mb-4",children:[h.jsx("input",{type:"text",value:o,onChange:c=>s(c.target.value),placeholder:"Enter a new business rule...",className:"input flex-grow"}),h.jsx("button",{onClick:u,disabled:r,className:"btn-primary",children:r?"Saving...":"Save Rule"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("h4",{className:"font-semibold text-zinc-600",children:"Saved Rules:"}),e.length===0?h.jsx("p",{className:"text-sm text-zinc-400",children:"No custom rules saved yet."}):h.jsx("ul",{className:"divide-y divide-gray-200",children:e.map(c=>h.jsxs("li",{className:"py-2 flex justify-between items-center",children:[h.jsx("span",{className:"text-sm text-zinc-800",children:c.rule}),h.jsx("button",{onClick:()=>n(c.id),className:"text-red-500 hover:text-red-700",children:h.jsx(Cx,{})})]},c.id))})]})]})},S5=async()=>{try{console.log("🔄 بدء تحديث الموظفين...");const e=await Se.collection("employees").get();if(e.empty)return console.log("❌ لا يوجد موظفين في قاعدة البيانات"),{success:!1,message:"لا يوجد موظفين في قاعدة البيانات"};console.log(`📊 تم العثور على ${e.size} موظف`);const t=Se.batch();let n=0;return e.forEach(r=>{const o=r.data();o.hasOwnProperty("linkedAccount")?console.log(`⏭️ الموظف ${o.name||r.id} محدث مسبقاً`):(t.update(r.ref,{linkedAccount:!1,updatedAt:de.firestore.FieldValue.serverTimestamp()}),n++,console.log(`✅ تم تحديث الموظف: ${o.name||r.id}`))}),n>0?(await t.commit(),console.log(`🎉 تم تحديث ${n} موظف بنجاح!`),{success:!0,message:`تم تحديث ${n} موظف بنجاح!`,updatedCount:n}):(console.log("ℹ️ جميع الموظفين محدثين مسبقاً"),{success:!0,message:"جميع الموظفين محدثين مسبقاً",updatedCount:0})}catch(e){return console.error("❌ خطأ في تحديث الموظفين:",e),{success:!1,message:`خطأ في تحديث الموظفين: ${e.message}`,error:e}}},cI=e=>{if(!e)return null;const t=String(e).match(/unknown[\s_\-]*(\d{1,10})/i)||String(e).match(/(\d{2,10})$/);return t?t[1]:null},_5=e=>{if(!e)return null;const t=String(e).trim(),n=t.match(/^(\d{3,4})\b/);if(n)return n[1];const r=t.match(/unknown[\s_\-]*(\d{3,4})/i);if(r)return r[1];const o=t.match(/(\d{3,4})\s*$/);return o?o[1]:null},N5=async()=>{let e=0,t=0,n=0;const r=await Se.collection("employees").get();for(const u of r.docs){const c=u.data(),f=c==null?void 0:c.employeeId,p=cI(c==null?void 0:c.name);!f&&p&&(await Se.collection("employees").doc(u.id).set({employeeId:p,name:`Unknown ${p}`},{merge:!0}),e++)}const o=await Se.collection("dailyMetrics").get();for(const u of o.docs){const c=u.data();if(c!=null&&c.employeeId)continue;const f=cI(c==null?void 0:c.employee);f&&(await Se.collection("dailyMetrics").doc(u.id).set({employeeId:f},{merge:!0}),t++)}const s=async u=>{const c=await Se.collection(u).get();for(const f of c.docs){const p=f.data();if(p!=null&&p.employeeId)continue;const m=_5((p==null?void 0:p["SalesMan Name"])||(p==null?void 0:p.employee));m&&(await Se.collection(u).doc(f.id).set({employeeId:m},{merge:!0}),n++)}};return await s("salesTransactions"),await s("kingDuvetSales"),{employeesUpdated:e,metricsUpdated:t,salesUpdated:n}},E5=({onSelectiveDelete:e,isProcessing:t})=>{const{t:n}=Oe(),[r,o]=M.useState("visitors"),[s,u]=M.useState(new Date().getFullYear()),[c,f]=M.useState(new Date().getMonth()),p=M.useMemo(()=>Array.from({length:5},(v,w)=>new Date().getFullYear()-w),[]),m=M.useMemo(()=>Array.from({length:12},(v,w)=>new Date(0,w).toLocaleString("en-US",{month:"long"})),[]),y=()=>{e(r,s,c)};return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-2",children:n("selective_data_deletion_title")}),h.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:n("selective_data_deletion_desc")}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end p-4 border border-red-200 bg-red-50 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:n("data_type")}),h.jsxs("select",{value:r,onChange:v=>o(v.target.value),className:"input",children:[h.jsx("option",{value:"visitors",children:n("visitors")}),h.jsx("option",{value:"sales",children:n("sales")})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:n("year")}),h.jsx("select",{value:s,onChange:v=>u(Number(v.target.value)),className:"input",children:p.map(v=>h.jsx("option",{value:v,children:v},v))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:n("month")}),h.jsx("select",{value:c,onChange:v=>f(Number(v.target.value)),className:"input",children:m.map((v,w)=>h.jsx("option",{value:w,children:v},w))})]}),h.jsx("button",{onClick:y,disabled:t,className:"btn-danger w-full",children:n(t?"deleting":"delete_data_button")})]})]})},I5=()=>{const{t:e}=Oe(),[t,n]=M.useState(!1),[r,o]=M.useState(null),s=async()=>{if(confirm(e("confirm_update_employees"))){n(!0),o(null);try{const u=await S5();o(u)}catch(u){o({success:!1,message:`${e("error_updating_employees")}: ${u}`})}finally{n(!1)}}};return h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-2",children:e("update_employees")}),h.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:e("update_employees_desc")}),h.jsxs("div",{className:"p-4 border border-orange-200 bg-orange-50 rounded-lg",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-orange-600 text-lg",children:"👥"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-orange-800",children:e("update_employees")}),h.jsx("p",{className:"text-orange-700 text-sm",children:e("update_employees_desc")})]})]}),h.jsx("button",{onClick:s,disabled:t,className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:t?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e("updating")]}):h.jsxs(h.Fragment,{children:[h.jsx("span",{children:"🔄"}),e("update_all_employees")]})}),r&&h.jsxs("div",{className:`mt-4 p-3 rounded-lg ${r.success?"bg-green-100 border border-green-200":"bg-red-100 border border-red-200"}`,children:[h.jsx("p",{className:`font-medium ${r.success?"text-green-800":"text-red-800"}`,children:r.message}),r.updatedCount!==void 0&&r.updatedCount>0&&h.jsxs("p",{className:"text-green-700 text-sm mt-1",children:[e("employees_updated_successfully"),": ",r.updatedCount]})]})]})]})},T5=({employeeSummary:e,storeSummary:t,kingDuvetSales:n,onAddMonthlyData:r,onDeleteAllData:o,onSelectiveDelete:s,isProcessing:u,businessRules:c,onSaveRule:f,onDeleteRule:p,profile:m})=>{const y=(m==null?void 0:m.role)==="admin",v=(m==null?void 0:m.role)==="general_manager";return h.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[y&&h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-4",children:"Administrative Tools"}),h.jsx("button",{onClick:r,className:"btn-primary",children:"Add Historical Monthly Data"}),h.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:"Use this to enter aggregated data for a full month retrospectively."})]}),y&&h.jsx(b5,{rules:c,onSave:f,onDelete:p,isProcessing:u}),y&&h.jsx(I5,{}),y&&h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-2",children:"Fix Unknown Employees"}),h.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:'Extract numeric IDs from names like "Unknown 2792" and backfill missing employeeId in employees and dailyMetrics.'}),h.jsx(j5,{})]}),(y||v)&&h.jsx(x5,{employeeSummary:e,storeSummary:t,kingDuvetSales:n}),y&&h.jsxs("div",{className:"space-y-6",children:[h.jsx(E5,{onSelectiveDelete:s,isProcessing:u}),h.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"text-xl font-semibold text-zinc-700 mb-4",children:"Data Management"}),h.jsxs("div",{className:"p-4 border border-red-300 rounded-lg bg-red-50",children:[h.jsx("h4",{className:"font-bold text-red-800",children:"Danger Zone"}),h.jsx("p",{className:"text-red-700 mt-1 text-sm",children:"This action will permanently delete all data in the database. This cannot be undone."}),h.jsx("div",{className:"mt-4",children:h.jsx("button",{onClick:o,disabled:u,className:"btn-danger",children:u?"Deleting...":"Delete All Data"})})]})]})]})]})},j5=()=>{const{t:e}=Oe(),[t,n]=Bl.useState(!1),[r,o]=Bl.useState(null),s=async()=>{n(!0),o(null);try{const u=await N5();o(u)}finally{n(!1)}};return h.jsxs("div",{className:"p-4 border border-blue-200 bg-blue-50 rounded-lg",children:[h.jsx("button",{onClick:s,disabled:t,className:"btn-primary",children:t?"Processing...":"Fix Unknown Employees & Metrics"}),r&&h.jsxs("p",{className:"text-sm text-blue-800 mt-2",children:["Employees updated: ",r.employeesUpdated," — Metrics updated: ",r.metricsUpdated]})]})},k5=({store:e,allMetrics:t,onBack:n,allStores:r,setModalState:o,allDateData:s,profile:u})=>{const{t:c,locale:f}=Oe(),[p,m]=M.useState(""),[y,v]=M.useState(!1),[w,E]=M.useState({year:new Date().getFullYear(),month:new Date().getMonth(),day:"all"}),_=M.useMemo(()=>t.filter(j=>{if(j.store!==e.name)return!1;const k=j.date;if(!k||typeof k.toDate!="function")return!1;const A=k.toDate(),T=w.year==="all"||A.getUTCFullYear()===w.year,L=w.month==="all"||A.getUTCMonth()===w.month;if(!T||!L)return T&&L;if((w.mode??"single")==="range"&&w.month!=="all"&&w.year!=="all"){const $=w.dayFrom===void 0?"all":w.dayFrom,O=w.dayTo===void 0?"all":w.dayTo,R=A.getUTCDate();if($==="all"&&O==="all")return!0;if($==="all"&&typeof O=="number")return R<=O;if(typeof $=="number"&&O==="all")return R>=$;if(typeof $=="number"&&typeof O=="number"){const X=Math.min($,O),q=Math.max($,O);return R>=X&&R<=q}return!0}const K=w.day==="all"||A.getUTCDate()===w.day;return T&&L&&K}),[e.name,t,w]),C=M.useMemo(()=>{const j=_.reduce((T,L)=>T+(L.totalSales||0),0),k=_.reduce((T,L)=>T+(L.visitors||0),0),A=_.reduce((T,L)=>T+(L.transactionCount||0),0);return{totalSales:j,totalVisitors:k,totalTransactions:A,atv:A>0?j/A:0,visitorRate:k>0?A/k*100:0,salesPerVisitor:k>0?j/k:0}},[_]),b=M.useMemo(()=>{const j=new Date,k=j.getFullYear(),A=j.getMonth(),T=j.getDate(),L=new Date(k,A+1,0).getDate(),U=Math.max(0,L-T+1),K=t.filter(q=>{if(q.store!==e.name||!q.date||typeof q.date.toDate!="function")return!1;const J=q.date.toDate();return J.getFullYear()===k&&J.getMonth()===A}).reduce((q,J)=>q+(J.totalSales||0),0),$=gs(e.targets,{year:k,month:A,day:"all"}),O=$-K,X=$*.9-K;return{salesMTD:K,remainingTarget:O,remainingDays:U,requiredDailyAverage:U>0?Math.max(0,O)/U:0,requiredDailyAverage90:U>0?Math.max(0,X)/U:0}},[e.name,e.targets,t]),N=async()=>{v(!0),m("");try{const j=f==="ar"?"Provide the response in Arabic.":"",k=`Analyze the performance for store "${e.name}". Data: ${JSON.stringify(C)}. Provide a brief summary, 2 strengths, 1 area for improvement, and 2 actionable steps. ${j}`,A=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:k}]}]});m(A)}catch(j){m(`Error: ${j.message}`)}finally{v(!1)}},x=()=>{o({type:"aiComparison",data:{item:e,allItems:r,type:"store"}})};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("button",{onClick:n,className:"btn-secondary flex items-center gap-2",children:[h.jsx(q6,{})," ",c("back_to_all_stores")]}),h.jsxs("button",{onClick:x,className:"btn-secondary flex items-center gap-2",children:[h.jsx(Mi,{})," ",c("compare_with_ai")]})]}),h.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border",children:[h.jsx("h2",{className:"text-3xl font-bold text-zinc-800",children:e.name}),h.jsxs("p",{className:"text-zinc-500",children:[c("monthly_target"),": ",gs(e.targets,{year:new Date().getFullYear(),month:new Date().getMonth(),day:"all"}).toLocaleString("en-US",{style:"currency",currency:"SAR"})]})]}),h.jsx(Vs,{dateFilter:w,setDateFilter:E,allData:s}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsx(pn,{title:c("total_sales"),value:C.totalSales,format:j=>j.toLocaleString("en-US",{style:"currency",currency:"SAR"})}),h.jsx(pn,{title:c("visitors"),value:C.totalVisitors}),h.jsx(pn,{title:c("total_transactions"),value:C.totalTransactions}),h.jsx(pn,{title:c("avg_transaction_value"),value:C.atv,format:j=>j.toLocaleString("en-US",{style:"currency",currency:"SAR"})}),h.jsx(pn,{title:c("conversion_rate"),value:C.visitorRate,format:j=>`${j.toFixed(1)}%`}),h.jsx(pn,{title:c("sales_per_visitor"),value:C.salesPerVisitor,format:j=>j.toLocaleString("en-US",{style:"currency",currency:"SAR"})})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"font-semibold text-lg text-zinc-700 mb-3",children:c("ai_performance_review")}),h.jsxs("button",{onClick:N,disabled:y,className:"btn-primary flex items-center gap-2",children:[h.jsx(Mi,{})," ",c(y?"analyzing":"generate_ai_analysis")]}),y&&h.jsx("div",{className:"mt-4",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"})}),p&&h.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:p.replace(/\n/g,"<br />")}})]}),h.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"font-semibold text-lg text-zinc-700 mb-3",children:c("dynamic_daily_target")}),h.jsxs("div",{className:"space-y-3 text-sm",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:c("sales_this_month")}),h.jsx("span",{className:"font-semibold",children:b.salesMTD.toLocaleString("en-US",{style:"currency",currency:"SAR"})})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:c("remaining_target")}),h.jsx("span",{className:"font-semibold text-red-600",children:b.remainingTarget>0?b.remainingTarget.toLocaleString("en-US",{style:"currency",currency:"SAR"}):c("achieved")})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:c("remaining_days")}),h.jsx("span",{className:"font-semibold",children:b.remainingDays})]}),h.jsxs("div",{className:"flex justify-between items-center bg-orange-50 p-2 rounded-lg mt-2",children:[h.jsx("span",{className:"font-bold text-orange-700",children:c("required_daily_avg")}),h.jsx("span",{className:"font-bold text-orange-700 text-lg",children:b.requiredDailyAverage.toLocaleString("en-US",{style:"currency",currency:"SAR"})})]}),h.jsxs("div",{className:"flex justify-between items-center bg-amber-50 p-2 rounded-lg",children:[h.jsx("span",{className:"font-bold text-amber-700",children:c("required_daily_avg_90")}),h.jsx("span",{className:"font-bold text-amber-700 text-lg",children:b.requiredDailyAverage90.toLocaleString("en-US",{style:"currency",currency:"SAR"})})]})]})]})]})]})},C5=({fullData:e,currentPage:t,businessRules:n})=>{const[r,o]=M.useState(!1),[s,u]=M.useState([{role:"model",parts:[{text:"أهلاً بك! أنا حسن مساعدك الذكي. كيف يمكنني مساعدتك اليوم؟"}]}]),[c,f]=M.useState(""),[p,m]=M.useState(!1),y=M.useRef(null);M.useEffect(()=>{var w;(w=y.current)==null||w.scrollIntoView({behavior:"smooth"})},[s]);const v=async w=>{if(w.preventDefault(),!c.trim()||p)return;const E={role:"user",parts:[{text:c}]};u(C=>[...C,E]);const _=c;f(""),m(!0);try{const C=n.length>0?`--- IMPORTANT BUSINESS RULES (Follow these in all answers) ---
${n.map(k=>`- ${k.rule}`).join(`
`)}
--- END RULES ---`:"",b=`--- REAL-TIME DATA SNAPSHOT ---
${JSON.stringify(e,null,2)}
--- END DATA ---`,N=`You are 'Hassan', an expert retail analyst and business advisor. Your answers must be based strictly on the provided REAL-TIME DATA SNAPSHOT and you must always follow the IMPORTANT BUSINESS RULES. The user is currently on the '${t}' page; use this context for more relevant answers. Be concise, actionable, and use markdown for formatting. All responses must be in Arabic.`,x=`User Query: "${_}"`,j=await hi({model:"gemini-2.5-flash",contents:[...s,{role:"user",parts:[{text:`${C}

${b}

${x}`}]}],config:{systemInstruction:N}});u(k=>[...k,{role:"model",parts:[{text:j}]}])}catch(C){u(b=>[...b,{role:"model",parts:[{text:`عذراً، حدث خطأ: ${C.message}`}]}])}finally{m(!1)}};return h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>o(!r),className:"fixed bottom-6 right-6 bg-orange-600 text-white rounded-full p-4 shadow-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-transform transform hover:scale-110 z-40","aria-label":"Open AI Assistant",children:h.jsx(Mi,{})}),r&&h.jsxs("div",{className:"fixed bottom-20 right-6 w-96 h-[60vh] bg-white rounded-2xl shadow-2xl flex flex-col z-40",children:[h.jsxs("header",{className:"flex items-center justify-between p-4 border-b bg-gray-50 rounded-t-2xl",children:[h.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"المساعد الذكي: حسن"}),h.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-800",children:h.jsx(H6,{})})]}),h.jsx("div",{className:"flex-grow p-4 overflow-y-auto",children:h.jsxs("div",{className:"space-y-4",children:[s.map((w,E)=>h.jsx("div",{className:`flex ${w.role==="user"?"justify-end":"justify-start"}`,children:h.jsx("div",{className:`p-3 rounded-lg max-w-xs prose prose-sm ${w.role==="user"?"bg-blue-500 text-white":"bg-gray-100 text-zinc-800"}`,dangerouslySetInnerHTML:{__html:w.parts[0].text.replace(/\n/g,"<br />").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},E)),p&&h.jsx("div",{className:"flex justify-start",children:h.jsx("div",{className:"p-3 rounded-lg bg-gray-100 text-sm",children:"حسن يفكر..."})}),h.jsx("div",{ref:y})]})}),h.jsx("div",{className:"p-4 border-t",children:h.jsxs("form",{onSubmit:v,className:"flex gap-2",children:[h.jsx("input",{type:"text",value:c,onChange:w=>f(w.target.value),placeholder:"اسأل حسن...",className:"input flex-grow",disabled:p}),h.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!c.trim(),children:"إرسال"})]})})]})]})},A5=({onLogout:e})=>{const{t}=Oe();return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:h.jsxs("div",{className:"w-full max-w-lg p-8 text-center bg-white rounded-xl shadow-lg",children:[h.jsx("div",{className:"mx-auto w-16 h-16 mb-4 flex items-center justify-center rounded-full bg-orange-100 text-orange-600",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),h.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("pending_approval_title")}),h.jsx("p",{className:"mt-2 text-gray-600",children:t("pending_approval_message")}),h.jsxs("button",{onClick:e,className:"mt-6 btn-secondary flex items-center gap-2 mx-auto",children:[h.jsx(CA,{})," ",t("logout")]})]})})},Ax={employee:"موظف",store_manager:"مدير معرض",area_manager:"مدير منطقة",general_manager:"مدير عام",admin:"مدير النظام"},OA={employee:"bg-blue-100 text-blue-800",store_manager:"bg-green-100 text-green-800",area_manager:"bg-purple-100 text-purple-800",general_manager:"bg-orange-100 text-orange-800",admin:"bg-red-100 text-red-800"},D5=()=>{const{t:e}=Oe(),[t,n]=M.useState([]),[r,o]=M.useState(!0),[s,u]=M.useState(null);M.useEffect(()=>{const m=Se.collection("pendingEmployees").where("status","==","pending").onSnapshot(v=>{const w=v.docs.map(E=>{const _=E.data();return{id:E.id,employeeId:_.employeeId??"",email:_.email??"",name:_.name??"",role:_.role??"employee",status:_.status??"pending",createdAt:_.createdAt,userId:_.userId??"",source:"pendingEmployees",..._}});n(E=>{const _=E.filter(b=>b.source==="users"),C=[...w,..._];return C.sort((b,N)=>{var k,A;const x=(k=b.createdAt)!=null&&k.toDate?b.createdAt.toDate():new Date(b.createdAt);return((A=N.createdAt)!=null&&A.toDate?N.createdAt.toDate():new Date(N.createdAt)).getTime()-x.getTime()}),C}),o(!1)}),y=Se.collection("users").where("status","==","pending").onSnapshot(v=>{const w=v.docs.map(E=>{const _=E.data();return{id:E.id,employeeId:_.employeeId??"",email:_.email??"",name:_.name??"",role:_.role??"employee",status:_.status??"pending",createdAt:_.createdAt||_.approvedAt||new Date,userId:E.id,source:"users",..._}});n(E=>{const C=[...E.filter(b=>b.source==="pendingEmployees"),...w];return C.sort((b,N)=>{var k,A;const x=(k=b.createdAt)!=null&&k.toDate?b.createdAt.toDate():new Date(b.createdAt);return((A=N.createdAt)!=null&&A.toDate?N.createdAt.toDate():new Date(N.createdAt)).getTime()-x.getTime()}),C}),o(!1)});return()=>{m(),y()}},[]);const c=async m=>{u(m.id);try{const y=async()=>{if(!m.employeeId)return;const v=String(m.employeeId).trim(),w=Se.collection("employees"),E=w.doc(v);if(!(await E.get()).exists){const C=await w.where("employeeId","==",v).limit(1).get();if(!C.empty){await C.docs[0].ref.update({linkedAccount:!0,userEmail:m.email,userId:m.userId,role:m.role,approvedAt:de.firestore.FieldValue.serverTimestamp(),status:"active"});return}await E.set({employeeId:v,name:m.name,userEmail:m.email,userId:m.userId,role:m.role,linkedAccount:!0,approvedAt:de.firestore.FieldValue.serverTimestamp(),status:"active"},{merge:!0});return}await E.update({linkedAccount:!0,userEmail:m.email,userId:m.userId,role:m.role,approvedAt:de.firestore.FieldValue.serverTimestamp(),status:"active"})};m.source==="users"?(await Se.collection("users").doc(m.userId).update({status:"approved",approvedAt:de.firestore.FieldValue.serverTimestamp(),approvedBy:"admin"}),await y()):(await Se.collection("users").doc(m.userId).set({id:m.userId,name:m.name,email:m.email,employeeId:m.employeeId,role:m.role,status:"approved",approvedAt:de.firestore.FieldValue.serverTimestamp(),approvedBy:"admin"}),await y(),await Se.collection("pendingEmployees").doc(m.id).delete()),alert("تم قبول الطلب بنجاح")}catch(y){console.error("Error approving employee:",y),alert("حدث خطأ أثناء قبول الطلب")}finally{u(null)}},f=async m=>{if(confirm("هل أنت متأكد من رفض هذا الطلب؟")){u(m.id);try{m.source==="users"?await Se.collection("users").doc(m.userId).update({status:"rejected"}):await Se.collection("pendingEmployees").doc(m.id).delete(),alert("تم رفض الطلب")}catch(y){console.error("Error rejecting employee:",y),alert("حدث خطأ أثناء رفض الطلب")}finally{u(null)}}},p=[{key:"employeeId",label:"رقم الموظف",render:m=>h.jsx("span",{className:"font-mono font-semibold text-blue-600",children:m})},{key:"name",label:"اسم الموظف",render:m=>h.jsx("span",{className:"font-medium text-gray-900",children:m})},{key:"email",label:"البريد الإلكتروني",render:m=>h.jsx("span",{className:"text-gray-600",children:m})},{key:"role",label:"الدور",render:m=>h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${OA[m]||"bg-gray-100 text-gray-800"}`,children:Ax[m]||m})},{key:"createdAt",label:"تاريخ الطلب",render:m=>{var y,v;return h.jsx("span",{className:"text-sm text-gray-500",children:((v=(y=m==null?void 0:m.toDate)==null?void 0:y.call(m))==null?void 0:v.toLocaleDateString("ar-SA"))||"غير محدد"})}},{key:"actions",label:"الإجراءات",render:(m,y)=>h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>c(y),disabled:s===y.id,className:"px-3 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed text-sm flex items-center gap-1",children:s===y.id?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري..."]}):h.jsx(h.Fragment,{children:"✅ قبول"})}),h.jsx("button",{onClick:()=>f(y),disabled:s===y.id,className:"px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed text-sm flex items-center gap-1",children:"❌ رفض"})]})}];return r?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600",children:"جاري تحميل الطلبات..."})]})}):h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200 p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e("pending_approvals")}),h.jsx("p",{className:"text-gray-600 mt-1",children:e("manage_new_registration_requests")})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-sm text-gray-500",children:e("total_requests")}),h.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.length})]}),h.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-orange-600 text-xl",children:"⏳"})})]})]}),t.length===0?h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("span",{className:"text-green-600 text-2xl",children:"✅"})}),h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e("no_pending_requests")}),h.jsx("p",{className:"text-gray-600",children:e("all_requests_processed")})]}):h.jsx("div",{className:"overflow-hidden",children:h.jsx(Bs,{data:t,columns:p,getRowClassName:(m,y)=>y%2===0?"bg-white":"bg-gray-50"})})]})})},Zo=({role:e,size:t="md",showIcon:n=!0})=>{const r={sm:"px-2 py-1 text-xs",md:"px-3 py-1 text-sm",lg:"px-4 py-2 text-base"},o={sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"},s=u=>{switch(u){case"admin":return"👑";case"general_manager":return"🎯";case"area_manager":return"🏢";case"store_manager":return"🏪";case"employee":return"👤";default:return"👤"}};return h.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full font-medium ${r[t]} ${OA[e]}`,children:[n&&h.jsx("span",{className:`${o[t]} flex items-center justify-center`,children:s(e)}),Ax[e]]})},M5=()=>{const{t:e}=Oe(),[t,n]=M.useState([]),[r,o]=M.useState(!0),[s,u]=M.useState(null);M.useEffect(()=>{c()},[]);const c=async()=>{try{const w=(await Se.collection("users").get()).docs.map(E=>{const _=E.data();return{id:E.id,name:_.name??"",email:_.email??"",employeeId:_.employeeId??"",role:_.role??"employee",status:_.status??"pending",..._}}).filter(E=>E.status==="approved"||E.status==="active"||E.role==="admin"&&!E.status);n(w)}catch(y){console.error("Error loading users:",y)}finally{o(!1)}},f=async(y,v)=>{u(y);try{await Se.collection("users").doc(y).update({role:v,updatedAt:new Date,updatedBy:"admin"});const w=t.find(E=>E.id===y);w!=null&&w.employeeId&&await Se.collection("employees").doc(w.employeeId).update({role:v,updatedAt:new Date}),n(E=>E.map(_=>_.id===y?{..._,role:v}:_)),alert(e("role_updated"))}catch(w){console.error("Error updating role:",w),alert(e("role_failed"))}finally{u(null)}},p=[{key:"name",label:e("user_name"),render:(y,v)=>{var w;return h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-orange-600 font-bold text-lg",children:((w=y==null?void 0:y.charAt(0))==null?void 0:w.toUpperCase())??"U"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:y??""}),h.jsx("p",{className:"text-sm text-gray-500",children:v.email??""})]})]})}},{key:"employeeId",label:e("employee_id"),render:y=>h.jsx("span",{className:"font-mono font-semibold text-blue-600",children:y??""})},{key:"role",label:e("current_role"),render:y=>h.jsx(Zo,{role:y,size:"md"})},{key:"status",label:e("status"),render:y=>h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y==="approved"||y==="active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e(y==="approved"||y==="active"?"approved":"pending")})},{key:"actions",label:e("change_role"),render:(y,v)=>h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("select",{value:v.role,onChange:w=>f(v.id,w.target.value),disabled:s===v.id,className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50",children:[h.jsxs("option",{value:"employee",children:["👤 ",e("employee")]}),h.jsxs("option",{value:"store_manager",children:["🏬 ",e("store_manager")]}),h.jsxs("option",{value:"area_manager",children:["📍 ",e("area_manager")]}),h.jsxs("option",{value:"general_manager",children:["🎯 ",e("general_manager")]}),h.jsxs("option",{value:"admin",children:["👑 ",e("admin")]})]}),s===v.id&&h.jsx("div",{className:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})]})}],m=t.reduce((y,v)=>(y[v.role]=(y[v.role]||0)+1,y),{});return r?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600",children:e("loading")})]})}):h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:Object.entries(Ax).map(([y,v])=>h.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:v}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m[y]||0})]}),h.jsx(Zo,{role:y,size:"sm"})]})},y))}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200 p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e("roles_management")}),h.jsx("p",{className:"text-gray-600 mt-1",children:e("modify_roles")}),h.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[h.jsxs("p",{className:"text-blue-800 font-medium",children:["🧭 ",e("roles_guide")]}),h.jsx("p",{className:"text-blue-700 text-sm mt-1",children:e("roles_description")})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-sm text-gray-500",children:e("total_users")}),h.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.length})]}),h.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-orange-600 text-xl",children:"👥"})})]})]}),t.length===0?h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("span",{className:"text-gray-400 text-2xl",children:"👥"})}),h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e("no_users_found")}),h.jsx("p",{className:"text-gray-600",children:e("check_firebase_or_signup")})]}):h.jsx("div",{className:"overflow-hidden",children:h.jsx(Bs,{data:t,columns:p,getRowClassName:(y,v)=>v%2===0?"bg-white":"bg-gray-50"})})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-neutral-200 p-6",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:e("roles_guide")}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx(Zo,{role:"employee",size:"sm"})}),h.jsx("p",{className:"text-sm text-gray-600",children:e("view_own_sales_only")})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx(Zo,{role:"store_manager",size:"sm"})}),h.jsx("p",{className:"text-sm text-gray-600",children:e("manage_branch_employees")})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx(Zo,{role:"area_manager",size:"sm"})}),h.jsx("p",{className:"text-sm text-gray-600",children:e("edit_employee_targets")})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx(Zo,{role:"general_manager",size:"sm"})}),h.jsx("p",{className:"text-sm text-gray-600",children:e("view_all_areas")})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx(Zo,{role:"admin",size:"sm"})}),h.jsx("p",{className:"text-sm text-gray-600",children:e("full_permissions")})]})]})]})]})},R5=({onSave:e,onClose:t,isProcessing:n,stores:r,profile:o})=>{var E;const{t:s}=Oe(),[u,c]=M.useState(new Date().toISOString().split("T")[0]),f=(o==null?void 0:o.role)==="store_manager"?o.store:(E=r[0])==null?void 0:E.name,[p,m]=M.useState(f||""),[y,v]=M.useState(""),w=_=>{_.preventDefault(),!(!p||!u||!y||Number(y)<0)&&e({date:u,store:p,visitors:Number(y)})};return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:s("add_visitors")}),h.jsxs("form",{onSubmit:w,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("store")}),h.jsxs("select",{value:p,onChange:_=>m(_.target.value),required:!0,className:"input",children:[h.jsx("option",{value:"",children:s("select_store")}),r.map(_=>h.jsx("option",{value:_.name,children:_.name},_.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("date")}),h.jsx("input",{type:"date",value:u,onChange:_=>c(_.target.value),required:!0,className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("visitors_count")}),h.jsx("input",{type:"number",value:y,onChange:_=>v(_.target.value),required:!0,className:"input",placeholder:"e.g., 150",min:"0"})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:t,disabled:n,className:"btn-secondary",children:s("cancel")}),h.jsx("button",{type:"submit",disabled:n||!p||!y,className:"btn-primary",children:s(n?"saving":"save")})]})]})]})},O5=({data:e,onSave:t,onClose:n,isProcessing:r,stores:o,profile:s})=>{var $;const{t:u}=Oe(),[c,f]=M.useState((e==null?void 0:e.name)||""),[p,m]=M.useState((e==null?void 0:e.currentStore)||""),[y,v]=M.useState((($=o.find(O=>O.name===((e==null?void 0:e.currentStore)||"")))==null?void 0:$.areaManager)||""),[w,E]=M.useState(new Date().getFullYear()),[_,C]=M.useState(new Date().getMonth()+1),[b,N]=M.useState(0),[x,j]=M.useState(0),k=(s==null?void 0:s.role)==="area_manager",A=M.useMemo(()=>y?o.filter(O=>O.areaManager===y):o,[y,o]);M.useEffect(()=>{var X,q,J,V;const O=((q=(X=e==null?void 0:e.targets)==null?void 0:X[w])==null?void 0:q[_])||0,R=((V=(J=e==null?void 0:e.duvetTargets)==null?void 0:J[w])==null?void 0:V[_])||0;N(O),j(R)},[e,w,_]);const T=O=>{var X;O.preventDefault();const R=((X=String(c).match(/^\d+/))==null?void 0:X[0])||(e==null?void 0:e.employeeId)||null;t({id:e==null?void 0:e.id,name:c,store:p,employeeId:R,targetUpdate:{year:w,month:_,salesTarget:b,duvetTarget:x}})},L=[...new Set(o.map(O=>O.areaManager))],U=[new Date().getFullYear()-1,new Date().getFullYear(),new Date().getFullYear()+1],K=Array.from({length:12},(O,R)=>R+1);return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:u(e?"edit_employee":"add_employee")}),h.jsxs("form",{onSubmit:T,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("employee_name")}),h.jsx("input",{type:"text",value:c,onChange:O=>f(O.target.value),required:!0,className:"input",disabled:k})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("area_manager")}),h.jsxs("select",{value:y,onChange:O=>{v(O.target.value),m("")},required:!0,className:"input",disabled:k,children:[h.jsx("option",{value:"",children:u("select_area")}),L.map(O=>h.jsx("option",{value:O,children:O},O))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("store")}),h.jsxs("select",{value:p,onChange:O=>m(O.target.value),required:!0,className:"input",disabled:!y||k,children:[h.jsx("option",{value:"",children:u("select_store")}),A.map(O=>h.jsx("option",{value:O.name,children:O.name},O.id))]})]}),h.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[h.jsx("h3",{className:"font-semibold",children:u("monthly_targets")}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("select",{value:w,onChange:O=>E(Number(O.target.value)),className:"input",children:[h.jsx("option",{value:"",children:u("year")}),U.map(O=>h.jsx("option",{value:O,children:O},O))]}),h.jsxs("select",{value:_,onChange:O=>C(Number(O.target.value)),className:"input",children:[h.jsx("option",{value:"",children:u("month")}),K.map(O=>h.jsx("option",{value:O,children:O},O))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("sales_target")}),h.jsx("input",{type:"number",value:b,onChange:O=>N(Number(O.target.value)),className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("duvet_unit_target")}),h.jsx("input",{type:"number",value:x,onChange:O=>j(Number(O.target.value)),className:"input"})]})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:n,disabled:r,className:"btn-secondary",children:u("cancel")}),h.jsx("button",{type:"submit",disabled:r,className:"btn-primary",children:u(r?"saving":"save")})]})]})]})},L5=({data:e,onSave:t,onClose:n,isProcessing:r,profile:o})=>{const{t:s}=Oe(),[u,c]=M.useState((e==null?void 0:e.name)||""),[f,p]=M.useState((e==null?void 0:e.areaManager)||""),[m,y]=M.useState(new Date().getFullYear()),[v,w]=M.useState(new Date().getMonth()+1),[E,_]=M.useState(0),C=(o==null?void 0:o.role)==="admin"||(o==null?void 0:o.role)==="general_manager";M.useEffect(()=>{var j,k;if(e){c(e.name||""),p(e.areaManager||"");const A=((k=(j=e.targets)==null?void 0:j[m])==null?void 0:k[v])||0;_(A)}else c(""),p(""),_(0)},[e,m,v]);const b=j=>{j.preventDefault(),t({id:e==null?void 0:e.id,name:u,areaManager:f,targetUpdate:{year:m,month:v,salesTarget:E}})},N=[new Date().getFullYear()-1,new Date().getFullYear(),new Date().getFullYear()+1],x=Array.from({length:12},(j,k)=>k+1);return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:s(e?"edit_store":"add_store")}),h.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("store_name")}),h.jsx("input",{type:"text",value:u,onChange:j=>c(j.target.value),required:!0,className:"input",disabled:!C})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("area_manager")}),h.jsx("input",{type:"text",value:f,onChange:j=>p(j.target.value),required:!0,className:"input",placeholder:"e.g., Central Region",disabled:!C})]}),h.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[h.jsx("h3",{className:"font-semibold",children:s("monthly_sales_target")}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("select",{value:m,onChange:j=>y(Number(j.target.value)),className:"input",children:N.map(j=>h.jsx("option",{value:j,children:j},j))}),h.jsx("select",{value:v,onChange:j=>w(Number(j.target.value)),className:"input",children:x.map(j=>h.jsx("option",{value:j,children:j},j))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("sales_target")}),h.jsx("input",{type:"number",value:E,onChange:j=>_(Number(j.target.value)),className:"input"})]})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:n,disabled:r,className:"btn-secondary",children:s("cancel")}),h.jsx("button",{type:"submit",disabled:r,className:"btn-primary",children:s(r?"saving":"save")})]})]})]})},P5=({data:e,onSave:t,onClose:n,isProcessing:r,stores:o})=>{const{t:s}=Oe(),[u,c]=M.useState(new Date().toISOString().split("T")[0]),[f,p]=M.useState(e.store||""),[m,y]=M.useState(""),[v,w]=M.useState(""),[E,_]=M.useState(""),C=b=>{var j;b.preventDefault();const N=e.employee&&((j=String(e.employee).match(/^\d+/))==null?void 0:j[0])||null,x={date:u,store:f,employeeId:N,totalSales:Number(m),transactionCount:Number(E)};e.mode==="store"?x.visitors=Number(v):x.employee=e.employee,t(x)};return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:s("add_daily_kpis")}),h.jsxs("form",{onSubmit:C,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("date")}),h.jsx("input",{type:"date",value:u,onChange:b=>c(b.target.value),required:!0,className:"input"})]}),e.mode==="employee"?h.jsxs("p",{children:["For: ",h.jsx("strong",{children:e.employee})]}):h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("store")}),h.jsxs("select",{value:f,onChange:b=>p(b.target.value),required:!0,className:"input",children:[h.jsx("option",{value:"",children:s("select_store")}),o.map(b=>h.jsx("option",{value:b.name,children:b.name},b.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("total_sales")}),h.jsx("input",{type:"number",value:m,onChange:b=>y(b.target.value),required:!0,className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("number_of_bills")}),h.jsx("input",{type:"number",value:E,onChange:b=>_(b.target.value),required:!0,className:"input"})]}),e.mode==="store"&&h.jsxs("div",{children:[h.jsx("label",{className:"label",children:s("total_visitors")}),h.jsx("input",{type:"number",value:v,onChange:b=>w(b.target.value),required:!0,className:"input"})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:s("cancel")}),h.jsx("button",{type:"submit",disabled:r,className:"btn-primary",children:s(r?"saving":"save_kpis")})]})]})]})},U5=({onSave:e,onClose:t,isProcessing:n,stores:r})=>{const{t:o}=Oe(),[s,u]=M.useState(new Date().getFullYear()),[c,f]=M.useState(new Date().getMonth()+1),[p,m]=M.useState(""),[y,v]=M.useState(""),[w,E]=M.useState(""),[_,C]=M.useState(""),b=j=>{j.preventDefault();const k=Number(y),A=Number(_),T=Number(w);e({year:s,month:c,store:p,totalSales:k,visitors:T,transactionCount:A,atv:A>0?k/A:0,visitorRate:T>0?A/T*100:0})},N=[new Date().getFullYear()-2,new Date().getFullYear()-1,new Date().getFullYear()],x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:o("add_historical_monthly_data")}),h.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("year")}),h.jsx("select",{value:s,onChange:j=>u(Number(j.target.value)),className:"input",children:N.map(j=>h.jsx("option",{value:j,children:j},j))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("month")}),h.jsx("select",{value:c,onChange:j=>f(Number(j.target.value)),className:"input",children:x.map((j,k)=>h.jsx("option",{value:k+1,children:j},k+1))})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("store")}),h.jsxs("select",{value:p,onChange:j=>m(j.target.value),required:!0,className:"input",children:[h.jsx("option",{value:"",children:o("select_store")}),r.map(j=>h.jsx("option",{value:j.name,children:j.name},j.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("total_monthly_sales")}),h.jsx("input",{type:"number",value:y,onChange:j=>v(j.target.value),required:!0,className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("total_monthly_bills")}),h.jsx("input",{type:"number",value:_,onChange:j=>C(j.target.value),required:!0,className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("total_monthly_visitors")}),h.jsx("input",{type:"number",value:w,onChange:j=>E(j.target.value),required:!0,className:"input"})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:t,className:"btn-secondary",children:o("cancel")}),h.jsx("button",{type:"submit",disabled:n,className:"btn-primary",children:o(n?"saving":"save_data")})]})]})]})},F5=({data:e,onSave:t,onClose:n,isProcessing:r,stores:o,allEmployees:s})=>{const{t:u}=Oe(),[c,f]=M.useState(e.role||"employee"),[p,m]=M.useState(""),[y,v]=M.useState("");M.useEffect(()=>{var N;if(e.status==="pending"&&e.employeeId){const x=s.find(j=>j.employeeId===e.employeeId);if(x!=null&&x.currentStore){const j=x.currentStore;v(j);const k=o.find(A=>A.name===j);k!=null&&k.areaManager&&m(k.areaManager)}}else v(e.store||""),m(e.areaManager||((N=o.find(x=>x.name===e.store))==null?void 0:N.areaManager)||"")},[e,s,o]);const w=M.useMemo(()=>[...new Set(o.map(N=>N.areaManager))],[o]),E=M.useMemo(()=>p?o.filter(N=>N.areaManager===p):o,[p,o]),_=["admin","general_manager","area_manager","store_manager","employee"],C=N=>{N.preventDefault();const x={role:c,status:"active"};c==="area_manager"?(x.areaManager=p,x.store=""):(c==="store_manager"||c==="employee")&&(x.areaManager=p,x.store=y),t(e.id,x)},b=e.status==="pending"?u("approve_and_save"):u("save_changes");return h.jsxs("div",{className:"modal-content",children:[h.jsxs("h2",{className:"modal-title",children:[u("edit_user"),": ",e.name]}),h.jsxs("p",{className:"text-sm text-gray-500 -mt-2 mb-4",children:[e.email," (",u("employee_id"),": ",e.employeeId,")"]}),h.jsxs("form",{onSubmit:C,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("role")}),h.jsx("select",{value:c,onChange:N=>f(N.target.value),className:"input",children:_.map(N=>h.jsx("option",{value:N,children:N.replace(/_/g," ")},N))})]}),(c==="area_manager"||c==="store_manager"||c==="employee")&&h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("area_manager")}),h.jsxs("select",{value:p,onChange:N=>{m(N.target.value),v("")},required:!0,className:"input",children:[h.jsx("option",{value:"",children:u("select_area")}),w.map(N=>h.jsx("option",{value:N,children:N},N))]})]}),(c==="store_manager"||c==="employee")&&h.jsxs("div",{children:[h.jsx("label",{className:"label",children:u("store")}),h.jsxs("select",{value:y,onChange:N=>v(N.target.value),required:!0,disabled:!p,className:"input",children:[h.jsx("option",{value:"",children:u("select_store")}),E.map(N=>h.jsx("option",{value:N.name,children:N.name},N.id))]})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:u("cancel")}),h.jsx("button",{type:"submit",disabled:r,className:"btn-primary",children:r?u("saving"):b})]})]})]})},$5=({message:e,onClose:t})=>{const{t:n}=Oe();return h.jsx("div",{className:"modal-backdrop",children:h.jsxs("div",{className:"modal-content text-center",children:[h.jsx("h3",{className:"modal-title",children:e.type==="confirm"?n("confirmation"):n("alert")}),h.jsx("p",{children:e.text}),h.jsxs("div",{className:"modal-actions justify-center",children:[e.type==="confirm"&&e.onConfirm&&h.jsx("button",{onClick:()=>{e.onConfirm(),t()},className:"btn-danger",children:n("confirm")}),h.jsx("button",{onClick:t,className:"btn-secondary",children:n("close")})]})]})})},V5=({data:e,onSave:t,onClose:n,isProcessing:r})=>{const{t:o}=Oe(),[s,u]=M.useState(""),[c,f]=M.useState(""),p=m=>{m.preventDefault(),!(!s.trim()||!c.trim())&&t({recipientId:e.employeeId||"",recipientName:e.name,title:s,message:c})};return h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:o("send_task_alert_to",{name:e.name})}),h.jsxs("form",{onSubmit:p,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("title")}),h.jsx("input",{type:"text",value:s,onChange:m=>u(m.target.value),required:!0,className:"input",placeholder:"e.g., Follow up on VIP customer"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("message_instructions")}),h.jsx("textarea",{value:c,onChange:m=>f(m.target.value),required:!0,className:"input h-32",placeholder:"Provide details about the task..."})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",onClick:n,disabled:r,className:"btn-secondary",children:o("cancel")}),h.jsx("button",{type:"submit",disabled:r,className:"btn-primary",children:o(r?"sending":"send_task")})]})]})]})},Fp=({title:e,children:t,onClose:n,isLoading:r})=>{const{t:o}=Oe();return h.jsxs("div",{className:"modal-content max-w-2xl",children:[h.jsxs("h2",{className:"modal-title flex items-center gap-2",children:[h.jsx(Mi,{})," ",e]}),h.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:r?h.jsxs("div",{className:"text-center p-8",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mx-auto"}),h.jsx("p",{className:"mt-2 text-zinc-600",children:o("generating_insights")})]}):h.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:String(t).replace(/\n/g,"<br />").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>")}})}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:n,className:"btn-secondary",children:o("close")})})]})},B5=({data:e,onClose:t})=>{const{t:n,locale:r}=Oe(),[o,s]=M.useState(""),[u,c]=M.useState(!0);return M.useEffect(()=>{(async()=>{const p=r==="ar"?"Provide the response in Arabic.":"",m=`Generate a short, motivational coaching message for a retail employee named ${e.name}. Their current performance data is provided. Focus on one key area for improvement and provide two practical tips. Keep it positive and encouraging. ${p} Data: ${JSON.stringify(e)}`;try{const y=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:m}]}]});s(y)}catch(y){s(`Error: ${y.message}`)}finally{c(!1)}})()},[e,r]),h.jsx(Fp,{title:n("coaching_for",{name:e.name}),onClose:t,isLoading:u,children:o})},z5=({salesData:e,onClose:t})=>{const{t:n,locale:r}=Oe(),[o,s]=M.useState(""),[u,c]=M.useState(!0);return M.useEffect(()=>{(async()=>{const m=`Based on the following daily sales data, provide a brief trend analysis and a simple sales forecast for the next 7 days. ${r==="ar"?"Provide the response in Arabic.":""} Data: ${JSON.stringify(e.slice(-30))}`;try{const y=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:m}]}]});s(y)}catch(y){s(`Error: ${y.message}`)}finally{c(!1)}})()},[e,r]),h.jsx(Fp,{title:n("sales_forecast_analysis"),onClose:t,isLoading:u,children:o})},q5=({product:e,onClose:t})=>{const{t:n,locale:r}=Oe(),[o,s]=M.useState(""),[u,c]=M.useState(!0);return M.useEffect(()=>{(async()=>{const m=`Create a short, compelling sales pitch for a retail salesperson to sell the following product. Focus on 2 key benefits. ${r==="ar"?"Provide the response in Arabic.":""} Product Name: ${e.name}, Category: ${qd(e)}, Price: ${e.price} SAR.`;try{const y=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:m}]}]});s(y)}catch(y){s(`Error: ${y.message}`)}finally{c(!1)}})()},[e,r]),h.jsx(Fp,{title:n("sales_pitch_for",{name:e.name}),onClose:t,isLoading:u,children:o})},K5=({query:e,fullData:t,onClose:n})=>{const{t:r,locale:o}=Oe(),[s,u]=M.useState(""),[c,f]=M.useState(!0);return M.useEffect(()=>{(async()=>{const m=o==="ar"?"All responses must be in Arabic.":"",y=`--- DATA SNAPSHOT ---
${JSON.stringify(t,null,2)}
--- END DATA ---`,v=`You are an expert retail analyst. Your answers must be based strictly on the provided DATA SNAPSHOT. Provide concise, actionable insights in response to the user's query. Use markdown for formatting. ${m}`,w=`User Query: "${e}"`;try{const E=await hi({model:"gemini-2.5-flash",contents:[{role:"user",parts:[{text:`${y}

${w}`}]}],config:{systemInstruction:v}});u(E)}catch(E){u(`Sorry, an error occurred: ${E.message}`)}finally{f(!1)}})()},[e,t,o]),h.jsx(Fp,{title:r("results_for",{query:e}),onClose:n,isLoading:c,children:s})},H5=({data:e,allItems:t,type:n,onClose:r})=>{const{t:o,locale:s}=Oe(),[u,c]=M.useState(""),[f,p]=M.useState(""),[m,y]=M.useState(!1),v=M.useMemo(()=>t.filter(E=>E.id!==e.id),[t,e.id]),w=async()=>{if(!u)return;const E=t.find(b=>b.id===u);if(!E)return;y(!0),p("");const C=`You are a retail performance analyst. Provide a detailed comparison between these two ${n}s. Analyze their key metrics, identify the main differences in performance, and suggest reasons for these differences. Conclude with a specific recommendation for each. Use markdown formatting. ${s==="ar"?"Provide the response in Arabic.":""}
        
        **${n==="store"?"Store 1":"Employee 1"}:**
        ${JSON.stringify(e,null,2)}

        **${n==="store"?"Store 2":"Employee 2"}:**
        ${JSON.stringify(E,null,2)}`;try{const b=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:C}]}]});p(b)}catch(b){p(`Error generating comparison: ${b.message}`)}finally{y(!1)}};return h.jsxs("div",{className:"modal-content max-w-2xl",children:[h.jsxs("h2",{className:"modal-title flex items-center gap-2",children:[h.jsx(Mi,{})," ",o("ai_comparison")]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("comparing")}),h.jsx("p",{className:"font-bold text-lg",children:e.name})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:o("with")}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("select",{value:u,onChange:E=>c(E.target.value),className:"input flex-grow",children:[h.jsx("option",{value:"",children:o(n==="store"?"select_store":"add_employee")}),v.map(E=>h.jsx("option",{value:E.id,children:E.name},E.id))]}),h.jsx("button",{onClick:w,disabled:!u||m,className:"btn-primary",children:o("compare")})]})]}),(m||f)&&h.jsx("div",{className:"mt-4 border-t pt-4",children:m?h.jsxs("div",{className:"text-center p-8",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mx-auto"}),h.jsx("p",{className:"mt-2 text-zinc-600",children:o("generating_comparison")})]}):h.jsx("div",{className:"max-h-[40vh] overflow-y-auto pr-2 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:f.replace(/\n/g,"<br />").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})})]}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:r,className:"btn-secondary",children:o("close")})})]})},G5=({data:e,onClose:t})=>{const{t:n,locale:r}=Oe(),{store:o,allMetrics:s}=e,[u,c]=M.useState(null),[f,p]=M.useState(null),[m,y]=M.useState(!0);M.useEffect(()=>{(async()=>{y(!0),p(null);try{const E=await k6(o,s,r);c(E)}catch(E){p(E.message||"An unknown error occurred during prediction."),console.error(E)}finally{y(!1)}})()},[o,s,r]);const v=w=>w>60?"text-red-600":w>30?"text-yellow-600":"text-green-600";return h.jsxs("div",{className:"modal-content max-w-lg",children:[h.jsxs("h2",{className:"modal-title flex items-center gap-2",children:[h.jsx(Mi,{})," ",n("predictive_analysis_for")," ",o.name]}),m?h.jsxs("div",{className:"text-center p-8",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mx-auto"}),h.jsx("p",{className:"mt-2 text-zinc-600",children:n("generating_prediction")})]}):f?h.jsxs("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg",children:[h.jsx("h4",{className:"font-bold",children:n("error")}),h.jsx("p",{children:f})]}):u&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-sm font-semibold text-zinc-500",children:n("risk_score_target")}),h.jsxs("p",{className:`text-6xl font-bold ${v(u.riskScore)}`,children:[u.riskScore,h.jsx("span",{className:"text-2xl",children:"%"})]})]}),h.jsxs("div",{className:"space-y-2 text-sm",children:[h.jsxs("div",{className:"flex justify-between p-2 rounded bg-gray-50",children:[h.jsx("span",{className:"font-semibold text-zinc-600",children:n("ai_predicted_sales")}),h.jsx("span",{className:"font-bold",children:u.predictedSales.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{className:"flex justify-between p-2 rounded bg-gray-50",children:[h.jsx("span",{className:"font-semibold text-zinc-600",children:n("current_month_target")}),h.jsx("span",{className:"font-bold",children:o.effectiveTarget.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-semibold text-zinc-600 mb-1",children:n("ai_justification")}),h.jsx("p",{className:"p-3 bg-blue-50 text-blue-800 rounded-lg text-sm",children:u.justification})]})]}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:t,className:"btn-secondary",children:n("close")})})]})},W5=({data:e,onClose:t})=>{var u;const{t:n}=Oe(),{title:r,kpi:o,data:s}=e;return o==="totalSales"&&((u=s[0])!=null&&u.areaManager)?h.jsxs("div",{className:"modal-content max-w-2xl",children:[h.jsxs("h2",{className:"modal-title",children:[r," Breakdown"]}),h.jsx("div",{className:"h-96",children:h.jsx(tr,{title:n("sales_by_store"),children:h.jsx(vs,{data:s,dataKey:"totalSales",nameKey:"name",format:c=>c.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})})}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:t,className:"btn-secondary",children:n("close")})})]}):h.jsxs("div",{className:"modal-content",children:[h.jsx("h2",{className:"modal-title",children:r}),h.jsx("p",{children:"Detailed breakdown for this KPI is not yet available."}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:t,className:"btn-secondary",children:n("close")})})]})},Y5=({data:e,onClose:t})=>{const{product:n,allData:r,stores:o}=e,[s,u]=M.useState("All"),[c,f]=M.useState(""),[p,m]=M.useState(!1),y=N=>String(N??"").trim().toUpperCase();M.useEffect(()=>{console.log("✅ Stage 4 Completed — Ready for Next Step")},[]);const v=M.useMemo(()=>{const N=new Set(o.filter(k=>s==="All"||k.name===s).map(k=>k.name)),x=y(n.alias),j=y(n.name);return r.filter(k=>{if(!k||!N.has(k["Outlet Name"]))return!1;const A=y(k["Item Alias"]),T=y(k["Item Name"]);return A===x||T===j})},[r,n.alias,n.name,o,s]),w=M.useMemo(()=>{var j,k,A,T,L;const N=Array.from({length:12},(U,K)=>({name:new Date(0,K).toLocaleString("en-US",{month:"short"}),Sales:0,Target:0})),x=((L=(T=(A=(k=(j=v[0])==null?void 0:j["Bill Dt."])==null?void 0:k.toDate)==null?void 0:A.call(k))==null?void 0:T.getUTCFullYear)==null?void 0:L.call(T))??new Date().getUTCFullYear();return v.forEach(U=>{const K=U["Bill Dt."].toDate();if(K.getUTCFullYear()!==x)return;const $=Number(U["Sold Qty"]||0)*Number(U["Item Rate"]||0);N[K.getUTCMonth()].Sales+=$}),N},[v]),E=M.useMemo(()=>{const N=v.reduce((j,k)=>j+Number(k["Sold Qty"]||0),0),x=v.reduce((j,k)=>j+Number(k["Sold Qty"]||0)*Number(k["Item Rate"]||0),0);return{qty:N,value:x}},[v]),_=M.useMemo(()=>{const N=new Map,x=new Map;r.forEach(U=>{var P,Z;const K=(Z=(P=U["Bill Dt."])==null?void 0:P.toDate)==null?void 0:Z.call(P);if(!K)return;const $=(U.bill_no||U.Bill_No||U.Invoice||U.Transaction_ID||U["Bill Number"]||U["Invoice No"]||"").toString(),O=$?String($):`${K.getUTCFullYear()}-${K.getUTCMonth()}-${K.getUTCDate()}|${U["Outlet Name"]}|${U["SalesMan Name"]||""}`;$||console.warn("⚠ Missing Bill_No, using fallback mode");const R=String(U["Item Alias"]||U.alias||"").trim(),X=String(U["Item Name"]||"").trim(),q=y(R),J=y(X),V=q||J;if(V){x.has(V)||x.set(V,{alias:R,name:X});const z=N.get(O)||[];z.push({key:V,aliasRaw:R,nameRaw:X}),N.set(O,z)}});const j=y(n.alias),k=y(n.name),A=new Map;let T=0;return N.forEach(U=>{const K=Array.from(new Set(U.map(O=>O.key)));(K.includes(j)||K.includes(k))&&(T++,K.forEach(O=>{O===j||O===k||A.set(O,(A.get(O)||0)+1)}))}),{top:Array.from(A.entries()).map(([U,K])=>{var $,O;return{key:U,count:K,alias:(($=x.get(U))==null?void 0:$.alias)||"",name:((O=x.get(U))==null?void 0:O.name)||""}}).sort((U,K)=>K.count-U.count).slice(0,3),invoicesWithTarget:T}},[r,n]),C=async()=>{m(!0);try{const{top:N,invoicesWithTarget:x}=_;if(!x||x<3||N.length===0)f("لا توجد بيانات كافية لإصدار توصية دقيقة.");else{const j=N.map(L=>({key:L.key,count:L.count,pct:Math.round(L.count/x*100)})),k=`يعتمد هذا التحليل على bill_no فقط. عدد الفواتير التي ظهر فيها المنتج: ${x}.
أفضل ارتباطات: ${j.map(L=>`${L.key}: ${L.count} (${L.pct}%)`).join(", ")}`,A=`أنت نظام توصية يعتمد بالكامل على رقم الفاتورة bill_no.
المنتج: ${n.name} (الكود ${n.alias}).
${k}
اكتب 2-3 توصيات عملية ومباشرة بالعربية، مثل: "ينباع عادةً مع X بناءً على بيانات الفواتير"، واذكر النِسَب %. تجنب أي استدلالات لا تعتمد على bill_no.`,T=await hi({model:"gemini-2.5-flash",contents:[{parts:[{text:A}]}]});f(T)}}catch(N){f(`تعذر توليد التوصية: ${(N==null?void 0:N.message)||N}`)}finally{m(!1)}},b=()=>{const x=[["Product",n.name],["Code",n.alias],["Unit Price",String(n.price)],[],["Month","Sales Value"],...w.map(T=>[T.name,String(T.Sales)])].map(T=>T.map(L=>`"${String(L).replace(/"/g,'""')}"`).join(",")).join(`
`),j=new Blob([x],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(j),A=document.createElement("a");A.href=k,A.download=`${n.alias}_insights.csv`,A.click(),URL.revokeObjectURL(k)};return h.jsxs("div",{className:"modal-content max-w-3xl",children:[h.jsxs("h2",{className:"modal-title flex items-center gap-2",children:["Product Details — ",n.name]}),h.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:[h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 bg-gray-50 p-4 rounded-lg border",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-zinc-500",children:"Code"}),h.jsx("div",{className:"font-semibold",children:n.alias})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-zinc-500",children:"Unit Price"}),h.jsx("div",{className:"font-semibold",children:n.price.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-zinc-500",children:"Total Qty"}),h.jsx("div",{className:"font-semibold",children:E.qty.toLocaleString("en-US")})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-zinc-500",children:"Total Value"}),h.jsx("div",{className:"font-semibold",children:E.value.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("label",{className:"label",children:"Branch"}),h.jsxs("select",{value:s,onChange:N=>u(N.target.value),className:"input w-56",children:[h.jsx("option",{value:"All",children:"All"}),o.map(N=>h.jsx("option",{value:N.name,children:N.name},N.id))]})]}),h.jsx(tr,{title:"Monthly Trend (This Year)",children:h.jsx(vs,{data:w,dataKey:"Sales",nameKey:"name",format:N=>N.toLocaleString("en-US",{style:"currency",currency:"SAR",maximumFractionDigits:0})})}),h.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[h.jsx("h3",{className:"font-semibold mb-2",children:"Sold With (Top 3)"}),h.jsxs("ul",{className:"list-disc ms-5 text-sm text-zinc-700",children:[_.top.length===0&&h.jsx("li",{children:"لا يوجد بيانات كافية"}),_.top.map(N=>h.jsxs("li",{children:[N.alias||N.key," — ",N.name," (",N.count,")"]},N.key))]})]}),h.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200 text-blue-900",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"font-semibold",children:"AI Recommendation"}),h.jsx("button",{onClick:C,className:"btn-primary text-sm",disabled:p,children:p?"Generating...":"Generate"})]}),c&&h.jsx("div",{className:"mt-2 whitespace-pre-wrap text-sm",children:c})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx("button",{onClick:b,className:"btn-secondary",children:"📤 Export Insights"})})]}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{onClick:t,className:"btn-secondary",children:"Close"})})]})},{Timestamp:ti}=de.firestore,Q5=({icon:e,label:t,name:n,activeTab:r,setActiveTab:o,setIsSidebarOpen:s})=>{const u=r===n,c=()=>{o(n),s(!1)};return h.jsxs("li",{onClick:c,className:`group relative flex items-center p-3 rounded-xl cursor-pointer transition-all duration-300 ${u?"bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold shadow-lg":"text-neutral-600 hover:bg-orange-50 hover:text-orange-600 hover:shadow-md"}`,children:[h.jsxs("div",{className:"relative z-10 flex items-center w-full",children:[h.jsx("div",{className:`p-2 rounded-lg transition-all duration-200 flex-shrink-0 ${u?"bg-white/20":"bg-neutral-100 group-hover:bg-orange-100"}`,children:e}),h.jsx("span",{className:"ms-3 font-medium text-sm whitespace-nowrap",children:t})]}),u&&h.jsx("div",{className:"absolute right-3 w-2 h-2 bg-white rounded-full shadow-sm"})]})},X5=({notifications:e,onNotificationClick:t})=>{const{t:n}=Oe(),[r,o]=M.useState(!1),s=e.filter(u=>!u.read).length;return h.jsxs("div",{className:"relative",children:[h.jsxs("button",{onClick:()=>o(!r),className:"relative p-2 text-zinc-600 hover:bg-gray-100 rounded-full",children:[h.jsx(Y6,{}),s>0&&h.jsx("span",{className:"absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-white"})]}),r&&h.jsxs("div",{className:"absolute top-full mt-2 end-0 w-80 bg-white rounded-lg shadow-xl border z-10",onMouseLeave:()=>o(!1),children:[h.jsx("div",{className:"p-3 font-semibold text-sm border-b",children:n("notifications")}),e.length===0?h.jsx("p",{className:"p-4 text-sm text-gray-500",children:n("no_notifications")}):h.jsx("ul",{className:"max-h-80 overflow-y-auto",children:e.map(u=>h.jsxs("li",{onClick:()=>t(u.id),className:`p-3 text-sm border-b hover:bg-gray-50 cursor-pointer ${u.read?"":"bg-blue-50"}`,children:[h.jsx("p",{className:"font-semibold",children:n("new_user_registered")}),h.jsx("p",{className:"text-gray-600",children:n("user_awaits_approval",{name:u.userName})})]},u.id))})]})]})},J5=({user:e,profile:t,onLogout:n})=>{const{t:r}=Oe(),[o,s]=M.useState(!1),[u,c]=M.useState({greeting:"",Icon:sI});M.useEffect(()=>{const p=new Date().getHours(),m=p>=4&&p<12?"greeting_morning":"greeting_evening";c({greeting:r(m),Icon:p>=4&&p<12?sI:G6})},[r]);const f=M.useMemo(()=>{var m;if(t!=null&&t.name)return t.name;if(e.displayName)return e.displayName;if(!e.email)return"User";const p=e.email.split("@")[0];return((m=p==null?void 0:p.charAt(0))==null?void 0:m.toUpperCase())+(p==null?void 0:p.slice(1))||"User"},[e,t]);return h.jsxs("div",{className:"relative",children:[h.jsxs("button",{onClick:()=>s(!o),className:"flex items-center gap-2 text-sm text-zinc-700 font-medium greeting-fade-in p-2 rounded-lg hover:bg-gray-100",children:[h.jsx(u.Icon,{}),h.jsxs("span",{children:[u.greeting,", ",f]}),h.jsx(W6,{})]}),o&&h.jsx("div",{className:"absolute top-full mt-2 end-0 w-48 bg-white rounded-lg shadow-xl border z-10",onMouseLeave:()=>s(!1),children:h.jsx("ul",{className:"p-2 text-sm text-gray-700",children:h.jsx("li",{children:h.jsxs("button",{onClick:n,className:"w-full text-start flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-100 text-red-600",children:[h.jsx(CA,{})," ",r("logout")]})})})})]})},Z5=({user:e,profile:t})=>{var Xt,Tu;const{t:n,locale:r,setLocale:o}=Oe(),[s,u]=M.useState("dashboard"),[c,f]=M.useState(!1),[p,m]=M.useState([]),[y,v]=M.useState([]),[w,E]=M.useState([]),[_,C]=M.useState([]),[b,N]=M.useState([]),[x,j]=M.useState([]),[k,A]=M.useState([]),[T,L]=M.useState([]),[U,K]=M.useState(!0),[$,O]=M.useState({year:new Date().getFullYear(),month:new Date().getMonth(),day:"all"}),[R,X]=M.useState({areaManager:((t==null?void 0:t.role)==="area_manager"||(t==null?void 0:t.role)==="store_manager")&&t.areaManager||"All",store:((t==null?void 0:t.role)==="store_manager"||(t==null?void 0:t.role)==="employee")&&t.store||"All"}),[q,J]=M.useState(null),[V,P]=M.useState({type:null,data:null}),[Z,z]=M.useState({isOpen:!1,text:"",type:"alert"}),[ae,Q]=M.useState(!1),[we,De]=M.useState(!1),[xe,Ve]=M.useState(null),[re,je]=M.useState([]);M.useEffect(()=>{if(!t)return;const se={stores:m,employees:v,dailyMetrics:E,kingDuvetSales:C,salesTransactions:N,businessRules:j};((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="general_manager")&&(se.users=A);const ie=Object.keys(se);let Ne=0;const We=Object.entries(se).map(([wt,Fe])=>Se.collection(wt).onSnapshot(Nt=>{const Et=Nt.docs.map(Tr=>({id:Tr.id,...Tr.data()}));Fe(Et),We.length>0&&Ne<ie.length&&(Ne++,Ne===ie.length&&K(!1))},Nt=>{console.error(`Error fetching ${wt}:`,Nt),We.length>0&&Ne<ie.length&&(Ne++,Ne===ie.length&&K(!1))}));let Ct=()=>{};return t!=null&&t.employeeId&&(Ct=Se.collection("tasks").where("recipientId","==",t.employeeId).orderBy("createdAt","desc").onSnapshot(Fe=>{const Nt=Fe.docs.map(Et=>({id:Et.id,...Et.data()}));L(Nt)},Fe=>{console.error("Error fetching tasks:",Fe)})),()=>{We.forEach(wt=>wt()),Ct()}},[t]),M.useEffect(()=>{if((t==null?void 0:t.role)!=="admin"&&(t==null?void 0:t.role)!=="general_manager")return;const ie=Se.collection("users").where("status","==","pending").onSnapshot(Ne=>{const We=[],Ct=new Set;Ne.forEach(wt=>{const Fe=wt.data();Ct.add(Fe.id),re.some(Et=>Et.id===Fe.id)||We.push({id:Fe.id,userName:Fe.name,message:`New user "${Fe.name}" is awaiting approval.`,type:"newUser",timestamp:ti.now(),read:!1})}),je(wt=>[...We,...wt.filter(Fe=>Ct.has(Fe.id))].sort((Fe,Nt)=>Nt.timestamp.toMillis()-Fe.timestamp.toMillis()))});return()=>ie()},[t,re]);const et=se=>{je(ie=>ie.map(Ne=>Ne.id===se?{...Ne,read:!0}:Ne)),u("pendingApprovals")},ft=M.useMemo(()=>{if(q){const se=p.find(ie=>ie.name===q);return{areaManager:(se==null?void 0:se.areaManager)||"All",store:q}}return R},[q,R,p]),Ce=YV({stores:p,employees:y,dailyMetrics:w,kingDuvetSales:_,salesTransactions:b,dateFilter:$,areaStoreFilter:ft,profile:t}),st=M.useMemo(()=>[...w,...b,..._],[w,b,_]),{handleSmartUpload:Ze,uploadResult:at,clearUploadResult:dt}=C6(Se,z,Q,y,p),Dn=M.useCallback((se,ie)=>{De(!0),se(ie),setTimeout(()=>De(!1),50)},[]),Hr=async(se,ie)=>{if(!ie.id&&(t==null?void 0:t.role)!=="admin"){z({isOpen:!0,text:"You do not have permission to add new items.",type:"alert"});return}if(se==="employees"&&(t==null?void 0:t.role)!=="admin"&&(t==null?void 0:t.role)!=="area_manager"){z({isOpen:!0,text:"You do not have permission to modify employees.",type:"alert"});return}if(se==="stores"&&(t==null?void 0:t.role)!=="admin"&&(t==null?void 0:t.role)!=="general_manager"){z({isOpen:!0,text:"You do not have permission to modify stores.",type:"alert"});return}Q(!0);try{const We=ie.id||ie.name.replace(/\s+/g,"_"),Ct=Se.collection(se).doc(We),wt={name:ie.name};if("store"in ie&&(wt.currentStore=ie.store),"areaManager"in ie&&(wt.areaManager=ie.areaManager),await Ct.set(wt,{merge:!0}),ie.targetUpdate){const{year:Fe,month:Nt,salesTarget:Et,duvetTarget:Tr}=ie.targetUpdate,dr={};Et!==void 0&&(dr[`targets.${Fe}.${Nt}`]=Et),Tr!==void 0&&(dr[`duvetTargets.${Fe}.${Nt}`]=Tr),Object.keys(dr).length>0&&await Ct.update(dr)}z({isOpen:!0,text:n("save_success",{item:n(se.slice(0,-1))}),type:"alert"})}catch(We){z({isOpen:!0,text:`${n("error")}: ${We.message}`,type:"alert"})}finally{Q(!1),P({type:null})}},Ir=(se,ie,Ne)=>{if((t==null?void 0:t.role)!=="admin"){z({isOpen:!0,text:"You do not have permission to delete items.",type:"alert"});return}z({isOpen:!0,text:n("confirm_delete",{name:Ne}),type:"confirm",onConfirm:async()=>{Q(!0);try{await Se.collection(se).doc(ie).delete(),z({isOpen:!0,text:n("delete_success",{name:Ne}),type:"alert"})}catch(We){z({isOpen:!0,text:`${n("error")}: ${We.message}`,type:"alert"})}finally{Q(!1)}}})},zs=async se=>{Q(!0);try{const ie=new Date(se.date),Ne=ti.fromDate(ie);await Se.collection("dailyMetrics").add({...se,date:Ne}),z({isOpen:!0,text:n("daily_metric_success"),type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error")}: ${ie.message}`,type:"alert"})}finally{Q(!1),P({type:null})}},ve=async se=>{Q(!0);try{const{date:ie,store:Ne,visitors:We}=se,Ct=ti.fromDate(new Date(ie)),wt=`${ie}_${Ne.replace(/\s+/g,"-")}`;await Se.collection("dailyMetrics").doc(wt).set({date:Ct,store:Ne,visitors:We},{merge:!0}),z({isOpen:!0,text:n("add_visitors_success"),type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error")}: ${ie.message}`,type:"alert"})}finally{Q(!1),P({type:null})}},Ue=async se=>{Q(!0);try{const{year:ie,month:Ne,store:We,totalSales:Ct,visitors:wt,transactionCount:Fe,atv:Nt,visitorRate:Et}=se,Tr=new Date(ie,Ne,0).getDate(),dr=`${ie}-${String(Ne).padStart(2,"0")}-${String(Tr).padStart(2,"0")}`,Li=new Date(dr),fi=ti.fromDate(Li);await Se.collection("dailyMetrics").add({date:fi,store:We,totalSales:Ct,visitors:wt,transactionCount:Fe,atv:Nt,visitorRate:Et,isMonthlySummary:!0}),z({isOpen:!0,text:n("monthly_metric_success"),type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error")}: ${ie.message}`,type:"alert"})}finally{Q(!1),P({type:null})}},oe=()=>{z({isOpen:!0,text:n("confirm_delete_all"),type:"confirm",onConfirm:async()=>{Q(!0);const se=["dailyMetrics","kingDuvetSales","salesTransactions","employees","stores","businessRules"];try{for(const ie of se){const Ne=await Se.collection(ie).get(),We=Se.batch();Ne.docs.forEach(Ct=>We.delete(Ct.ref)),await We.commit()}z({isOpen:!0,text:n("delete_all_success"),type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error_deleting_data")}: ${ie.message}`,type:"alert"})}finally{Q(!1)}}})},ye=async(se,ie,Ne)=>{const We=new Date(ie,Ne).toLocaleString(r,{month:"long"}),wt=n(se==="visitors"?"confirm_delete_visitors_data":se==="sales"?"confirm_delete_sales_data":"confirm_delete_products_data",{month:We,year:ie.toString()});z({isOpen:!0,text:wt,type:"confirm",onConfirm:async()=>{Q(!0);try{const Fe=ti.fromDate(new Date(ie,Ne,1)),Nt=ti.fromDate(new Date(ie,Ne+1,0,23,59,59)),Et=Se.batch();if(se==="visitors")(await Se.collection("dailyMetrics").where("date",">=",Fe).where("date","<=",Nt).get()).forEach(fi=>{Et.update(fi.ref,{visitors:de.firestore.FieldValue.delete()})});else if(se==="sales")(await Se.collection("dailyMetrics").where("date",">=",Fe).where("date","<=",Nt).get()).forEach(pr=>{Et.update(pr.ref,{totalSales:de.firestore.FieldValue.delete(),transactionCount:de.firestore.FieldValue.delete(),employee:de.firestore.FieldValue.delete(),employeeId:de.firestore.FieldValue.delete()})}),(await Se.collection("salesTransactions").where("Bill Dt.",">=",Fe).where("Bill Dt.","<=",Nt).get()).forEach(pr=>Et.delete(pr.ref)),(await Se.collection("kingDuvetSales").where("Bill Dt.",">=",Fe).where("Bill Dt.","<=",Nt).get()).forEach(pr=>Et.delete(pr.ref));else if(se==="products"){const dr=ti.fromDate(new Date(ie,Ne,1)),Li=ti.fromDate(new Date(ie,Ne+1,0,23,59,59)),fi=async At=>{const Pi=await Se.collection(At).where("Bill Dt.",">=",dr).where("Bill Dt.","<=",Li).get();console.log(`[SelectiveDelete] ${At} matched:`,Pi.size);let Ks=0,pr=Se.batch();for(const Xc of Pi.docs)pr.delete(Xc.ref),Ks++,Ks%400===0&&(await pr.commit(),console.log(`[SelectiveDelete] ${At} committed 400 deletes`),pr=Se.batch());await pr.commit(),console.log(`[SelectiveDelete] ${At} final commit; total deleted: ${Ks}`)};await fi("salesTransactions"),await fi("kingDuvetSales")}await Et.commit();const Tr=n("delete_success_for_period",{dataType:n(se),month:We,year:ie.toString()});z({isOpen:!0,text:Tr,type:"alert"})}catch(Fe){z({isOpen:!0,text:`${n("error")}: ${Fe.message}`,type:"alert"})}finally{Q(!1)}}})},Te=async se=>{if(se.trim()){Q(!0);try{await Se.collection("businessRules").add({rule:se}),z({isOpen:!0,text:n("rule_saved_success"),type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error")}: ${ie.message}`,type:"alert"})}finally{Q(!1)}}},qt=async(se,ie)=>{Q(!0);try{await Se.collection("users").doc(se).update(ie),z({isOpen:!0,text:n("user_updated_success"),type:"alert"})}catch(Ne){z({isOpen:!0,text:`${n("error")}: ${Ne.message}`,type:"alert"})}finally{Q(!1),P({type:null})}},Kt=async se=>{if(!(!e||!t)){Q(!0);try{const ie={...se,senderId:e.uid,senderName:t.name,status:"pending",createdAt:ti.now()};await Se.collection("tasks").add(ie),z({isOpen:!0,text:`Task sent to ${se.recipientName}.`,type:"alert"})}catch(ie){z({isOpen:!0,text:`${n("error")}: ${ie.message}`,type:"alert"})}finally{Q(!1),P({type:null})}}},Do=async(se,ie)=>{try{const Ne=Se.collection("tasks").doc(se),We={status:ie};ie==="completed"&&(We.completedAt=ti.now()),await Ne.update(We)}catch(Ne){z({isOpen:!0,text:`Error updating task: ${Ne.message}`,type:"alert"})}},Gn=async()=>{await Nc.signOut()},ze=M.useMemo(()=>{const se=(t==null?void 0:t.role)||"employee";return[{icon:h.jsx(R6,{}),label:n("dashboard"),name:"dashboard",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx($6,{}),label:n("lfl_comparison"),name:"lfl",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx(O6,{}),label:n("stores"),name:"stores",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx(L6,{}),label:n("employees"),name:"employees",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx(B6,{}),label:n("commissions"),name:"commissions",roles:["admin","general_manager","area_manager","store_manager"]},{icon:h.jsx(P6,{}),label:n("products"),name:"products",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx(V6,{}),label:n("duvets"),name:"duvets",roles:["admin","general_manager","area_manager","store_manager","employee"]},{icon:h.jsx(F6,{}),label:n("smart_upload"),name:"uploads",roles:["admin","general_manager","area_manager"]},{icon:h.jsx(z6,{}),label:n("settings"),name:"settings",roles:["admin","general_manager"]},{icon:h.jsx("span",{children:"⏳"}),label:n("pending_approvals"),name:"pendingApprovals",roles:["admin"]},{icon:h.jsx("span",{children:"👥"}),label:n("roles_management"),name:"rolesManagement",roles:["admin"]}].filter(Ne=>Ne.roles.includes(se))},[t,n]);if(M.useEffect(()=>{var se;t&&!ze.find(ie=>ie.name===s)&&u(((se=ze[0])==null?void 0:se.name)||"dashboard")},[ze,s,t]),(t==null?void 0:t.status)==="pending")return h.jsx(A5,{onLogout:Gn});const hr=()=>{if(U)return h.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})});if(s==="stores"&&xe)return h.jsx(k5,{store:xe,allMetrics:w,onBack:()=>Ve(null),allStores:Ce.storeSummary,setModalState:P,allDateData:st,profile:t});const se={dateFilter:$,setDateFilter:ie=>Dn(O,ie),areaStoreFilter:R,setAreaStoreFilter:ie=>Dn(X,ie),allStores:p,allDateData:st,setModalState:P,isRecalculating:we,profile:t};switch(s){case"dashboard":return h.jsx(i5,{...Ce,...se,dashboardPieFilter:q,setDashboardPieFilter:J,tasks:T,onUpdateTaskStatus:Do,isProcessing:ae});case"stores":return h.jsx(h5,{...Ce,...se,onEdit:ie=>P({type:"store",data:ie}),onDelete:(ie,Ne)=>Ir("stores",ie,Ne),onSelectStore:Ve,allMetrics:w});case"employees":return h.jsx(d5,{...Ce,...se,onEdit:ie=>P({type:"employee",data:ie}),onDelete:(ie,Ne)=>Ir("employees",ie,Ne),dailyMetrics:w,salesTransactions:b,kingDuvetSales:_,allEmployees:y,storeSummary:Ce.storeSummary});case"products":return h.jsx(p5,{...Ce,...se});case"duvets":return h.jsx(m5,{...Ce,...se});case"commissions":return h.jsx(g5,{...Ce,...se});case"uploads":return h.jsx(v5,{onUpload:Ze,isProcessing:ae,uploadResult:at,onClearResult:dt});case"lfl":return h.jsx(w5,{allStores:p,allMetrics:w,profile:t});case"settings":return h.jsx(T5,{employeeSummary:Object.values(Ce.employeeSummary).flat(),storeSummary:Ce.storeSummary,kingDuvetSales:_,onAddMonthlyData:()=>P({type:"monthlyStoreMetric"}),onDeleteAllData:oe,onSelectiveDelete:ye,isProcessing:ae,businessRules:x,onSaveRule:Te,onDeleteRule:ie=>Ir("businessRules",ie,"this rule"),profile:t});case"pendingApprovals":return h.jsx(D5,{});case"rolesManagement":return h.jsx(M5,{});default:return h.jsxs("div",{className:"text-center p-10 bg-white rounded-lg shadow",children:[h.jsx("h2",{className:"text-2xl font-bold text-zinc-800",children:n("page_not_found_title")}),h.jsx("p",{className:"text-zinc-500 mt-2",children:n("page_not_found_message")})]})}},Mn={...Ce,salesTransactions:b,kingDuvetSales:_},fr=r==="ar"?"translate-x-full":"-translate-x-full",qs=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="general_manager";return h.jsxs("div",{className:"relative md:flex",children:[c&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",onClick:()=>f(!1)}),h.jsxs("aside",{className:`w-64 sm:w-72 bg-white border-r border-primary-100 h-screen flex flex-col fixed inset-y-0 ltr:left-0 rtl:right-0 transform ${c?"translate-x-0":fr} md:translate-x-0 transition-all duration-300 ease-in-out z-30 shadow-xl`,children:[h.jsx("div",{className:"p-4 sm:p-6 border-b border-primary-100",children:h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center shadow-lg",children:h.jsx("span",{className:"text-white font-bold text-lg",children:"K.A"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl font-bold text-neutral-900",children:"COCKPIT"}),h.jsx("p",{className:"text-sm text-neutral-500",children:"Management Dashboard"})]})]})}),h.jsx("nav",{className:"flex-grow overflow-y-auto p-3 sm:p-4",children:h.jsx("ul",{className:"space-y-2",children:ze.map(se=>h.jsx(Q5,{...se,activeTab:s,setActiveTab:u,setIsSidebarOpen:f},se.name))})}),h.jsxs("div",{className:"p-3 sm:p-4 border-t border-primary-100 bg-white",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center",children:h.jsx("span",{className:"text-white text-sm font-bold",children:((Tu=(Xt=t==null?void 0:t.name)==null?void 0:Xt.charAt(0))==null?void 0:Tu.toUpperCase())||"U"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm font-semibold text-neutral-900 truncate",children:(t==null?void 0:t.name)||"User"}),h.jsx("p",{className:"text-xs text-neutral-500 capitalize",children:(t==null?void 0:t.role)||"employee"})]})]}),h.jsx("div",{className:"text-center text-xs text-neutral-400",children:"Developed by K.A Team"})]})]}),h.jsxs("main",{className:"flex-1 p-2 sm:p-4 md:p-6 md:ltr:ml-64 md:rtl:mr-64 lg:ltr:ml-72 lg:rtl:mr-72 bg-neutral-50 min-h-screen",children:[h.jsx("header",{className:"bg-white rounded-2xl shadow-lg border border-neutral-200 p-4 sm:p-6 mb-4 sm:mb-6",children:h.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-3",children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsx("button",{className:"md:hidden p-3 text-neutral-600 hover:bg-neutral-100 rounded-xl transition-all duration-200",onClick:()=>f(!0),children:h.jsx(K6,{})}),h.jsx("div",{className:"min-w-0",children:h.jsx("h2",{className:"text-2xl font-bold text-neutral-900 capitalize truncate max-w-[70vw] sm:max-w-none",children:n(s.replace(/([A-Z])/g," $1").replace("ai","AI"))})})]}),h.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[qs&&h.jsx(X5,{notifications:re,onNotificationClick:et}),h.jsxs("button",{onClick:()=>o(r==="en"?"ar":"en"),className:"px-3 py-1.5 text-xs font-semibold rounded-full border border-zinc-300 hover:bg-gray-100 text-zinc-700",title:r==="en"?"العربية":"English",children:[r==="en"?"A":"ع"," - ",r==="en"?"ع":"A"]}),h.jsx(J5,{user:e,profile:t,onLogout:Gn})]})]})}),hr()]}),h.jsx(C5,{fullData:Mn,currentPage:s,businessRules:x}),V.type&&h.jsxs("div",{className:"modal-backdrop",children:[V.type==="visitors"&&h.jsx(R5,{onSave:ve,onClose:()=>P({type:null}),isProcessing:ae,stores:Ce.storeSummary,profile:t}),V.type==="employee"&&h.jsx(O5,{profile:t,data:V.data,onSave:se=>Hr("employees",se),onClose:()=>P({type:null}),isProcessing:ae,stores:p}),V.type==="store"&&h.jsx(L5,{profile:t,data:V.data,onSave:se=>Hr("stores",se),onClose:()=>P({type:null}),isProcessing:ae}),V.type==="dailyMetric"&&h.jsx(P5,{data:V.data,onSave:zs,onClose:()=>P({type:null}),isProcessing:ae,stores:p}),V.type==="monthlyStoreMetric"&&h.jsx(U5,{onSave:Ue,onClose:()=>P({type:null}),isProcessing:ae,stores:p}),V.type==="userEdit"&&h.jsx(F5,{data:V.data,onSave:qt,onClose:()=>P({type:null}),isProcessing:ae,stores:p,allEmployees:y}),V.type==="aiCoaching"&&h.jsx(B5,{data:V.data,onClose:()=>P({type:null})}),V.type==="salesForecast"&&h.jsx(z5,{salesData:V.data,onClose:()=>P({type:null})}),V.type==="salesPitch"&&h.jsx(q5,{product:V.data,onClose:()=>P({type:null})}),V.type==="naturalLanguageSearch"&&h.jsx(K5,{query:V.data.query,fullData:Ce,onClose:()=>P({type:null})}),V.type==="aiComparison"&&h.jsx(H5,{data:V.data.item,allItems:V.data.allItems,type:V.data.type,onClose:()=>P({type:null})}),V.type==="aiPrediction"&&h.jsx(G5,{data:V.data,onClose:()=>P({type:null})}),V.type==="kpiBreakdown"&&h.jsx(W5,{data:V.data,onClose:()=>P({type:null})}),V.type==="productDetails"&&h.jsx(Y5,{data:V.data,onClose:()=>P({type:null})}),V.type==="task"&&h.jsx(V5,{data:V.data,onSave:Kt,onClose:()=>P({type:null}),isProcessing:ae})]}),Z.isOpen&&h.jsx($5,{message:Z,onClose:()=>z({isOpen:!1,text:"",type:"alert"})})]})},eB=()=>{const{t:e}=Oe(),[t,n]=M.useState("login"),[r,o]=M.useState(""),[s,u]=M.useState(""),[c,f]=M.useState(""),[p,m]=M.useState(""),[y,v]=M.useState(""),[w,E]=M.useState(""),[_,C]=M.useState(""),[b,N]=M.useState(null),[x,j]=M.useState(null),[k,A]=M.useState(!1),T=async $=>{$.preventDefault(),A(!0),N(null);try{let O=r;if(!r.includes("@")){const q=await Se.collection("users").where("employeeId","==",r).limit(1).get();if(q.empty)throw new Error(e("error_no_user_id"));const J=q.docs[0].data();if(!(J!=null&&J.email))throw new Error(e("error_no_user_email"));O=J.email}await Nc.signInWithEmailAndPassword(O,s)}catch(O){N(O.message||e("error_login_failed"))}finally{A(!1)}},L=async $=>{$.preventDefault(),A(!0),N(null),j(null);try{if(w!==_)throw new Error(e("passwords_do_not_match"));const R=(await Nc.createUserWithEmailAndPassword(y,w)).user;R&&(await R.updateProfile({displayName:c}),await Se.collection("users").doc(R.uid).set({id:R.uid,name:c,employeeId:p,email:y,role:"employee",status:"pending"}),j(e("sign_up_success")),setTimeout(()=>{n("login"),j(null)},2e3))}catch(O){N(O.message)}finally{A(!1)}},U=h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:h.jsxs("div",{className:"w-full max-w-lg bg-white rounded-2xl shadow-lg p-8",children:[h.jsxs("div",{className:"text-center mb-4",children:[h.jsx("div",{className:"mx-auto mb-4 w-14 h-14 rounded-xl bg-orange-600 text-white flex items-center justify-center font-bold text-xl",children:"K.A"}),h.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Cockpit"}),h.jsx("p",{className:"mt-1 text-gray-600",children:e("please_sign_in")})]}),h.jsxs("form",{className:"space-y-4",onSubmit:T,children:[h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(uI,{})}),h.jsx("input",{className:"auth-input",type:"text",placeholder:e("email_or_id"),value:r,onChange:$=>o($.target.value),required:!0})]}),h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(Jv,{})}),h.jsx("input",{className:"auth-input",type:"password",placeholder:e("password"),value:s,onChange:$=>u($.target.value),required:!0})]}),b&&h.jsx("p",{className:"text-sm text-red-500",children:b}),h.jsx("button",{className:"auth-button w-full",type:"submit",disabled:k,children:e(k?"signing_in":"sign_in")})]}),h.jsxs("div",{className:"text-center mt-4 text-sm text-gray-600",children:[e("no_account")," ",h.jsx("button",{onClick:()=>{n("signup"),N(null)},className:"font-medium text-orange-600 hover:underline",children:e("sign_up")})]})]})}),K=h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:h.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-lg p-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 text-center mb-6",children:e("create_your_account")}),h.jsxs("form",{className:"grid grid-cols-1 gap-4",onSubmit:L,children:[h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(aI,{})}),h.jsx("input",{className:"auth-input",type:"text",placeholder:e("name"),value:c,onChange:$=>f($.target.value),required:!0})]}),h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(aI,{})}),h.jsx("input",{className:"auth-input",type:"text",placeholder:e("employee_id"),value:p,onChange:$=>m($.target.value),required:!0})]}),h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(uI,{})}),h.jsx("input",{className:"auth-input",type:"email",placeholder:e("email"),value:y,onChange:$=>v($.target.value),required:!0})]}),h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(Jv,{})}),h.jsx("input",{className:"auth-input",type:"password",placeholder:e("password"),value:w,onChange:$=>E($.target.value),required:!0})]}),h.jsxs("div",{className:"auth-input-container",children:[h.jsx("span",{className:"auth-input-icon",children:h.jsx(Jv,{})}),h.jsx("input",{className:"auth-input",type:"password",placeholder:e("confirm_password"),value:_,onChange:$=>C($.target.value),required:!0})]}),b&&h.jsx("p",{className:"text-sm text-red-500",children:b}),x&&h.jsx("p",{className:"text-sm text-green-600",children:x}),h.jsx("button",{className:"auth-button w-full mt-2",type:"submit",disabled:k,children:e(k?"signing_in":"sign_up")})]}),h.jsxs("div",{className:"text-center mt-4 text-sm text-gray-600",children:[e("already_have_account")," ",h.jsx("button",{onClick:()=>{n("login"),N(null)},className:"font-medium text-orange-600 hover:underline",children:e("sign_in")})]})]})});return t==="login"?U:K},tB=()=>h.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-orange-600 mx-auto"}),h.jsx("p",{className:"mt-4 text-xl font-semibold text-zinc-700",children:"Initializing..."})]})}),nB=()=>{const{user:e,profile:t,loading:n}=KV(),{locale:r}=Oe();return M.useEffect(()=>{document.documentElement.lang=r,document.documentElement.dir=r==="ar"?"rtl":"ltr"},[r]),n?h.jsx(tB,{}):h.jsx("div",{className:"bg-gray-50 min-h-screen font-sans",children:e&&t?h.jsx(Z5,{user:e,profile:t}):h.jsx(eB,{})})},LA=document.getElementById("root");if(!LA)throw new Error("Could not find root element to mount to");const rB=Zv.createRoot(LA);rB.render(h.jsx(Bl.StrictMode,{children:h.jsx(HV,{children:h.jsx(l5,{children:h.jsx(nB,{})})})}));
